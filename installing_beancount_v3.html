<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://beancount.github.io/docs/installing_beancount_v3.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Installing Beancount - Beancount Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link href="assets/_mkdocstrings.css" rel="stylesheet" />
  <link href="css/custom.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Installing Beancount";
    var mkdocs_page_input_path = "installing_beancount_v3.md";
    var mkdocs_page_url = "/docs/installing_beancount_v3.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> Beancount Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="index.html">Index</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Outline</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="command_line_accounting_in_context.html">Command Line Accounting in Context</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="the_double_entry_counting_method.html">The Double Entry Counting Method</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="installing_beancount.html">Installing Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="getting_started_with_beancount.html">Getting Started with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_language_syntax.html">Beancount Language Syntax</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_options_reference.html">Beancount Options Reference</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="precision_tolerances.html">Precision Tolerances</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_query_language.html">Beancount Query Language</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="how_inventories_work.html">How Inventories Work</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="exporting_your_portfolio.html">Exporting Your Portfolio</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="tutorial_example.html">Tutorial & Example</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_history_and_credits.html">Beancount History and Credits</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="importing_external_data.html">Importing External Data</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Cookbooks & Examples</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="trading_with_beancount.html">Trading with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="how_we_share_expenses.html">How We Share Expenses</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="health_care_expenses.html">Health Care Expenses</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="calculating_portolio_returns.html">Calculating Portfolio Returns</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="tracking_medical_claims.html">Tracking Out-of-Network Medical Claims in Beancount</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_design_doc.html">Beancount Design Doc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="external_contributions.html">External Contributions</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals & Discussions</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="#">Beancount 3</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="beancount_v3.html">Goals & Design</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="installing_beancount_v3.html">Installing Beancount</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#setup-python">Setup Python</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#building-with-bazel">Building with Bazel</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#bazel-dependencies">Bazel Dependencies</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#building-testing">Building &amp; Testing</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#development">Development</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#ingestion">Ingestion</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#tbd">TBD</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#installation-for-development-with-meson">Installation for development with meson</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#on-linux">On Linux</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#on-windows">On Windows</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beancount_v3_dependencies.html">Dependencies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="beangulp.html">Beangulp</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/index.html">beancount</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.core.html">beancount.core</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.loader.html">beancount.loader</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.ops.html">beancount.ops</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.parser.html">beancount.parser</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.plugins.html">beancount.plugins</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.scripts.html">beancount.scripts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.tools.html">beancount.tools</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="api_reference/beancount.utils.html">beancount.utils</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Beancount Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
      
        
          <li>Outline &raquo;</li>
        
      
        
          <li>Beancount 3 &raquo;</li>
        
      
    
    <li>Installing Beancount</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="installing-beancount-c-version">Installing Beancount (C++ version)<a id="title"></a><a class="headerlink" href="#installing-beancount-c-version" title="Permanent link"></a></h1>
<p><a href="mailto:blais@furius.ca"><u>Martin Blais</u></a> - July 2020</p>
<p><a href="http://furius.ca/beancount/doc/v3-install"><u>http://furius.ca/beancount/doc/v3-install</u></a></p>
<p><em>Instructions for downloading and running Beancount v3 (in development) on your computer. For v2, see this document instead: <a href="installing_beancount.html">Beancount - Install (v2)</a></em></p>
<table><tbody><tr class="odd"><td><em><strong>This document is about Beancount v3, an experimental in-development version (as of July 2020); Instructions for building the stable version (Beancount v2) can be found in <a href="installing_beancount.md"><u>this other document</u></a>.</strong></em></td></tr></tbody></table>

<h2 id="setup-python">Setup Python<a id="setup-python"></a><a class="headerlink" href="#setup-python" title="Permanent link"></a></h2>
<p>Python dependencies are still required to run programs.</p>
<pre><code>pip install –r requirements/dev.txt
</code></pre>
<h2 id="building-with-bazel">Building with Bazel<a id="building-with-bazel"></a><a class="headerlink" href="#building-with-bazel" title="Permanent link"></a></h2>
<p><em>Warning: This is an experimental development branch. Do not expect everything to be polished perfectly.</em></p>
<h3 id="bazel-dependencies">Bazel Dependencies<a id="bazel-dependencies"></a><a class="headerlink" href="#bazel-dependencies" title="Permanent link"></a></h3>
<p>Beancount v3 uses the Bazel build system, which for the most part insulates you from local installs and dependencies from your computer.</p>
<p>The dependencies to install are:</p>
<ul>
<li>
<p><strong>Bazel itself.</strong> Follow instructions on <a href="https://bazel.build/"><u>https://bazel.build/</u></a></p>
</li>
<li>
<p><strong>A C++ compiler.</strong> Either g++ or clang works. I'm using clang-11.</p>
</li>
<li>
<p><strong>A Python runtime</strong> (version 3.8 or above). Install from your distribution.</p>
</li>
</ul>
<p>Bazel will download and compile all the libraries it requires itself (even the code generators, e.g., Bison), building them at their precise versions as specified in the build, so you will not have to worry about them.</p>
<h3 id="building-testing">Building &amp; Testing<a id="building-testing"></a><a class="headerlink" href="#building-testing" title="Permanent link"></a></h3>
<p>Simply run the following command:</p>
<pre><code>bazel build //bin:all
</code></pre>
<p>There is currently no installation script, you have to run from source. You can run individual programs (e.g. bean-check) with this command:</p>
<pre><code>bazel run //bin:bean_check -- /path/to/ledger.beancount
</code></pre>
<p>Or if you don't care to automatically rebuild modified code, like this:</p>
<pre><code> ./bazel-bin/bin/bean_check /path/to/ledger.beancount
</code></pre>
<h3 id="development">Development<a id="development"></a><a class="headerlink" href="#development" title="Permanent link"></a></h3>
<p>You can run all the unit tests like this:</p>
<pre><code>bazel test //...
</code></pre>
<p>Because Bazel has a detailed account of all dependencies, re-running this command after modifying code will result in only the touched targets being re-tested; this makes iterative development with testing a bit more fun.</p>
<p>Another advantage is that since all the libraries the build depends on are downloaded and built, while this can be slow on the first build, it allows us to use very recently released versions of the code we depend on.</p>
<p>Targets are defined in BUILD files local to their directories. All the build rules can be found under //third_party.</p>
<h3 id="ingestion">Ingestion<a id="ingestion"></a><a class="headerlink" href="#ingestion" title="Permanent link"></a></h3>
<p>The ingestion code involves importing code that lives outside the repository. Bazel binaries are self-contained and will fail to import modules that haven't been declared as dependencies, so running the <code>//bin:bean_extract</code> target, for example, probably won't work.</p>
<p>This does not work yet (short of building your import configuration as a py_binary() target that would explicitly link to Beancount). This is doable without writing much Bazel code by defining a suitable WORKSPACE file that fetches the rules from it. I haven't produced an example of this yet (TBD).</p>
<p>As a workaround, you can set your PYTHONPATH to import from the source location and create a symlink to the parser .so file beforehand. You can do it like this:</p>
<pre><code>make bazel-link
</code></pre>
<h3 id="tbd">TBD<a id="tbd"></a><a class="headerlink" href="#tbd" title="Permanent link"></a></h3>
<p>A few build integration tasks remain to be done:</p>
<ul>
<li>
<p>pytype is not supported yet.</p>
</li>
<li>
<p>pylint is not integrated in the build either.</p>
</li>
</ul>
<h2 id="installation-for-development-with-meson">Installation for development with meson <a id="installation-for-development-with-meson"></a><a class="headerlink" href="#installation-for-development-with-meson" title="Permanent link"></a></h2>
<p><em><strong>Note</strong>: this section is updated base on the following discussion: <a href="https://groups.google.com/g/beancount/c/7ppbyz_5B5w"><u>https://groups.google.com/g/beancount/c/7ppbyz_5B5w</u></a></em></p>
<p>The Bazel build for Beancount v3 builds some experimental C++ code that is at the time of writing (9 March 2024) not yet used for anything else than a technology demonstration. In “production” v3 uses meson-python to build the extension modules and pack them up in a Python wheel. This is what is used by pip during installation.</p>
<p>This section describes installation processes for the purposes of development beancount v3 python code, rather than experimenting with C++ code.</p>
<h3 id="on-linux">On Linux<a id="on-linux"></a><a class="headerlink" href="#on-linux" title="Permanent link"></a></h3>
<p>Tested with python3.12 on Ubuntu</p>
<p>Related links</p>
<p><a href="https://mesonbuild.com/meson-python/how-to-guides/editable-installs.html#build-dependencies"><u>https://mesonbuild.com/meson-python/how-to-guides/editable-installs.html</u></a></p>
<pre><code>git clone https://github.com/beancount/beancount.git
</code></pre>
<p>Create and activate virtual environment</p>
<pre><code>python3.12 -m venv beancount/venv
. beancount/venv/bin/activate
cd beancount
</code></pre>
<p>Install required packages.</p>
<pre><code>python -m pip install meson-python meson ninja
</code></pre>
<p>Install beancount in editable mode with no build isolation</p>
<pre><code>python -m pip install --no-build-isolation --editable .
</code></pre>
<p><strong>Note:</strong> There is an <a href="https://groups.google.com/g/beancount/c/7ppbyz_5B5w/m/YlHiKhynFAAJ"><u>opinion</u></a> that --no-build-isolation option is not needed, but it was also mentioned that the <a href="https://groups.google.com/g/beancount/c/7ppbyz_5B5w/m/nSxCzuutFAAJ"><u>installation wasn’t working</u></a> without this option. Also the <a href="https://mesonbuild.com/meson-python/how-to-guides/editable-installs.html#editable-installs"><u>documentation</u></a> suggests that this option is needed. This may depend on the type of Linux environment</p>
<p>Install pytest</p>
<pre><code>python -m pip install pytest
</code></pre>
<p>Run the tests and make sure everything is ok:</p>
<pre><code>pytest --import-mode=importlib beancount/
</code></pre>
<h3 id="on-windows">On Windows<a id="on-windows"></a><a class="headerlink" href="#on-windows" title="Permanent link"></a></h3>
<p>Tested on 64 bit Windows 10 Pro</p>
<p><strong>prerequisites</strong></p>
<p>Install Microsoft Visual Studio (tested on v 2022)</p>
<p><strong>Procedure</strong></p>
<pre><code>git clone https://github.com/beancount/beancount.git
cd beancount
</code></pre>
<p>If running x64 bit Windows, start the "x64 Native Tools Command Prompt for VS 20XX". To do this press and release the Windows keys and type x64</p>
<p><img src="installing_beancount_v3/media/9c5ea265a2ff61958e89a0965bd95bbd54854eb0.png" style="width:3.83854in;height:2.03255in" /></p>
<p>Open this prompt</p>
<p>Go to the directory, where beancount is installed</p>
<pre><code>C:\Program Files\Microsoft Visual Studio\2022\Community&gt;cd C:\_code\t\beancount
C:\_code\t\beancount&gt;
</code></pre>
<p>Activate the virtual environment</p>
<pre><code>C:\_code\t\beancount&gt;venv\Scripts\Activate
(venv) C:\_code\t\beancount&gt;
</code></pre>
<p>Instal required packages</p>
<pre><code>(venv) C:\_code\t\beancount&gt;py -m pip install meson-python meson ninja
</code></pre>
<p>Install beancount in editable mode. Unlike on Linux the <strong><code>--no-build-isolation</code></strong> on Windows from one side throws some errors from the other side does not seem to be needed</p>
<pre><code>(venv) C:\_code\t\beancount&gt; py -m pip install --editable .
</code></pre>
<p>Install pytest</p>
<pre><code>(venv) C:\_code\t\beancount&gt;py -m pip install pytest
</code></pre>
<p>Run tests</p>
<pre><code>(venv) C:\_code\t\beancount&gt;pytest --import-mode=importlib beancount
</code></pre>
<p>Note: some of the tests on Windows fail, but this is due to general <a href="https://github.com/beancount/beancount/issues?q=is%3Aopen+is%3Aissue+label%3Aportability"><u>portability issue</u></a></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="beancount_v3_dependencies.html" class="btn btn-neutral float-right" title="Dependencies">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="beancount_v3.html" class="btn btn-neutral" title="Goals & Design"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="beancount_v3.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="beancount_v3_dependencies.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
