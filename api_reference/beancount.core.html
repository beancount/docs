<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://beancount.github.io/docs/api_reference/beancount.core.html" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>beancount.core - Beancount Documentation</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="../css/custom.css" rel="stylesheet"/>
<script>
    // Current page data
    var mkdocs_page_name = "beancount.core";
    var mkdocs_page_input_path = "api_reference/beancount.core.md";
    var mkdocs_page_url = "/docs/api_reference/beancount.core.html";
  </script>
<script defer="" src="../js/jquery-2.1.1.min.js"></script>
<script defer="" src="../js/modernizr-2.8.3.min.js"></script>
</link></link></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> Beancount Documentation</a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Index</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Outline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../command_line_accounting_in_context.html">Command Line Accounting in Context</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../the_double_entry_counting_method.html">The Double Entry Counting Method</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installing_beancount.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_with_beancount.html">Getting Started with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_language_syntax.html">Beancount Language Syntax</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_options_reference.html">Beancount Options Reference</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../precision_tolerances.html">Precision Tolerances</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_query_language.html">Beancount Query Language</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_inventories_work.html">How Inventories Work</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../exporting_your_portfolio.html">Exporting Your Portfolio</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_example.html">Tutorial &amp; Example</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_history_and_credits.html">Beancount History and Credits</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../importing_external_data.html">Importing External Data</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Cookbooks &amp; Examples</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../trading_with_beancount.html">Trading with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_we_share_expenses.html">How We Share Expenses</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../health_care_expenses.html">Health Care Expenses</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../calculating_portolio_returns.html">Calculating Portfolio Returns</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_design_doc.html">Beancount Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../external_contributions.html">External Contributions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals &amp; Discussions</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Beancount 3</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../beancount_v3.html">Goals &amp; Design</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installing_beancount_v3.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../beancount_v3_dependencies.html">Dependencies</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">beancount</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="beancount.core.html">beancount.core</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#beancount.core">beancount.core</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.account">account</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.AccountTransformer">AccountTransformer</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.account.AccountTransformer.parse">parse()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.account.AccountTransformer.render">render()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.commonprefix">commonprefix()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.has_component">has_component()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.is_valid">is_valid()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.join">join()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.leaf">leaf()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.parent">parent()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.parent_matcher">parent_matcher()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.parents">parents()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.root">root()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.sans_root">sans_root()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.split">split()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.walk">walk()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.account_types">account_types</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.AccountTypes">AccountTypes</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.account_types.AccountTypes.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.account_types.AccountTypes.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.account_types.AccountTypes.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.get_account_sign">get_account_sign()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.get_account_sort_key">get_account_sort_key()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.get_account_type">get_account_type()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_account_type">is_account_type()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_balance_sheet_account">is_balance_sheet_account()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_equity_account">is_equity_account()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_income_statement_account">is_income_statement_account()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_root_account">is_root_account()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.amount">amount</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.Amount">Amount</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__bool__">__bool__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__eq__">__eq__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__hash__">__hash__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__lt__">__lt__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__neg__">__neg__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__str__">__str__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.from_string">from_string()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.to_string">to_string()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.A">A()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.abs">abs()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.add">add()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.div">div()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.from_string">from_string()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.mul">mul()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.sortkey">sortkey()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.sub">sub()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.compare">compare</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.CompareError">CompareError</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.compare.CompareError.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.compare.CompareError.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.compare.CompareError.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.compare_entries">compare_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.excludes_entries">excludes_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.hash_entries">hash_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.hash_entry">hash_entry()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.includes_entries">includes_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.stable_hash_namedtuple">stable_hash_namedtuple()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.convert">convert</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.convert_amount">convert_amount()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.convert_position">convert_position()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_cost">get_cost()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_units">get_units()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_value">get_value()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_weight">get_weight()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.data">data</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Balance">Balance</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Balance.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Balance.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Balance.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Booking">Booking</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Close">Close</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Close.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Close.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Close.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Commodity">Commodity</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Commodity.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Commodity.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Commodity.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Custom">Custom</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Custom.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Custom.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Custom.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Document">Document</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Document.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Document.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Document.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Event">Event</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Event.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Event.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Event.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Note">Note</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Note.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Note.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Note.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Open">Open</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Open.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Open.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Open.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Pad">Pad</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Pad.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Pad.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Pad.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Posting">Posting</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Posting.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Posting.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Posting.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Price">Price</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Price.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Price.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Price.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Query">Query</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Query.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Query.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Query.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Transaction">Transaction</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Transaction.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Transaction.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Transaction.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.TxnPosting">TxnPosting</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.TxnPosting.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.TxnPosting.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.TxnPosting.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.create_simple_posting">create_simple_posting()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.create_simple_posting_with_cost">create_simple_posting_with_cost()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.entry_sortkey">entry_sortkey()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.filter_txns">filter_txns()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.find_closest">find_closest()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.get_entry">get_entry()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.has_entry_account_component">has_entry_account_component()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.iter_entry_dates">iter_entry_dates()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.new_directive">new_directive()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.new_metadata">new_metadata()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.posting_has_conversion">posting_has_conversion()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.posting_sortkey">posting_sortkey()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.remove_account_postings">remove_account_postings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.sanity_check_types">sanity_check_types()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.sorted">sorted()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.transaction_has_conversion">transaction_has_conversion()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.display_context">display_context</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.Align">Align</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.DisplayContext">DisplayContext</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.build">build()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.quantize">quantize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.set_commas">set_commas()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.DisplayFormatter">DisplayFormatter</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.Precision">Precision</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.distribution">distribution</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.distribution.Distribution">Distribution</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.empty">empty()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.max">max()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.min">min()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.mode">mode()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.update">update()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.flags">flags</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.getters">getters</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.GetAccounts">GetAccounts</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Balance">Balance()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Close">Close()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Commodity">Commodity()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Custom">Custom()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Document">Document()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Event">Event()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.get_accounts_use_map">get_accounts_use_map()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.get_entry_accounts">get_entry_accounts()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Note">Note()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Open">Open()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Pad">Pad()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Price">Price()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Query">Query()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Transaction">Transaction()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_account_components">get_account_components()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_account_open_close">get_account_open_close()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_accounts">get_accounts()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_accounts_use_map">get_accounts_use_map()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_active_years">get_active_years()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_all_links">get_all_links()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_all_payees">get_all_payees()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_all_tags">get_all_tags()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_commodity_map">get_commodity_map()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_dict_accounts">get_dict_accounts()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_entry_accounts">get_entry_accounts()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_leveln_parent_accounts">get_leveln_parent_accounts()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_min_max_dates">get_min_max_dates()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_values_meta">get_values_meta()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.interpolate">interpolate</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.BalanceError">BalanceError</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.interpolate.BalanceError.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.interpolate.BalanceError.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.interpolate.BalanceError.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.compute_entries_balance">compute_entries_balance()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.compute_entry_context">compute_entry_context()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.compute_residual">compute_residual()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.fill_residual_posting">fill_residual_posting()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.get_residual_postings">get_residual_postings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.has_nontrivial_balance">has_nontrivial_balance()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.infer_tolerances">infer_tolerances()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.is_tolerance_user_specified">is_tolerance_user_specified()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.quantize_with_tolerance">quantize_with_tolerance()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.inventory">inventory</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.Booking">Booking</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.Inventory">Inventory</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__abs__">__abs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__add__">__add__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__copy__">__copy__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__iadd__">__iadd__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__iter__">__iter__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__lt__">__lt__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__mul__">__mul__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__neg__">__neg__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__str__">__str__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.add_amount">add_amount()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.add_inventory">add_inventory()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.add_position">add_position()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.average">average()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.cost_currencies">cost_currencies()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.currencies">currencies()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.currency_pairs">currency_pairs()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.from_string">from_string()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.get_currency_units">get_currency_units()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.get_only_position">get_only_position()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.get_positions">get_positions()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_empty">is_empty()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_mixed">is_mixed()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_reduced_by">is_reduced_by()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_small">is_small()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.reduce">reduce()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.segregate_units">segregate_units()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.to_string">to_string()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.check_invariants">check_invariants()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.from_string">from_string()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.number">number</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.D">D()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.is_fast_decimal">is_fast_decimal()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.round_to">round_to()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.same_sign">same_sign()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.position">position</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.Cost">Cost</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Cost.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Cost.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Cost.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.CostSpec">CostSpec</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.CostSpec.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.CostSpec.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.CostSpec.__repr__">__repr__()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.Position">Position</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__abs__">__abs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__copy__">__copy__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__eq__">__eq__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__hash__">__hash__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__lt__">__lt__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__mul__">__mul__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__neg__">__neg__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__str__">__str__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.currency_pair">currency_pair()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.from_amounts">from_amounts()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.from_string">from_string()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.get_negative">get_negative()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.is_negative_at_cost">is_negative_at_cost()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.sortkey">sortkey()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.to_string">to_string()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.cost_to_str">cost_to_str()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.from_amounts">from_amounts()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.from_string">from_string()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.get_position">get_position()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.to_string">to_string()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.prices">prices</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.PriceMap">PriceMap</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.build_price_map">build_price_map()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_all_prices">get_all_prices()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_last_price_entries">get_last_price_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_latest_price">get_latest_price()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_price">get_price()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.normalize_base_quote">normalize_base_quote()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.core.realization">realization</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.RealAccount">RealAccount</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__eq__">__eq__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__ne__">__ne__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__setitem__">__setitem__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.copy">copy()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.compute_balance">compute_balance()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.compute_postings_balance">compute_postings_balance()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.contains">contains()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.dump">dump()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.dump_balances">dump_balances()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.filter">filter()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.find_last_active_posting">find_last_active_posting()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.get">get()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.get_or_create">get_or_create()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.get_postings">get_postings()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.index_key">index_key()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.iter_children">iter_children()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.iterate_with_balance">iterate_with_balance()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.postings_by_account">postings_by_account()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.realize">realize()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ingest.html">beancount.ingest</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.loader.html">beancount.loader</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ops.html">beancount.ops</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.parser.html">beancount.parser</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.prices.html">beancount.prices</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.query.html">beancount.query</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.reports.html">beancount.reports</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.tools.html">beancount.tools</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.utils.html">beancount.utils</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.web.html">beancount.web</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">Beancount Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="..">Docs</a> »</li>
<li>API reference »</li>
<li>beancount.core</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/beancount/docs/edit/master/docs/api_reference/beancount.core.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div role="main">
<div class="section">
<h1 id="beancountcore">beancount.core<a class="headerlink" href="#beancountcore" title="Permanent link"></a></h1>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#beancount.core" id="beancount.core" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#beancount.core" title="Permanent link"></a></h2>
<div class="doc doc-contents first">
<p>Core basic objects and data structures to represent a list of entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.account">
<code>beancount.core.account</code>
<a class="headerlink" href="#beancount.core.account" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Functions that operate on account strings.</p>
<p>These account objects are rather simple and dumb; they do not contain the list
of their associated postings. This is achieved by building a realization; see
realization.py for details.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.account.AccountTransformer">
<code>beancount.core.account.AccountTransformer</code>
<a class="headerlink" href="#beancount.core.account.AccountTransformer" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Account name transformer.</p>
<pre><code>This is used to support Win... huh, filesystems and platforms which do not
support colon characters.

Attributes:
  rsep: A character string, the new separator to use in link names.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.account.AccountTransformer.parse">
<code class="highlight language-python">
beancount.core.account.AccountTransformer.parse
(self, transformed_name)

        </code>
<a class="headerlink" href="#beancount.core.account.AccountTransformer.parse" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Convert the transform account name to an account name.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def parse(self, transformed_name):
    "Convert the transform account name to an account name."
    return (transformed_name
            if self.rsep is None
            else transformed_name.replace(self.rsep, sep))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.account.AccountTransformer.render">
<code class="highlight language-python">
beancount.core.account.AccountTransformer.render
(self, account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.AccountTransformer.render" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Convert the account name to a transformed account name.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def render(self, account_name):
    "Convert the account name to a transformed account name."
    return (account_name
            if self.rsep is None
            else account_name.replace(sep, self.rsep))
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.commonprefix">
<code class="highlight language-python">
beancount.core.account.commonprefix
(accounts)

        </code>
<a class="headerlink" href="#beancount.core.account.commonprefix" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the common prefix of a list of account names.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>accounts</code></td>
<td><code></code></td>
<td>
<p>A sequence of account name strings.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the common parent account. If none, returns an empty string.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def commonprefix(accounts):
    """Return the common prefix of a list of account names.

    Args:
      accounts: A sequence of account name strings.
    Returns:
      A string, the common parent account. If none, returns an empty string.
    """
    accounts_lists = [account_.split(sep)
                      for account_ in accounts]
    # Note: the os.path.commonprefix() function just happens to work here.
    # Inspect its code, and even the special case of no common prefix
    # works well with str.join() below.
    common_list = path.commonprefix(accounts_lists)
    return sep.join(common_list)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.has_component">
<code class="highlight language-python">
beancount.core.account.has_component
(account_name, component)

        </code>
<a class="headerlink" href="#beancount.core.account.has_component" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if one of the account contains a given component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, an account name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>component</code></td>
<td><code></code></td>
<td>
<p>A string, a component of an account name. For instance,
<code>Food</code> in <code>Expenses:Food:Restaurant</code>. All components are considered.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Boolean</code></td>
<td>
<p>true if the component is in the account. Note that a component
name must be whole, that is <code>NY</code> is not in <code>Expenses:Taxes:StateNY</code>.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def has_component(account_name, component):
    """Return true if one of the account contains a given component.

    Args:
      account_name: A string, an account name.
      component: A string, a component of an account name. For instance,
        ``Food`` in ``Expenses:Food:Restaurant``. All components are considered.
    Returns:
      Boolean: true if the component is in the account. Note that a component
      name must be whole, that is ``NY`` is not in ``Expenses:Taxes:StateNY``.
    """
    return bool(re.search('(^|:){}(:|$)'.format(component), account_name))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.is_valid">
<code class="highlight language-python">
beancount.core.account.is_valid
(string)

        </code>
<a class="headerlink" href="#beancount.core.account.is_valid" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the given string is a valid account name.
This does not check for the root account types, just the general syntax.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string, to be checked for account name pattern.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the string has the form of an account's name.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_valid(string):
    """Return true if the given string is a valid account name.
    This does not check for the root account types, just the general syntax.

    Args:
      string: A string, to be checked for account name pattern.
    Returns:
      A boolean, true if the string has the form of an account's name.
    """
    return (isinstance(string, str) and
            bool(re.match('{}$'.format(ACCOUNT_RE), string)))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.join">
<code class="highlight language-python">
beancount.core.account.join
    (*
components)

        </code>
<a class="headerlink" href="#beancount.core.account.join" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Join the names with the account separator.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*components</code></td>
<td><code></code></td>
<td>
<p>Strings, the components of an account name.</p>
</td>
<td><code>()</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, joined in a single account name.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def join(*components):
    """Join the names with the account separator.

    Args:
      *components: Strings, the components of an account name.
    Returns:
      A string, joined in a single account name.
    """
    return sep.join(components)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.leaf">
<code class="highlight language-python">
beancount.core.account.leaf
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.leaf" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the name of the leaf of this account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account whose leaf name to return.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the name of the leaf of the account.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def leaf(account_name):
    """Get the name of the leaf of this account.

    Args:
      account_name: A string, the name of the account whose leaf name to return.
    Returns:
      A string, the name of the leaf of the account.
    """
    assert isinstance(account_name, str)
    return account_name.split(sep)[-1] if account_name else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.parent">
<code class="highlight language-python">
beancount.core.account.parent
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.parent" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the name of the parent account of the given account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account whose parent to return.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the name of the parent account of this account.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def parent(account_name):
    """Return the name of the parent account of the given account.

    Args:
      account_name: A string, the name of the account whose parent to return.
    Returns:
      A string, the name of the parent account of this account.
    """
    assert isinstance(account_name, str), account_name
    if not account_name:
        return None
    components = account_name.split(sep)
    components.pop(-1)
    return sep.join(components)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.parent_matcher">
<code class="highlight language-python">
beancount.core.account.parent_matcher
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.parent_matcher" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Build a predicate that returns whether an account is under the given one.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>The name of the parent account we want to check for.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A callable, which, when called, will return true if the given account is a
child of <code>account_name</code>.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def parent_matcher(account_name):
    """Build a predicate that returns whether an account is under the given one.

    Args:
      account_name: The name of the parent account we want to check for.
    Returns:
      A callable, which, when called, will return true if the given account is a
      child of ``account_name``.
    """
    return re.compile(r'{}($|{})'.format(re.escape(account_name), sep)).match
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.parents">
<code class="highlight language-python">
beancount.core.account.parents
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.parents" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A generator of the names of the parents of this account, including this account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>The name of the account we want to start iterating from.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A generator of account name strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def parents(account_name):
    """A generator of the names of the parents of this account, including this account.

    Args:
      account_name: The name of the account we want to start iterating from.
    Returns:
      A generator of account name strings.
    """
    while account_name:
        yield account_name
        account_name = parent(account_name)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.root">
<code class="highlight language-python">
beancount.core.account.root
(num_components, account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.root" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the first few components of an account's name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_components</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of components to return.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, an account name.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the account root up to 'num_components' components.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def root(num_components, account_name):
    """Return the first few components of an account's name.

    Args:
      num_components: An integer, the number of components to return.
      account_name: A string, an account name.
    Returns:
      A string, the account root up to 'num_components' components.
    """
    return join(*(split(account_name)[:num_components]))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.sans_root">
<code class="highlight language-python">
beancount.core.account.sans_root
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.sans_root" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the name of the account without the root.</p>
<p>For example, an input of 'Assets:BofA:Checking' will produce 'BofA:Checking'.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account whose leaf name to return.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the name of the non-root portion of this account name.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def sans_root(account_name):
    """Get the name of the account without the root.

    For example, an input of 'Assets:BofA:Checking' will produce 'BofA:Checking'.

    Args:
      account_name: A string, the name of the account whose leaf name to return.
    Returns:
      A string, the name of the non-root portion of this account name.
    """
    assert isinstance(account_name, str)
    components = account_name.split(sep)[1:]
    return join(*components) if account_name else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.split">
<code class="highlight language-python">
beancount.core.account.split
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account.split" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Split an account's name into its components.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, an account name.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of strings, the components of the account name (without the separators).</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def split(account_name):
    """Split an account's name into its components.

    Args:
      account_name: A string, an account name.
    Returns:
      A list of strings, the components of the account name (without the separators).
    """
    return account_name.split(sep)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account.walk">
<code class="highlight language-python">
beancount.core.account.walk
(root_directory)

        </code>
<a class="headerlink" href="#beancount.core.account.walk" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A version of os.walk() which yields directories that are valid account names.</p>
<p>This only yields directories that are accounts... it skips the other ones.
For convenience, it also yields you the account's name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>root_directory</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the root of the hierarchy to be walked.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  Tuples of (root, account-name, dirs, files), similar to os.walk().</p>
<details class="quote">
<summary>Source code in <code>beancount/core/account.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def walk(root_directory):
    """A version of os.walk() which yields directories that are valid account names.

    This only yields directories that are accounts... it skips the other ones.
    For convenience, it also yields you the account's name.

    Args:
      root_directory: A string, the name of the root of the hierarchy to be walked.
    Yields:
      Tuples of (root, account-name, dirs, files), similar to os.walk().
    """
    for root, dirs, files in os.walk(root_directory):
        dirs.sort()
        files.sort()
        relroot = root[len(root_directory)+1:]
        account_name = relroot.replace(os.sep, sep)
        if is_valid(account_name):
            yield (root, account_name, dirs, files)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.account_types">
<code>beancount.core.account_types</code>
<a class="headerlink" href="#beancount.core.account_types" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Definition for global account types.</p>
<p>This is where we keep the global account types value and definition.</p>
<p>Note that it's unfortunate that we're using globals and side-effect here, but
this is the best solution in the short-term, the account types are used
in too many places to pass around that state everywhere. Maybe we change
this later on.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.account_types.AccountTypes">
<code>beancount.core.account_types.AccountTypes</code>
<a class="headerlink" href="#beancount.core.account_types.AccountTypes" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>AccountTypes(assets, liabilities, equity, income, expenses)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.account_types.AccountTypes.__getnewargs__">
<code class="highlight language-python">
beancount.core.account_types.AccountTypes.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.account_types.AccountTypes.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.account_types.AccountTypes.__new__">
<code class="highlight language-python">
beancount.core.account_types.AccountTypes.__new__
(_cls, assets, liabilities, equity, income, expenses)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.account_types.AccountTypes.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of AccountTypes(assets, liabilities, equity, income, expenses)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.account_types.AccountTypes.__repr__">
<code class="highlight language-python">
beancount.core.account_types.AccountTypes.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.account_types.AccountTypes.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.get_account_sign">
<code class="highlight language-python">
beancount.core.account_types.get_account_sign
(account_name, account_types=None)

        </code>
<a class="headerlink" href="#beancount.core.account_types.get_account_sign" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the sign of the normal balance of a particular account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account whose sign is to return.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_types</code></td>
<td><code></code></td>
<td>
<p>An optional instance of the current account_types.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>+1 or -1, depending on the account's type.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_account_sign(account_name, account_types=None):
    """Return the sign of the normal balance of a particular account.

    Args:
      account_name: A string, the name of the account whose sign is to return.
      account_types: An optional instance of the current account_types.
    Returns:
      +1 or -1, depending on the account's type.
    """
    if account_types is None:
        account_types = DEFAULT_ACCOUNT_TYPES
    assert isinstance(account_name, str), "Account is not a string: {}".format(account_name)
    account_type = get_account_type(account_name)
    return (+1
            if account_type in (account_types.assets,
                                account_types.expenses)
            else -1)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.get_account_sort_key">
<code class="highlight language-python">
beancount.core.account_types.get_account_sort_key
(account_types, account_name)

        </code>
<a class="headerlink" href="#beancount.core.account_types.get_account_sort_key" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a tuple that can be used to order/sort account names.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_types</code></td>
<td><code></code></td>
<td>
<p>An instance of AccountTypes, a tuple of account type names.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A function object to use as the optional 'key' argument to the sort
function. It accepts a single argument, the account name to sort and
produces a sortable key.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_account_sort_key(account_types, account_name):
    """Return a tuple that can be used to order/sort account names.

    Args:
      account_types: An instance of AccountTypes, a tuple of account type names.
    Returns:
      A function object to use as the optional 'key' argument to the sort
      function. It accepts a single argument, the account name to sort and
      produces a sortable key.
    """
    return (account_types.index(get_account_type(account_name)), account_name)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.get_account_type">
<code class="highlight language-python">
beancount.core.account_types.get_account_type
(account_name)

        </code>
<a class="headerlink" href="#beancount.core.account_types.get_account_type" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the type of this account's name.</p>
<p>Warning: No check is made on the validity of the account type. This merely
returns the root account of the corresponding account name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account whose type is to return.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the type of the account in 'account_name'.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_account_type(account_name):
    """Return the type of this account's name.

    Warning: No check is made on the validity of the account type. This merely
    returns the root account of the corresponding account name.

    Args:
      account_name: A string, the name of the account whose type is to return.
    Returns:
      A string, the type of the account in 'account_name'.

    """
    assert isinstance(account_name, str), "Account is not a string: {}".format(account_name)
    return account.split(account_name)[0]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.is_account_type">
<code class="highlight language-python">
beancount.core.account_types.is_account_type
(account_type, account_name)

        </code>
<a class="headerlink" href="#beancount.core.account_types.is_account_type" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the type of this account's name.</p>
<p>Warning: No check is made on the validity of the account type. This merely
returns the root account of the corresponding account name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_type</code></td>
<td><code></code></td>
<td>
<p>A string, the prefix type of the account.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account whose type is to return.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the account is of the given type.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_account_type(account_type, account_name):
    """Return the type of this account's name.

    Warning: No check is made on the validity of the account type. This merely
    returns the root account of the corresponding account name.

    Args:
      account_type: A string, the prefix type of the account.
      account_name: A string, the name of the account whose type is to return.
    Returns:
      A boolean, true if the account is of the given type.
    """
    return bool(re.match('^{}{}'.format(account_type, account.sep), account_name))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.is_balance_sheet_account">
<code class="highlight language-python">
beancount.core.account_types.is_balance_sheet_account
(account_name, account_types)

        </code>
<a class="headerlink" href="#beancount.core.account_types.is_balance_sheet_account" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the given account is a balance sheet account.
Assets, liabilities and equity accounts are balance sheet accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, an account name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_types</code></td>
<td><code></code></td>
<td>
<p>An instance of AccountTypes.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the account is a balance sheet account.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_balance_sheet_account(account_name, account_types):
    """Return true if the given account is a balance sheet account.
    Assets, liabilities and equity accounts are balance sheet accounts.

    Args:
      account_name: A string, an account name.
      account_types: An instance of AccountTypes.
    Returns:
      A boolean, true if the account is a balance sheet account.
    """
    assert isinstance(account_name, str), "Account is not a string: {}".format(account_name)
    assert isinstance(account_types, AccountTypes), (
        "Account types has invalid type: {}".format(account_types))
    account_type = get_account_type(account_name)
    return account_type in (account_types.assets,
                            account_types.liabilities,
                            account_types.equity)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.is_equity_account">
<code class="highlight language-python">
beancount.core.account_types.is_equity_account
(account_name, account_types)

        </code>
<a class="headerlink" href="#beancount.core.account_types.is_equity_account" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the given account is an equity account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, an account name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_types</code></td>
<td><code></code></td>
<td>
<p>An instance of AccountTypes.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the account is an equity account.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_equity_account(account_name, account_types):
    """Return true if the given account is an equity account.

    Args:
      account_name: A string, an account name.
      account_types: An instance of AccountTypes.
    Returns:
      A boolean, true if the account is an equity account.
    """
    assert isinstance(account_name, str), "Account is not a string: {}".format(account_name)
    assert isinstance(account_types, AccountTypes), (
        "Account types has invalid type: {}".format(account_types))
    account_type = get_account_type(account_name)
    return account_type == account_types.equity
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.is_income_statement_account">
<code class="highlight language-python">
beancount.core.account_types.is_income_statement_account
(account_name, account_types)

        </code>
<a class="headerlink" href="#beancount.core.account_types.is_income_statement_account" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the given account is an income statement account.
Income and expense accounts are income statement accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, an account name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_types</code></td>
<td><code></code></td>
<td>
<p>An instance of AccountTypes.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the account is an income statement account.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_income_statement_account(account_name, account_types):
    """Return true if the given account is an income statement account.
    Income and expense accounts are income statement accounts.

    Args:
      account_name: A string, an account name.
      account_types: An instance of AccountTypes.
    Returns:
      A boolean, true if the account is an income statement account.
    """
    assert isinstance(account_name, str), "Account is not a string: {}".format(account_name)
    assert isinstance(account_types, AccountTypes), (
        "Account types has invalid type: {}".format(account_types))
    account_type = get_account_type(account_name)
    return account_type in (account_types.income,
                            account_types.expenses)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.account_types.is_root_account">
<code class="highlight language-python">
beancount.core.account_types.is_root_account
(account_name, account_types=None)

        </code>
<a class="headerlink" href="#beancount.core.account_types.is_root_account" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the account name is a root account.
This function does not verify whether the account root is a valid
one, just that it is a root account or not.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the account to check for.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_types</code></td>
<td><code></code></td>
<td>
<p>An optional instance of the current account_types;
if provided, we check against these values. If not provided, we
merely check that name pattern is that of an account component with
no separator.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the account is root account.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/account_types.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_root_account(account_name, account_types=None):
    """Return true if the account name is a root account.
    This function does not verify whether the account root is a valid
    one, just that it is a root account or not.

    Args:
      account_name: A string, the name of the account to check for.
      account_types: An optional instance of the current account_types;
        if provided, we check against these values. If not provided, we
        merely check that name pattern is that of an account component with
        no separator.
    Returns:
      A boolean, true if the account is root account.
    """
    assert isinstance(account_name, str), "Account is not a string: {}".format(account_name)
    if account_types is not None:
        assert isinstance(account_types, AccountTypes), (
            "Account types has invalid type: {}".format(account_types))
        return account_name in account_types
    else:
        return (account_name and
                bool(re.match(r'([A-Z][A-Za-z0-9\-]+)$', account_name)))
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.amount">
<code>beancount.core.amount</code>
<a class="headerlink" href="#beancount.core.amount" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Amount class.</p>
<p>This simple class is used to associate a number of units of a currency with its
currency:</p>
<p>(number, currency).</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.amount.Amount">
<code>beancount.core.amount.Amount</code>
<a class="headerlink" href="#beancount.core.amount.Amount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An 'Amount' represents a number of a particular unit of something.</p>
<pre><code>It's essentially a typed number, with corresponding manipulation operations
defined on it.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__bool__">
<code class="highlight language-python">
beancount.core.amount.Amount.__bool__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__bool__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Boolean predicate returns true if the number is non-zero.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if non-zero number.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __bool__(self):
    """Boolean predicate returns true if the number is non-zero.
    Returns:
      A boolean, true if non-zero number.
    """
    return self.number != ZERO
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__eq__">
<code class="highlight language-python">
beancount.core.amount.Amount.__eq__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__eq__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Equality predicate. Returns true if both number and currency are equal.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __eq__(self, other):
    """Equality predicate. Returns true if both number and currency are equal.
    Returns:
      A boolean.
    """
    if other is None:
        return False
    return (self.number, self.currency) == (other.number, other.currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__hash__">
<code class="highlight language-python">
beancount.core.amount.Amount.__hash__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__hash__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>A hashing function for amounts. The hash includes the currency.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An integer, the hash for this amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __hash__(self):
    """A hashing function for amounts. The hash includes the currency.
    Returns:
      An integer, the hash for this amount.
    """
    return hash((self.number, self.currency))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__lt__">
<code class="highlight language-python">
beancount.core.amount.Amount.__lt__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__lt__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Ordering comparison. This is used in the sorting key of positions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>True if this is less than the other Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __lt__(self, other):
    """Ordering comparison. This is used in the sorting key of positions.
    Args:
      other: An instance of Amount.
    Returns:
      True if this is less than the other Amount.
    """
    return sortkey(self) &lt; sortkey(other)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__neg__">
<code class="highlight language-python">
beancount.core.amount.Amount.__neg__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__neg__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the negative of this amount.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Amount, with the negative number of units.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __neg__(self):
    """Return the negative of this amount.
    Returns:
      A new instance of Amount, with the negative number of units.
    """
    return Amount(-self.number, self.currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__new__">
<code class="highlight language-python">
beancount.core.amount.Amount.__new__
(cls, number, currency)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Constructor from a number and currency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A string or Decimal instance. Will get converted automatically.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, the currency symbol to use.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __new__(cls, number, currency):
    """Constructor from a number and currency.

    Args:
      number: A string or Decimal instance. Will get converted automatically.
      currency: A string, the currency symbol to use.
    """
    assert isinstance(number, Amount.valid_types_number), repr(number)
    assert isinstance(currency, Amount.valid_types_currency), repr(currency)
    return _Amount.__new__(cls, number, currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__repr__">
<code class="highlight language-python">
beancount.core.amount.Amount.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Convert an Amount instance to a printable string with the defaults.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A formatted string of the quantized amount and symbol.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    """Convert an Amount instance to a printable string with the defaults.

    Returns:
      A formatted string of the quantized amount and symbol.
    """
    return self.to_string()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.__str__">
<code class="highlight language-python">
beancount.core.amount.Amount.__str__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.__str__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Convert an Amount instance to a printable string with the defaults.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A formatted string of the quantized amount and symbol.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    """Convert an Amount instance to a printable string with the defaults.

    Returns:
      A formatted string of the quantized amount and symbol.
    """
    return self.to_string()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.from_string">
<code class="highlight language-python">
beancount.core.amount.Amount.from_string
(string)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.amount.Amount.from_string" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create an amount from a string.</p>
<p>This is a miniature parser used for building tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string of &lt;number&gt; &lt;currency&gt;.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create an amount from a string.

    This is a miniature parser used for building tests.

    Args:
      string: A string of &lt;number&gt; &lt;currency&gt;.
    Returns:
      A new instance of Amount.
    """
    match = re.match(r'\s*([-+]?[0-9.]+)\s+({currency})'.format(currency=CURRENCY_RE),
                     string)
    if not match:
        raise ValueError("Invalid string for amount: '{}'".format(string))
    number, currency = match.group(1, 2)
    return Amount(D(number), currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.amount.Amount.to_string">
<code class="highlight language-python">
beancount.core.amount.Amount.to_string
(self, dformat=&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;)

        </code>
<a class="headerlink" href="#beancount.core.amount.Amount.to_string" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Convert an Amount instance to a printable string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dformat</code></td>
<td><code></code></td>
<td>
<p>An instance of DisplayFormatter.</p>
</td>
<td><code>&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A formatted string of the quantized amount and symbol.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def to_string(self, dformat=DEFAULT_FORMATTER):
    """Convert an Amount instance to a printable string.

    Args:
      dformat: An instance of DisplayFormatter.
    Returns:
      A formatted string of the quantized amount and symbol.
    """
    number_fmt = (dformat.format(self.number, self.currency)
                  if isinstance(self.number, Decimal)
                  else str(self.number))
    return "{} {}".format(number_fmt, self.currency)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.A">
<code class="highlight language-python">
beancount.core.amount.A
(string)

        </code>
<a class="headerlink" href="#beancount.core.amount.A" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create an amount from a string.</p>
<p>This is a miniature parser used for building tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string of &lt;number&gt; &lt;currency&gt;.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create an amount from a string.

    This is a miniature parser used for building tests.

    Args:
      string: A string of &lt;number&gt; &lt;currency&gt;.
    Returns:
      A new instance of Amount.
    """
    match = re.match(r'\s*([-+]?[0-9.]+)\s+({currency})'.format(currency=CURRENCY_RE),
                     string)
    if not match:
        raise ValueError("Invalid string for amount: '{}'".format(string))
    number, currency = match.group(1, 2)
    return Amount(D(number), currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.abs">
<code class="highlight language-python">
beancount.core.amount.abs
(amount)

        </code>
<a class="headerlink" href="#beancount.core.amount.abs" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the absolute value of the given amount.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def abs(amount):
    """Return the absolute value of the given amount.

    Args:
      amount: An instance of Amount.
    Returns:
      An instance of Amount.
    """
    return (amount
            if amount.number &gt;= ZERO
            else Amount(-amount.number, amount.currency))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.add">
<code class="highlight language-python">
beancount.core.amount.add
(amount1, amount2)

        </code>
<a class="headerlink" href="#beancount.core.amount.add" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Add the given amounts with the same currency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount1</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>amount2</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Amount, with the sum the two amount's numbers, in the same
currency.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def add(amount1, amount2):
    """Add the given amounts with the same currency.

    Args:
      amount1: An instance of Amount.
      amount2: An instance of Amount.
    Returns:
      An instance of Amount, with the sum the two amount's numbers, in the same
      currency.
    """
    assert isinstance(amount1.number, Decimal), (
        "Amount1's number is not a Decimal instance: {}".format(amount1.number))
    assert isinstance(amount2.number, Decimal), (
        "Amount2's number is not a Decimal instance: {}".format(amount2.number))
    if amount1.currency != amount2.currency:
        raise ValueError(
            "Unmatching currencies for operation on {} and {}".format(
                amount1, amount2))
    return Amount(amount1.number + amount2.number, amount1.currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.div">
<code class="highlight language-python">
beancount.core.amount.div
(amount, number)

        </code>
<a class="headerlink" href="#beancount.core.amount.div" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Divide the given amount by a number.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A decimal number.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount, with the same currency, but with amount units divided by 'number'.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def div(amount, number):
    """Divide the given amount by a number.

    Args:
      amount: An instance of Amount.
      number: A decimal number.
    Returns:
      An Amount, with the same currency, but with amount units divided by 'number'.
    """
    assert isinstance(amount.number, Decimal), (
        "Amount's number is not a Decimal instance: {}".format(amount.number))
    assert isinstance(number, Decimal), (
        "Number is not a Decimal instance: {}".format(number))
    return Amount(amount.number / number, amount.currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.from_string">
<code class="highlight language-python">
beancount.core.amount.from_string
(string)

        </code>
<a class="headerlink" href="#beancount.core.amount.from_string" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create an amount from a string.</p>
<p>This is a miniature parser used for building tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string of &lt;number&gt; &lt;currency&gt;.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create an amount from a string.

    This is a miniature parser used for building tests.

    Args:
      string: A string of &lt;number&gt; &lt;currency&gt;.
    Returns:
      A new instance of Amount.
    """
    match = re.match(r'\s*([-+]?[0-9.]+)\s+({currency})'.format(currency=CURRENCY_RE),
                     string)
    if not match:
        raise ValueError("Invalid string for amount: '{}'".format(string))
    number, currency = match.group(1, 2)
    return Amount(D(number), currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.mul">
<code class="highlight language-python">
beancount.core.amount.mul
(amount, number)

        </code>
<a class="headerlink" href="#beancount.core.amount.mul" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Multiply the given amount by a number.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A decimal number.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount, with the same currency, but with 'number' times units.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def mul(amount, number):
    """Multiply the given amount by a number.

    Args:
      amount: An instance of Amount.
      number: A decimal number.
    Returns:
      An Amount, with the same currency, but with 'number' times units.
    """
    assert isinstance(amount.number, Decimal), (
        "Amount's number is not a Decimal instance: {}".format(amount.number))
    assert isinstance(number, Decimal), (
        "Number is not a Decimal instance: {}".format(number))
    return Amount(amount.number * number, amount.currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.sortkey">
<code class="highlight language-python">
beancount.core.amount.sortkey
(amount)

        </code>
<a class="headerlink" href="#beancount.core.amount.sortkey" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A comparison function that sorts by currency first.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A sort key, composed of the currency first and then the number.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def sortkey(amount):
    """A comparison function that sorts by currency first.

    Args:
      amount: An instance of Amount.
    Returns:
      A sort key, composed of the currency first and then the number.
    """
    return (amount.currency, amount.number)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.amount.sub">
<code class="highlight language-python">
beancount.core.amount.sub
(amount1, amount2)

        </code>
<a class="headerlink" href="#beancount.core.amount.sub" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Subtract the given amounts with the same currency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount1</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>amount2</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Amount, with the difference between the two amount's
numbers, in the same currency.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/amount.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def sub(amount1, amount2):
    """Subtract the given amounts with the same currency.

    Args:
      amount1: An instance of Amount.
      amount2: An instance of Amount.
    Returns:
      An instance of Amount, with the difference between the two amount's
      numbers, in the same currency.
    """
    assert isinstance(amount1.number, Decimal), (
        "Amount1's number is not a Decimal instance: {}".format(amount1.number))
    assert isinstance(amount2.number, Decimal), (
        "Amount2's number is not a Decimal instance: {}".format(amount2.number))
    if amount1.currency != amount2.currency:
        raise ValueError(
            "Unmatching currencies for operation on {} and {}".format(
                amount1, amount2))
    return Amount(amount1.number - amount2.number, amount1.currency)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.compare">
<code>beancount.core.compare</code>
<a class="headerlink" href="#beancount.core.compare" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Comparison helpers for data objects.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.compare.CompareError">
<code>beancount.core.compare.CompareError</code>
<a class="headerlink" href="#beancount.core.compare.CompareError" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>CompareError(source, message, entry)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.compare.CompareError.__getnewargs__">
<code class="highlight language-python">
beancount.core.compare.CompareError.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.compare.CompareError.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.compare.CompareError.__new__">
<code class="highlight language-python">
beancount.core.compare.CompareError.__new__
(_cls, source, message, entry)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.compare.CompareError.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of CompareError(source, message, entry)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.compare.CompareError.__repr__">
<code class="highlight language-python">
beancount.core.compare.CompareError.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.compare.CompareError.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.compare.compare_entries">
<code class="highlight language-python">
beancount.core.compare.compare_entries
(entries1, entries2)

        </code>
<a class="headerlink" href="#beancount.core.compare.compare_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compare two lists of entries. This is used for testing.</p>
<p>The entries are compared with disregard for their file location.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries1</code></td>
<td><code></code></td>
<td>
<p>A list of directives of any type.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries2</code></td>
<td><code></code></td>
<td>
<p>Another list of directives of any type.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A tuple of (success, not_found1, not_found2), where the fields are</code></td>
<td>
<p>success: A boolean, true if all the values are equal.
  missing1: A list of directives from 'entries1' not found in
    'entries2'.
  missing2: A list of directives from 'entries2' not found in
    'entries1'.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>If a duplicate entry is found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compare_entries(entries1, entries2):
    """Compare two lists of entries. This is used for testing.

    The entries are compared with disregard for their file location.

    Args:
      entries1: A list of directives of any type.
      entries2: Another list of directives of any type.
    Returns:
      A tuple of (success, not_found1, not_found2), where the fields are:
        success: A boolean, true if all the values are equal.
        missing1: A list of directives from 'entries1' not found in
          'entries2'.
        missing2: A list of directives from 'entries2' not found in
          'entries1'.
    Raises:
      ValueError: If a duplicate entry is found.
    """
    hashes1, errors1 = hash_entries(entries1, exclude_meta=True)
    hashes2, errors2 = hash_entries(entries2, exclude_meta=True)
    keys1 = set(hashes1.keys())
    keys2 = set(hashes2.keys())

    if errors1 or errors2:
        error = (errors1 + errors2)[0]
        raise ValueError(str(error))

    same = keys1 == keys2
    missing1 = data.sorted([hashes1[key] for key in keys1 - keys2])
    missing2 = data.sorted([hashes2[key] for key in keys2 - keys1])
    return (same, missing1, missing2)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.compare.excludes_entries">
<code class="highlight language-python">
beancount.core.compare.excludes_entries
(subset_entries, entries)

        </code>
<a class="headerlink" href="#beancount.core.compare.excludes_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Check that a list of entries does not appear in another list.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>subset_entries</code></td>
<td><code></code></td>
<td>
<p>The set of entries to look for in 'entries'.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>The larger list of entries that should not include 'subset_entries'.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean and a list of entries that are not supposed to appear.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>If a duplicate entry is found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def excludes_entries(subset_entries, entries):
    """Check that a list of entries does not appear in another list.

    Args:
      subset_entries: The set of entries to look for in 'entries'.
      entries: The larger list of entries that should not include 'subset_entries'.
    Returns:
      A boolean and a list of entries that are not supposed to appear.
    Raises:
      ValueError: If a duplicate entry is found.
    """
    subset_hashes, subset_errors = hash_entries(subset_entries, exclude_meta=True)
    subset_keys = set(subset_hashes.keys())
    hashes, errors = hash_entries(entries, exclude_meta=True)
    keys = set(hashes.keys())

    if subset_errors or errors:
        error = (subset_errors + errors)[0]
        raise ValueError(str(error))

    intersection = keys.intersection(subset_keys)
    excludes = not bool(intersection)
    extra = data.sorted([subset_hashes[key] for key in intersection])
    return (excludes, extra)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.compare.hash_entries">
<code class="highlight language-python">
beancount.core.compare.hash_entries
(entries, exclude_meta=False)

        </code>
<a class="headerlink" href="#beancount.core.compare.hash_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute unique hashes of each of the entries and return a map of them.</p>
<p>This is used for comparisons between sets of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>exclude_meta</code></td>
<td><code></code></td>
<td>
<p>If set, exclude the metadata from the hash. Use this for
unit tests comparing entries coming from different sources as the
filename and lineno will be distinct. However, when you're using the
hashes to uniquely identify transactions, you want to include the
filenames and line numbers (the default).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A dict of hash-value to entry (for all entries) and a list of errors.
Errors are created when duplicate entries are found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def hash_entries(entries, exclude_meta=False):
    """Compute unique hashes of each of the entries and return a map of them.

    This is used for comparisons between sets of entries.

    Args:
      entries: A list of directives.
      exclude_meta: If set, exclude the metadata from the hash. Use this for
        unit tests comparing entries coming from different sources as the
        filename and lineno will be distinct. However, when you're using the
        hashes to uniquely identify transactions, you want to include the
        filenames and line numbers (the default).
    Returns:
      A dict of hash-value to entry (for all entries) and a list of errors.
      Errors are created when duplicate entries are found.
    """
    entry_hash_dict = {}
    errors = []
    num_legal_duplicates = 0
    for entry in entries:
        hash_ = hash_entry(entry, exclude_meta)

        if hash_ in entry_hash_dict:
            if isinstance(entry, Price):
                # Note: Allow duplicate Price entries, they should be common
                # because of the nature of stock markets (if they're closed, the
                # data source is likely to return an entry for the previously
                # available date, which may already have been fetched).
                num_legal_duplicates += 1
            else:
                other_entry = entry_hash_dict[hash_]
                errors.append(
                    CompareError(entry.meta,
                                 "Duplicate entry: {} == {}".format(entry, other_entry),
                                 entry))
        entry_hash_dict[hash_] = entry

    if not errors:
        assert len(entry_hash_dict) + num_legal_duplicates == len(entries), (
            len(entry_hash_dict), len(entries), num_legal_duplicates)
    return entry_hash_dict, errors
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.compare.hash_entry">
<code class="highlight language-python">
beancount.core.compare.hash_entry
(entry, exclude_meta=False)

        </code>
<a class="headerlink" href="#beancount.core.compare.hash_entry" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the stable hash of a single entry.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A directive instance.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>exclude_meta</code></td>
<td><code></code></td>
<td>
<p>If set, exclude the metadata from the hash. Use this for
unit tests comparing entries coming from different sources as the
filename and lineno will be distinct. However, when you're using the
hashes to uniquely identify transactions, you want to include the
filenames and line numbers (the default).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A stable hexadecimal hash of this entry.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def hash_entry(entry, exclude_meta=False):
    """Compute the stable hash of a single entry.

    Args:
      entry: A directive instance.
      exclude_meta: If set, exclude the metadata from the hash. Use this for
        unit tests comparing entries coming from different sources as the
        filename and lineno will be distinct. However, when you're using the
        hashes to uniquely identify transactions, you want to include the
        filenames and line numbers (the default).
    Returns:
      A stable hexadecimal hash of this entry.

    """
    return stable_hash_namedtuple(entry,
                                  IGNORED_FIELD_NAMES if exclude_meta else frozenset())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.compare.includes_entries">
<code class="highlight language-python">
beancount.core.compare.includes_entries
(subset_entries, entries)

        </code>
<a class="headerlink" href="#beancount.core.compare.includes_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Check if a list of entries is included in another list.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>subset_entries</code></td>
<td><code></code></td>
<td>
<p>The set of entries to look for in 'entries'.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>The larger list of entries that could include 'subset_entries'.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean and a list of missing entries.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>If a duplicate entry is found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def includes_entries(subset_entries, entries):
    """Check if a list of entries is included in another list.

    Args:
      subset_entries: The set of entries to look for in 'entries'.
      entries: The larger list of entries that could include 'subset_entries'.
    Returns:
      A boolean and a list of missing entries.
    Raises:
      ValueError: If a duplicate entry is found.
    """
    subset_hashes, subset_errors = hash_entries(subset_entries, exclude_meta=True)
    subset_keys = set(subset_hashes.keys())
    hashes, errors = hash_entries(entries, exclude_meta=True)
    keys = set(hashes.keys())

    if subset_errors or errors:
        error = (subset_errors + errors)[0]
        raise ValueError(str(error))

    includes = subset_keys.issubset(keys)
    missing = data.sorted([subset_hashes[key] for key in subset_keys - keys])
    return (includes, missing)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.compare.stable_hash_namedtuple">
<code class="highlight language-python">
beancount.core.compare.stable_hash_namedtuple
(objtuple, ignore=frozenset())

        </code>
<a class="headerlink" href="#beancount.core.compare.stable_hash_namedtuple" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Hash the given namedtuple and its child fields.</p>
<p>This iterates over all the members of objtuple, skipping the attributes from
the 'ignore' set, and computes a unique hash string code. If the elements
are lists or sets, sorts them for stability.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>objtuple</code></td>
<td><code></code></td>
<td>
<p>A tuple object or other.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>ignore</code></td>
<td><code></code></td>
<td>
<p>A set of strings, attribute names to be skipped in
computing a stable hash. For instance, circular references to objects
or irrelevant data.</p>
</td>
<td><code>frozenset()</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/compare.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def stable_hash_namedtuple(objtuple, ignore=frozenset()):
    """Hash the given namedtuple and its child fields.

    This iterates over all the members of objtuple, skipping the attributes from
    the 'ignore' set, and computes a unique hash string code. If the elements
    are lists or sets, sorts them for stability.

    Args:
      objtuple: A tuple object or other.
      ignore: A set of strings, attribute names to be skipped in
        computing a stable hash. For instance, circular references to objects
        or irrelevant data.

    """
    # Note: this routine is slow and would stand to be implemented in C.
    hashobj = hashlib.md5()
    for attr_name, attr_value in zip(objtuple._fields, objtuple):
        if attr_name in ignore:
            continue
        if isinstance(attr_value, (list, set, frozenset)):
            subhashes = set()
            for element in attr_value:
                if isinstance(element, tuple):
                    subhashes.add(stable_hash_namedtuple(element, ignore))
                else:
                    md5 = hashlib.md5()
                    md5.update(str(element).encode())
                    subhashes.add(md5.hexdigest())
            for subhash in sorted(subhashes):
                hashobj.update(subhash.encode())
        else:
            hashobj.update(str(attr_value).encode())
    return hashobj.hexdigest()
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.convert">
<code>beancount.core.convert</code>
<a class="headerlink" href="#beancount.core.convert" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Conversions from Position (or Posting) to units, cost, weight, market value.</p>
<ul>
<li>Units: Just the primary amount of the position.</li>
<li>Cost: The cost basis of the position, if available.</li>
<li>Weight: The cost basis or price of the position.</li>
<li>Market Value: The units converted to a value via a price map.</li>
</ul>
<p>To convert an inventory's contents, simply use these functions in conjunction
with <code>Inventory.reduce()</code>, like</p>
<pre><code>cost_inv = inv.reduce(convert.get_cost)
</code></pre>
<p>This module equivalently converts Position and Posting instances. Note that
we're specifically avoiding to create an import dependency on
beancount.core.data in order to keep this module isolatable, but it works on
postings due to duck-typing.</p>
<p>Function named <code>get_*()</code> are used to compute values from postings to their price currency.
Functions named <code>convert_*()</code> are used to convert postings and amounts to any currency.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.convert.convert_amount">
<code class="highlight language-python">
beancount.core.convert.convert_amount
(amt, target_currency, price_map, date=None, via=None)

        </code>
<a class="headerlink" href="#beancount.core.convert.convert_amount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the market value of an Amount in a particular currency.</p>
<p>In addition, if a conversion rate isn't available, you can provide a list of
currencies to attempt to synthesize a rate for via implied rates.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amt</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>target_currency</code></td>
<td><code></code></td>
<td>
<p>The target currency to convert to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A dict of prices, as built by prices.build_price_map().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance to evaluate the value at, or None.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>via</code></td>
<td><code></code></td>
<td>
<p>A list of currencies to attempt to synthesize an implied rate if the
direct conversion fails.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount, either with a successful value currency conversion, or if we
could not convert the value, the amount itself, unmodified.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/convert.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def convert_amount(amt, target_currency, price_map, date=None, via=None):
    """Return the market value of an Amount in a particular currency.

    In addition, if a conversion rate isn't available, you can provide a list of
    currencies to attempt to synthesize a rate for via implied rates.

    Args:
      amt: An instance of Amount.
      target_currency: The target currency to convert to.
      price_map: A dict of prices, as built by prices.build_price_map().
      date: A datetime.date instance to evaluate the value at, or None.
      via: A list of currencies to attempt to synthesize an implied rate if the
        direct conversion fails.
    Returns:
      An Amount, either with a successful value currency conversion, or if we
      could not convert the value, the amount itself, unmodified.

    """
    # First, attempt to convert directly. This should be the most
    # straightforward conversion.
    base_quote = (amt.currency, target_currency)
    _, rate = prices.get_price(price_map, base_quote, date)
    if rate is not None:
        # On success, just make the conversion directly.
        return Amount(amt.number * rate, target_currency)
    elif via:
        assert isinstance(via, (tuple, list))

        # A price is unavailable, attempt to convert via cost/price currency
        # hop, if the value currency isn't the target currency.
        for implied_currency in via:
            if implied_currency == target_currency:
                continue
            base_quote1 = (amt.currency, implied_currency)
            _, rate1 = prices.get_price(price_map, base_quote1, date)
            if rate1 is not None:
                base_quote2 = (implied_currency, target_currency)
                _, rate2 = prices.get_price(price_map, base_quote2, date)
                if rate2 is not None:
                    return Amount(amt.number * rate1 * rate2, target_currency)

    # We failed to infer a conversion rate; return the amt.
    return amt
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.convert.convert_position">
<code class="highlight language-python">
beancount.core.convert.convert_position
(pos, target_currency, price_map, date=None)

        </code>
<a class="headerlink" href="#beancount.core.convert.convert_position" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the market value of a Position or Posting in a particular currency.</p>
<p>In addition, if the rate from the position's currency to target_currency
isn't available, an attempt is made to convert from its cost currency, if
one is available.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pos</code></td>
<td><code></code></td>
<td>
<p>An instance of Position or Posting, equivalently.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>target_currency</code></td>
<td><code></code></td>
<td>
<p>The target currency to convert to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A dict of prices, as built by prices.build_price_map().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance to evaluate the value at, or None.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount, either with a successful value currency conversion, or if we
could not convert the value, just the units, unmodified. (See get_value()
above for details.)</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/convert.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def convert_position(pos, target_currency, price_map, date=None):
    """Return the market value of a Position or Posting in a particular currency.

    In addition, if the rate from the position's currency to target_currency
    isn't available, an attempt is made to convert from its cost currency, if
    one is available.

    Args:
      pos: An instance of Position or Posting, equivalently.
      target_currency: The target currency to convert to.
      price_map: A dict of prices, as built by prices.build_price_map().
      date: A datetime.date instance to evaluate the value at, or None.
    Returns:
      An Amount, either with a successful value currency conversion, or if we
      could not convert the value, just the units, unmodified. (See get_value()
      above for details.)
    """
    cost = pos.cost
    value_currency = (
        (isinstance(cost, Cost) and cost.currency) or
        (hasattr(pos, 'price') and pos.price and pos.price.currency) or
        None)
    return convert_amount(pos.units, target_currency, price_map,
                          date=date, via=(value_currency,))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.convert.get_cost">
<code class="highlight language-python">
beancount.core.convert.get_cost
(pos)

        </code>
<a class="headerlink" href="#beancount.core.convert.get_cost" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the total cost of a Position or Posting.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pos</code></td>
<td><code></code></td>
<td>
<p>An instance of Position or Posting, equivalently.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/convert.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_cost(pos):
    """Return the total cost of a Position or Posting.

    Args:
      pos: An instance of Position or Posting, equivalently.
    Returns:
      An Amount.
    """
    assert isinstance(pos, Position) or type(pos).__name__ == 'Posting'
    cost = pos.cost
    return (Amount(cost.number * pos.units.number, cost.currency)
            if (isinstance(cost, Cost) and isinstance(cost.number, Decimal))
            else pos.units)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.convert.get_units">
<code class="highlight language-python">
beancount.core.convert.get_units
(pos)

        </code>
<a class="headerlink" href="#beancount.core.convert.get_units" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the units of a Position or Posting.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pos</code></td>
<td><code></code></td>
<td>
<p>An instance of Position or Posting, equivalently.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/convert.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_units(pos):
    """Return the units of a Position or Posting.

    Args:
      pos: An instance of Position or Posting, equivalently.
    Returns:
      An Amount.
    """
    assert isinstance(pos, Position) or type(pos).__name__ == 'Posting'
    return pos.units
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.convert.get_value">
<code class="highlight language-python">
beancount.core.convert.get_value
(pos, price_map, date=None)

        </code>
<a class="headerlink" href="#beancount.core.convert.get_value" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the market value of a Position or Posting.</p>
<p>Note that if the position is not held at cost, this does not convert
anything, even if a price is available in the 'price_map'. We don't specify
a target currency here. If you're attempting to make such a conversion, see
<code>convert_*()</code> functions below.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pos</code></td>
<td><code></code></td>
<td>
<p>An instance of Position or Posting, equivalently.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A dict of prices, as built by prices.build_price_map().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance to evaluate the value at, or None.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount, either with a successful value currency conversion, or if we
could not convert the value, just the units, unmodified. This is designed
so that you could reduce an inventory with this and not lose any
information silently in case of failure to convert (possibly due to an
empty price map). Compare the returned currency to that of the input
position if you need to check for success.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/convert.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_value(pos, price_map, date=None):
    """Return the market value of a Position or Posting.

    Note that if the position is not held at cost, this does not convert
    anything, even if a price is available in the 'price_map'. We don't specify
    a target currency here. If you're attempting to make such a conversion, see
    ``convert_*()`` functions below.

    Args:
      pos: An instance of Position or Posting, equivalently.
      price_map: A dict of prices, as built by prices.build_price_map().
      date: A datetime.date instance to evaluate the value at, or None.
    Returns:
      An Amount, either with a successful value currency conversion, or if we
      could not convert the value, just the units, unmodified. This is designed
      so that you could reduce an inventory with this and not lose any
      information silently in case of failure to convert (possibly due to an
      empty price map). Compare the returned currency to that of the input
      position if you need to check for success.
    """
    assert isinstance(pos, Position) or type(pos).__name__ == 'Posting'
    units = pos.units
    cost = pos.cost

    # Try to infer what the cost/price currency should be.
    value_currency = (
        (isinstance(cost, Cost) and cost.currency) or
        (hasattr(pos, 'price') and pos.price and pos.price.currency) or
        None)

    if isinstance(value_currency, str):
        # We have a value currency; hit the price database.
        base_quote = (units.currency, value_currency)
        _, price_number = prices.get_price(price_map, base_quote, date)
        if price_number is not None:
            return Amount(units.number * price_number, value_currency)

    # We failed to infer a conversion rate; return the units.
    return units
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.convert.get_weight">
<code class="highlight language-python">
beancount.core.convert.get_weight
(pos)

        </code>
<a class="headerlink" href="#beancount.core.convert.get_weight" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the weight of a Position or Posting.</p>
<p>This is the amount that will need to be balanced from a posting of a
transaction.</p>
<p>This is a <em>key</em> element of the semantics of transactions in this software. A
balance amount is the amount used to check the balance of a transaction.
Here are all relevant examples, with the amounts used to balance the
postings:</p>
<pre><code>Assets:Account  5234.50 USD                             -&gt;  5234.50 USD
Assets:Account  3877.41 EUR @ 1.35 USD                  -&gt;  5234.50 USD
Assets:Account       10 HOOL {523.45 USD}               -&gt;  5234.50 USD
Assets:Account       10 HOOL {523.45 USD} @ 545.60 CAD  -&gt;  5234.50 USD
</code></pre>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pos</code></td>
<td><code></code></td>
<td>
<p>An instance of Position or Posting, equivalently.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Amount.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/convert.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_weight(pos):
    """Return the weight of a Position or Posting.

    This is the amount that will need to be balanced from a posting of a
    transaction.

    This is a *key* element of the semantics of transactions in this software. A
    balance amount is the amount used to check the balance of a transaction.
    Here are all relevant examples, with the amounts used to balance the
    postings:

        Assets:Account  5234.50 USD                             -&gt;  5234.50 USD
        Assets:Account  3877.41 EUR @ 1.35 USD                  -&gt;  5234.50 USD
        Assets:Account       10 HOOL {523.45 USD}               -&gt;  5234.50 USD
        Assets:Account       10 HOOL {523.45 USD} @ 545.60 CAD  -&gt;  5234.50 USD

    Args:
      pos: An instance of Position or Posting, equivalently.
    Returns:
      An Amount.
    """
    assert isinstance(pos, Position) or type(pos).__name__ == 'Posting'
    units = pos.units
    cost = pos.cost

    # It the object has a cost, use that as the weight, to balance.
    if isinstance(cost, Cost) and isinstance(cost.number, Decimal):
        weight = Amount(cost.number * pos.units.number, cost.currency)
    else:
        # Otherwise use the postings.
        weight = units

        # Unless there is a price available; use that if present.
        if not isinstance(pos, Position):
            price = pos.price
            if price is not None:
                # Note: Here we could assert that price.currency == units.currency.
                if price.number is MISSING or units.number is MISSING:
                    converted_number = MISSING
                else:
                    converted_number = price.number * units.number
                weight = Amount(converted_number, price.currency)

    return weight
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.data">
<code>beancount.core.data</code>
<a class="headerlink" href="#beancount.core.data" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Basic data structures used to represent the Ledger entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Balance">
<code>beancount.core.data.Balance</code>
<a class="headerlink" href="#beancount.core.data.Balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Balance(meta, date, account, amount, tolerance, diff_amount)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Balance.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Balance.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Balance.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Balance.__new__">
<code class="highlight language-python">
beancount.core.data.Balance.__new__
(_cls, meta, date, account, amount, tolerance, diff_amount)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Balance.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Balance(meta, date, account, amount, tolerance, diff_amount)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Balance.__repr__">
<code class="highlight language-python">
beancount.core.data.Balance.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Balance.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Booking">
<code>beancount.core.data.Booking</code>
<a class="headerlink" href="#beancount.core.data.Booking" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An enumeration.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Close">
<code>beancount.core.data.Close</code>
<a class="headerlink" href="#beancount.core.data.Close" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Close(meta, date, account)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Close.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Close.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Close.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Close.__new__">
<code class="highlight language-python">
beancount.core.data.Close.__new__
(_cls, meta, date, account)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Close.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Close(meta, date, account)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Close.__repr__">
<code class="highlight language-python">
beancount.core.data.Close.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Close.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Commodity">
<code>beancount.core.data.Commodity</code>
<a class="headerlink" href="#beancount.core.data.Commodity" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Commodity(meta, date, currency)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Commodity.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Commodity.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Commodity.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Commodity.__new__">
<code class="highlight language-python">
beancount.core.data.Commodity.__new__
(_cls, meta, date, currency)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Commodity.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Commodity(meta, date, currency)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Commodity.__repr__">
<code class="highlight language-python">
beancount.core.data.Commodity.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Commodity.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Custom">
<code>beancount.core.data.Custom</code>
<a class="headerlink" href="#beancount.core.data.Custom" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Custom(meta, date, type, values)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Custom.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Custom.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Custom.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Custom.__new__">
<code class="highlight language-python">
beancount.core.data.Custom.__new__
(_cls, meta, date, type, values)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Custom.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Custom(meta, date, type, values)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Custom.__repr__">
<code class="highlight language-python">
beancount.core.data.Custom.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Custom.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Document">
<code>beancount.core.data.Document</code>
<a class="headerlink" href="#beancount.core.data.Document" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Document(meta, date, account, filename, tags, links)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Document.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Document.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Document.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Document.__new__">
<code class="highlight language-python">
beancount.core.data.Document.__new__
(_cls, meta, date, account, filename, tags, links)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Document.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Document(meta, date, account, filename, tags, links)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Document.__repr__">
<code class="highlight language-python">
beancount.core.data.Document.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Document.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Event">
<code>beancount.core.data.Event</code>
<a class="headerlink" href="#beancount.core.data.Event" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Event(meta, date, type, description)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Event.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Event.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Event.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Event.__new__">
<code class="highlight language-python">
beancount.core.data.Event.__new__
(_cls, meta, date, type, description)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Event.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Event(meta, date, type, description)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Event.__repr__">
<code class="highlight language-python">
beancount.core.data.Event.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Event.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Note">
<code>beancount.core.data.Note</code>
<a class="headerlink" href="#beancount.core.data.Note" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Note(meta, date, account, comment)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Note.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Note.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Note.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Note.__new__">
<code class="highlight language-python">
beancount.core.data.Note.__new__
(_cls, meta, date, account, comment)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Note.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Note(meta, date, account, comment)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Note.__repr__">
<code class="highlight language-python">
beancount.core.data.Note.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Note.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Open">
<code>beancount.core.data.Open</code>
<a class="headerlink" href="#beancount.core.data.Open" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Open(meta, date, account, currencies, booking)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Open.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Open.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Open.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Open.__new__">
<code class="highlight language-python">
beancount.core.data.Open.__new__
(_cls, meta, date, account, currencies, booking)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Open.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Open(meta, date, account, currencies, booking)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Open.__repr__">
<code class="highlight language-python">
beancount.core.data.Open.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Open.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Pad">
<code>beancount.core.data.Pad</code>
<a class="headerlink" href="#beancount.core.data.Pad" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Pad(meta, date, account, source_account)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Pad.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Pad.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Pad.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Pad.__new__">
<code class="highlight language-python">
beancount.core.data.Pad.__new__
(_cls, meta, date, account, source_account)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Pad.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Pad(meta, date, account, source_account)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Pad.__repr__">
<code class="highlight language-python">
beancount.core.data.Pad.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Pad.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Posting">
<code>beancount.core.data.Posting</code>
<a class="headerlink" href="#beancount.core.data.Posting" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Posting(account, units, cost, price, flag, meta)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Posting.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Posting.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Posting.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Posting.__new__">
<code class="highlight language-python">
beancount.core.data.Posting.__new__
(_cls, account, units, cost, price, flag, meta)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Posting.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Posting(account, units, cost, price, flag, meta)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Posting.__repr__">
<code class="highlight language-python">
beancount.core.data.Posting.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Posting.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Price">
<code>beancount.core.data.Price</code>
<a class="headerlink" href="#beancount.core.data.Price" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Price(meta, date, currency, amount)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Price.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Price.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Price.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Price.__new__">
<code class="highlight language-python">
beancount.core.data.Price.__new__
(_cls, meta, date, currency, amount)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Price.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Price(meta, date, currency, amount)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Price.__repr__">
<code class="highlight language-python">
beancount.core.data.Price.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Price.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Query">
<code>beancount.core.data.Query</code>
<a class="headerlink" href="#beancount.core.data.Query" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Query(meta, date, name, query_string)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Query.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Query.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Query.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Query.__new__">
<code class="highlight language-python">
beancount.core.data.Query.__new__
(_cls, meta, date, name, query_string)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Query.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Query(meta, date, name, query_string)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Query.__repr__">
<code class="highlight language-python">
beancount.core.data.Query.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Query.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.Transaction">
<code>beancount.core.data.Transaction</code>
<a class="headerlink" href="#beancount.core.data.Transaction" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Transaction(meta, date, flag, payee, narration, tags, links, postings)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Transaction.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.Transaction.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Transaction.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Transaction.__new__">
<code class="highlight language-python">
beancount.core.data.Transaction.__new__
(_cls, meta, date, flag, payee, narration, tags, links, postings)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Transaction.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Transaction(meta, date, flag, payee, narration, tags, links, postings)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.Transaction.__repr__">
<code class="highlight language-python">
beancount.core.data.Transaction.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.Transaction.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.data.TxnPosting">
<code>beancount.core.data.TxnPosting</code>
<a class="headerlink" href="#beancount.core.data.TxnPosting" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>TxnPosting(txn, posting)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.TxnPosting.__getnewargs__">
<code class="highlight language-python">
beancount.core.data.TxnPosting.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.TxnPosting.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.TxnPosting.__new__">
<code class="highlight language-python">
beancount.core.data.TxnPosting.__new__
(_cls, txn, posting)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.TxnPosting.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of TxnPosting(txn, posting)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.data.TxnPosting.__repr__">
<code class="highlight language-python">
beancount.core.data.TxnPosting.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.data.TxnPosting.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.create_simple_posting">
<code class="highlight language-python">
beancount.core.data.create_simple_posting
(entry, account, number, currency)

        </code>
<a class="headerlink" href="#beancount.core.data.create_simple_posting" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a simple posting on the entry, with just a number and currency (no cost).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>The entry instance to add the posting to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account</code></td>
<td><code></code></td>
<td>
<p>A string, the account to use on the posting.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A Decimal number or string to use in the posting's Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, the currency for the Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Posting, and as a side-effect the entry has had its list of
postings modified with the new Posting instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def create_simple_posting(entry, account, number, currency):
    """Create a simple posting on the entry, with just a number and currency (no cost).

    Args:
      entry: The entry instance to add the posting to.
      account: A string, the account to use on the posting.
      number: A Decimal number or string to use in the posting's Amount.
      currency: A string, the currency for the Amount.
    Returns:
      An instance of Posting, and as a side-effect the entry has had its list of
      postings modified with the new Posting instance.
    """
    if isinstance(account, str):
        pass
    if number is None:
        units = None
    else:
        if not isinstance(number, Decimal):
            number = D(number)
        units = Amount(number, currency)
    posting = Posting(account, units, None, None, None, None)
    if entry is not None:
        entry.postings.append(posting)
    return posting
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.create_simple_posting_with_cost">
<code class="highlight language-python">
beancount.core.data.create_simple_posting_with_cost
(entry, account, number, currency, cost_number, cost_currency)

        </code>
<a class="headerlink" href="#beancount.core.data.create_simple_posting_with_cost" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a simple posting on the entry, with just a number and currency (no cost).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>The entry instance to add the posting to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account</code></td>
<td><code></code></td>
<td>
<p>A string, the account to use on the posting.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A Decimal number or string to use in the posting's Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, the currency for the Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cost_number</code></td>
<td><code></code></td>
<td>
<p>A Decimal number or string to use for the posting's cost Amount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cost_currency</code></td>
<td><code></code></td>
<td>
<p>a string, the currency for the cost Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Posting, and as a side-effect the entry has had its list of
postings modified with the new Posting instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def create_simple_posting_with_cost(entry, account,
                                    number, currency,
                                    cost_number, cost_currency):
    """Create a simple posting on the entry, with just a number and currency (no cost).

    Args:
      entry: The entry instance to add the posting to.
      account: A string, the account to use on the posting.
      number: A Decimal number or string to use in the posting's Amount.
      currency: A string, the currency for the Amount.
      cost_number: A Decimal number or string to use for the posting's cost Amount.
      cost_currency: a string, the currency for the cost Amount.
    Returns:
      An instance of Posting, and as a side-effect the entry has had its list of
      postings modified with the new Posting instance.
    """
    if isinstance(account, str):
        pass
    if not isinstance(number, Decimal):
        number = D(number)
    if cost_number and not isinstance(cost_number, Decimal):
        cost_number = D(cost_number)
    units = Amount(number, currency)
    cost = Cost(cost_number, cost_currency, None, None)
    posting = Posting(account, units, cost, None, None, None)
    if entry is not None:
        entry.postings.append(posting)
    return posting
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.entry_sortkey">
<code class="highlight language-python">
beancount.core.data.entry_sortkey
(entry)

        </code>
<a class="headerlink" href="#beancount.core.data.entry_sortkey" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Sort-key for entries. We sort by date, except that checks
should be placed in front of every list of entries of that same day,
in order to balance linearly.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An entry instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple of (date, integer, integer), that forms the sort key for the
entry.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def entry_sortkey(entry):
    """Sort-key for entries. We sort by date, except that checks
    should be placed in front of every list of entries of that same day,
    in order to balance linearly.

    Args:
      entry: An entry instance.
    Returns:
      A tuple of (date, integer, integer), that forms the sort key for the
      entry.
    """
    return (entry.date, SORT_ORDER.get(type(entry), 0), entry.meta["lineno"])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.filter_txns">
<code class="highlight language-python">
beancount.core.data.filter_txns
(entries)

        </code>
<a class="headerlink" href="#beancount.core.data.filter_txns" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A generator that yields only the Transaction instances.</p>
<p>This is such an incredibly common operation that it deserves a terse
filtering mechanism.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  A sorted list of only the Transaction directives.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def filter_txns(entries):
    """A generator that yields only the Transaction instances.

    This is such an incredibly common operation that it deserves a terse
    filtering mechanism.

    Args:
      entries: A list of directives.
    Yields:
      A sorted list of only the Transaction directives.
    """
    for entry in entries:
        if isinstance(entry, Transaction):
            yield entry
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.find_closest">
<code class="highlight language-python">
beancount.core.data.find_closest
(entries, filename, lineno)

        </code>
<a class="headerlink" href="#beancount.core.data.find_closest" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find the closest entry from entries to (filename, lineno).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the ledger file to look for. Be careful
to provide the very same filename, and note that the parser stores the
absolute path of the filename here.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>lineno</code></td>
<td><code></code></td>
<td>
<p>An integer, the line number closest after the directive we're
looking for. This may be the exact/first line of the directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The closest entry found in the given file for the given filename, or
None, if none could be found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def find_closest(entries, filename, lineno):
    """Find the closest entry from entries to (filename, lineno).

    Args:
      entries: A list of directives.
      filename: A string, the name of the ledger file to look for. Be careful
        to provide the very same filename, and note that the parser stores the
        absolute path of the filename here.
      lineno: An integer, the line number closest after the directive we're
        looking for. This may be the exact/first line of the directive.
    Returns:
      The closest entry found in the given file for the given filename, or
      None, if none could be found.
    """
    min_diffline = sys.maxsize
    closest_entry = None
    for entry in entries:
        emeta = entry.meta
        if emeta["filename"] == filename and emeta["lineno"] &gt; 0:
            diffline = lineno - emeta["lineno"]
            if 0 &lt;= diffline &lt; min_diffline:
                min_diffline = diffline
                closest_entry = entry
    return closest_entry
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.get_entry">
<code class="highlight language-python">
beancount.core.data.get_entry
(posting_or_entry)

        </code>
<a class="headerlink" href="#beancount.core.data.get_entry" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the entry associated with the posting or entry.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A TxnPosting or entry instance</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A datetime instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_entry(posting_or_entry):
    """Return the entry associated with the posting or entry.

    Args:
      entry: A TxnPosting or entry instance
    Returns:
      A datetime instance.
    """
    return (posting_or_entry.txn
            if isinstance(posting_or_entry, TxnPosting)
            else posting_or_entry)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.has_entry_account_component">
<code class="highlight language-python">
beancount.core.data.has_entry_account_component
(entry, component)

        </code>
<a class="headerlink" href="#beancount.core.data.has_entry_account_component" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if one of the entry's postings has an account component.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A Transaction entry.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>component</code></td>
<td><code></code></td>
<td>
<p>A string, a component of an account name. For instance,
<code>Food</code> in <code>Expenses:Food:Restaurant</code>. All components are considered.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Boolean</code></td>
<td>
<p>true if the component is in the account. Note that a component
name must be whole, that is <code>NY</code> is not in <code>Expenses:Taxes:StateNY</code>.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def has_entry_account_component(entry, component):
    """Return true if one of the entry's postings has an account component.

    Args:
      entry: A Transaction entry.
      component: A string, a component of an account name. For instance,
        ``Food`` in ``Expenses:Food:Restaurant``. All components are considered.
    Returns:
      Boolean: true if the component is in the account. Note that a component
      name must be whole, that is ``NY`` is not in ``Expenses:Taxes:StateNY``.
    """
    return (isinstance(entry, Transaction) and
            any(has_component(posting.account, component)
                for posting in entry.postings))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.iter_entry_dates">
<code class="highlight language-python">
beancount.core.data.iter_entry_dates
(entries, date_begin, date_end)

        </code>
<a class="headerlink" href="#beancount.core.data.iter_entry_dates" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Iterate over the entries in a date window.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A date-sorted list of dated directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date_begin</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance, the first date to include.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date_end</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance, one day beyond the last date.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  Instances of the dated directives, between the dates, and in the order in
  which they appear.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def iter_entry_dates(entries, date_begin, date_end):
    """Iterate over the entries in a date window.

    Args:
      entries: A date-sorted list of dated directives.
      date_begin: A datetime.date instance, the first date to include.
      date_end: A datetime.date instance, one day beyond the last date.
    Yields:
      Instances of the dated directives, between the dates, and in the order in
      which they appear.
    """
    getdate = lambda entry: entry.date
    index_begin = bisect_left_with_key(entries, date_begin, key=getdate)
    index_end = bisect_left_with_key(entries, date_end, key=getdate)
    for index in range(index_begin, index_end):
        yield entries[index]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.new_directive">
<code class="highlight language-python">
beancount.core.data.new_directive
(clsname, fields)

        </code>
<a class="headerlink" href="#beancount.core.data.new_directive" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a directive class. Do not include default fields.
This should probably be carried out through inheritance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the capitalized name of the directive.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>List[Tuple]</code></td>
<td>
<p>A string or the list of strings, names for the fields
to add to the base tuple.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;function NamedTuple at 0x7fa29e883ca0&gt;</code></td>
<td>
<p>A type object for the new directive type.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def new_directive(clsname, fields: List[Tuple]) -&gt; NamedTuple:
    """Create a directive class. Do not include default fields.
    This should probably be carried out through inheritance.

    Args:
      name: A string, the capitalized name of the directive.
      fields: A string or the list of strings, names for the fields
        to add to the base tuple.
    Returns:
      A type object for the new directive type.
    """
    return NamedTuple(
        clsname,
        [('meta', Meta), ('date', datetime.date)] + fields)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.new_metadata">
<code class="highlight language-python">
beancount.core.data.new_metadata
(filename, lineno, kvlist=None)

        </code>
<a class="headerlink" href="#beancount.core.data.new_metadata" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a new metadata container from the filename and line number.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the filename for the creator of this directive.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>lineno</code></td>
<td><code></code></td>
<td>
<p>An integer, the line number where the directive has been created.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kvlist</code></td>
<td><code></code></td>
<td>
<p>An optional container of key-values.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A metadata dict.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def new_metadata(filename, lineno, kvlist=None):
    """Create a new metadata container from the filename and line number.

    Args:
      filename: A string, the filename for the creator of this directive.
      lineno: An integer, the line number where the directive has been created.
      kvlist: An optional container of key-values.
    Returns:
      A metadata dict.
    """
    meta = {'filename': filename,
            'lineno': lineno}
    if kvlist:
        meta.update(kvlist)
    return meta
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.posting_has_conversion">
<code class="highlight language-python">
beancount.core.data.posting_has_conversion
(posting)

        </code>
<a class="headerlink" href="#beancount.core.data.posting_has_conversion" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if this position involves a conversion.</p>
<p>A conversion is when there is a price attached to the amount but no cost.
This is used on transactions to convert between units.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>posting</code></td>
<td><code></code></td>
<td>
<p>an instance of Posting</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if this posting has a price conversion.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def posting_has_conversion(posting):
    """Return true if this position involves a conversion.

    A conversion is when there is a price attached to the amount but no cost.
    This is used on transactions to convert between units.

    Args:
      posting: an instance of Posting
    Return:
      A boolean, true if this posting has a price conversion.
    """
    return (posting.cost is None and
            posting.price is not None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.posting_sortkey">
<code class="highlight language-python">
beancount.core.data.posting_sortkey
(entry)

        </code>
<a class="headerlink" href="#beancount.core.data.posting_sortkey" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Sort-key for entries or postings. We sort by date, except that checks
should be placed in front of every list of entries of that same day,
in order to balance linearly.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A Posting or entry instance</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple of (date, integer, integer), that forms the sort key for the
posting or entry.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def posting_sortkey(entry):
    """Sort-key for entries or postings. We sort by date, except that checks
    should be placed in front of every list of entries of that same day,
    in order to balance linearly.

    Args:
      entry: A Posting or entry instance
    Returns:
      A tuple of (date, integer, integer), that forms the sort key for the
      posting or entry.
    """
    if isinstance(entry, TxnPosting):
        entry = entry.txn
    return (entry.date, SORT_ORDER.get(type(entry), 0), entry.meta["lineno"])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.remove_account_postings">
<code class="highlight language-python">
beancount.core.data.remove_account_postings
(account, entries)

        </code>
<a class="headerlink" href="#beancount.core.data.remove_account_postings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Remove all postings with the given account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account</code></td>
<td><code></code></td>
<td>
<p>A string, the account name whose postings we want to remove.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of entries without the rounding postings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def remove_account_postings(account, entries):
    """Remove all postings with the given account.

    Args:
      account: A string, the account name whose postings we want to remove.
    Returns:
      A list of entries without the rounding postings.
    """
    new_entries = []
    for entry in entries:
        if isinstance(entry, Transaction) and (
                any(posting.account == account for posting in entry.postings)):
            entry = entry._replace(postings=[posting
                                             for posting in entry.postings
                                             if posting.account != account])
        new_entries.append(entry)
    return new_entries
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.sanity_check_types">
<code class="highlight language-python">
beancount.core.data.sanity_check_types
(entry, allow_none_for_tags_and_links=False)

        </code>
<a class="headerlink" href="#beancount.core.data.sanity_check_types" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Check that the entry and its postings has all correct data types.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of one of the entries to be checked.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>allow_none_for_tags_and_links</code></td>
<td><code></code></td>
<td>
<p>A boolean, whether to allow plugins to
generate Transaction objects with None as value for the 'tags' or 'links'
attributes.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AssertionError</code></td>
<td>
<p>If there is anything that is unexpected, raises an exception.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def sanity_check_types(entry, allow_none_for_tags_and_links=False):
    """Check that the entry and its postings has all correct data types.

    Args:
      entry: An instance of one of the entries to be checked.
      allow_none_for_tags_and_links: A boolean, whether to allow plugins to
        generate Transaction objects with None as value for the 'tags' or 'links'
        attributes.
    Raises:
      AssertionError: If there is anything that is unexpected, raises an exception.
    """
    assert isinstance(entry, ALL_DIRECTIVES), "Invalid directive type"
    assert isinstance(entry.meta, dict), "Invalid type for meta"
    assert 'filename' in entry.meta, "Missing filename in metadata"
    assert 'lineno' in entry.meta, "Missing line number in metadata"
    assert isinstance(entry.date, datetime.date), "Invalid date type"
    if isinstance(entry, Transaction):
        assert isinstance(entry.flag, (NoneType, str)), "Invalid flag type"
        assert isinstance(entry.payee, (NoneType, str)), "Invalid payee type"
        assert isinstance(entry.narration, (NoneType, str)), "Invalid narration type"
        set_types = ((NoneType, set, frozenset)
                     if allow_none_for_tags_and_links
                     else (set, frozenset))
        assert isinstance(entry.tags, set_types), (
            "Invalid tags type: {}".format(type(entry.tags)))
        assert isinstance(entry.links, set_types), (
            "Invalid links type: {}".format(type(entry.links)))
        assert isinstance(entry.postings, list), "Invalid postings list type"
        for posting in entry.postings:
            assert isinstance(posting, Posting), "Invalid posting type"
            assert isinstance(posting.account, str), "Invalid account type"
            assert isinstance(posting.units, (Amount, NoneType)), "Invalid units type"
            assert isinstance(posting.cost, (Cost, CostSpec, NoneType)), "Invalid cost type"
            assert isinstance(posting.price, (Amount, NoneType)), "Invalid price type"
            assert isinstance(posting.flag, (str, NoneType)), "Invalid flag type"
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.sorted">
<code class="highlight language-python">
beancount.core.data.sorted
(entries)

        </code>
<a class="headerlink" href="#beancount.core.data.sorted" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A convenience to sort a list of entries, using entry_sortkey().</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A sorted list of directives.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def sorted(entries):
    """A convenience to sort a list of entries, using entry_sortkey().

    Args:
      entries: A list of directives.
    Returns:
      A sorted list of directives.
    """
    return builtins.sorted(entries, key=entry_sortkey)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.data.transaction_has_conversion">
<code class="highlight language-python">
beancount.core.data.transaction_has_conversion
(transaction)

        </code>
<a class="headerlink" href="#beancount.core.data.transaction_has_conversion" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Given a Transaction entry, return true if at least one of
the postings has a price conversion (without an associated
cost). These are the source of non-zero conversion balances.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>transaction</code></td>
<td><code></code></td>
<td>
<p>an instance of a Transaction entry.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if this transaction contains at least one posting with a
price conversion.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/data.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def transaction_has_conversion(transaction):
    """Given a Transaction entry, return true if at least one of
    the postings has a price conversion (without an associated
    cost). These are the source of non-zero conversion balances.

    Args:
      transaction: an instance of a Transaction entry.
    Returns:
      A boolean, true if this transaction contains at least one posting with a
      price conversion.
    """
    assert isinstance(transaction, Transaction), (
        "Invalid type of entry for transaction: {}".format(transaction))
    for posting in transaction.postings:
        if posting_has_conversion(posting):
            return True
    return False
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.display_context">
<code>beancount.core.display_context</code>
<a class="headerlink" href="#beancount.core.display_context" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>A settings class to offer control over the number of digits rendered.</p>
<p>This module contains routines that can accumulate information on the width and
precision of numbers to be rendered and derive the precision required to render
all of them consistently and under certain common alignment requirements. This
is required in order to output neatly lined up columns of numbers in various
styles.</p>
<p>A common case is that the precision can be observed for numbers present in the
input file. This display precision can be used as the "precision by default" if
we write a routine for which it is inconvenient to feed all the numbers to build
such an accumulator.</p>
<p>Here are all the aspects supported by this module:</p>
<p>PRECISION: Numbers for a particular currency are always rendered to the same
  precision, and they can be rendered to one of two precisions; either</p>
<ol>
<li>the most common number of fractional digits, or</li>
<li>the maximum number of digits seen (this is useful for rendering prices).</li>
</ol>
<p>ALIGNMENT: Several alignment methods are supported.</p>
<ul>
<li>
<p>"natural": Render the strings as small as possible with no padding, but to
    their currency's precision. Like this:</p>
<p>'1.2345'
  '764'
  '-7,409.01'
  '0.00000125'</p>
</li>
<li>
<p>"dot-aligned": The periods will align vertically, the left and right sides
    are padded so that the column of numbers has the same width:</p>
<p>'     1.2345    '
  '   764         '
  '-7,409.01      '
  '     0.00000125'</p>
</li>
<li>
<p>"right": The strings are all flushed right, the left side is padded so that
    the column of numbers has the same width:</p>
<p>'     1.2345'
  '        764'
  '  -7,409.01'
  ' 0.00000125'</p>
</li>
</ul>
<p>SIGN: If a negative sign is present in the input numbers, the rendered numbers
  reserve a space for it. If not, then we save the space.</p>
<p>COMMAS: If the user requests to render commas, commas are rendered in the
  output.</p>
<p>RESERVED: A number of extra integral digits reserved on the left in order to
  allow rendering novel numbers that haven't yet been seen. For example,
  balances may contains much larger numbers than the numbers seen in input
  files, and these need to be accommodated when aligning to the right.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.display_context.Align">
<code>beancount.core.display_context.Align</code>
<a class="headerlink" href="#beancount.core.display_context.Align" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Alignment style for numbers.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.display_context.DisplayContext">
<code>beancount.core.display_context.DisplayContext</code>
<a class="headerlink" href="#beancount.core.display_context.DisplayContext" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A builder object used to construct a DisplayContext from a series of numbers.</p>
<pre><code>Attributes:
  ccontexts: A dict of currency string to CurrencyContext instance.
  commas: A bool, true if we should render commas. This just gets propagated
    onwards as the default value of to build with.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.display_context.DisplayContext.build">
<code class="highlight language-python">
beancount.core.display_context.DisplayContext.build
(self, alignment=&lt;Align.NATURAL: 1&gt;, precision=&lt;Precision.MOST_COMMON: 1&gt;, commas=None, reserved=0)

        </code>
<a class="headerlink" href="#beancount.core.display_context.DisplayContext.build" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Build a formatter for the given display context.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>alignment</code></td>
<td><code></code></td>
<td>
<p>The desired alignment.</p>
</td>
<td><code>&lt;Align.NATURAL: 1&gt;</code></td>
</tr>
<tr>
<td><code>precision</code></td>
<td><code></code></td>
<td>
<p>The desired precision.</p>
</td>
<td><code>&lt;Precision.MOST_COMMON: 1&gt;</code></td>
</tr>
<tr>
<td><code>commas</code></td>
<td><code></code></td>
<td>
<p>Whether to render commas or not. If 'None', the default value carried
by the context will be used.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>reserved</code></td>
<td><code></code></td>
<td>
<p>An integer, the number of extra digits to be allocated in
the maximum width calculations.</p>
</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/display_context.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def build(self,
          alignment=Align.NATURAL,
          precision=Precision.MOST_COMMON,
          commas=None,
          reserved=0):
    """Build a formatter for the given display context.

    Args:
      alignment: The desired alignment.
      precision: The desired precision.
      commas: Whether to render commas or not. If 'None', the default value carried
        by the context will be used.
      reserved: An integer, the number of extra digits to be allocated in
        the maximum width calculations.
    """
    if commas is None:
        commas = self.commas
    if alignment == Align.NATURAL:
        build_method = self._build_natural
    elif alignment == Align.RIGHT:
        build_method = self._build_right
    elif alignment == Align.DOT:
        build_method = self._build_dot
    else:
        raise ValueError("Unknown alignment: {}".format(alignment))
    fmtstrings = build_method(precision, commas, reserved)

    return DisplayFormatter(self, precision, fmtstrings)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.display_context.DisplayContext.quantize">
<code class="highlight language-python">
beancount.core.display_context.DisplayContext.quantize
(self, number, currency, precision=&lt;Precision.MOST_COMMON: 1&gt;)

        </code>
<a class="headerlink" href="#beancount.core.display_context.DisplayContext.quantize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Quantize the given number to the given precision.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A Decimal instance, the number to be quantized.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A currency string.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>precision</code></td>
<td><code></code></td>
<td>
<p>Which precision to use.</p>
</td>
<td><code>&lt;Precision.MOST_COMMON: 1&gt;</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Decimal instance, the quantized number.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/display_context.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def quantize(self, number, currency, precision=Precision.MOST_COMMON):
    """Quantize the given number to the given precision.

    Args:
      number: A Decimal instance, the number to be quantized.
      currency: A currency string.
      precision: Which precision to use.
    Returns:
      A Decimal instance, the quantized number.
    """
    assert isinstance(number, Decimal), "Invalid data: {}".format(number)
    ccontext = self.ccontexts[currency]
    num_fractional_digits = ccontext.get_fractional(precision)
    if num_fractional_digits is None:
        # Note: We could probably logging.warn() this situation here.
        return number
    qdigit = Decimal(1).scaleb(-num_fractional_digits)
    return number.quantize(qdigit)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.display_context.DisplayContext.set_commas">
<code class="highlight language-python">
beancount.core.display_context.DisplayContext.set_commas
(self, commas)

        </code>
<a class="headerlink" href="#beancount.core.display_context.DisplayContext.set_commas" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Set the default value for rendering commas.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/display_context.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def set_commas(self, commas):
    """Set the default value for rendering commas."""
    self.commas = commas
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.display_context.DisplayContext.update">
<code class="highlight language-python">
beancount.core.display_context.DisplayContext.update
(self, number, currency='__default__')

        </code>
<a class="headerlink" href="#beancount.core.display_context.DisplayContext.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Update the builder with the given number for the given currency.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>An instance of Decimal to consider for this currency.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>An optional string, the currency this numbers applies to.</p>
</td>
<td><code>'__default__'</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/display_context.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, number, currency='__default__'):
    """Update the builder with the given number for the given currency.

    Args:
      number: An instance of Decimal to consider for this currency.
      currency: An optional string, the currency this numbers applies to.
    """
    self.ccontexts[currency].update(number)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.display_context.DisplayFormatter">
<code>beancount.core.display_context.DisplayFormatter</code>
<a class="headerlink" href="#beancount.core.display_context.DisplayFormatter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A class used to contain various settings that control how we output numbers.
    In particular, the precision used for each currency, and whether or not
    commas should be printed. This object is intended to be passed around to all
    functions that format numbers to strings.</p>
<pre><code>Attributes:
  dcontext: A DisplayContext instance.
  precision: An enum of Precision from which it was built.
  fmtstrings: A dict of currency to pre-baked format strings for it.
  fmtfuncs: A dict of currency to pre-baked formatting functions for it.
</code></pre>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.display_context.Precision">
<code>beancount.core.display_context.Precision</code>
<a class="headerlink" href="#beancount.core.display_context.Precision" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The type of precision required.</p>
<div class="doc doc-children">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.distribution">
<code>beancount.core.distribution</code>
<a class="headerlink" href="#beancount.core.distribution" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>A simple accumulator for data about a mathematical distribution.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.distribution.Distribution">
<code>beancount.core.distribution.Distribution</code>
<a class="headerlink" href="#beancount.core.distribution.Distribution" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A class that computes a histogram of integer values. This is used to compute
    a length that will cover at least some decent fraction of the samples.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.distribution.Distribution.empty">
<code class="highlight language-python">
beancount.core.distribution.Distribution.empty
(self)

        </code>
<a class="headerlink" href="#beancount.core.distribution.Distribution.empty" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return true if the distribution is empty.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/distribution.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def empty(self):
    """Return true if the distribution is empty.

    Returns:
      A boolean.
    """
    return len(self.hist) == 0
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.distribution.Distribution.max">
<code class="highlight language-python">
beancount.core.distribution.Distribution.max
(self)

        </code>
<a class="headerlink" href="#beancount.core.distribution.Distribution.max" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the minimum value seen in the distribution.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An element of the value type, or None, if the distribution was empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/distribution.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def max(self):
    """Return the minimum value seen in the distribution.

    Returns:
      An element of the value type, or None, if the distribution was empty.
    """
    if not self.hist:
        return None
    value, _ = sorted(self.hist.items())[-1]
    return value
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.distribution.Distribution.min">
<code class="highlight language-python">
beancount.core.distribution.Distribution.min
(self)

        </code>
<a class="headerlink" href="#beancount.core.distribution.Distribution.min" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the minimum value seen in the distribution.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An element of the value type, or None, if the distribution was empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/distribution.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def min(self):
    """Return the minimum value seen in the distribution.

    Returns:
      An element of the value type, or None, if the distribution was empty.
    """
    if not self.hist:
        return None
    value, _ = sorted(self.hist.items())[0]
    return value
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.distribution.Distribution.mode">
<code class="highlight language-python">
beancount.core.distribution.Distribution.mode
(self)

        </code>
<a class="headerlink" href="#beancount.core.distribution.Distribution.mode" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the mode of the distribution.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An element of the value type, or None, if the distribution was empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/distribution.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def mode(self):
    """Return the mode of the distribution.

    Returns:
      An element of the value type, or None, if the distribution was empty.
    """
    if not self.hist:
        return None
    max_value = 0
    max_count = 0
    for value, count in sorted(self.hist.items()):
        if count &gt;= max_count:
            max_count = count
            max_value = value
    return max_value
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.distribution.Distribution.update">
<code class="highlight language-python">
beancount.core.distribution.Distribution.update
(self, value)

        </code>
<a class="headerlink" href="#beancount.core.distribution.Distribution.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add a sample to the distribution.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>value</code></td>
<td><code></code></td>
<td>
<p>A value of the function.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/distribution.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, value):
    """Add a sample to the distribution.

    Args:
      value: A value of the function.
    """
    self.hist[value] += 1
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.flags">
<code>beancount.core.flags</code>
<a class="headerlink" href="#beancount.core.flags" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Flag constants.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.getters">
<code>beancount.core.getters</code>
<a class="headerlink" href="#beancount.core.getters" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Getter functions that operate on lists of entries to return various lists of
things that they reference, accounts, tags, links, currencies, etc.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.getters.GetAccounts">
<code>beancount.core.getters.GetAccounts</code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Accounts gatherer.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Balance">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Balance
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Balance" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with a single account attribute.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The single account of this directive.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _one(_, entry):
    """Process directives with a single account attribute.

    Args:
      entry: An instance of a directive.
    Returns:
      The single account of this directive.
    """
    return (entry.account,)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Close">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Close
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Close" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with a single account attribute.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The single account of this directive.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _one(_, entry):
    """Process directives with a single account attribute.

    Args:
      entry: An instance of a directive.
    Returns:
      The single account of this directive.
    """
    return (entry.account,)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Commodity">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Commodity
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Commodity" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with no accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An empty list</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _zero(_, entry):
    """Process directives with no accounts.

    Args:
      entry: An instance of a directive.
    Returns:
      An empty list
    """
    return ()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Custom">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Custom
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Custom" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with no accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An empty list</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _zero(_, entry):
    """Process directives with no accounts.

    Args:
      entry: An instance of a directive.
    Returns:
      An empty list
    """
    return ()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Document">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Document
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Document" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with a single account attribute.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The single account of this directive.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _one(_, entry):
    """Process directives with a single account attribute.

    Args:
      entry: An instance of a directive.
    Returns:
      The single account of this directive.
    """
    return (entry.account,)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Event">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Event
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Event" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with no accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An empty list</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _zero(_, entry):
    """Process directives with no accounts.

    Args:
      entry: An instance of a directive.
    Returns:
      An empty list
    """
    return ()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.get_accounts_use_map">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.get_accounts_use_map
(self, entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.get_accounts_use_map" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Gather the list of accounts from the list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of dictionaries of account name to date, one for first date
used and one for last date used. The keys should be identical.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_accounts_use_map(self, entries):
    """Gather the list of accounts from the list of entries.

    Args:
      entries: A list of directive instances.
    Returns:
      A pair of dictionaries of account name to date, one for first date
      used and one for last date used. The keys should be identical.
    """
    accounts_first = {}
    accounts_last = {}
    for entry in entries:
        method = getattr(self, entry.__class__.__name__)
        for account_ in method(entry):
            if account_ not in accounts_first:
                accounts_first[account_] = entry.date
            accounts_last[account_] = entry.date
    return accounts_first, accounts_last
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.get_entry_accounts">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.get_entry_accounts
(self, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.get_entry_accounts" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Gather all the accounts references by a single directive.</p>
<p>Note: This should get replaced by a method on each directive eventually,
that would be the clean way to do this.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>A directive instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of account name strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_entry_accounts(self, entry):
    """Gather all the accounts references by a single directive.

    Note: This should get replaced by a method on each directive eventually,
    that would be the clean way to do this.

    Args:
      entry: A directive instance.
    Returns:
      A set of account name strings.
    """
    method = getattr(self, entry.__class__.__name__)
    return set(method(entry))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Note">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Note
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Note" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with a single account attribute.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The single account of this directive.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _one(_, entry):
    """Process directives with a single account attribute.

    Args:
      entry: An instance of a directive.
    Returns:
      The single account of this directive.
    """
    return (entry.account,)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Open">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Open
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Open" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with a single account attribute.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The single account of this directive.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _one(_, entry):
    """Process directives with a single account attribute.

    Args:
      entry: An instance of a directive.
    Returns:
      The single account of this directive.
    """
    return (entry.account,)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Pad">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Pad
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Pad" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process a Pad directive.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of Pad.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The two accounts of the Pad directive.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def Pad(_, entry):
    """Process a Pad directive.

    Args:
      entry: An instance of Pad.
    Returns:
      The two accounts of the Pad directive.
    """
    return (entry.account, entry.source_account)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Price">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Price
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Price" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with no accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An empty list</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _zero(_, entry):
    """Process directives with no accounts.

    Args:
      entry: An instance of a directive.
    Returns:
      An empty list
    """
    return ()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Query">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Query
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Query" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process directives with no accounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a directive.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An empty list</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _zero(_, entry):
    """Process directives with no accounts.

    Args:
      entry: An instance of a directive.
    Returns:
      An empty list
    """
    return ()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.getters.GetAccounts.Transaction">
<code class="highlight language-python">
beancount.core.getters.GetAccounts.Transaction
(_, entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.GetAccounts.Transaction" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Process a Transaction directive.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of Transaction.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  The accounts of the legs of the transaction.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def Transaction(_, entry):
    """Process a Transaction directive.

    Args:
      entry: An instance of Transaction.
    Yields:
      The accounts of the legs of the transaction.
    """
    for posting in entry.postings:
        yield posting.account
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_account_components">
<code class="highlight language-python">
beancount.core.getters.get_account_components
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_account_components" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Gather all the account components available in the given directives.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of strings, the unique account components, including the root
account names.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_account_components(entries):
    """Gather all the account components available in the given directives.

    Args:
      entries: A list of directive instances.
    Returns:
      A list of strings, the unique account components, including the root
      account names.
    """
    accounts = get_accounts(entries)
    components = set()
    for account_name in accounts:
        components.update(account.split(account_name))
    return sorted(components)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_account_open_close">
<code class="highlight language-python">
beancount.core.getters.get_account_open_close
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_account_open_close" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Fetch the open/close entries for each of the accounts.</p>
<p>If an open or close entry happens to be duplicated, accept the earliest
entry (chronologically).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A map of account name strings to pairs of (open-directive, close-directive)
tuples.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_account_open_close(entries):
    """Fetch the open/close entries for each of the accounts.

    If an open or close entry happens to be duplicated, accept the earliest
    entry (chronologically).

    Args:
      entries: A list of directive instances.
    Returns:
      A map of account name strings to pairs of (open-directive, close-directive)
      tuples.
    """
    # A dict of account name to (open-entry, close-entry).
    open_close_map = defaultdict(lambda: [None, None])
    for entry in entries:
        if not isinstance(entry, (Open, Close)):
            continue
        open_close = open_close_map[entry.account]
        index = 0 if isinstance(entry, Open) else 1
        previous_entry = open_close[index]
        if previous_entry is not None:
            if previous_entry.date &lt;= entry.date:
                entry = previous_entry
        open_close[index] = entry

    return dict(open_close_map)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_accounts">
<code class="highlight language-python">
beancount.core.getters.get_accounts
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_accounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Gather all the accounts references by a list of directives.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of account strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_accounts(entries):
    """Gather all the accounts references by a list of directives.

    Args:
      entries: A list of directive instances.
    Returns:
      A set of account strings.
    """
    _, accounts_last = _GetAccounts.get_accounts_use_map(entries)
    return accounts_last.keys()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_accounts_use_map">
<code class="highlight language-python">
beancount.core.getters.get_accounts_use_map
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_accounts_use_map" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Gather all the accounts references by a list of directives.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of dictionaries of account name to date, one for first date
used and one for last date used. The keys should be identical.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_accounts_use_map(entries):
    """Gather all the accounts references by a list of directives.

    Args:
      entries: A list of directive instances.
    Returns:
      A pair of dictionaries of account name to date, one for first date
      used and one for last date used. The keys should be identical.
    """
    return _GetAccounts.get_accounts_use_map(entries)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_active_years">
<code class="highlight language-python">
beancount.core.getters.get_active_years
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_active_years" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Yield all the years that have at least one entry in them.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  Unique dates see in the list of directives.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_active_years(entries):
    """Yield all the years that have at least one entry in them.

    Args:
      entries: A list of directive instances.
    Yields:
      Unique dates see in the list of directives.
    """
    seen = set()
    prev_year = None
    for entry in entries:
        year = entry.date.year
        if year != prev_year:
            prev_year = year
            assert year not in seen
            seen.add(year)
            yield year
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_all_links">
<code class="highlight language-python">
beancount.core.getters.get_all_links
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_all_links" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a list of all the links seen in the given entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of links strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_all_links(entries):
    """Return a list of all the links seen in the given entries.

    Args:
      entries: A list of directive instances.
    Returns:
      A set of links strings.
    """
    all_links = set()
    for entry in entries:
        if not isinstance(entry, Transaction):
            continue
        if entry.links:
            all_links.update(entry.links)
    return sorted(all_links)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_all_payees">
<code class="highlight language-python">
beancount.core.getters.get_all_payees
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_all_payees" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a list of all the unique payees seen in the given entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of payee strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_all_payees(entries):
    """Return a list of all the unique payees seen in the given entries.

    Args:
      entries: A list of directive instances.
    Returns:
      A set of payee strings.
    """
    all_payees = set()
    for entry in entries:
        if not isinstance(entry, Transaction):
            continue
        all_payees.add(entry.payee)
    all_payees.discard(None)
    return sorted(all_payees)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_all_tags">
<code class="highlight language-python">
beancount.core.getters.get_all_tags
(entries)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_all_tags" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a list of all the tags seen in the given entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of tag strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_all_tags(entries):
    """Return a list of all the tags seen in the given entries.

    Args:
      entries: A list of directive instances.
    Returns:
      A set of tag strings.
    """
    all_tags = set()
    for entry in entries:
        if not isinstance(entry, Transaction):
            continue
        if entry.tags:
            all_tags.update(entry.tags)
    return sorted(all_tags)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_commodity_map">
<code class="highlight language-python">
beancount.core.getters.get_commodity_map
(entries, create_missing=True)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_commodity_map" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create map of commodity names to Commodity entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>create_missing</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if you want to automatically generate
missing commodity directives if not present in the output map.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A map of commodity name strings to Commodity directives.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_commodity_map(entries, create_missing=True):
    """Create map of commodity names to Commodity entries.

    Args:
      entries: A list of directive instances.
      create_missing: A boolean, true if you want to automatically generate
        missing commodity directives if not present in the output map.
    Returns:
      A map of commodity name strings to Commodity directives.
    """
    if not entries:
        return {}

    commodities_map = {}
    for entry in entries:
        if isinstance(entry, Commodity):
            commodities_map[entry.currency] = entry

        elif isinstance(entry, Transaction):
            for posting in entry.postings:

                # Main currency.
                units = posting.units
                commodities_map.setdefault(units.currency, None)

                # Currency in cost.
                cost = posting.cost
                if cost:
                    commodities_map.setdefault(cost.currency, None)

                # Currency in price.
                price = posting.price
                if price:
                    commodities_map.setdefault(price.currency, None)

        elif isinstance(entry, Balance):
            commodities_map.setdefault(entry.amount.currency, None)

        elif isinstance(entry, Price):
            commodities_map.setdefault(entry.currency, None)

    if create_missing:
        # Create missing Commodity directives when they haven't been specified explicitly.
        # (I think it might be better to always do this from the loader.)
        date = entries[0].date
        meta = data.new_metadata('&lt;getters&gt;', 0)
        commodities_map = {
            commodity: (entry
                        if entry is not None
                        else Commodity(meta, date, commodity))
            for commodity, entry in commodities_map.items()}

    return commodities_map
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_dict_accounts">
<code class="highlight language-python">
beancount.core.getters.get_dict_accounts
(account_names)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_dict_accounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a nested dict of all the unique leaf names.
account names are labelled with LABEL=True</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_names</code></td>
<td><code></code></td>
<td>
<p>An iterable of account names (strings)</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A nested OrderedDict of account leafs</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_dict_accounts(account_names):
    """Return a nested dict of all the unique leaf names.
    account names are labelled with LABEL=True

    Args:
      account_names: An iterable of account names (strings)
    Returns:
      A nested OrderedDict of account leafs
    """
    leveldict = OrderedDict()
    for account_name in account_names:
        nested_dict = leveldict
        for component in account.split(account_name):
            nested_dict = nested_dict.setdefault(component, OrderedDict())
        nested_dict[get_dict_accounts.ACCOUNT_LABEL] = True
    return leveldict
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_entry_accounts">
<code class="highlight language-python">
beancount.core.getters.get_entry_accounts
(entry)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_entry_accounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Gather all the accounts references by a single directive.</p>
<p>Note: This should get replaced by a method on each directive eventually,
that would be the clean way to do this.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A directive instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of account strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_entry_accounts(entry):
    """Gather all the accounts references by a single directive.

    Note: This should get replaced by a method on each directive eventually,
    that would be the clean way to do this.

    Args:
      entries: A directive instance.
    Returns:
      A set of account strings.
    """
    return _GetAccounts.get_entry_accounts(entry)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_leveln_parent_accounts">
<code class="highlight language-python">
beancount.core.getters.get_leveln_parent_accounts
(account_names, level, nrepeats=0)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_leveln_parent_accounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a list of all the unique leaf names at level N in an account hierarchy.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_names</code></td>
<td><code></code></td>
<td>
<p>A list of account names (strings)</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>level</code></td>
<td><code></code></td>
<td>
<p>The level to cross-cut. 0 is for root accounts.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>nrepeats</code></td>
<td><code></code></td>
<td>
<p>A minimum number of times a leaf is required to be present in the
the list of unique account names in order to be returned by this function.</p>
</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of leaf node names.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_leveln_parent_accounts(account_names, level, nrepeats=0):
    """Return a list of all the unique leaf names at level N in an account hierarchy.

    Args:
      account_names: A list of account names (strings)
      level: The level to cross-cut. 0 is for root accounts.
      nrepeats: A minimum number of times a leaf is required to be present in the
        the list of unique account names in order to be returned by this function.
    Returns:
      A list of leaf node names.
    """
    leveldict = defaultdict(int)
    for account_name in set(account_names):
        components = account.split(account_name)
        if level &lt; len(components):
            leveldict[components[level]] += 1
    levels = {level_
              for level_, count in leveldict.items()
              if count &gt; nrepeats}
    return sorted(levels)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_min_max_dates">
<code class="highlight language-python">
beancount.core.getters.get_min_max_dates
(entries, types=None)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_min_max_dates" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the minimum and maximum dates in the list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directive instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>types</code></td>
<td><code></code></td>
<td>
<p>An optional tuple of types to restrict the entries to.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of datetime.date dates, the minimum and maximum dates seen in the
directives.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_min_max_dates(entries, types=None):
    """Return the minimum and maximum dates in the list of entries.

    Args:
      entries: A list of directive instances.
      types: An optional tuple of types to restrict the entries to.
    Returns:
      A pair of datetime.date dates, the minimum and maximum dates seen in the
      directives.
    """
    date_first = date_last = None

    for entry in entries:
        if types and not isinstance(entry, types):
            continue
        date_first = entry.date
        break

    for entry in reversed(entries):
        if types and not isinstance(entry, types):
            continue
        date_last = entry.date
        break

    return (date_first, date_last)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.getters.get_values_meta">
<code class="highlight language-python">
beancount.core.getters.get_values_meta
    (name_to_entries_map, *
meta_keys, *, default=None)

        </code>
<a class="headerlink" href="#beancount.core.getters.get_values_meta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get a map of the metadata from a map of entries values.</p>
<p>Given a dict of some key to a directive instance (or None), return a mapping
of the key to the metadata extracted from each directive, or a default
value. This can be used to gather a particular piece of metadata from an
accounts map or a commodities map.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name_to_entries_map</code></td>
<td><code></code></td>
<td>
<p>A dict of something to an entry or None.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>meta_keys</code></td>
<td><code></code></td>
<td>
<p>A list of strings, the keys to fetch from the metadata.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>default</code></td>
<td><code></code></td>
<td>
<p>The default value to use if the metadata is not available or if
the value/entry is None.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A mapping of the keys of name_to_entries_map to the values of the 'meta_keys'
metadata. If there are multiple 'meta_keys', each value is a tuple of them.
On the other hand, if there is only a single one, the value itself is returned.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/getters.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_values_meta(name_to_entries_map, *meta_keys, default=None):
    """Get a map of the metadata from a map of entries values.

    Given a dict of some key to a directive instance (or None), return a mapping
    of the key to the metadata extracted from each directive, or a default
    value. This can be used to gather a particular piece of metadata from an
    accounts map or a commodities map.

    Args:
      name_to_entries_map: A dict of something to an entry or None.
      meta_keys: A list of strings, the keys to fetch from the metadata.
      default: The default value to use if the metadata is not available or if
        the value/entry is None.
    Returns:
      A mapping of the keys of name_to_entries_map to the values of the 'meta_keys'
      metadata. If there are multiple 'meta_keys', each value is a tuple of them.
      On the other hand, if there is only a single one, the value itself is returned.
    """
    value_map = {}
    for key, entry in name_to_entries_map.items():
        value_list = []
        for meta_key in meta_keys:
            value_list.append(entry.meta.get(meta_key, default)
                              if entry is not None
                              else default)
        value_map[key] = (value_list[0]
                          if len(meta_keys) == 1
                          else tuple(value_list))
    return value_map
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.interpolate">
<code>beancount.core.interpolate</code>
<a class="headerlink" href="#beancount.core.interpolate" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Code used to automatically complete postings without positions.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.interpolate.BalanceError">
<code>beancount.core.interpolate.BalanceError</code>
<a class="headerlink" href="#beancount.core.interpolate.BalanceError" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>BalanceError(source, message, entry)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.interpolate.BalanceError.__getnewargs__">
<code class="highlight language-python">
beancount.core.interpolate.BalanceError.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.interpolate.BalanceError.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.interpolate.BalanceError.__new__">
<code class="highlight language-python">
beancount.core.interpolate.BalanceError.__new__
(_cls, source, message, entry)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.interpolate.BalanceError.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of BalanceError(source, message, entry)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.interpolate.BalanceError.__repr__">
<code class="highlight language-python">
beancount.core.interpolate.BalanceError.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.interpolate.BalanceError.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.compute_entries_balance">
<code class="highlight language-python">
beancount.core.interpolate.compute_entries_balance
(entries, prefix=None, date=None)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.compute_entries_balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the balance of all postings of a list of entries.</p>
<p>Sum up all the positions in all the postings of all the transactions in the
list of entries and return an inventory of it.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>prefix</code></td>
<td><code></code></td>
<td>
<p>If specified, a prefix string to restrict by account name. Only
postings with an account that starts with this prefix will be summed up.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance at which to stop adding up the balance.
The date is exclusive.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compute_entries_balance(entries, prefix=None, date=None):
    """Compute the balance of all postings of a list of entries.

    Sum up all the positions in all the postings of all the transactions in the
    list of entries and return an inventory of it.

    Args:
      entries: A list of directives.
      prefix: If specified, a prefix string to restrict by account name. Only
        postings with an account that starts with this prefix will be summed up.
      date: A datetime.date instance at which to stop adding up the balance.
        The date is exclusive.
    Returns:
      An instance of Inventory.
    """
    total_balance = Inventory()
    for entry in entries:
        if not (date is None or entry.date &lt; date):
            break
        if isinstance(entry, Transaction):
            for posting in entry.postings:
                if prefix is None or posting.account.startswith(prefix):
                    total_balance.add_position(posting)
    return total_balance
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.compute_entry_context">
<code class="highlight language-python">
beancount.core.interpolate.compute_entry_context
(entries, context_entry)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.compute_entry_context" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the balances of all accounts referenced by entry up to entry.</p>
<p>This provides the inventory of the accounts to which the entry is to be
applied, before and after.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context_entry</code></td>
<td><code></code></td>
<td>
<p>The entry for which we want to obtain the before and after
context.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>Two dicts of account-name to Inventory instance, one which represents the
context before the entry is applied, and one that represents the context
after it has been applied.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compute_entry_context(entries, context_entry):
    """Compute the balances of all accounts referenced by entry up to entry.

    This provides the inventory of the accounts to which the entry is to be
    applied, before and after.

    Args:
      entries: A list of directives.
      context_entry: The entry for which we want to obtain the before and after
        context.
    Returns:
      Two dicts of account-name to Inventory instance, one which represents the
      context before the entry is applied, and one that represents the context
      after it has been applied.
    """
    assert context_entry is not None, "context_entry is missing."

    # Get the set of accounts for which to compute the context.
    context_accounts = getters.get_entry_accounts(context_entry)

    # Iterate over the entries until we find the target one and accumulate the
    # balance.
    context_before = collections.defaultdict(inventory.Inventory)
    for entry in entries:
        if entry is context_entry:
            break
        if isinstance(entry, Transaction):
            for posting in entry.postings:
                if not any(posting.account == account
                           for account in context_accounts):
                    continue
                balance = context_before[posting.account]
                balance.add_position(posting)

    # Compute the after context for the entry.
    context_after = copy.deepcopy(context_before)
    if isinstance(context_entry, Transaction):
        for posting in entry.postings:
            balance = context_after[posting.account]
            balance.add_position(posting)

    return context_before, context_after
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.compute_residual">
<code class="highlight language-python">
beancount.core.interpolate.compute_residual
(postings)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.compute_residual" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the residual of a set of complete postings, and the per-currency precision.</p>
<p>This is used to cross-check a balanced transaction.</p>
<p>The precision is the maximum fraction that is being used for each currency
(a dict). We use the currency of the weight amount in order to infer the
quantization precision for each currency. Integer amounts aren't
contributing to the determination of precision.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting instances.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory, with the residual of the given list of postings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compute_residual(postings):
    """Compute the residual of a set of complete postings, and the per-currency precision.

    This is used to cross-check a balanced transaction.

    The precision is the maximum fraction that is being used for each currency
    (a dict). We use the currency of the weight amount in order to infer the
    quantization precision for each currency. Integer amounts aren't
    contributing to the determination of precision.

    Args:
      postings: A list of Posting instances.
    Returns:
      An instance of Inventory, with the residual of the given list of postings.
    """
    inventory = Inventory()
    for posting in postings:
        # Skip auto-postings inserted to absorb the residual (rounding error).
        if posting.meta and posting.meta.get(AUTOMATIC_RESIDUAL, False):
            continue
        # Add to total residual balance.
        inventory.add_amount(convert.get_weight(posting))
    return inventory
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.fill_residual_posting">
<code class="highlight language-python">
beancount.core.interpolate.fill_residual_posting
(entry, account_rounding)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.fill_residual_posting" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>If necessary, insert a posting to absorb the residual.
This makes the transaction balance exactly.</p>
<p>Note: This was developed in order to tweak transactions before exporting
them to Ledger. A better method would be to enable the feature that
automatically inserts these rounding postings on all transactions, and so
maybe this method can be deprecated if we do so.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entry</code></td>
<td><code></code></td>
<td>
<p>An instance of a Transaction.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_rounding</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the rounding account that
absorbs residuals / rounding errors.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A possibly new, modified entry with a new posting. If a residual
was not needed - the transaction already balanced perfectly - no new
leg is inserted.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def fill_residual_posting(entry, account_rounding):
    """If necessary, insert a posting to absorb the residual.
    This makes the transaction balance exactly.

    Note: This was developed in order to tweak transactions before exporting
    them to Ledger. A better method would be to enable the feature that
    automatically inserts these rounding postings on all transactions, and so
    maybe this method can be deprecated if we do so.

    Args:
      entry: An instance of a Transaction.
      account_rounding: A string, the name of the rounding account that
        absorbs residuals / rounding errors.
    Returns:
      A possibly new, modified entry with a new posting. If a residual
      was not needed - the transaction already balanced perfectly - no new
      leg is inserted.

    """
    residual = compute_residual(entry.postings)
    if not residual.is_empty():
        new_postings = list(entry.postings)
        new_postings.extend(get_residual_postings(residual, account_rounding))
        entry = entry._replace(postings=new_postings)
    return entry
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.get_residual_postings">
<code class="highlight language-python">
beancount.core.interpolate.get_residual_postings
(residual, account_rounding)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.get_residual_postings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create postings to book the given residuals.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>residual</code></td>
<td><code></code></td>
<td>
<p>An Inventory, the residual positions.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_rounding</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the rounding account that
absorbs residuals / rounding errors.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of new postings to be inserted to reduce the given residual.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_residual_postings(residual, account_rounding):
    """Create postings to book the given residuals.

    Args:
      residual: An Inventory, the residual positions.
      account_rounding: A string, the name of the rounding account that
        absorbs residuals / rounding errors.
    Returns:
      A list of new postings to be inserted to reduce the given residual.
    """
    meta = {AUTOMATIC_META: True,
            AUTOMATIC_RESIDUAL: True}
    return [Posting(account_rounding, -position.units, position.cost, None, None,
                    meta.copy())
            for position in residual.get_positions()]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.has_nontrivial_balance">
<code class="highlight language-python">
beancount.core.interpolate.has_nontrivial_balance
(posting)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.has_nontrivial_balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return True if a Posting has a balance amount that would have to be calculated.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>posting</code></td>
<td><code></code></td>
<td>
<p>A Posting instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def has_nontrivial_balance(posting):
    """Return True if a Posting has a balance amount that would have to be calculated.

    Args:
      posting: A Posting instance.
    Returns:
      A boolean.
    """
    return posting.cost or posting.price
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.infer_tolerances">
<code class="highlight language-python">
beancount.core.interpolate.infer_tolerances
(postings, options_map, use_cost=None)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.infer_tolerances" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Infer tolerances from a list of postings.</p>
<p>The tolerance is the maximum fraction that is being used for each currency
(a dict). We use the currency of the weight amount in order to infer the
quantization precision for each currency. Integer amounts aren't
contributing to the determination of precision.</p>
<p>The 'use_cost' option allows one to experiment with letting postings at cost
and at price influence the maximum value of the tolerance. It's tricky to
use and alters the definition of the tolerance in a non-trivial way, if you
use it. The tolerance is expanded by the sum of the cost times a fraction 'M'
of the smallest digits in the number of units for all postings held at cost.</p>
<p>For example, in this transaction:</p>
<pre><code>2006-01-17 * "Plan Contribution"
  Assets:Investments:VWELX 18.572 VWELX {30.96 USD}
  Assets:Investments:VWELX 18.572 VWELX {30.96 USD}
  Assets:Investments:Cash -1150.00 USD
</code></pre>
<p>The tolerance for units of USD will calculated as the MAXIMUM of:</p>
<p>0.01 * M = 0.005 (from the 1150.00 USD leg)</p>
<p>The sum of
    0.001 * M x 30.96 = 0.01548 +
    0.001 * M x 30.96 = 0.01548
                      = 0.03096</p>
<p>So the tolerance for USD in this case is max(0.005, 0.03096) = 0.03096. Prices
contribute similarly to the maximum tolerance allowed.</p>
<p>Note that 'M' above is the inferred_tolerance_multiplier and its default
value is 0.5.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>use_cost</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should be using a combination of the smallest
digit of the number times the cost or price in order to infer the tolerance.
If the value is left unspecified (as 'None'), the default value can be
overridden by setting an option.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A dict of currency to the tolerated difference amount to be used for it,
e.g. 0.005.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def infer_tolerances(postings, options_map, use_cost=None):
    """Infer tolerances from a list of postings.

    The tolerance is the maximum fraction that is being used for each currency
    (a dict). We use the currency of the weight amount in order to infer the
    quantization precision for each currency. Integer amounts aren't
    contributing to the determination of precision.

    The 'use_cost' option allows one to experiment with letting postings at cost
    and at price influence the maximum value of the tolerance. It's tricky to
    use and alters the definition of the tolerance in a non-trivial way, if you
    use it. The tolerance is expanded by the sum of the cost times a fraction 'M'
    of the smallest digits in the number of units for all postings held at cost.

    For example, in this transaction:

        2006-01-17 * "Plan Contribution"
          Assets:Investments:VWELX 18.572 VWELX {30.96 USD}
          Assets:Investments:VWELX 18.572 VWELX {30.96 USD}
          Assets:Investments:Cash -1150.00 USD

    The tolerance for units of USD will calculated as the MAXIMUM of:

      0.01 * M = 0.005 (from the 1150.00 USD leg)

      The sum of
        0.001 * M x 30.96 = 0.01548 +
        0.001 * M x 30.96 = 0.01548
                          = 0.03096

    So the tolerance for USD in this case is max(0.005, 0.03096) = 0.03096. Prices
    contribute similarly to the maximum tolerance allowed.

    Note that 'M' above is the inferred_tolerance_multiplier and its default
    value is 0.5.

    Args:
      postings: A list of Posting instances.
      options_map: A dict of options.
      use_cost: A boolean, true if we should be using a combination of the smallest
        digit of the number times the cost or price in order to infer the tolerance.
        If the value is left unspecified (as 'None'), the default value can be
        overridden by setting an option.
    Returns:
      A dict of currency to the tolerated difference amount to be used for it,
      e.g. 0.005.
    """
    if use_cost is None:
        use_cost = options_map["infer_tolerance_from_cost"]

    inferred_tolerance_multiplier = options_map["inferred_tolerance_multiplier"]

    default_tolerances = options_map["inferred_tolerance_default"]
    tolerances = default_tolerances.copy()

    cost_tolerances = collections.defaultdict(D)
    for posting in postings:
        # Skip the precision on automatically inferred postings.
        if posting.meta and AUTOMATIC_META in posting.meta:
            continue
        units = posting.units
        if not (isinstance(units, Amount) and isinstance(units.number, Decimal)):
            continue

        # Compute bounds on the number.
        currency = units.currency
        expo = units.number.as_tuple().exponent
        if expo &lt; 0:
            # Note: the exponent is a negative value.
            tolerance = ONE.scaleb(expo) * inferred_tolerance_multiplier
            tolerances[currency] = max(tolerance,
                                       tolerances.get(currency, -1024))

            if not use_cost:
                continue

            # Compute bounds on the smallest digit of the number implied as cost.
            cost = posting.cost
            if cost is not None:
                cost_currency = cost.currency
                if isinstance(cost, Cost):
                    cost_tolerance = min(tolerance * cost.number, MAXIMUM_TOLERANCE)
                else:
                    assert isinstance(cost, CostSpec)
                    cost_tolerance = MAXIMUM_TOLERANCE
                    for cost_number in cost.number_total, cost.number_per:
                        if cost_number is None or cost_number is MISSING:
                            continue
                        cost_tolerance = min(tolerance * cost_number, cost_tolerance)
                cost_tolerances[cost_currency] += cost_tolerance

            # Compute bounds on the smallest digit of the number implied as cost.
            price = posting.price
            if isinstance(price, Amount) and isinstance(price.number, Decimal):
                price_currency = price.currency
                price_tolerance = min(tolerance * price.number, MAXIMUM_TOLERANCE)
                cost_tolerances[price_currency] += price_tolerance

    for currency, tolerance in cost_tolerances.items():
        tolerances[currency] = max(tolerance, tolerances.get(currency, -1024))

    default = tolerances.pop('*', ZERO)
    return defdict.ImmutableDictWithDefault(tolerances, default=default)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.is_tolerance_user_specified">
<code class="highlight language-python">
beancount.core.interpolate.is_tolerance_user_specified
(tolerance)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.is_tolerance_user_specified" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the given tolerance number was user-specified.</p>
<p>This would allow the user to provide a tolerance like # 0.1234 but not
0.123456. This is used to detect whether a tolerance value # is input by the
user and not inferred automatically.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tolerance</code></td>
<td><code></code></td>
<td>
<p>An instance of Decimal.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_tolerance_user_specified(tolerance):
    """Return true if the given tolerance number was user-specified.

    This would allow the user to provide a tolerance like # 0.1234 but not
    0.123456. This is used to detect whether a tolerance value # is input by the
    user and not inferred automatically.

    Args:
      tolerance: An instance of Decimal.
    Returns:
      A boolean.
    """
    return len(tolerance.as_tuple().digits) &lt; MAX_TOLERANCE_DIGITS
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.interpolate.quantize_with_tolerance">
<code class="highlight language-python">
beancount.core.interpolate.quantize_with_tolerance
(tolerances, currency, number)

        </code>
<a class="headerlink" href="#beancount.core.interpolate.quantize_with_tolerance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Quantize the units using the tolerance dict.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tolerances</code></td>
<td><code></code></td>
<td>
<p>A dict of currency to tolerance Decimalvalues.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A number to quantize.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string currency.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Decimal, the number possibly quantized.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/interpolate.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def quantize_with_tolerance(tolerances, currency, number):
    """Quantize the units using the tolerance dict.

    Args:
      tolerances: A dict of currency to tolerance Decimalvalues.
      number: A number to quantize.
      currency: A string currency.
    Returns:
      A Decimal, the number possibly quantized.
    """
    # Applying rounding to the default tolerance, if there is one.
    tolerance = tolerances.get(currency)
    if tolerance:
        quantum = (tolerance * 2).normalize()

        # If the tolerance is a neat number provided by the user,
        # quantize the inferred numbers. See doc on quantize():
        #
        # Unlike other operations, if the length of the coefficient
        # after the quantize operation would be greater than
        # precision, then an InvalidOperation is signaled. This
        # guarantees that, unless there is an error condition, the
        # quantized exponent is always equal to that of the
        # right-hand operand.
        if is_tolerance_user_specified(quantum):
            number = number.quantize(quantum)
    return number
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.inventory">
<code>beancount.core.inventory</code>
<a class="headerlink" href="#beancount.core.inventory" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>A container for an inventory of positions.</p>
<p>This module provides a container class that can hold positions. An inventory is
a mapping of positions, where each position is keyed by</p>
<p>(currency: str, cost: Cost) -&gt; position: Position</p>
<p>where</p>
<p>'currency': The commodity under consideration, USD, CAD, or stock units such
     as HOOL, MSFT, AAPL, etc.;</p>
<p>'cost': None or a Cost instance existing of cost currency, number, date, and
     label;</p>
<p>'position': A Position object, whose 'units' attribute is guaranteed to have
    the same currency as 'currency' and whose 'cost' attribute is equal to the
    'cost' key. It basically stores the number of units.</p>
<p>This is meant to accommodate both booked and non-booked amounts. The clever
trick that we pull to do this is that for positions which aren't booked, we
simply leave the 'cost' as None. This is the case for most of the transactions.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.inventory.Booking">
<code>beancount.core.inventory.Booking</code>
<a class="headerlink" href="#beancount.core.inventory.Booking" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Result of booking a new lot to an existing inventory.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.inventory.Inventory">
<code>beancount.core.inventory.Inventory</code>
<a class="headerlink" href="#beancount.core.inventory.Inventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An Inventory is a set of positions.</p>
<pre><code>Attributes:
  positions: A list of Position instances, held in this Inventory object.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__abs__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__abs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__abs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return an inventory with the absolute value of each position.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __abs__(self):
    """Return an inventory with the absolute value of each position.

    Returns:
      An instance of Inventory.
    """
    return Inventory({key: abs(pos) for key, pos in self.items()})
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__add__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__add__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__add__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add another inventory to this one. This inventory is not modified.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __add__(self, other):
    """Add another inventory to this one. This inventory is not modified.

    Args:
      other: An instance of Inventory.
    Returns:
      A new instance of Inventory.
    """
    new_inventory = self.__copy__()
    new_inventory.add_inventory(other)
    return new_inventory
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__copy__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__copy__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__copy__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>A shallow copy of this inventory object.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory, equal to this one.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __copy__(self):
    """A shallow copy of this inventory object.

    Returns:
      An instance of Inventory, equal to this one.
    """
    return Inventory(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__iadd__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__iadd__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__iadd__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add all the positions of another Inventory instance to this one.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>An instance of Inventory to add to this one.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>This inventory, modified.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def add_inventory(self, other):
    """Add all the positions of another Inventory instance to this one.

    Args:
      other: An instance of Inventory to add to this one.
    Returns:
      This inventory, modified.
    """
    if self.is_empty():
        # Optimization for empty inventories; if the current one is empty,
        # adopt all of the other inventory's positions without running
        # through the full aggregation checks. This should be very cheap. We
        # can do this because the positions are immutable.
        self.update(other)
    else:
        for position in other.get_positions():
            self.add_position(position)
    return self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__init__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__init__
(self, positions=None)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a new inventory using a list of existing positions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>positions</code></td>
<td><code></code></td>
<td>
<p>A list of Position instances or an existing dict or
Inventory instance.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, positions=None):
    """Create a new inventory using a list of existing positions.

    Args:
      positions: A list of Position instances or an existing dict or
        Inventory instance.
    """
    if isinstance(positions, (dict, Inventory)):
        dict.__init__(self, positions)
    else:
        dict.__init__(self)
        if positions:
            assert isinstance(positions, Iterable)
            for position in positions:
                self.add_position(position)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__iter__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__iter__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__iter__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Iterate over the positions. Note that there is no guaranteed order.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __iter__(self):
    """Iterate over the positions. Note that there is no guaranteed order."""
    return iter(self.values())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__lt__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__lt__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__lt__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Inequality comparison operator.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __lt__(self, other):
    """Inequality comparison operator."""
    return sorted(self) &lt; sorted(other)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__mul__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__mul__
(self, scalar)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__mul__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Scale/multiply the contents of the inventory.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>scalar</code></td>
<td><code></code></td>
<td>
<p>A Decimal.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __mul__(self, scalar):
    """Scale/multiply the contents of the inventory.

    Args:
      scalar: A Decimal.
    Returns:
      An instance of Inventory.
    """
    return Inventory({key: pos * scalar for key, pos in self.items()})
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__neg__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__neg__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__neg__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return an inventory with the negative of values of this one.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __neg__(self):
    """Return an inventory with the negative of values of this one.

    Returns:
      An instance of Inventory.
    """
    return Inventory({key: -pos for key, pos in self.items()})
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__repr__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render as a human-readable string.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, for human consumption.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    """Render as a human-readable string.

    Returns:
      A string, for human consumption.
    """
    return self.to_string()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.__str__">
<code class="highlight language-python">
beancount.core.inventory.Inventory.__str__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.__str__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render as a human-readable string.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, for human consumption.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    """Render as a human-readable string.

    Returns:
      A string, for human consumption.
    """
    return self.to_string()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.add_amount">
<code class="highlight language-python">
beancount.core.inventory.Inventory.add_amount
(self, units, cost=None)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.add_amount" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add to this inventory using amount and cost. This adds with strict lot
matching, that is, no partial matches are done on the arguments to the
keys of the inventory.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>units</code></td>
<td><code></code></td>
<td>
<p>An Amount instance to add.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cost</code></td>
<td><code></code></td>
<td>
<p>An instance of Cost or None, as a key to the inventory.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of (position, booking) where 'position' is the position that
that was modified BEFORE it was modified, and where 'booking' is a
Booking enum that hints at how the lot was booked to this inventory.
Position may be None if there is no corresponding Position object,
e.g. the position was deleted.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def add_amount(self, units, cost=None):
    """Add to this inventory using amount and cost. This adds with strict lot
    matching, that is, no partial matches are done on the arguments to the
    keys of the inventory.

    Args:
      units: An Amount instance to add.
      cost: An instance of Cost or None, as a key to the inventory.
    Returns:
      A pair of (position, booking) where 'position' is the position that
      that was modified BEFORE it was modified, and where 'booking' is a
      Booking enum that hints at how the lot was booked to this inventory.
      Position may be None if there is no corresponding Position object,
      e.g. the position was deleted.
    """
    if ASSERTS_TYPES:
        assert isinstance(units, Amount), (
            "Internal error: {!r} (type: {})".format(units, type(units).__name__))
        assert cost is None or isinstance(cost, Cost), (
            "Internal error: {!r} (type: {})".format(cost, type(cost).__name__))

    # Find the position.
    key = (units.currency, cost)
    pos = self.get(key, None)

    if pos is not None:
        # Note: In order to augment or reduce, all the fields have to match.

        # Check if reducing.
        booking = (Booking.REDUCED
                   if not same_sign(pos.units.number, units.number)
                   else Booking.AUGMENTED)

        # Compute the new number of units.
        number = pos.units.number + units.number
        if number == ZERO:
            # If empty, delete the position.
            del self[key]
        else:
            # Otherwise update it.
            self[key] = Position(Amount(number, units.currency), cost)
    else:
        # If not found, create a new one.
        if units.number == ZERO:
            booking = Booking.IGNORED
        else:
            self[key] = Position(units, cost)
            booking = Booking.CREATED

    return pos, booking
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.add_inventory">
<code class="highlight language-python">
beancount.core.inventory.Inventory.add_inventory
(self, other)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.add_inventory" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add all the positions of another Inventory instance to this one.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>An instance of Inventory to add to this one.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>This inventory, modified.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def add_inventory(self, other):
    """Add all the positions of another Inventory instance to this one.

    Args:
      other: An instance of Inventory to add to this one.
    Returns:
      This inventory, modified.
    """
    if self.is_empty():
        # Optimization for empty inventories; if the current one is empty,
        # adopt all of the other inventory's positions without running
        # through the full aggregation checks. This should be very cheap. We
        # can do this because the positions are immutable.
        self.update(other)
    else:
        for position in other.get_positions():
            self.add_position(position)
    return self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.add_position">
<code class="highlight language-python">
beancount.core.inventory.Inventory.add_position
(self, position)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.add_position" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Add using a position (with strict lot matching).
Return True if this position was booked against and reduced another.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>position</code></td>
<td><code></code></td>
<td>
<p>The Posting or Position to add to this inventory.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of (position, booking) where 'position' is the position that
that was modified, and where 'booking' is a Booking enum that hints at
how the lot was booked to this inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def add_position(self, position):
    """Add using a position (with strict lot matching).
    Return True if this position was booked against and reduced another.

    Args:
      position: The Posting or Position to add to this inventory.
    Returns:
      A pair of (position, booking) where 'position' is the position that
      that was modified, and where 'booking' is a Booking enum that hints at
      how the lot was booked to this inventory.
    """
    if ASSERTS_TYPES:
        assert hasattr(position, 'units') and hasattr(position, 'cost'), (
            "Invalid type for position: {}".format(position))
        assert isinstance(position.cost, (type(None), Cost)), (
            "Invalid type for cost: {}".format(position.cost))
    return self.add_amount(position.units, position.cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.average">
<code class="highlight language-python">
beancount.core.inventory.Inventory.average
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.average" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Average all lots of the same currency together.</p>
<p>Use the minimum date from each aggregated set of lots.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def average(self):
    """Average all lots of the same currency together.

    Use the minimum date from each aggregated set of lots.

    Returns:
      An instance of Inventory.
    """
    groups = collections.defaultdict(list)
    for position in self:
        key = (position.units.currency,
               position.cost.currency if position.cost else None)
        groups[key].append(position)

    average_inventory = Inventory()
    for (currency, cost_currency), positions in groups.items():
        total_units = sum(position.units.number
                          for position in positions)
        # Explicitly skip aggregates when resulting in zero units.
        if total_units == ZERO:
            continue
        units_amount = Amount(total_units, currency)

        if cost_currency:
            total_cost = sum(convert.get_cost(position).number
                             for position in positions)
            cost_number = (Decimal('Infinity')
                           if total_units == ZERO
                           else (total_cost / total_units))
            min_date = None
            for pos in positions:
                pos_date = pos.cost.date if pos.cost else None
                if pos_date is not None:
                    min_date = (pos_date
                                if min_date is None
                                else min(min_date, pos_date))
            cost = Cost(cost_number, cost_currency, min_date, None)
        else:
            cost = None

        average_inventory.add_amount(units_amount, cost)

    return average_inventory
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.cost_currencies">
<code class="highlight language-python">
beancount.core.inventory.Inventory.cost_currencies
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.cost_currencies" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the list of unit currencies held in this inventory.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of currency strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def cost_currencies(self):
    """Return the list of unit currencies held in this inventory.

    Returns:
      A set of currency strings.
    """
    return set(cost.currency
               for _, cost in self.keys()
               if cost is not None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.currencies">
<code class="highlight language-python">
beancount.core.inventory.Inventory.currencies
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.currencies" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the list of unit currencies held in this inventory.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of currency strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def currencies(self):
    """Return the list of unit currencies held in this inventory.

    Returns:
      A list of currency strings.
    """
    return set(currency for currency, _ in self.keys())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.currency_pairs">
<code class="highlight language-python">
beancount.core.inventory.Inventory.currency_pairs
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.currency_pairs" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the commodities held in this inventory.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A set of currency strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def currency_pairs(self):
    """Return the commodities held in this inventory.

    Returns:
      A set of currency strings.
    """
    return set(position.currency_pair() for position in self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.from_string">
<code class="highlight language-python">
beancount.core.inventory.Inventory.from_string
(string)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.inventory.Inventory.from_string" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create an Inventory from a string. This is useful for writing tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A comma-separated string of &lt;number&gt; &lt;currency&gt; with an
optional {&lt;number&gt; &lt;currency&gt;} for the cost.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Inventory with the given balances.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create an Inventory from a string. This is useful for writing tests.

    Args:
      string: A comma-separated string of &lt;number&gt; &lt;currency&gt; with an
        optional {&lt;number&gt; &lt;currency&gt;} for the cost.
    Returns:
      A new instance of Inventory with the given balances.
    """
    new_inventory = Inventory()
    # We need to split the comma-separated positions but ignore commas
    # occurring within a {...cost...} specification.
    position_strs = re.split(
        r'([-+]?[0-9,.]+\s+[A-Z]+\s*(?:{[^}]*})?)\s*,?\s*', string)[1::2]
    for position_str in position_strs:
        new_inventory.add_position(position_from_string(position_str))
    return new_inventory
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.get_currency_units">
<code class="highlight language-python">
beancount.core.inventory.Inventory.get_currency_units
(self, currency)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.get_currency_units" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Fetch the total amount across all the position in the given currency.
This may sum multiple lots in the same currency denomination.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>currency</code></td>
<td><code></code></td>
<td>
<p>A string, the currency to filter the positions with.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Amount, with the given currency.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_currency_units(self, currency):
    """Fetch the total amount across all the position in the given currency.
    This may sum multiple lots in the same currency denomination.

    Args:
      currency: A string, the currency to filter the positions with.
    Returns:
      An instance of Amount, with the given currency.
    """
    total_units = ZERO
    for position in self:
        if position.units.currency == currency:
            total_units += position.units.number
    return Amount(total_units, currency)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.get_only_position">
<code class="highlight language-python">
beancount.core.inventory.Inventory.get_only_position
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.get_only_position" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the first position and assert there are no more.
If the inventory is empty, return None.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_only_position(self):
    """Return the first position and assert there are no more.
    If the inventory is empty, return None.
    """
    if len(self) &gt; 0:
        if len(self) &gt; 1:
            raise AssertionError("Inventory has more than one expected "
                                 "position: {}".format(self))
        return next(iter(self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.get_positions">
<code class="highlight language-python">
beancount.core.inventory.Inventory.get_positions
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.get_positions" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the positions in this inventory.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A shallow copy of the list of positions.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_positions(self):
    """Return the positions in this inventory.

    Returns:
      A shallow copy of the list of positions.
    """
    return list(iter(self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.is_empty">
<code class="highlight language-python">
beancount.core.inventory.Inventory.is_empty
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.is_empty" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return true if the inventory is empty, that is, has no positions.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_empty(self):
    """Return true if the inventory is empty, that is, has no positions.

    Returns:
      A boolean.
    """
    return len(self) == 0
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.is_mixed">
<code class="highlight language-python">
beancount.core.inventory.Inventory.is_mixed
(self)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.is_mixed" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return true if the inventory contains a mix of positive and negative lots for
at least one instrument.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_mixed(self):
    """Return true if the inventory contains a mix of positive and negative lots for
    at least one instrument.

    Returns:
      A boolean.
    """
    signs_map = {}
    for position in self:
        sign = position.units.number &gt;= 0
        prev_sign = signs_map.setdefault(position.units.currency, sign)
        if sign != prev_sign:
            return True
    return False
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.is_reduced_by">
<code class="highlight language-python">
beancount.core.inventory.Inventory.is_reduced_by
(self, ramount)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.is_reduced_by" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return true if the amount could reduce this inventory.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ramount</code></td>
<td><code></code></td>
<td>
<p>An instance of Amount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_reduced_by(self, ramount):
    """Return true if the amount could reduce this inventory.

    Args:
      ramount: An instance of Amount.
    Returns:
      A boolean.
    """
    if ramount.number == ZERO:
        return False
    for position in self:
        units = position.units
        if (ramount.currency == units.currency and
            not same_sign(ramount.number, units.number)):
            return True
    return False
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.is_small">
<code class="highlight language-python">
beancount.core.inventory.Inventory.is_small
(self, tolerances)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.is_small" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return true if all the positions in the inventory are small.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tolerances</code></td>
<td><code></code></td>
<td>
<p>A Decimal, the small number of units under which a position
is considered small, or a dict of currency to such epsilon precision.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_small(self, tolerances):
    """Return true if all the positions in the inventory are small.

    Args:
      tolerances: A Decimal, the small number of units under which a position
        is considered small, or a dict of currency to such epsilon precision.
    Returns:
      A boolean.
    """
    if isinstance(tolerances, dict):
        for position in self:
            tolerance = tolerances.get(position.units.currency, ZERO)
            if abs(position.units.number) &gt; tolerance:
                return False
        small = True
    else:
        small = not any(abs(position.units.number) &gt; tolerances
                        for position in self)
    return small
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.reduce">
<code class="highlight language-python">
beancount.core.inventory.Inventory.reduce
    (self, reducer, *
args)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.reduce" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Reduce an inventory using one of the conversion functions.</p>
<p>See functions in beancount.core.convert.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def reduce(self, reducer, *args):
    """Reduce an inventory using one of the conversion functions.

    See functions in beancount.core.convert.

    Returns:
      An instance of Inventory.
    """
    inventory = Inventory()
    for position in self:
        inventory.add_amount(reducer(position, *args))
    return inventory
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.segregate_units">
<code class="highlight language-python">
beancount.core.inventory.Inventory.segregate_units
(self, currencies)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.segregate_units" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Split up the list of positions to the given currencies.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>currencies</code></td>
<td><code></code></td>
<td>
<p>A list of currency strings, the currencies to isolate.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A dict of currency to Inventory instances.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def segregate_units(self, currencies):
    """Split up the list of positions to the given currencies.

    Args:
      currencies: A list of currency strings, the currencies to isolate.
    Returns:
      A dict of currency to Inventory instances.
    """
    per_currency_dict = {currency: Inventory()
                         for currency in currencies}
    per_currency_dict[None] = Inventory()
    for position in self:
        currency = position.units.currency
        key = (currency if currency in currencies else None)
        per_currency_dict[key].add_position(position)
    return per_currency_dict
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.inventory.Inventory.to_string">
<code class="highlight language-python">
beancount.core.inventory.Inventory.to_string
(self, dformat=&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;, parens=True)

        </code>
<a class="headerlink" href="#beancount.core.inventory.Inventory.to_string" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Convert an Inventory instance to a printable string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dformat</code></td>
<td><code></code></td>
<td>
<p>An instance of DisplayFormatter.</p>
</td>
<td><code>&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;</code></td>
</tr>
<tr>
<td><code>parents</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should surround the results by parentheses.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A formatted string of the quantized amount and symbol.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def to_string(self, dformat=DEFAULT_FORMATTER, parens=True):
    """Convert an Inventory instance to a printable string.

    Args:
      dformat: An instance of DisplayFormatter.
      parents: A boolean, true if we should surround the results by parentheses.
    Returns:
      A formatted string of the quantized amount and symbol.
    """
    fmt = '({})' if parens else '{}'
    return fmt.format(
        ', '.join(pos.to_string(dformat) for pos in sorted(self)))
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.inventory.check_invariants">
<code class="highlight language-python">
beancount.core.inventory.check_invariants
(inv)

        </code>
<a class="headerlink" href="#beancount.core.inventory.check_invariants" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Check the invariants of the Inventory.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>inventory</code></td>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>True if the invariants are respected.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def check_invariants(inv):
    """Check the invariants of the Inventory.

    Args:
      inventory: An instance of Inventory.
    Returns:
      True if the invariants are respected.
    """
    # Check that all the keys are unique.
    lots = set((pos.units.currency, pos.cost) for pos in inv)
    assert len(lots) == len(inv), "Invalid inventory: {}".format(inv)
    # Check that none of the amounts is zero.
    for pos in inv:
        assert pos.units.number != ZERO, "Invalid position size: {}".format(pos)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.inventory.from_string">
<code class="highlight language-python">
beancount.core.inventory.from_string
(string)

        </code>
<a class="headerlink" href="#beancount.core.inventory.from_string" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create an Inventory from a string. This is useful for writing tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A comma-separated string of &lt;number&gt; &lt;currency&gt; with an
optional {&lt;number&gt; &lt;currency&gt;} for the cost.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Inventory with the given balances.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/inventory.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create an Inventory from a string. This is useful for writing tests.

    Args:
      string: A comma-separated string of &lt;number&gt; &lt;currency&gt; with an
        optional {&lt;number&gt; &lt;currency&gt;} for the cost.
    Returns:
      A new instance of Inventory with the given balances.
    """
    new_inventory = Inventory()
    # We need to split the comma-separated positions but ignore commas
    # occurring within a {...cost...} specification.
    position_strs = re.split(
        r'([-+]?[0-9,.]+\s+[A-Z]+\s*(?:{[^}]*})?)\s*,?\s*', string)[1::2]
    for position_str in position_strs:
        new_inventory.add_position(position_from_string(position_str))
    return new_inventory
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.number">
<code>beancount.core.number</code>
<a class="headerlink" href="#beancount.core.number" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>The module contains the basic Decimal type import.</p>
<p>About Decimal usage:</p>
<ul>
<li>
<p>Do not import Decimal from the 'decimal' or 'cdecimal' modules; always import
  your Decimal class from beancount.core.amount.</p>
</li>
<li>
<p>Prefer to use D() to create new instances of Decimal objects, which
  handles more syntax, e.g., handles None, and numbers with commas.</p>
</li>
</ul>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.number.D">
<code class="highlight language-python">
beancount.core.number.D
(strord=None)

        </code>
<a class="headerlink" href="#beancount.core.number.D" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a string into a Decimal object.</p>
<p>This is used in parsing amounts from files in the importers. This is the
main function you should use to build all numbers the system manipulates
(never use floating-point in an accounting system). Commas are stripped and
ignored, as they are assumed to be thousands separators (the French comma
separator as decimal is not supported). This function just returns the
argument if it is already a Decimal object, for convenience.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>strord</code></td>
<td><code></code></td>
<td>
<p>A string or Decimal instance.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Decimal instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/number.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def D(strord=None):
    """Convert a string into a Decimal object.

    This is used in parsing amounts from files in the importers. This is the
    main function you should use to build all numbers the system manipulates
    (never use floating-point in an accounting system). Commas are stripped and
    ignored, as they are assumed to be thousands separators (the French comma
    separator as decimal is not supported). This function just returns the
    argument if it is already a Decimal object, for convenience.

    Args:
      strord: A string or Decimal instance.
    Returns:
      A Decimal instance.
    """
    try:
        # Note: try a map lookup and optimize performance here.
        if strord is None or strord == '':
            return Decimal()
        elif isinstance(strord, str):
            return Decimal(_CLEAN_NUMBER_RE.sub('', strord))
        elif isinstance(strord, Decimal):
            return strord
        elif isinstance(strord, (int, float)):
            return Decimal(strord)
        else:
            assert strord is None, "Invalid value to convert: {}".format(strord)
    except Exception as exc:
        raise ValueError("Impossible to create Decimal instance from {!s}: {}".format(
                         strord, exc))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.number.is_fast_decimal">
<code class="highlight language-python">
beancount.core.number.is_fast_decimal
(decimal_module)

        </code>
<a class="headerlink" href="#beancount.core.number.is_fast_decimal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if a fast C decimal implementation is installed.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/number.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_fast_decimal(decimal_module):
    "Return true if a fast C decimal implementation is installed."
    return isinstance(decimal_module.Decimal().sqrt, types.BuiltinFunctionType)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.number.round_to">
<code class="highlight language-python">
beancount.core.number.round_to
(number, increment)

        </code>
<a class="headerlink" href="#beancount.core.number.round_to" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Round a number <em>down</em> to a particular increment.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number</code></td>
<td><code></code></td>
<td>
<p>A Decimal, the number to be rounded.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>increment</code></td>
<td><code></code></td>
<td>
<p>A Decimal, the size of the increment.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Decimal, the rounded number.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/number.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def round_to(number, increment):
    """Round a number *down* to a particular increment.

    Args:
      number: A Decimal, the number to be rounded.
      increment: A Decimal, the size of the increment.
    Returns:
      A Decimal, the rounded number.
    """
    return int((number / increment)) * increment
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.number.same_sign">
<code class="highlight language-python">
beancount.core.number.same_sign
(number1, number2)

        </code>
<a class="headerlink" href="#beancount.core.number.same_sign" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if both numbers have the same sign.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number1</code></td>
<td><code></code></td>
<td>
<p>An instance of Decimal.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>number2</code></td>
<td><code></code></td>
<td>
<p>An instance of Decimal.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/number.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def same_sign(number1, number2):
    """Return true if both numbers have the same sign.

    Args:
      number1: An instance of Decimal.
      number2: An instance of Decimal.
    Returns:
      A boolean.
    """
    return (number1 &gt;= 0) == (number2 &gt;= 0)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.position">
<code>beancount.core.position</code>
<a class="headerlink" href="#beancount.core.position" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>A position object, which consists of units Amount and cost Cost.</p>
<p>See types below for details.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.position.Cost">
<code>beancount.core.position.Cost</code>
<a class="headerlink" href="#beancount.core.position.Cost" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Cost(number, currency, date, label)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Cost.__getnewargs__">
<code class="highlight language-python">
beancount.core.position.Cost.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Cost.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Cost.__new__">
<code class="highlight language-python">
beancount.core.position.Cost.__new__
(_cls, number, currency, date, label)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Cost.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Cost(number, currency, date, label)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Cost.__repr__">
<code class="highlight language-python">
beancount.core.position.Cost.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Cost.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.position.CostSpec">
<code>beancount.core.position.CostSpec</code>
<a class="headerlink" href="#beancount.core.position.CostSpec" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>CostSpec(number_per, number_total, currency, date, label, merge)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.CostSpec.__getnewargs__">
<code class="highlight language-python">
beancount.core.position.CostSpec.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.CostSpec.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.CostSpec.__new__">
<code class="highlight language-python">
beancount.core.position.CostSpec.__new__
(_cls, number_per, number_total, currency, date, label, merge)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.CostSpec.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of CostSpec(number_per, number_total, currency, date, label, merge)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.CostSpec.__repr__">
<code class="highlight language-python">
beancount.core.position.CostSpec.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.CostSpec.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.position.Position">
<code>beancount.core.position.Position</code>
<a class="headerlink" href="#beancount.core.position.Position" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A 'Position' is a pair of units and optional cost.
    This is used to track inventories.</p>
<pre><code>Attributes:
  units: An Amount, the number of units and its currency.
  cost: A Cost that represents the lot, or None.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__abs__">
<code class="highlight language-python">
beancount.core.position.Position.__abs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__abs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the absolute value of the position.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Position with the absolute units.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __abs__(self):
    """Return the absolute value of the position.

    Returns:
      An instance of Position with the absolute units.
    """
    return Position(amount_abs(self.units), self.cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__copy__">
<code class="highlight language-python">
beancount.core.position.Position.__copy__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__copy__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Shallow copy, except for the lot, which can be shared. This is important for
performance reasons; a lot of time is spent here during balancing.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A shallow copy of this position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __copy__(self):
    """Shallow copy, except for the lot, which can be shared. This is important for
    performance reasons; a lot of time is spent here during balancing.

    Returns:
      A shallow copy of this position.
    """
    # Note: We use Decimal() for efficiency.
    return Position(copy.copy(self.units), copy.copy(self.cost))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__eq__">
<code class="highlight language-python">
beancount.core.position.Position.__eq__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__eq__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Equality comparison with another Position. The objects are considered equal
if both number and lot are matching, and if the number of units is zero
and the other position is None, that is also okay.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>An instance of Position, or None.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the positions are equal.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __eq__(self, other):
    """Equality comparison with another Position. The objects are considered equal
    if both number and lot are matching, and if the number of units is zero
    and the other position is None, that is also okay.

    Args:
      other: An instance of Position, or None.
    Returns:
      A boolean, true if the positions are equal.
    """
    return (self.units.number == ZERO
            if other is None
            else (self.units == other.units and self.cost == other.cost))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__hash__">
<code class="highlight language-python">
beancount.core.position.Position.__hash__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__hash__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Compute a hash for this position.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A hash of this position object.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __hash__(self):
    """Compute a hash for this position.

    Returns:
      A hash of this position object.
    """
    return hash((self.units, self.cost))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__lt__">
<code class="highlight language-python">
beancount.core.position.Position.__lt__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__lt__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>A less-than comparison operator for positions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>Another instance of Position.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>True if this positions is smaller than the other position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __lt__(self, other):
    """A less-than comparison operator for positions.

    Args:
      other: Another instance of Position.
    Returns:
      True if this positions is smaller than the other position.
    """
    return self.sortkey() &lt; other.sortkey()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__mul__">
<code class="highlight language-python">
beancount.core.position.Position.__mul__
(self, scalar)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__mul__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Scale/multiply the contents of the position.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>scalar</code></td>
<td><code></code></td>
<td>
<p>A Decimal.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __mul__(self, scalar):
    """Scale/multiply the contents of the position.

    Args:
      scalar: A Decimal.
    Returns:
      An instance of Inventory.
    """
    return Position(amount_mul(self.units, scalar), self.cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__neg__">
<code class="highlight language-python">
beancount.core.position.Position.__neg__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__neg__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Get a copy of this position but with a negative number.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Position which represents the inverse of this Position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_negative(self):
    """Get a copy of this position but with a negative number.

    Returns:
      An instance of Position which represents the inverse of this Position.
    """
    # Note: We use Decimal() for efficiency.
    return Position(-self.units, self.cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__new__">
<code class="highlight language-python">
beancount.core.position.Position.__new__
(cls, units, cost=None)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of _Position(units, cost)</p>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __new__(cls, units, cost=None):
    assert isinstance(units, Amount), (
        "Expected an Amount for units; received '{}'".format(units))
    assert cost is None or isinstance(cost, Position.cost_types), (
        "Expected a Cost for cost; received '{}'".format(cost))
    return _Position.__new__(cls, units, cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__repr__">
<code class="highlight language-python">
beancount.core.position.Position.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a string representation of the position.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, a printable representation of the position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    """Return a string representation of the position.

    Returns:
      A string, a printable representation of the position.
    """
    return self.to_string()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.__str__">
<code class="highlight language-python">
beancount.core.position.Position.__str__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.__str__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a string representation of the position.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, a printable representation of the position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    """Return a string representation of the position.

    Returns:
      A string, a printable representation of the position.
    """
    return self.to_string()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.currency_pair">
<code class="highlight language-python">
beancount.core.position.Position.currency_pair
(self)

        </code>
<a class="headerlink" href="#beancount.core.position.Position.currency_pair" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the currency pair associated with this position.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of a currency string and a cost currency string or None.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def currency_pair(self):
    """Return the currency pair associated with this position.

    Returns:
      A pair of a currency string and a cost currency string or None.
    """
    return (self.units.currency, self.cost.currency if self.cost else None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.from_amounts">
<code class="highlight language-python">
beancount.core.position.Position.from_amounts
(units, cost_amount=None)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.from_amounts" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a position from an amount and a cost.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An amount, that represents the number of units and the lot currency.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cost_amount</code></td>
<td><code></code></td>
<td>
<p>If not None, represents the cost amount.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Position instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_amounts(units, cost_amount=None):
    """Create a position from an amount and a cost.

    Args:
      amount: An amount, that represents the number of units and the lot currency.
      cost_amount: If not None, represents the cost amount.
    Returns:
      A Position instance.
    """
    assert cost_amount is None or isinstance(cost_amount, Amount), (
        "Invalid type for cost: {}".format(cost_amount))
    cost = (Cost(cost_amount.number, cost_amount.currency, None, None)
            if cost_amount else
            None)
    return Position(units, cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.from_string">
<code class="highlight language-python">
beancount.core.position.Position.from_string
(string)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.core.position.Position.from_string" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a position from a string specification.</p>
<p>This is a miniature parser used for building tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;
&lt;currency&gt;} for the cost, similar to the parser syntax.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create a position from a string specification.

    This is a miniature parser used for building tests.

    Args:
      string: A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;
        &lt;currency&gt;} for the cost, similar to the parser syntax.
    Returns:
      A new instance of Position.
    """
    match = re.match(
        (r'\s*({})\s+({})'
         r'(?:\s+{{([^}}]*)}})?'
         r'\s*$').format(NUMBER_RE, CURRENCY_RE),
        string)
    if not match:
        raise ValueError("Invalid string for position: '{}'".format(string))

    number = D(match.group(1))
    currency = match.group(2)

    # Parse a cost expression.
    cost_number = None
    cost_currency = None
    date = None
    label = None
    cost_expression = match.group(3)
    if match.group(3):
        expressions = [expr.strip() for expr in re.split('[,/]', cost_expression)]
        for expr in expressions:

            # Match a compound number.
            match = re.match(
                r'({NUMBER_RE})\s*(?:#\s*({NUMBER_RE}))?\s+({CURRENCY_RE})$'
                .format(NUMBER_RE=NUMBER_RE, CURRENCY_RE=CURRENCY_RE),
                expr
            )
            if match:
                per_number, total_number, cost_currency = match.group(1, 2, 3)
                per_number = D(per_number) if per_number else ZERO
                total_number = D(total_number) if total_number else ZERO
                if total_number:
                    # Calculate the per-unit cost.
                    total = number * per_number + total_number
                    per_number = total / number
                cost_number = per_number
                continue

            # Match a date.
            match = re.match(r'(\d\d\d\d)[-/](\d\d)[-/](\d\d)$', expr)
            if match:
                date = datetime.date(*map(int, match.group(1, 2, 3)))
                continue

            # Match a label.
            match = re.match(r'"([^"]+)*"$', expr)
            if match:
                label = match.group(1)
                continue

            # Match a merge-cost marker.
            match = re.match(r'\*$', expr)
            if match:
                raise ValueError("Merge-code not supported in string constructor.")

            raise ValueError("Invalid cost component: '{}'".format(expr))
        cost = Cost(cost_number, cost_currency, date, label)
    else:
        cost = None

    return Position(Amount(number, currency), cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.get_negative">
<code class="highlight language-python">
beancount.core.position.Position.get_negative
(self)

        </code>
<a class="headerlink" href="#beancount.core.position.Position.get_negative" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Get a copy of this position but with a negative number.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Position which represents the inverse of this Position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_negative(self):
    """Get a copy of this position but with a negative number.

    Returns:
      An instance of Position which represents the inverse of this Position.
    """
    # Note: We use Decimal() for efficiency.
    return Position(-self.units, self.cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.is_negative_at_cost">
<code class="highlight language-python">
beancount.core.position.Position.is_negative_at_cost
(self)

        </code>
<a class="headerlink" href="#beancount.core.position.Position.is_negative_at_cost" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return true if the position is held at cost and negative.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_negative_at_cost(self):
    """Return true if the position is held at cost and negative.

    Returns:
      A boolean.
    """
    return (self.units.number &lt; ZERO and self.cost is not None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.sortkey">
<code class="highlight language-python">
beancount.core.position.Position.sortkey
(self)

        </code>
<a class="headerlink" href="#beancount.core.position.Position.sortkey" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a key to sort positions by. This key depends on the order of the
currency of the lot (we want to order common currencies first) and the
number of units.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple, used to sort lists of positions.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def sortkey(self):
    """Return a key to sort positions by. This key depends on the order of the
    currency of the lot (we want to order common currencies first) and the
    number of units.

    Returns:
      A tuple, used to sort lists of positions.
    """
    currency = self.units.currency
    order_units = CURRENCY_ORDER.get(currency, NCURRENCIES + len(currency))
    if self.cost is not None:
        cost_number = self.cost.number
        cost_currency = self.cost.currency
    else:
        cost_number = ZERO
        cost_currency = ''

    return (order_units, cost_number, cost_currency, self.units.number)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.position.Position.to_string">
<code class="highlight language-python">
beancount.core.position.Position.to_string
(self, dformat=&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;, detail=True)

        </code>
<a class="headerlink" href="#beancount.core.position.Position.to_string" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Render the position to a string.See to_string() for details.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def to_string(self, dformat=DEFAULT_FORMATTER, detail=True):
    """Render the position to a string.See to_string() for details.
    """
    return to_string(self, dformat, detail)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.position.cost_to_str">
<code class="highlight language-python">
beancount.core.position.cost_to_str
(cost, dformat, detail=True)

        </code>
<a class="headerlink" href="#beancount.core.position.cost_to_str" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Format an instance of Cost or a CostSpec to a string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cost</code></td>
<td><code></code></td>
<td>
<p>An instance of Cost or CostSpec.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>dformat</code></td>
<td><code></code></td>
<td>
<p>A DisplayFormatter object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>detail</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should render the non-amount components.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, suitable for formatting.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def cost_to_str(cost, dformat, detail=True):
    """Format an instance of Cost or a CostSpec to a string.

    Args:
      cost: An instance of Cost or CostSpec.
      dformat: A DisplayFormatter object.
      detail: A boolean, true if we should render the non-amount components.
    Returns:
      A string, suitable for formatting.
    """
    strlist = []

    if isinstance(cost, Cost):
        if isinstance(cost.number, Decimal):
            strlist.append(Amount(cost.number, cost.currency).to_string(dformat))
        if detail:
            if cost.date:
                strlist.append(cost.date.isoformat())
            if cost.label:
                strlist.append('"{}"'.format(cost.label))

    elif isinstance(cost, CostSpec):
        if isinstance(cost.number_per, Decimal) or isinstance(cost.number_total, Decimal):
            amountlist = []
            if isinstance(cost.number_per, Decimal):
                amountlist.append(dformat.format(cost.number_per))
            if isinstance(cost.number_total, Decimal):
                amountlist.append('#')
                amountlist.append(dformat.format(cost.number_total))
            if isinstance(cost.currency, str):
                amountlist.append(cost.currency)
            strlist.append(' '.join(amountlist))
        if detail:
            if cost.date:
                strlist.append(cost.date.isoformat())
            if cost.label:
                strlist.append('"{}"'.format(cost.label))
            if cost.merge:
                strlist.append('*')

    return ', '.join(strlist)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.position.from_amounts">
<code class="highlight language-python">
beancount.core.position.from_amounts
(units, cost_amount=None)

        </code>
<a class="headerlink" href="#beancount.core.position.from_amounts" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a position from an amount and a cost.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>amount</code></td>
<td><code></code></td>
<td>
<p>An amount, that represents the number of units and the lot currency.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cost_amount</code></td>
<td><code></code></td>
<td>
<p>If not None, represents the cost amount.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A Position instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_amounts(units, cost_amount=None):
    """Create a position from an amount and a cost.

    Args:
      amount: An amount, that represents the number of units and the lot currency.
      cost_amount: If not None, represents the cost amount.
    Returns:
      A Position instance.
    """
    assert cost_amount is None or isinstance(cost_amount, Amount), (
        "Invalid type for cost: {}".format(cost_amount))
    cost = (Cost(cost_amount.number, cost_amount.currency, None, None)
            if cost_amount else
            None)
    return Position(units, cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.position.from_string">
<code class="highlight language-python">
beancount.core.position.from_string
(string)

        </code>
<a class="headerlink" href="#beancount.core.position.from_string" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create a position from a string specification.</p>
<p>This is a miniature parser used for building tests.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;
&lt;currency&gt;} for the cost, similar to the parser syntax.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A new instance of Position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@staticmethod
def from_string(string):
    """Create a position from a string specification.

    This is a miniature parser used for building tests.

    Args:
      string: A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;
        &lt;currency&gt;} for the cost, similar to the parser syntax.
    Returns:
      A new instance of Position.
    """
    match = re.match(
        (r'\s*({})\s+({})'
         r'(?:\s+{{([^}}]*)}})?'
         r'\s*$').format(NUMBER_RE, CURRENCY_RE),
        string)
    if not match:
        raise ValueError("Invalid string for position: '{}'".format(string))

    number = D(match.group(1))
    currency = match.group(2)

    # Parse a cost expression.
    cost_number = None
    cost_currency = None
    date = None
    label = None
    cost_expression = match.group(3)
    if match.group(3):
        expressions = [expr.strip() for expr in re.split('[,/]', cost_expression)]
        for expr in expressions:

            # Match a compound number.
            match = re.match(
                r'({NUMBER_RE})\s*(?:#\s*({NUMBER_RE}))?\s+({CURRENCY_RE})$'
                .format(NUMBER_RE=NUMBER_RE, CURRENCY_RE=CURRENCY_RE),
                expr
            )
            if match:
                per_number, total_number, cost_currency = match.group(1, 2, 3)
                per_number = D(per_number) if per_number else ZERO
                total_number = D(total_number) if total_number else ZERO
                if total_number:
                    # Calculate the per-unit cost.
                    total = number * per_number + total_number
                    per_number = total / number
                cost_number = per_number
                continue

            # Match a date.
            match = re.match(r'(\d\d\d\d)[-/](\d\d)[-/](\d\d)$', expr)
            if match:
                date = datetime.date(*map(int, match.group(1, 2, 3)))
                continue

            # Match a label.
            match = re.match(r'"([^"]+)*"$', expr)
            if match:
                label = match.group(1)
                continue

            # Match a merge-cost marker.
            match = re.match(r'\*$', expr)
            if match:
                raise ValueError("Merge-code not supported in string constructor.")

            raise ValueError("Invalid cost component: '{}'".format(expr))
        cost = Cost(cost_number, cost_currency, date, label)
    else:
        cost = None

    return Position(Amount(number, currency), cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.position.get_position">
<code class="highlight language-python">
beancount.core.position.get_position
(posting)

        </code>
<a class="headerlink" href="#beancount.core.position.get_position" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Build a Position instance from a Posting instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>posting</code></td>
<td><code></code></td>
<td>
<p>An instance of Posting.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_position(posting):
    """Build a Position instance from a Posting instance.

    Args:
      posting: An instance of Posting.
    Returns:
      An instance of Position.
    """
    return Position(posting.units, posting.cost)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.position.to_string">
<code class="highlight language-python">
beancount.core.position.to_string
(pos, dformat=&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;, detail=True)

        </code>
<a class="headerlink" href="#beancount.core.position.to_string" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Render the Position or Posting instance to a string.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pos</code></td>
<td><code></code></td>
<td>
<p>An instance of Position or Posting.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>dformat</code></td>
<td><code></code></td>
<td>
<p>An instance of DisplayFormatter.</p>
</td>
<td><code>&lt;beancount.core.display_context.DisplayFormatter object at 0x7fa29e4da310&gt;</code></td>
</tr>
<tr>
<td><code>detail</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should only render the lot details
beyond the cost (lot-date, label, etc.). If false, we only render
the cost, if present.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered position.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/position.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def to_string(pos, dformat=DEFAULT_FORMATTER, detail=True):
    """Render the Position or Posting instance to a string.

    Args:
      pos: An instance of Position or Posting.
      dformat: An instance of DisplayFormatter.
      detail: A boolean, true if we should only render the lot details
       beyond the cost (lot-date, label, etc.). If false, we only render
       the cost, if present.
    Returns:
      A string, the rendered position.
    """
    pos_str = pos.units.to_string(dformat)
    if pos.cost is not None:
        pos_str = '{} {{{}}}'.format(pos_str, cost_to_str(pos.cost, dformat, detail))
    return pos_str
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.prices">
<code>beancount.core.prices</code>
<a class="headerlink" href="#beancount.core.prices" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>This module has code that can build a database of historical prices at
various times, from which unrealized capital gains and market value can be
deduced.</p>
<p>Prices are deduced from Price entries found in the file, or perhaps
created by scripts (for example you could build a script that will fetch
live prices online and create entries on-the-fly).</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.prices.PriceMap">
<code>beancount.core.prices.PriceMap</code>
<a class="headerlink" href="#beancount.core.prices.PriceMap" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A price map dictionary.</p>
<pre><code>The keys include both the set of forward (base, quote) pairs and their
inverse. In order to determine which are the forward pairs, access the
'forward_pairs' attribute

Attributes:
  forward_pairs: A list of (base, quote) keys for the forward pairs.
</code></pre>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.prices.build_price_map">
<code class="highlight language-python">
beancount.core.prices.build_price_map
(entries)

        </code>
<a class="headerlink" href="#beancount.core.prices.build_price_map" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Build a price map from a list of arbitrary entries.</p>
<p>If multiple prices are found for the same (currency, cost-currency) pair at
the same date, the latest date is kept and the earlier ones (for that day)
are discarded.</p>
<p>If inverse price pairs are found, e.g. USD in AUD and AUD in USD, the
inverse that has the smallest number of price points is converted into the
one that has the most price points. In that way they are reconciled into a
single one.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives, hopefully including some Price and/or</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A dict of (currency, cost-currency) keys to sorted lists of (date, number)
pairs, where 'date' is the date the price occurs at and 'number' a Decimal
that represents the price, or rate, between these two
currencies/commodities. Each date occurs only once in the sorted list of
prices of a particular key. All of the inverses are automatically
generated in the price map.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/prices.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def build_price_map(entries):
    """Build a price map from a list of arbitrary entries.

    If multiple prices are found for the same (currency, cost-currency) pair at
    the same date, the latest date is kept and the earlier ones (for that day)
    are discarded.

    If inverse price pairs are found, e.g. USD in AUD and AUD in USD, the
    inverse that has the smallest number of price points is converted into the
    one that has the most price points. In that way they are reconciled into a
    single one.

    Args:
      entries: A list of directives, hopefully including some Price and/or
      Transaction entries.
    Returns:
      A dict of (currency, cost-currency) keys to sorted lists of (date, number)
      pairs, where 'date' is the date the price occurs at and 'number' a Decimal
      that represents the price, or rate, between these two
      currencies/commodities. Each date occurs only once in the sorted list of
      prices of a particular key. All of the inverses are automatically
      generated in the price map.
    """
    # Fetch a list of all the price entries seen in the ledger.
    price_entries = [entry
                     for entry in entries
                     if isinstance(entry, Price)]

    # Build a map of exchange rates between these units.
    # (base-currency, quote-currency) -&gt; List of (date, rate).
    price_map = collections.defaultdict(list)
    for price in price_entries:
        base_quote = (price.currency, price.amount.currency)
        price_map[base_quote].append((price.date, price.amount.number))

    # Find pairs of inversed units.
    inversed_units = []
    for base_quote, values in price_map.items():
        base, quote = base_quote
        if (quote, base) in price_map:
            inversed_units.append(base_quote)

    # Find pairs of inversed units, and swallow the conversion with the smaller
    # number of rates into the other one.
    for base, quote in inversed_units:
        bq_prices = price_map[(base, quote)]
        qb_prices = price_map[(quote, base)]
        remove = ((base, quote)
                  if len(bq_prices) &lt; len(qb_prices)
                  else (quote, base))
        base, quote = remove

        remove_list = price_map[remove]
        insert_list = price_map[(quote, base)]
        del price_map[remove]

        inverted_list = [(date, ONE/rate)
                         for (date, rate) in remove_list
                         if rate != ZERO]
        insert_list.extend(inverted_list)

    # Unzip and sort each of the entries and eliminate duplicates on the date.
    sorted_price_map = PriceMap({
        base_quote: list(misc_utils.sorted_uniquify(date_rates, lambda x: x[0], last=True))
        for (base_quote, date_rates) in price_map.items()})

    # Compute and insert all the inverted rates.
    forward_pairs = list(sorted_price_map.keys())
    for (base, quote), price_list in list(sorted_price_map.items()):
        # Note: You have to filter out zero prices for zero-cost postings, like
        # gifted options.
        sorted_price_map[(quote, base)] = [
            (date, ONE/price) for date, price in price_list
            if price != ZERO]

    sorted_price_map.forward_pairs = forward_pairs
    return sorted_price_map
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.prices.get_all_prices">
<code class="highlight language-python">
beancount.core.prices.get_all_prices
(price_map, base_quote)

        </code>
<a class="headerlink" href="#beancount.core.prices.get_all_prices" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a sorted list of all (date, number) price pairs.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price map, which is a dict of (base, quote) -&gt; list of (date,
number) tuples, as created by build_price_map.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>base_quote</code></td>
<td><code></code></td>
<td>
<p>A pair of strings, the base currency to lookup, and the quote
currency to lookup, which expresses which units the base currency is
denominated in. This may also just be a string, with a '/' separator.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of (date, Decimal) pairs, sorted by date.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>KeyError</code></td>
<td>
<p>If the base/quote could not be found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/prices.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_all_prices(price_map, base_quote):
    """Return a sorted list of all (date, number) price pairs.

    Args:
      price_map: A price map, which is a dict of (base, quote) -&gt; list of (date,
        number) tuples, as created by build_price_map.
      base_quote: A pair of strings, the base currency to lookup, and the quote
        currency to lookup, which expresses which units the base currency is
        denominated in. This may also just be a string, with a '/' separator.
    Returns:
      A list of (date, Decimal) pairs, sorted by date.
    Raises:
      KeyError: If the base/quote could not be found.
    """
    base_quote = normalize_base_quote(base_quote)
    return _lookup_price_and_inverse(price_map, base_quote)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.prices.get_last_price_entries">
<code class="highlight language-python">
beancount.core.prices.get_last_price_entries
(entries, date)

        </code>
<a class="headerlink" href="#beancount.core.prices.get_last_price_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Run through the entries until the given date and return the last
Price entry encountered for each (currency, cost-currency) pair.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>An instance of datetime.date. If None, the very latest price
is returned.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of price entries.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/prices.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_last_price_entries(entries, date):
    """Run through the entries until the given date and return the last
    Price entry encountered for each (currency, cost-currency) pair.

    Args:
      entries: A list of directives.
      date: An instance of datetime.date. If None, the very latest price
        is returned.
    Returns:
      A list of price entries.
    """
    price_entry_map = {}
    for entry in entries:
        if date is not None and entry.date &gt;= date:
            break
        if isinstance(entry, Price):
            base_quote = (entry.currency, entry.amount.currency)
            price_entry_map[base_quote] = entry
    return sorted(price_entry_map.values(), key=data.entry_sortkey)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.prices.get_latest_price">
<code class="highlight language-python">
beancount.core.prices.get_latest_price
(price_map, base_quote)

        </code>
<a class="headerlink" href="#beancount.core.prices.get_latest_price" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the latest price/rate from a price map for the given base/quote pair.
This is often used to just get the 'current' price if you're looking at the
entire set of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price map, which is a dict of (base, quote) -&gt; list of (date,
number) tuples, as created by build_price_map.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of (date, number), where 'date' is a datetime.date instance and
'number' is a Decimal of the price, or rate, at that date. The date is the
latest date which we have an available price for in the price map.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/prices.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_latest_price(price_map, base_quote):
    """Return the latest price/rate from a price map for the given base/quote pair.
    This is often used to just get the 'current' price if you're looking at the
    entire set of entries.

    Args:
      price_map: A price map, which is a dict of (base, quote) -&gt; list of (date,
        number) tuples, as created by build_price_map.
    Returns:
      A pair of (date, number), where 'date' is a datetime.date instance and
      'number' is a Decimal of the price, or rate, at that date. The date is the
      latest date which we have an available price for in the price map.
    """
    base_quote = normalize_base_quote(base_quote)

    # Handle the degenerate case of a currency priced into its own.
    base, quote = base_quote
    if quote is None or base == quote:
        return (None, ONE)

    # Look up the list and return the latest element. The lists are assumed to
    # be sorted.
    try:
        price_list = _lookup_price_and_inverse(price_map, base_quote)
    except KeyError:
        price_list = None
    if price_list:
        return price_list[-1]
    else:
        return None, None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.prices.get_price">
<code class="highlight language-python">
beancount.core.prices.get_price
(price_map, base_quote, date=None)

        </code>
<a class="headerlink" href="#beancount.core.prices.get_price" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the price as of the given date.</p>
<p>If the date is unspecified, return the latest price.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>price_map</code></td>
<td><code></code></td>
<td>
<p>A price map, which is a dict of (base, quote) -&gt; list of (date,
number) tuples, as created by build_price_map.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>base_quote</code></td>
<td><code></code></td>
<td>
<p>A pair of strings, the base currency to lookup, and the quote
currency to lookup, which expresses which units the base currency is
denominated in. This may also just be a string, with a '/' separator.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>date</code></td>
<td><code></code></td>
<td>
<p>A datetime.date instance, the date at which we want the conversion
rate.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of (datetime.date, Decimal) instance. If no price information could
be found, return (None, None).</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/prices.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_price(price_map, base_quote, date=None):
    """Return the price as of the given date.

    If the date is unspecified, return the latest price.

    Args:
      price_map: A price map, which is a dict of (base, quote) -&gt; list of (date,
        number) tuples, as created by build_price_map.
      base_quote: A pair of strings, the base currency to lookup, and the quote
        currency to lookup, which expresses which units the base currency is
        denominated in. This may also just be a string, with a '/' separator.
      date: A datetime.date instance, the date at which we want the conversion
        rate.
    Returns:
      A pair of (datetime.date, Decimal) instance. If no price information could
      be found, return (None, None).
    """
    if date is None:
        return get_latest_price(price_map, base_quote)

    base_quote = normalize_base_quote(base_quote)

    # Handle the degenerate case of a currency priced into its own.
    base, quote = base_quote
    if quote is None or base == quote:
        return (None, ONE)

    try:
        price_list = _lookup_price_and_inverse(price_map, base_quote)
        index = bisect_key.bisect_right_with_key(price_list, date, key=lambda x: x[0])
        if index == 0:
            return None, None
        else:
            return price_list[index-1]
    except KeyError:
        return None, None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.prices.normalize_base_quote">
<code class="highlight language-python">
beancount.core.prices.normalize_base_quote
(base_quote)

        </code>
<a class="headerlink" href="#beancount.core.prices.normalize_base_quote" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a slash-separated string to a pair of strings.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>base_quote</code></td>
<td><code></code></td>
<td>
<p>A pair of strings, the base currency to lookup, and the quote
currency to lookup, which expresses which units the base currency is
denominated in. This may also just be a string, with a '/' separator.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/prices.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def normalize_base_quote(base_quote):
    """Convert a slash-separated string to a pair of strings.

    Args:
      base_quote: A pair of strings, the base currency to lookup, and the quote
        currency to lookup, which expresses which units the base currency is
        denominated in. This may also just be a string, with a '/' separator.
    Returns:
      A pair of strings.
    """
    if isinstance(base_quote, str):
        base_quote_norm = tuple(base_quote.split('/'))
        assert len(base_quote_norm) == 2, base_quote
        base_quote = base_quote_norm
    assert isinstance(base_quote, tuple), base_quote
    return base_quote
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.core.realization">
<code>beancount.core.realization</code>
<a class="headerlink" href="#beancount.core.realization" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Realization of specific lists of account postings into reports.</p>
<p>This code converts a list of entries into a tree of RealAccount nodes (which
stands for "realized accounts"). The RealAccount objects contain lists of
Posting instances instead of Transactions, or other entry types that are
attached to an account, such as a Balance or Note entry.</p>
<p>The interface of RealAccount corresponds to that of a regular Python dict, where
the keys are the names of the individual components of an account's name, and
the values are always other RealAccount instances. If you want to get an account
by long account name, there are helper functions in this module for this purpose
(see realization.get(), for instance). RealAccount instances also contain the
final balance of that account, resulting from its list of postings.</p>
<p>You should not build RealAccount trees yourself; instead, you should filter the
list of desired directives to display and call the realize() function with them.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.core.realization.RealAccount">
<code>beancount.core.realization.RealAccount</code>
<a class="headerlink" href="#beancount.core.realization.RealAccount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A realized account, inserted in a tree, that contains the list of realized entries.</p>
<pre><code>Attributes:
  account: A string, the full name of the corresponding account.
  postings: A list of postings associated with this accounting (does not
    include the postings of children accounts).
  balance: The final balance of the list of postings associated with this account.
</code></pre>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.realization.RealAccount.__eq__">
<code class="highlight language-python">
beancount.core.realization.RealAccount.__eq__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.realization.RealAccount.__eq__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Equality predicate. All attributes are compared.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>Another instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, True if the two real accounts are equal.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __eq__(self, other):
    """Equality predicate. All attributes are compared.

    Args:
      other: Another instance of RealAccount.
    Returns:
      A boolean, True if the two real accounts are equal.
    """
    return (dict.__eq__(self, other) and
            self.account == other.account and
            self.balance == other.balance and
            self.txn_postings == other.txn_postings)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.realization.RealAccount.__init__">
<code class="highlight language-python">
beancount.core.realization.RealAccount.__init__
    (self, account_name, *
args, **
kwargs)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.realization.RealAccount.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a RealAccount instance.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>a string, the name of the account. Maybe not be None.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, account_name, *args, **kwargs):
    """Create a RealAccount instance.

    Args:
      account_name: a string, the name of the account. Maybe not be None.
    """
    super().__init__(*args, **kwargs)
    assert isinstance(account_name, str)
    self.account = account_name
    self.txn_postings = []
    self.balance = inventory.Inventory()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.realization.RealAccount.__ne__">
<code class="highlight language-python">
beancount.core.realization.RealAccount.__ne__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.realization.RealAccount.__ne__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Not-equality predicate. See <strong>eq</strong>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>other</code></td>
<td><code></code></td>
<td>
<p>Another instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, True if the two real accounts are not equal.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __ne__(self, other):
    """Not-equality predicate. See __eq__.

    Args:
      other: Another instance of RealAccount.
    Returns:
      A boolean, True if the two real accounts are not equal.
    """
    return not self.__eq__(other)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.realization.RealAccount.__setitem__">
<code class="highlight language-python">
beancount.core.realization.RealAccount.__setitem__
(self, key, value)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.core.realization.RealAccount.__setitem__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Prevent the setting of non-string or non-empty keys on this dict.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>key</code></td>
<td><code></code></td>
<td>
<p>The dictionary key. Must be a string.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>value</code></td>
<td><code></code></td>
<td>
<p>The value, must be a RealAccount instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>KeyError</code></td>
<td>
<p>If the key is not a string, or is invalid.</p>
</td>
</tr>
<tr>
<td><code>ValueError</code></td>
<td>
<p>If the value is not a RealAccount instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __setitem__(self, key, value):
    """Prevent the setting of non-string or non-empty keys on this dict.

    Args:
      key: The dictionary key. Must be a string.
      value: The value, must be a RealAccount instance.
    Raises:
      KeyError: If the key is not a string, or is invalid.
      ValueError: If the value is not a RealAccount instance.
    """
    if not isinstance(key, str) or not key:
        raise KeyError("Invalid RealAccount key: '{}'".format(key))
    if not isinstance(value, RealAccount):
        raise ValueError("Invalid RealAccount value: '{}'".format(value))
    if not value.account.endswith(key):
        raise ValueError("RealAccount name '{}' inconsistent with key: '{}'".format(
            value.account, key))
    return super().__setitem__(key, value)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.core.realization.RealAccount.copy">
<code class="highlight language-python">
beancount.core.realization.RealAccount.copy
(self)

        </code>
<a class="headerlink" href="#beancount.core.realization.RealAccount.copy" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Override dict.copy() to clone a RealAccount.</p>
<p>This is only necessary to correctly implement the copy method.
Otherwise, calling .copy() on a RealAccount instance invokes the base
class' method, which return just a dict.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A cloned instance of RealAccount, with all members shallow-copied.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def copy(self):
    """Override dict.copy() to clone a RealAccount.

    This is only necessary to correctly implement the copy method.
    Otherwise, calling .copy() on a RealAccount instance invokes the base
    class' method, which return just a dict.

    Returns:
      A cloned instance of RealAccount, with all members shallow-copied.
    """
    return copy.copy(self)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.compute_balance">
<code class="highlight language-python">
beancount.core.realization.compute_balance
(real_account, leaf_only=False)

        </code>
<a class="headerlink" href="#beancount.core.realization.compute_balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the total balance of this account and all its subaccounts.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>A RealAccount instance.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>leaf_only</code></td>
<td><code></code></td>
<td>
<p>A boolean flag, true if we should yield only leaves.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compute_balance(real_account, leaf_only=False):
    """Compute the total balance of this account and all its subaccounts.

    Args:
      real_account: A RealAccount instance.
      leaf_only: A boolean flag, true if we should yield only leaves.
    Returns:
      An Inventory.
    """
    return functools.reduce(operator.add, [
        ra.balance for ra in iter_children(real_account, leaf_only)])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.compute_postings_balance">
<code class="highlight language-python">
beancount.core.realization.compute_postings_balance
(txn_postings)

        </code>
<a class="headerlink" href="#beancount.core.realization.compute_postings_balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the balance of a list of Postings's or TxnPosting's positions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>postings</code></td>
<td><code></code></td>
<td>
<p>A list of Posting instances and other directives (which are
skipped).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An Inventory.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compute_postings_balance(txn_postings):
    """Compute the balance of a list of Postings's or TxnPosting's positions.

    Args:
      postings: A list of Posting instances and other directives (which are
        skipped).
    Returns:
      An Inventory.
    """
    final_balance = inventory.Inventory()
    for txn_posting in txn_postings:
        if isinstance(txn_posting, Posting):
            final_balance.add_position(txn_posting)
        elif isinstance(txn_posting, TxnPosting):
            final_balance.add_position(txn_posting.posting)
    return final_balance
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.contains">
<code class="highlight language-python">
beancount.core.realization.contains
(real_account, account_name)

        </code>
<a class="headerlink" href="#beancount.core.realization.contains" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>True if the given account node contains the subaccount name.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of a direct or indirect subaccount of
this node.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true the name is a child of this node.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def contains(real_account, account_name):
    """True if the given account node contains the subaccount name.

    Args:
      account_name: A string, the name of a direct or indirect subaccount of
        this node.
    Returns:
      A boolean, true the name is a child of this node.
    """
    return get(real_account, account_name) is not None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.dump">
<code class="highlight language-python">
beancount.core.realization.dump
(root_account)

        </code>
<a class="headerlink" href="#beancount.core.realization.dump" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a RealAccount node to a line of lines.</p>
<p>Note: this is not meant to be used to produce text reports; the reporting
code should produce an intermediate object that contains the structure of
it, which can then be rendered to ASCII, HTML or CSV formats. This is
intended as a convenient little function for dumping trees of data for
debugging purposes.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>root_account</code></td>
<td><code></code></td>
<td>
<p>A RealAccount instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A list of tuples of (first_line, continuation_line, real_account) where
  first_line</code></td>
<td>
<p>A string, the first line to render, which includes the
    account name.
  continuation_line: A string, further line to render if necessary.
  real_account: The RealAccount instance which corresponds to this
    line.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def dump(root_account):
    """Convert a RealAccount node to a line of lines.

    Note: this is not meant to be used to produce text reports; the reporting
    code should produce an intermediate object that contains the structure of
    it, which can then be rendered to ASCII, HTML or CSV formats. This is
    intended as a convenient little function for dumping trees of data for
    debugging purposes.

    Args:
      root_account: A RealAccount instance.
    Returns:
      A list of tuples of (first_line, continuation_line, real_account) where
        first_line: A string, the first line to render, which includes the
          account name.
        continuation_line: A string, further line to render if necessary.
        real_account: The RealAccount instance which corresponds to this
          line.
    """
    # Compute all the lines ahead of time in order to calculate the width.
    lines = []

    # Start with the root node. We push the constant prefix before this node,
    # the account name, and the RealAccount instance. We will maintain a stack
    # of children nodes to render.
    stack = [('', root_account.account, root_account, True)]
    while stack:
        prefix, name, real_account, is_last = stack.pop(-1)

        if real_account is root_account:
            # For the root node, we don't want to render any prefix.
            first = cont = ''
        else:
            # Compute the string that precedes the name directly and the one below
            # that for the continuation lines.
            #  |
            #  @@@ Bank1    &lt;----------------
            #  @@@ |
            #  |   |-- Checking
            if is_last:
                first = prefix + PREFIX_LEAF_1
                cont = prefix + PREFIX_LEAF_C
            else:
                first = prefix + PREFIX_CHILD_1
                cont = prefix + PREFIX_CHILD_C

        # Compute the name to render for continuation lines.
        #  |
        #  |-- Bank1
        #  |   @@@       &lt;----------------
        #  |   |-- Checking
        if len(real_account) &gt; 0:
            cont_name = PREFIX_CHILD_C
        else:
            cont_name = PREFIX_LEAF_C

        # Add a line for this account.
        if not (real_account is root_account and not name):
            lines.append((first + name,
                          cont + cont_name,
                          real_account))

        # Push the children onto the stack, being careful with ordering and
        # marking the last node as such.
        child_items = sorted(real_account.items(), reverse=True)
        if child_items:
            child_iter = iter(child_items)
            child_name, child_account = next(child_iter)
            stack.append((cont, child_name, child_account, True))
            for child_name, child_account in child_iter:
                stack.append((cont, child_name, child_account, False))

    if not lines:
        return lines

    # Compute the maximum width of the lines and convert all of them to the same
    # maximal width. This makes it easy on the client.
    max_width = max(len(first_line) for first_line, _, __ in lines)
    line_format = '{{:{width}}}'.format(width=max_width)
    return [(line_format.format(first_line),
             line_format.format(cont_line),
             real_node)
            for (first_line, cont_line, real_node) in lines]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.dump_balances">
<code class="highlight language-python">
beancount.core.realization.dump_balances
(real_root, dformat, at_cost=False, fullnames=False, file=None)

        </code>
<a class="headerlink" href="#beancount.core.realization.dump_balances" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Dump a realization tree with balances.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_root</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>dformat</code></td>
<td><code></code></td>
<td>
<p>An instance of DisplayFormatter to format the numbers with.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>at_cost</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, render the values at cost.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>fullnames</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, don't render a tree of accounts and
render the full account names.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>A file object to dump the output to. If not specified, we
return the output as a string.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A string, the rendered tree, or nothing, if 'file' was provided.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def dump_balances(real_root, dformat, at_cost=False, fullnames=False, file=None):
    """Dump a realization tree with balances.

    Args:
      real_root: An instance of RealAccount.
      dformat: An instance of DisplayFormatter to format the numbers with.
      at_cost: A boolean, if true, render the values at cost.
      fullnames: A boolean, if true, don't render a tree of accounts and
        render the full account names.
      file: A file object to dump the output to. If not specified, we
        return the output as a string.
    Returns:
      A string, the rendered tree, or nothing, if 'file' was provided.
    """
    if fullnames:
        # Compute the maximum account name length;
        maxlen = max(len(real_child.account)
                     for real_child in iter_children(real_root, leaf_only=True))
        line_format = '{{:{width}}} {{}}\n'.format(width=maxlen)
    else:
        line_format = '{}       {}\n'

    output = file or io.StringIO()
    for first_line, cont_line, real_account in dump(real_root):
        if not real_account.balance.is_empty():
            if at_cost:
                rinv = real_account.balance.reduce(convert.get_cost)
            else:
                rinv = real_account.balance.reduce(convert.get_units)
            amounts = [position.units for position in rinv.get_positions()]
            positions = [amount_.to_string(dformat)
                         for amount_ in sorted(amounts, key=amount.sortkey)]
        else:
            positions = ['']

        if fullnames:
            for position in positions:
                if not position and len(real_account) &gt; 0:
                    continue  # Skip parent accounts with no position to render.
                output.write(line_format.format(real_account.account, position))
        else:
            line = first_line
            for position in positions:
                output.write(line_format.format(line, position))
                line = cont_line

    if file is None:
        return output.getvalue()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.filter">
<code class="highlight language-python">
beancount.core.realization.filter
(real_account, predicate)

        </code>
<a class="headerlink" href="#beancount.core.realization.filter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Filter a RealAccount tree of nodes by the predicate.</p>
<p>This function visits the tree and applies the predicate on each node. It
returns a partial clone of RealAccount whereby on each node
- either the predicate is true, or
- for at least one child of the node the predicate is true.
All the leaves have the predicate be true.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>predicate</code></td>
<td><code></code></td>
<td>
<p>A callable/function which accepts a real_account and returns
a boolean. If the function returns True, the node is kept.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A shallow clone of RealAccount is always returned.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def filter(real_account, predicate):
    """Filter a RealAccount tree of nodes by the predicate.

    This function visits the tree and applies the predicate on each node. It
    returns a partial clone of RealAccount whereby on each node
    - either the predicate is true, or
    - for at least one child of the node the predicate is true.
    All the leaves have the predicate be true.

    Args:
      real_account: An instance of RealAccount.
      predicate: A callable/function which accepts a real_account and returns
        a boolean. If the function returns True, the node is kept.
    Returns:
      A shallow clone of RealAccount is always returned.
    """
    assert isinstance(real_account, RealAccount)

    real_copy = RealAccount(real_account.account)
    real_copy.balance = real_account.balance
    real_copy.txn_postings = real_account.txn_postings

    for child_name, real_child in real_account.items():
        real_child_copy = filter(real_child, predicate)
        if real_child_copy is not None:
            real_copy[child_name] = real_child_copy

    if len(real_copy) &gt; 0 or predicate(real_account):
        return real_copy
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.find_last_active_posting">
<code class="highlight language-python">
beancount.core.realization.find_last_active_posting
(txn_postings)

        </code>
<a class="headerlink" href="#beancount.core.realization.find_last_active_posting" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Look at the end of the list of postings, and find the last
posting or entry that is not an automatically added directive.
Note that if the account is closed, the last posting is assumed
to be a Close directive (this is the case if the input is valid
and checks without errors.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>txn_postings</code></td>
<td><code></code></td>
<td>
<p>a list of postings or entries.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An entry, or None, if the input list was empty.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def find_last_active_posting(txn_postings):
    """Look at the end of the list of postings, and find the last
    posting or entry that is not an automatically added directive.
    Note that if the account is closed, the last posting is assumed
    to be a Close directive (this is the case if the input is valid
    and checks without errors.

    Args:
      txn_postings: a list of postings or entries.
    Returns:
      An entry, or None, if the input list was empty.
    """
    for txn_posting in reversed(txn_postings):
        assert not isinstance(txn_posting, Posting)

        if not isinstance(txn_posting, (TxnPosting, Open, Close, Pad, Balance, Note)):
            continue

        # pylint: disable=bad-continuation
        if (isinstance(txn_posting, TxnPosting) and
            txn_posting.txn.flag == flags.FLAG_UNREALIZED):
            continue
        return txn_posting
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.get">
<code class="highlight language-python">
beancount.core.realization.get
(real_account, account_name, default=None)

        </code>
<a class="headerlink" href="#beancount.core.realization.get" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Fetch the subaccount name from the real_account node.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount, the parent node to look for
children of.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of a possibly indirect child leaf
found down the tree of 'real_account' nodes.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>default</code></td>
<td><code></code></td>
<td>
<p>The default value that should be returned if the child
subaccount is not found.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A RealAccount instance for the child, or the default value, if the child
is not found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get(real_account, account_name, default=None):
    """Fetch the subaccount name from the real_account node.

    Args:
      real_account: An instance of RealAccount, the parent node to look for
        children of.
      account_name: A string, the name of a possibly indirect child leaf
        found down the tree of 'real_account' nodes.
      default: The default value that should be returned if the child
        subaccount is not found.
    Returns:
      A RealAccount instance for the child, or the default value, if the child
      is not found.
    """
    if not isinstance(account_name, str):
        raise ValueError
    components = account.split(account_name)
    for component in components:
        real_child = real_account.get(component, default)
        if real_child is default:
            return default
        real_account = real_child
    return real_account
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.get_or_create">
<code class="highlight language-python">
beancount.core.realization.get_or_create
(real_account, account_name)

        </code>
<a class="headerlink" href="#beancount.core.realization.get_or_create" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Fetch the subaccount name from the real_account node.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount, the parent node to look for
children of, or create under.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>account_name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the direct or indirect child leaf
to get or create.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A RealAccount instance for the child, or the default value, if the child
is not found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_or_create(real_account, account_name):
    """Fetch the subaccount name from the real_account node.

    Args:
      real_account: An instance of RealAccount, the parent node to look for
        children of, or create under.
      account_name: A string, the name of the direct or indirect child leaf
        to get or create.
    Returns:
      A RealAccount instance for the child, or the default value, if the child
      is not found.
    """
    if not isinstance(account_name, str):
        raise ValueError
    components = account.split(account_name)
    path = []
    for component in components:
        path.append(component)
        real_child = real_account.get(component, None)
        if real_child is None:
            real_child = RealAccount(account.join(*path))
            real_account[component] = real_child
        real_account = real_child
    return real_account
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.get_postings">
<code class="highlight language-python">
beancount.core.realization.get_postings
(real_account)

        </code>
<a class="headerlink" href="#beancount.core.realization.get_postings" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return a sorted list a RealAccount's postings and children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of Posting or directories.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_postings(real_account):
    """Return a sorted list a RealAccount's postings and children.

    Args:
      real_account: An instance of RealAccount.
    Returns:
      A list of Posting or directories.
    """
    # We accumulate all the postings at once here instead of incrementally
    # because we need to return them sorted.
    accumulator = []
    for real_child in iter_children(real_account):
        accumulator.extend(real_child.txn_postings)
    accumulator.sort(key=data.posting_sortkey)
    return accumulator
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.index_key">
<code class="highlight language-python">
beancount.core.realization.index_key
(sequence, value, key, cmp)

        </code>
<a class="headerlink" href="#beancount.core.realization.index_key" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find the index of the first element in 'sequence' which is equal to 'value'.
If 'key' is specified, the value compared to the value returned by this
function. If the value is not found, return None.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sequence</code></td>
<td><code></code></td>
<td>
<p>The sequence to search.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>value</code></td>
<td><code></code></td>
<td>
<p>The value to search for.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>key</code></td>
<td><code></code></td>
<td>
<p>A predicate to call to obtain the value to compare against.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>cmp</code></td>
<td><code></code></td>
<td>
<p>A comparison predicate.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The index of the first element found, or None, if the element was not found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def index_key(sequence, value, key, cmp):
    """Find the index of the first element in 'sequence' which is equal to 'value'.
    If 'key' is specified, the value compared to the value returned by this
    function. If the value is not found, return None.

    Args:
      sequence: The sequence to search.
      value: The value to search for.
      key: A predicate to call to obtain the value to compare against.
      cmp: A comparison predicate.
    Returns:
      The index of the first element found, or None, if the element was not found.
    """
    for index, element in enumerate(sequence):
        if cmp(key(element), value):
            return index
    return
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.iter_children">
<code class="highlight language-python">
beancount.core.realization.iter_children
(real_account, leaf_only=False)

        </code>
<a class="headerlink" href="#beancount.core.realization.iter_children" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Iterate this account node and all its children, depth-first.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>real_account</code></td>
<td><code></code></td>
<td>
<p>An instance of RealAccount.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>leaf_only</code></td>
<td><code></code></td>
<td>
<p>A boolean flag, true if we should yield only leaves.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p>Yields:
  Instances of RealAccount, beginning with this account. The order is
  undetermined.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def iter_children(real_account, leaf_only=False):
    """Iterate this account node and all its children, depth-first.

    Args:
      real_account: An instance of RealAccount.
      leaf_only: A boolean flag, true if we should yield only leaves.
    Yields:
      Instances of RealAccount, beginning with this account. The order is
      undetermined.
    """
    if leaf_only:
        if len(real_account) == 0:
            yield real_account
        else:
            for key, real_child in sorted(real_account.items()):
                for real_subchild in iter_children(real_child, leaf_only):
                    yield real_subchild
    else:
        yield real_account
        for key, real_child in sorted(real_account.items()):
            for real_subchild in iter_children(real_child):
                yield real_subchild
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.iterate_with_balance">
<code class="highlight language-python">
beancount.core.realization.iterate_with_balance
(txn_postings)

        </code>
<a class="headerlink" href="#beancount.core.realization.iterate_with_balance" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Iterate over the entries, accumulating the running balance.</p>
<p>For each entry, this yields tuples of the form:</p>
<p>(entry, postings, change, balance)</p>
<p>entry: This is the directive for this line. If the list contained Posting
  instance, this yields the corresponding Transaction object.
postings: A list of postings on this entry that affect the balance. Only the
  postings encountered in the input list are included; only those affect the
  balance. If 'entry' is not a Transaction directive, this should always be
  an empty list. We preserve the original ordering of the postings as they
  appear in the input list.
change: An Inventory object that reflects the total change due to the
  postings from this entry that appear in the list. For example, if a
  Transaction has three postings and two are in the input list, the sum of
  the two postings will be in the 'change' Inventory object. However, the
  position for the transactions' third posting--the one not included in the
  input list--will not be in this inventory.
balance: An Inventory object that reflects the balance <em>after</em> adding the
  'change' inventory due to this entry's transaction. The 'balance' yielded
  is never None, even for entries that do not affect the balance, that is,
  with an empty 'change' inventory. It's up to the caller, the one rendering
  the entry, to decide whether to render this entry's change for a
  particular entry type.</p>
<p>Note that if the input list of postings-or-entries is not in sorted date
order, two postings for the same entry appearing twice with a different date
in between will cause the entry appear twice. This is correct behavior, and
it is expected that in practice this should never happen anyway, because the
list of postings or entries should always be sorted. This method attempts to
detect this and raises an assertion if this is seen.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>txn_postings</code></td>
<td><code></code></td>
<td>
<p>A list of postings or directive instances.
Postings affect the balance; other entries do not.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p>Yields:
  Tuples of (entry, postings, change, balance) as described above.</p>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def iterate_with_balance(txn_postings):
    """Iterate over the entries, accumulating the running balance.

    For each entry, this yields tuples of the form:

      (entry, postings, change, balance)

    entry: This is the directive for this line. If the list contained Posting
      instance, this yields the corresponding Transaction object.
    postings: A list of postings on this entry that affect the balance. Only the
      postings encountered in the input list are included; only those affect the
      balance. If 'entry' is not a Transaction directive, this should always be
      an empty list. We preserve the original ordering of the postings as they
      appear in the input list.
    change: An Inventory object that reflects the total change due to the
      postings from this entry that appear in the list. For example, if a
      Transaction has three postings and two are in the input list, the sum of
      the two postings will be in the 'change' Inventory object. However, the
      position for the transactions' third posting--the one not included in the
      input list--will not be in this inventory.
    balance: An Inventory object that reflects the balance *after* adding the
      'change' inventory due to this entry's transaction. The 'balance' yielded
      is never None, even for entries that do not affect the balance, that is,
      with an empty 'change' inventory. It's up to the caller, the one rendering
      the entry, to decide whether to render this entry's change for a
      particular entry type.

    Note that if the input list of postings-or-entries is not in sorted date
    order, two postings for the same entry appearing twice with a different date
    in between will cause the entry appear twice. This is correct behavior, and
    it is expected that in practice this should never happen anyway, because the
    list of postings or entries should always be sorted. This method attempts to
    detect this and raises an assertion if this is seen.

    Args:
      txn_postings: A list of postings or directive instances.
        Postings affect the balance; other entries do not.
    Yields:
      Tuples of (entry, postings, change, balance) as described above.
    """

    # The running balance.
    running_balance = inventory.Inventory()

    # Previous date.
    prev_date = None

    # A list of entries at the current date.
    date_entries = []

    first = lambda pair: pair[0]
    for txn_posting in txn_postings:

        # Get the posting if we are dealing with one.
        assert not isinstance(txn_posting, Posting)
        if isinstance(txn_posting, TxnPosting):
            posting = txn_posting.posting
            entry = txn_posting.txn
        else:
            posting = None
            entry = txn_posting

        if entry.date != prev_date:
            assert prev_date is None or entry.date &gt; prev_date, (
                "Invalid date order for postings: {} &gt; {}".format(prev_date, entry.date))
            prev_date = entry.date

            # Flush the dated entries.
            for date_entry, date_postings in date_entries:
                change = inventory.Inventory()
                if date_postings:
                    # Compute the change due to this transaction and update the
                    # total balance at the same time.
                    for date_posting in date_postings:
                        change.add_position(date_posting)
                        running_balance.add_position(date_posting)
                yield date_entry, date_postings, change, running_balance

            date_entries.clear()
            assert not date_entries

        if posting is not None:
            # De-dup multiple postings on the same transaction entry by
            # grouping their positions together.
            index = index_key(date_entries, entry, first, operator.is_)
            if index is None:
                date_entries.append((entry, [posting]))
            else:
                # We are indeed de-duping!
                postings = date_entries[index][1]
                postings.append(posting)
        else:
            # This is a regular entry; nothing to add/remove.
            date_entries.append((entry, []))

    # Flush the final dated entries if any, same as above.
    for date_entry, date_postings in date_entries:
        change = inventory.Inventory()
        if date_postings:
            for date_posting in date_postings:
                change.add_position(date_posting)
                running_balance.add_position(date_posting)
        yield date_entry, date_postings, change, running_balance
    date_entries.clear()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.postings_by_account">
<code class="highlight language-python">
beancount.core.realization.postings_by_account
(entries)

        </code>
<a class="headerlink" href="#beancount.core.realization.postings_by_account" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create lists of postings and balances by account.</p>
<p>This routine aggregates postings and entries grouping them by account name.
The resulting lists contain postings in-lieu of Transaction directives, but
the other directives are stored as entries. This yields a list of postings
or other entries by account. All references to accounts are taken into
account.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A mapping of account name to list of TxnPosting instances or
non-Transaction directives, sorted in the same order as the entries.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def postings_by_account(entries):
    """Create lists of postings and balances by account.

    This routine aggregates postings and entries grouping them by account name.
    The resulting lists contain postings in-lieu of Transaction directives, but
    the other directives are stored as entries. This yields a list of postings
    or other entries by account. All references to accounts are taken into
    account.

    Args:
      entries: A list of directives.
    Returns:
       A mapping of account name to list of TxnPosting instances or
       non-Transaction directives, sorted in the same order as the entries.
    """
    txn_postings_map = collections.defaultdict(list)
    for entry in entries:

        if isinstance(entry, Transaction):
            # Insert an entry for each of the postings.
            for posting in entry.postings:
                txn_postings_map[posting.account].append(
                    TxnPosting(entry, posting))

        elif isinstance(entry, (Open, Close, Balance, Note, Document)):
            # Append some other entries in the realized list.
            txn_postings_map[entry.account].append(entry)

        elif isinstance(entry, Pad):
            # Insert the pad entry in both realized accounts.
            txn_postings_map[entry.account].append(entry)
            txn_postings_map[entry.source_account].append(entry)

        elif isinstance(entry, Custom):
            # Insert custom entry for each account in its values.
            for custom_value in entry.values:
                if custom_value.dtype == account.TYPE:
                    txn_postings_map[custom_value.value].append(entry)

    return txn_postings_map
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.core.realization.realize">
<code class="highlight language-python">
beancount.core.realization.realize
(entries, min_accounts=None, compute_balance=True)

        </code>
<a class="headerlink" href="#beancount.core.realization.realize" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Group entries by account, into a "tree" of realized accounts. RealAccount's
are essentially containers for lists of postings and the final balance of
each account, and may be non-leaf accounts (used strictly for organizing
accounts into a hierarchy). This is then used to issue reports.</p>
<p>The lists of postings in each account my be any of the entry types, except
for Transaction, whereby Transaction entries are replaced by the specific
Posting legs that belong to the account. Here's a simple diagram that
summarizes this seemingly complex, but rather simple data structure:</p>
<p>+-------------+ postings  +------+
   | RealAccount |----------&gt;| Open |
   +-------------+           +------+
                                 |
                                 v
                          +------------+     +-------------+
                          | TxnPosting |----&gt;| Transaction |
                          +------------+     +-------------+
                                 |      \                 \\
                                 v       <code>\.__          +---------+
                              +-----+</code>--------&gt;| Posting |
                              | Pad |                   +---------+
                              +-----+
                                 |
                                 v
                            +---------+
                            | Balance |
                            +---------+
                                 |
                                 v
                             +-------+
                             | Close |
                             +-------+
                                 |
                                 .</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>min_accounts</code></td>
<td><code></code></td>
<td>
<p>A list of strings, account names to ensure we create,
regardless of whether there are postings on those accounts or not.
This can be used to ensure the root accounts all exist.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>compute_balance</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if we should compute the final
balance on the realization.</p>
</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The root RealAccount instance.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/core/realization.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def realize(entries, min_accounts=None, compute_balance=True):
    r"""Group entries by account, into a "tree" of realized accounts. RealAccount's
    are essentially containers for lists of postings and the final balance of
    each account, and may be non-leaf accounts (used strictly for organizing
    accounts into a hierarchy). This is then used to issue reports.

    The lists of postings in each account my be any of the entry types, except
    for Transaction, whereby Transaction entries are replaced by the specific
    Posting legs that belong to the account. Here's a simple diagram that
    summarizes this seemingly complex, but rather simple data structure:

       +-------------+ postings  +------+
       | RealAccount |----------&gt;| Open |
       +-------------+           +------+
                                     |
                                     v
                              +------------+     +-------------+
                              | TxnPosting |----&gt;| Transaction |
                              +------------+     +-------------+
                                     |      \                 \\\
                                     v       `\.__          +---------+
                                  +-----+         `--------&gt;| Posting |
                                  | Pad |                   +---------+
                                  +-----+
                                     |
                                     v
                                +---------+
                                | Balance |
                                +---------+
                                     |
                                     v
                                 +-------+
                                 | Close |
                                 +-------+
                                     |
                                     .

    Args:
      entries: A list of directives.
      min_accounts: A list of strings, account names to ensure we create,
        regardless of whether there are postings on those accounts or not.
        This can be used to ensure the root accounts all exist.
      compute_balance: A boolean, true if we should compute the final
        balance on the realization.
    Returns:
      The root RealAccount instance.
    """
    # Create lists of the entries by account.
    txn_postings_map = postings_by_account(entries)

    # Create a RealAccount tree and compute the balance for each.
    real_root = RealAccount('')
    for account_name, txn_postings in txn_postings_map.items():
        real_account = get_or_create(real_root, account_name)
        real_account.txn_postings = txn_postings
        if compute_balance:
            real_account.balance = compute_postings_balance(txn_postings)

    # Ensure a minimum set of accounts that should exist. This is typically
    # called with an instance of AccountTypes to make sure that those exist.
    if min_accounts:
        for account_name in min_accounts:
            get_or_create(real_root, account_name)

    return real_root
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-right" href="beancount.ingest.html" title="beancount.ingest">Next <span class="icon icon-circle-arrow-right"></span></a>
<a class="btn btn-neutral" href="index.html" title="beancount"><span class="icon icon-circle-arrow-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<a class="fa fa-github" href="https://github.com/beancount/docs/" style="float: left; color: #fcfcfc"> GitHub</a>
<span><a href="index.html" style="color: #fcfcfc;">« Previous</a></span>
<span style="margin-left: 15px"><a href="beancount.ingest.html" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme.js"></script>
<script defer="" src="../js/extra.js"></script>
<script defer="" src="../search/main.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
