<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://beancount.github.io/docs/api_reference/beancount.core.html">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>beancount.core - Beancount Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
  <link href="../css/custom.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "beancount.core";
    var mkdocs_page_input_path = "api_reference/beancount.core.md";
    var mkdocs_page_url = "/docs/api_reference/beancount.core.html";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> Beancount Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../index.html">Index</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Outline</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../command_line_accounting_in_context.html">Command Line Accounting in Context</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../the_double_entry_counting_method.html">The Double Entry Counting Method</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../installing_beancount.html">Installing Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../getting_started_with_beancount.html">Getting Started with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_language_syntax.html">Beancount Language Syntax</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_options_reference.html">Beancount Options Reference</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../precision_tolerances.html">Precision Tolerances</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_query_language.html">Beancount Query Language</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../how_inventories_work.html">How Inventories Work</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../exporting_your_portfolio.html">Exporting Your Portfolio</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../tutorial_example.html">Tutorial & Example</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_history_and_credits.html">Beancount History and Credits</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../importing_external_data.html">Importing External Data</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Cookbooks & Examples</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../trading_with_beancount.html">Trading with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../how_we_share_expenses.html">How We Share Expenses</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../health_care_expenses.html">Health Care Expenses</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../calculating_portolio_returns.html">Calculating Portfolio Returns</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../tracking_medical_claims.html">Tracking Out-of-Network Medical Claims in Beancount</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_design_doc.html">Beancount Design Doc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../external_contributions.html">External Contributions</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals & Discussions</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Beancount 3</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_v3.html">Goals & Design</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../installing_beancount_v3.html">Installing Beancount</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beancount_v3_dependencies.html">Dependencies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../beangulp.html">Beangulp</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API reference</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="index.html">beancount</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="beancount.core.html">beancount.core</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core">beancount.core</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.account">account</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.AccountTransformer">AccountTransformer</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.account.AccountTransformer.parse">parse()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.account.AccountTransformer.render">render()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.commonprefix">commonprefix()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.has_component">has_component()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.is_valid">is_valid()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.join">join()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.leaf">leaf()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.parent">parent()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.parent_matcher">parent_matcher()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.parents">parents()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.root">root()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.sans_root">sans_root()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.split">split()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account.walk">walk()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.account_types">account_types</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.AccountTypes">AccountTypes</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.account_types.AccountTypes.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.account_types.AccountTypes.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.account_types.AccountTypes.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.get_account_sign">get_account_sign()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.get_account_sort_key">get_account_sort_key()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.get_account_type">get_account_type()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_account_type">is_account_type()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_balance_sheet_account">is_balance_sheet_account()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_equity_account">is_equity_account()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_income_statement_account">is_income_statement_account()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_inverted_account">is_inverted_account()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.account_types.is_root_account">is_root_account()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.amount">amount</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.Amount">Amount</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__bool__">__bool__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__eq__">__eq__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__hash__">__hash__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__lt__">__lt__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__neg__">__neg__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__repr__">__repr__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.__str__">__str__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.from_string">from_string()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.amount.Amount.to_string">to_string()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.A">A()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.abs">abs()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.add">add()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.div">div()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.from_string">from_string()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.mul">mul()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.sortkey">sortkey()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.amount.sub">sub()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.compare">compare</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.CompareError">CompareError</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.compare.CompareError.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.compare.CompareError.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.compare.CompareError.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.compare_entries">compare_entries()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.excludes_entries">excludes_entries()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.hash_entries">hash_entries()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.hash_entry">hash_entry()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.includes_entries">includes_entries()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.compare.stable_hash_namedtuple">stable_hash_namedtuple()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.convert">convert</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.convert_amount">convert_amount()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.convert_position">convert_position()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_cost">get_cost()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_units">get_units()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_value">get_value()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.convert.get_weight">get_weight()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.data">data</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Balance">Balance</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Balance.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Balance.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Balance.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Close">Close</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Close.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Close.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Close.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Commodity">Commodity</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Commodity.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Commodity.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Commodity.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Custom">Custom</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Custom.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Custom.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Custom.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Document">Document</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Document.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Document.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Document.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Event">Event</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Event.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Event.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Event.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Note">Note</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Note.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Note.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Note.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Open">Open</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Open.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Open.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Open.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Pad">Pad</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Pad.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Pad.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Pad.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Posting">Posting</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Posting.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Posting.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Posting.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Price">Price</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Price.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Price.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Price.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Query">Query</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Query.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Query.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Query.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.Transaction">Transaction</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Transaction.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Transaction.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.Transaction.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.TxnPosting">TxnPosting</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.TxnPosting.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.TxnPosting.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.TxnPosting.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.dtypes">dtypes</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Balance">Balance</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Close">Close</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Commodity">Commodity</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Custom">Custom</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Document">Document</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Event">Event</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Note">Note</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Open">Open</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Pad">Pad</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Price">Price</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Query">Query</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.data.dtypes.Transaction">Transaction</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.create_simple_posting">create_simple_posting()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.create_simple_posting_with_cost">create_simple_posting_with_cost()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.entry_sortkey">entry_sortkey()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.filter_txns">filter_txns()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.find_closest">find_closest()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.get_entry">get_entry()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.has_entry_account_component">has_entry_account_component()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.iter_entry_dates">iter_entry_dates()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.new_metadata">new_metadata()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.posting_has_conversion">posting_has_conversion()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.posting_sortkey">posting_sortkey()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.remove_account_postings">remove_account_postings()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.sanity_check_types">sanity_check_types()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.sorted">sorted()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.data.transaction_has_conversion">transaction_has_conversion()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.display_context">display_context</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.Align">Align</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.DisplayContext">DisplayContext</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.build">build()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.quantize">quantize()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.set_commas">set_commas()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.update">update()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.display_context.DisplayContext.update_from">update_from()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.DisplayFormatter">DisplayFormatter</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.display_context.Precision">Precision</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.distribution">distribution</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.distribution.Distribution">Distribution</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.empty">empty()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.max">max()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.min">min()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.mode">mode()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.update">update()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.distribution.Distribution.update_from">update_from()</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.flags">flags</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.getters">getters</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.GetAccounts">GetAccounts</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Balance">Balance()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Close">Close()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Commodity">Commodity()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Custom">Custom()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Document">Document()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Event">Event()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Note">Note()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Open">Open()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Pad">Pad()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Price">Price()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Query">Query()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.Transaction">Transaction()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.get_accounts_use_map">get_accounts_use_map()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.getters.GetAccounts.get_entry_accounts">get_entry_accounts()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_account_components">get_account_components()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_account_open_close">get_account_open_close()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_accounts">get_accounts()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_accounts_use_map">get_accounts_use_map()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_active_years">get_active_years()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_all_links">get_all_links()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_all_payees">get_all_payees()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_all_tags">get_all_tags()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_commodity_directives">get_commodity_directives()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_dict_accounts">get_dict_accounts()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_entry_accounts">get_entry_accounts()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_leveln_parent_accounts">get_leveln_parent_accounts()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_min_max_dates">get_min_max_dates()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.getters.get_values_meta">get_values_meta()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.interpolate">interpolate</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.BalanceError">BalanceError</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.interpolate.BalanceError.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.interpolate.BalanceError.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.interpolate.BalanceError.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.compute_entries_balance">compute_entries_balance()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.compute_entry_context">compute_entry_context()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.compute_residual">compute_residual()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.fill_residual_posting">fill_residual_posting()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.get_residual_postings">get_residual_postings()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.has_nontrivial_balance">has_nontrivial_balance()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.infer_tolerances">infer_tolerances()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.is_tolerance_user_specified">is_tolerance_user_specified()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.interpolate.quantize_with_tolerance">quantize_with_tolerance()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.inventory">inventory</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.Inventory">Inventory</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__abs__">__abs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__add__">__add__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__copy__">__copy__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__iadd__">__iadd__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__init__">__init__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__iter__">__iter__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__lt__">__lt__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__mul__">__mul__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__neg__">__neg__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__repr__">__repr__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.__str__">__str__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.add_amount">add_amount()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.add_inventory">add_inventory()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.add_position">add_position()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.average">average()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.cost_currencies">cost_currencies()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.currencies">currencies()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.currency_pairs">currency_pairs()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.from_string">from_string()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.get_currency_units">get_currency_units()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.get_only_position">get_only_position()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.get_positions">get_positions()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_empty">is_empty()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_mixed">is_mixed()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_reduced_by">is_reduced_by()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.is_small">is_small()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.reduce">reduce()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.segregate_units">segregate_units()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.split">split()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.inventory.Inventory.to_string">to_string()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.MatchResult">MatchResult</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.check_invariants">check_invariants()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.inventory.from_string">from_string()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.number">number</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.D">D()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.auto_quantize">auto_quantize()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.auto_quantized_exponent">auto_quantized_exponent()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.infer_quantum_from_list">infer_quantum_from_list()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.num_fractional_digits">num_fractional_digits()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.round_to">round_to()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.number.same_sign">same_sign()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.position">position</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.Cost">Cost</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Cost.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Cost.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Cost.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.CostSpec">CostSpec</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.CostSpec.__getnewargs__">__getnewargs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.CostSpec.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.CostSpec.__repr__">__repr__()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.Position">Position</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__abs__">__abs__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__copy__">__copy__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__eq__">__eq__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__hash__">__hash__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__lt__">__lt__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__mul__">__mul__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__neg__">__neg__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__new__">__new__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__repr__">__repr__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.__str__">__str__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.currency_pair">currency_pair()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.from_amounts">from_amounts()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.from_string">from_string()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.get_negative">get_negative()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.is_negative_at_cost">is_negative_at_cost()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.sortkey">sortkey()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.position.Position.to_string">to_string()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.cost_to_str">cost_to_str()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.from_amounts">from_amounts()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.from_string">from_string()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.get_position">get_position()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.position.to_string">to_string()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.prices">prices</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.PriceMap">PriceMap</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.build_price_map">build_price_map()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_all_prices">get_all_prices()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_last_price_entries">get_last_price_entries()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_latest_price">get_latest_price()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.get_price">get_price()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.normalize_base_quote">normalize_base_quote()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.prices.project">project()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#beancount.core.realization">realization</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.RealAccount">RealAccount</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__eq__">__eq__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__init__">__init__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__ne__">__ne__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.__setitem__">__setitem__()</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#beancount.core.realization.RealAccount.copy">copy()</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.compute_balance">compute_balance()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.compute_postings_balance">compute_postings_balance()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.contains">contains()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.dump">dump()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.dump_balances">dump_balances()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.filter">filter()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.find_last_active_posting">find_last_active_posting()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.get">get()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.get_or_create">get_or_create()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.get_postings">get_postings()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.index_key">index_key()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.iter_children">iter_children()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.iterate_with_balance">iterate_with_balance()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.postings_by_account">postings_by_account()</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#beancount.core.realization.realize">realize()</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.loader.html">beancount.loader</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.ops.html">beancount.ops</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.parser.html">beancount.parser</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.tools.html">beancount.tools</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="beancount.utils.html">beancount.utils</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Beancount Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>API reference &raquo;</li>
        
      
    
    <li>beancount.core</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="beancountcore">beancount.core<a class="headerlink" href="#beancountcore" title="Permanent link"></a></h1>


  <div class="doc doc-object doc-module">

<a id="beancount.core"></a>
    <div class="doc doc-contents first">

      <p>Core basic objects and data structures to represent a list of entries.</p>



  <div class="doc doc-children">












  <div class="doc doc-object doc-module">



<h2 id="beancount.core.account" class="doc doc-heading">
        <code>beancount.core.account</code>



<a href="#beancount.core.account" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Functions that operate on account strings.</p>
<p>These account objects are rather simple and dumb; they do not contain the list
of their associated postings. This is achieved by building a realization; see
realization.py for details.</p>



  <div class="doc doc-children">















  <div class="doc doc-object doc-class">



<h3 id="beancount.core.account.AccountTransformer" class="doc doc-heading">
        <code>
beancount.core.account.AccountTransformer        </code>



<a href="#beancount.core.account.AccountTransformer" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Account name transformer.</p>
<p>This is used to support Win... huh, filesystems and platforms which do not
support colon characters.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>rsep</code></td>
        <td></td>
        <td><p>A character string, the new separator to use in link names.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="beancount.core.account.AccountTransformer.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">AccountTransformer</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformed_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.AccountTransformer.parse" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Convert the transform account name to an account name.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformed_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Account</span><span class="p">:</span>
    <span class="s2">&quot;Convert the transform account name to an account name.&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">transformed_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsep</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">transformed_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rsep</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.account.AccountTransformer.render" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">AccountTransformer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.AccountTransformer.render" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Convert the account name to a transformed account name.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="s2">&quot;Convert the account name to a transformed account name.&quot;</span>
    <span class="k">return</span> <span class="n">account_name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">account_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsep</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.commonprefix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">(</span><span class="n">accounts</span><span class="p">)</span></code>


<a href="#beancount.core.account.commonprefix" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the common prefix of a list of account names.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>accounts</strong> (<code>Iterable[str]</code>)  A sequence of account name strings.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>str</code>  A string, the common parent account. If none, returns an empty string.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">commonprefix</span><span class="p">(</span><span class="n">accounts</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Account</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the common prefix of a list of account names.</span>

<span class="sd">    Args:</span>
<span class="sd">      accounts: A sequence of account name strings.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the common parent account. If none, returns an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">accounts_lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">account_</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">for</span> <span class="n">account_</span> <span class="ow">in</span> <span class="n">accounts</span><span class="p">]</span>
    <span class="c1"># Note: the os.path.commonprefix() function just happens to work here.</span>
    <span class="c1"># Inspect its code, and even the special case of no common prefix</span>
    <span class="c1"># works well with str.join() below.</span>
    <span class="n">common_list</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">(</span><span class="n">accounts_lists</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common_list</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.has_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">has_component</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span></code>


<a href="#beancount.core.account.has_component" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if one of the account contains a given component.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
            <li><p><strong>component</strong> (<code>str</code>)  A string, a component of an account name. For instance,
<code>Food</code> in <code>Expenses:Food:Restaurant</code>. All components are considered.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Boolean</code>  true if the component is in the account. Note that a component
name must be whole, that is <code>NY</code> is not in <code>Expenses:Taxes:StateNY</code>.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">has_component</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if one of the account contains a given component.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">      component: A string, a component of an account name. For instance,</span>
<span class="sd">        ``Food`` in ``Expenses:Food:Restaurant``. All components are considered.</span>
<span class="sd">    Returns:</span>
<span class="sd">      Boolean: true if the component is in the account. Note that a component</span>
<span class="sd">      name must be whole, that is ``NY`` is not in ``Expenses:Taxes:StateNY``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;(^|:)</span><span class="si">{}</span><span class="s2">(:|$)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">component</span><span class="p">),</span> <span class="n">account_name</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.is_valid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>


<a href="#beancount.core.account.is_valid" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the given string is a valid account name.
This does not check for the root account types, just the general syntax.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong> (<code>str</code>)  A string, to be checked for account name pattern.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the string has the form of an account's name.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the given string is a valid account name.</span>
<span class="sd">    This does not check for the root account types, just the general syntax.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string, to be checked for account name pattern.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the string has the form of an account&#39;s name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">bool</span><span class="p">(</span><span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ACCOUNT_RE</span><span class="p">),</span> <span class="n">string</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.join" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">components</span><span class="p">)</span></code>


<a href="#beancount.core.account.join" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Join the names with the account separator.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>*components</strong> (<code>Tuple[str]</code>)  Strings, the components of an account name.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>str</code>  A string, joined in a single account name.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="o">*</span><span class="n">components</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Join the names with the account separator.</span>

<span class="sd">    Args:</span>
<span class="sd">      *components: Strings, the components of an account name.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, joined in a single account name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.leaf" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.leaf" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Get the name of the leaf of this account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account whose leaf name to return.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>str</code>  A string, the name of the leaf of the account.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">leaf</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the name of the leaf of this account.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account whose leaf name to return.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the name of the leaf of the account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">account_name</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.parent" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">parent</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.parent" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the name of the parent account of the given account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account whose parent to return.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>str</code>  A string, the name of the parent account of this account.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parent</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the name of the parent account of the given account.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account whose parent to return.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the name of the parent account of this account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="n">account_name</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">account_name</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">components</span> <span class="o">=</span> <span class="n">account_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>
    <span class="n">components</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.parent_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">parent_matcher</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.parent_matcher" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Build a predicate that returns whether an account is under the given one.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  The name of the parent account we want to check for.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Callable[[str], Any]</code>  A callable, which, when called, will return true if the given account is a
child of <code>account_name</code>.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parent_matcher</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a predicate that returns whether an account is under the given one.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: The name of the parent account we want to check for.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A callable, which, when called, will return true if the given account is a</span>
<span class="sd">      child of ``account_name``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">($|</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">account_name</span><span class="p">),</span> <span class="n">sep</span><span class="p">))</span><span class="o">.</span><span class="n">match</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.parents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">parents</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.parents" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A generator of the names of the parents of this account, including this account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  The name of the account we want to start iterating from.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Iterator[str]</code>  A generator of account name strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parents</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Account</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A generator of the names of the parents of this account, including this account.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: The name of the account we want to start iterating from.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A generator of account name strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="n">account_name</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">account_name</span>
        <span class="n">account_name</span> <span class="o">=</span> <span class="n">parent</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.root" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">num_components</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.root" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the first few components of an account's name.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>num_components</strong> (<code>int</code>)  An integer, the number of components to return.</p></li>
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>str</code>  A string, the account root up to 'num_components' components.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">root</span><span class="p">(</span><span class="n">num_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the first few components of an account&#39;s name.</span>

<span class="sd">    Args:</span>
<span class="sd">      num_components: An integer, the number of components to return.</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the account root up to &#39;num_components&#39; components.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)[:</span><span class="n">num_components</span><span class="p">]))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.sans_root" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">sans_root</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.sans_root" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Get the name of the account without the root.</p>
<p>For example, an input of 'Assets:BofA:Checking' will produce 'BofA:Checking'.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account whose leaf name to return.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>str</code>  A string, the name of the non-root portion of this account name.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sans_root</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the name of the account without the root.</span>

<span class="sd">    For example, an input of &#39;Assets:BofA:Checking&#39; will produce &#39;BofA:Checking&#39;.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account whose leaf name to return.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the name of the non-root portion of this account name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">components</span> <span class="o">=</span> <span class="n">account_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">components</span><span class="p">)</span> <span class="k">if</span> <span class="n">account_name</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account.split" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Split an account's name into its components.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>List[str]</code>  A list of strings, the components of the account name (without the separators).</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split an account&#39;s name into its components.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of strings, the components of the account name (without the separators).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">account_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account.walk" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">root_directory</span><span class="p">)</span></code>


<a href="#beancount.core.account.walk" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A version of os.walk() which yields directories that are valid account names.</p>
<p>This only yields directories that are accounts... it skips the other ones.
For convenience, it also yields you the account's name.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>root_directory</strong> (<code>str</code>)  A string, the name of the root of the hierarchy to be walked.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  Tuples of (root, account-name, dirs, files), similar to os.walk().</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/account.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="n">root_directory</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Account</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A version of os.walk() which yields directories that are valid account names.</span>

<span class="sd">    This only yields directories that are accounts... it skips the other ones.</span>
<span class="sd">    For convenience, it also yields you the account&#39;s name.</span>

<span class="sd">    Args:</span>
<span class="sd">      root_directory: A string, the name of the root of the hierarchy to be walked.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Tuples of (root, account-name, dirs, files), similar to os.walk().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">root_directory</span><span class="p">):</span>
        <span class="n">dirs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">relroot</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">root_directory</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
        <span class="n">account_name</span> <span class="o">=</span> <span class="n">relroot</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
        <span class="c1"># The regex module does not handle Unicode characters in decomposed</span>
        <span class="c1"># form. Python uses the normal form for representing string. However,</span>
        <span class="c1"># some filesystems use the canonical decomposition form.</span>
        <span class="c1"># See https://docs.python.org/3/library/unicodedata.html#unicodedata.normalize</span>
        <span class="n">account_name</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s2">&quot;NFKC&quot;</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">account_name</span><span class="p">):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.account_types" class="doc doc-heading">
        <code>beancount.core.account_types</code>



<a href="#beancount.core.account_types" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Definition for global account types.</p>
<p>This is where we keep the global account types value and definition.</p>
<p>Note that it's unfortunate that we're using globals and side-effect here, but
this is the best solution in the short-term, the account types are used
in too many places to pass around that state everywhere. Maybe we change
this later on.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h3 id="beancount.core.account_types.AccountTypes" class="doc doc-heading">
        <code>
beancount.core.account_types.AccountTypes            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.account_types.AccountTypes" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>AccountTypes(assets, liabilities, equity, income, expenses)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.account_types.AccountTypes.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">AccountTypes</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.account_types.AccountTypes.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.account_types.AccountTypes.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">AccountTypes</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">assets</span><span class="p">,</span> <span class="n">liabilities</span><span class="p">,</span> <span class="n">equity</span><span class="p">,</span> <span class="n">income</span><span class="p">,</span> <span class="n">expenses</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.account_types.AccountTypes.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of AccountTypes(assets, liabilities, equity, income, expenses)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.account_types.AccountTypes.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">AccountTypes</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.account_types.AccountTypes.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.get_account_sign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">get_account_sign</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">account_types</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.get_account_sign" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the sign of the normal balance of a particular account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account whose sign is to return.</p></li>
            <li><p><strong>account_types</strong> (<code>AccountTypes</code>)  An optional instance of the current account_types.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>int</code>  +1 or -1, depending on the account's type.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_account_sign</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">,</span> <span class="n">account_types</span><span class="p">:</span> <span class="n">AccountTypes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the sign of the normal balance of a particular account.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account whose sign is to return.</span>
<span class="sd">      account_types: An optional instance of the current account_types.</span>
<span class="sd">    Returns:</span>
<span class="sd">      +1 or -1, depending on the account&#39;s type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">account_types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">account_types</span> <span class="o">=</span> <span class="n">DEFAULT_ACCOUNT_TYPES</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="n">account_type</span> <span class="o">=</span> <span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="n">account_type</span> <span class="ow">in</span> <span class="p">(</span><span class="n">account_types</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span> <span class="n">account_types</span><span class="o">.</span><span class="n">expenses</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.get_account_sort_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">get_account_sort_key</span><span class="p">(</span><span class="n">account_types</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.get_account_sort_key" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a tuple that can be used to order/sort account names.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_types</strong> (<code>AccountTypes</code>)  An instance of AccountTypes, a tuple of account type names.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Tuple[str, str]</code>  An object to use as the 'key' argument to the sort function.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_account_sort_key</span><span class="p">(</span>
    <span class="n">account_types</span><span class="p">:</span> <span class="n">AccountTypes</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Account</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a tuple that can be used to order/sort account names.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_types: An instance of AccountTypes, a tuple of account type names.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An object to use as the &#39;key&#39; argument to the sort function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">account_types</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)),</span> <span class="n">account_name</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.get_account_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.get_account_type" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the type of this account's name.</p>
<p>Warning: No check is made on the validity of the account type. This merely
returns the root account of the corresponding account name.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account whose type is to return.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, the type of the account in 'account_name'.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the type of this account&#39;s name.</span>

<span class="sd">    Warning: No check is made on the validity of the account type. This merely</span>
<span class="sd">    returns the root account of the corresponding account name.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account whose type is to return.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the type of the account in &#39;account_name&#39;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.is_account_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">is_account_type</span><span class="p">(</span><span class="n">account_type</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.is_account_type" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the type of this account's name.</p>
<p>Warning: No check is made on the validity of the account type. This merely
returns the root account of the corresponding account name.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_type</strong> (<code>str</code>)  A string, the prefix type of the account.</p></li>
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account whose type is to return.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the account is of the given type.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_account_type</span><span class="p">(</span><span class="n">account_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the type of this account&#39;s name.</span>

<span class="sd">    Warning: No check is made on the validity of the account type. This merely</span>
<span class="sd">    returns the root account of the corresponding account name.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_type: A string, the prefix type of the account.</span>
<span class="sd">      account_name: A string, the name of the account whose type is to return.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account is of the given type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_type</span><span class="p">,</span> <span class="n">account</span><span class="o">.</span><span class="n">sep</span><span class="p">),</span> <span class="n">account_name</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.is_balance_sheet_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">is_balance_sheet_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">account_types</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.is_balance_sheet_account" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the given account is a balance sheet account.
Assets, liabilities and equity accounts are balance sheet accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
            <li><p><strong>account_types</strong> (<code>AccountTypes</code>)  An instance of AccountTypes.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the account is a balance sheet account.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_balance_sheet_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">,</span> <span class="n">account_types</span><span class="p">:</span> <span class="n">AccountTypes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the given account is a balance sheet account.</span>
<span class="sd">    Assets, liabilities and equity accounts are balance sheet accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">      account_types: An instance of AccountTypes.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account is a balance sheet account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">account_types</span><span class="p">,</span> <span class="n">AccountTypes</span>
    <span class="p">),</span> <span class="s2">&quot;Account types has invalid type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_types</span><span class="p">)</span>
    <span class="n">account_type</span> <span class="o">=</span> <span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_type</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="n">account_types</span><span class="o">.</span><span class="n">assets</span><span class="p">,</span>
        <span class="n">account_types</span><span class="o">.</span><span class="n">liabilities</span><span class="p">,</span>
        <span class="n">account_types</span><span class="o">.</span><span class="n">equity</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.is_equity_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">is_equity_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">account_types</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.is_equity_account" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the given account is an equity account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
            <li><p><strong>account_types</strong> (<code>AccountTypes</code>)  An instance of AccountTypes.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the account is an equity account.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_equity_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">,</span> <span class="n">account_types</span><span class="p">:</span> <span class="n">AccountTypes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the given account is an equity account.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">      account_types: An instance of AccountTypes.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account is an equity account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">account_types</span><span class="p">,</span> <span class="n">AccountTypes</span>
    <span class="p">),</span> <span class="s2">&quot;Account types has invalid type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_types</span><span class="p">)</span>
    <span class="n">account_type</span> <span class="o">=</span> <span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_type</span> <span class="o">==</span> <span class="n">account_types</span><span class="o">.</span><span class="n">equity</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.is_income_statement_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">is_income_statement_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">account_types</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.is_income_statement_account" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the given account is an income statement account.
Income and expense accounts are income statement accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
            <li><p><strong>account_types</strong> (<code>AccountTypes</code>)  An instance of AccountTypes.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the account is an income statement account.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_income_statement_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">,</span> <span class="n">account_types</span><span class="p">:</span> <span class="n">AccountTypes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the given account is an income statement account.</span>
<span class="sd">    Income and expense accounts are income statement accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">      account_types: An instance of AccountTypes.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account is an income statement account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">account_types</span><span class="p">,</span> <span class="n">AccountTypes</span>
    <span class="p">),</span> <span class="s2">&quot;Account types has invalid type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_types</span><span class="p">)</span>
    <span class="n">account_type</span> <span class="o">=</span> <span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_type</span> <span class="ow">in</span> <span class="p">(</span><span class="n">account_types</span><span class="o">.</span><span class="n">income</span><span class="p">,</span> <span class="n">account_types</span><span class="o">.</span><span class="n">expenses</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.is_inverted_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">is_inverted_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="n">account_types</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.is_inverted_account" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the given account has inverted signs.</p>
<p>An inverted sign is the inverse as you'd expect in an external report, i.e.,
with all positive signs expected.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, an account name.</p></li>
            <li><p><strong>account_types</strong> (<code>AccountTypes</code>)  An instance of AccountTypes.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the account has an inverted sign.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_inverted_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">,</span> <span class="n">account_types</span><span class="p">:</span> <span class="n">AccountTypes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the given account has inverted signs.</span>

<span class="sd">    An inverted sign is the inverse as you&#39;d expect in an external report, i.e.,</span>
<span class="sd">    with all positive signs expected.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, an account name.</span>
<span class="sd">      account_types: An instance of AccountTypes.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account has an inverted sign.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">account_types</span><span class="p">,</span> <span class="n">AccountTypes</span>
    <span class="p">),</span> <span class="s2">&quot;Account types has invalid type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_types</span><span class="p">)</span>
    <span class="n">account_type</span> <span class="o">=</span> <span class="n">get_account_type</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_type</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="n">account_types</span><span class="o">.</span><span class="n">liabilities</span><span class="p">,</span>
        <span class="n">account_types</span><span class="o">.</span><span class="n">income</span><span class="p">,</span>
        <span class="n">account_types</span><span class="o">.</span><span class="n">equity</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.account_types.is_root_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">account_types</span><span class="o">.</span><span class="n">is_root_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.account_types.is_root_account" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the account name is a root account.</p>
<p>This function does not verify whether the account root is a valid
one, just that it is a root account or not.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong> (<code>str</code>)  A string, the name of the account to check for.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>bool</code>  A boolean, true if the account is root account.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/account_types.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_root_account</span><span class="p">(</span><span class="n">account_name</span><span class="p">:</span> <span class="n">Account</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the account name is a root account.</span>

<span class="sd">    This function does not verify whether the account root is a valid</span>
<span class="sd">    one, just that it is a root account or not.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of the account to check for.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the account is root account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Account is not a string: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">account_name</span> <span class="ow">and</span> <span class="nb">bool</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Z][A-Za-z0-9\-]+)$&quot;</span><span class="p">,</span> <span class="n">account_name</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.amount" class="doc doc-heading">
        <code>beancount.core.amount</code>



<a href="#beancount.core.amount" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Amount class.</p>
<p>This simple class is used to associate a number of units of a currency with its
currency:</p>
<p>(number, currency).</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h3 id="beancount.core.amount.Amount" class="doc doc-heading">
        <code>
beancount.core.amount.Amount            (<span title="beancount.core.amount._Amount">_Amount</span>)
        </code>



<a href="#beancount.core.amount.Amount" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An 'Amount' represents a number of a particular unit of something.</p>
<p>It's essentially a typed number, with corresponding manipulation operations
defined on it.</p>




  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__bool__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__bool__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Boolean predicate returns true if the number is non-zero.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, true if non-zero number.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Boolean predicate returns true if the number is non-zero.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if non-zero number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">!=</span> <span class="n">ZERO</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__eq__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Equality predicate. Returns true if both number and currency are equal.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Equality predicate. Returns true if both number and currency are equal.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__hash__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__hash__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A hashing function for amounts. The hash includes the currency.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An integer, the hash for this amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A hashing function for amounts. The hash includes the currency.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An integer, the hash for this amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__lt__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__lt__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Ordering comparison. This is used in the sorting key of positions.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  An instance of Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>True if this is less than the other Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ordering comparison. This is used in the sorting key of positions.</span>
<span class="sd">    Args:</span>
<span class="sd">      other: An instance of Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      True if this is less than the other Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sortkey</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sortkey</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__neg__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__neg__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the negative of this amount.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Amount, with the negative number of units.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the negative of this amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Amount, with the negative number of units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Constructor from a number and currency.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>number</strong>  A Decimal instance.</p></li>
            <li><p><strong>currency</strong>  A string, the currency symbol to use.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor from a number and currency.</span>

<span class="sd">    Args:</span>
<span class="sd">      number: A Decimal instance.</span>
<span class="sd">      currency: A string, the currency symbol to use.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">Amount</span><span class="o">.</span><span class="n">valid_types_number</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">Amount</span><span class="o">.</span><span class="n">valid_types_currency</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">currency</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_Amount</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Convert an Amount instance to a printable string with the defaults.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A formatted string of the quantized amount and symbol.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an Amount instance to a printable string with the defaults.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A formatted string of the quantized amount and symbol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.amount.Amount.__str__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Convert an Amount instance to a printable string with the defaults.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A formatted string of the quantized amount and symbol.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an Amount instance to a printable string with the defaults.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A formatted string of the quantized amount and symbol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.amount.Amount.from_string" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create an amount from a string.</p>
<p>This is a miniature parser used for building tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A string of &lt;number&gt; &lt;currency&gt;.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an amount from a string.</span>

<span class="sd">    This is a miniature parser used for building tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string of &lt;number&gt; &lt;currency&gt;.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;\s*([-+]?[0-9.]+)\s+(</span><span class="si">{currency}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currency</span><span class="o">=</span><span class="n">CURRENCY_RE</span><span class="p">),</span> <span class="n">string</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid string for amount: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
    <span class="n">number</span><span class="p">,</span> <span class="n">currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">number</span><span class="p">),</span> <span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.amount.Amount.to_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">Amount</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=&lt;</span><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayFormatter</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x78fcde6b7290</span><span class="o">&gt;</span><span class="p">)</span></code>


<a href="#beancount.core.amount.Amount.to_string" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Convert an Amount instance to a printable string.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>dformat</strong>  An instance of DisplayFormatter.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A formatted string of the quantized amount and symbol.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=</span><span class="n">DEFAULT_FORMATTER</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an Amount instance to a printable string.</span>

<span class="sd">    Args:</span>
<span class="sd">      dformat: An instance of DisplayFormatter.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A formatted string of the quantized amount and symbol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
        <span class="n">number_fmt</span> <span class="o">=</span> <span class="n">dformat</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="n">MISSING</span><span class="p">:</span>
        <span class="n">number_fmt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">number_fmt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number_fmt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.A" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>


<a href="#beancount.core.amount.A" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create an amount from a string.</p>
<p>This is a miniature parser used for building tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A string of &lt;number&gt; &lt;currency&gt;.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an amount from a string.</span>

<span class="sd">    This is a miniature parser used for building tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string of &lt;number&gt; &lt;currency&gt;.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;\s*([-+]?[0-9.]+)\s+(</span><span class="si">{currency}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currency</span><span class="o">=</span><span class="n">CURRENCY_RE</span><span class="p">),</span> <span class="n">string</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid string for amount: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
    <span class="n">number</span><span class="p">,</span> <span class="n">currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">number</span><span class="p">),</span> <span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.abs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span></code>


<a href="#beancount.core.amount.abs" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the absolute value of the given amount.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount</strong>  An instance of Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the absolute value of the given amount.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An instance of Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">amount</span> <span class="k">if</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span> <span class="o">&gt;=</span> <span class="n">ZERO</span> <span class="k">else</span> <span class="n">Amount</span><span class="p">(</span><span class="o">-</span><span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.add" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">amount1</span><span class="p">,</span> <span class="n">amount2</span><span class="p">)</span></code>


<a href="#beancount.core.amount.add" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Add the given amounts with the same currency.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount1</strong>  An instance of Amount.</p></li>
            <li><p><strong>amount2</strong>  An instance of Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Amount, with the sum the two amount's numbers, in the same
currency.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">amount1</span><span class="p">,</span> <span class="n">amount2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add the given amounts with the same currency.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount1: An instance of Amount.</span>
<span class="sd">      amount2: An instance of Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Amount, with the sum the two amount&#39;s numbers, in the same</span>
<span class="sd">      currency.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">amount1</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span>
    <span class="p">),</span> <span class="s2">&quot;Amount1&#39;s number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount1</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">amount2</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span>
    <span class="p">),</span> <span class="s2">&quot;Amount2&#39;s number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount2</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">amount1</span><span class="o">.</span><span class="n">currency</span> <span class="o">!=</span> <span class="n">amount2</span><span class="o">.</span><span class="n">currency</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Unmatching currencies for operation on </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount1</span><span class="p">,</span> <span class="n">amount2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">amount1</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="n">amount2</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">amount1</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.div" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span></code>


<a href="#beancount.core.amount.div" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Divide the given amount by a number.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount</strong>  An instance of Amount.</p></li>
            <li><p><strong>number</strong>  A decimal number.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount, with the same currency, but with amount units divided by 'number'.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">div</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Divide the given amount by a number.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An instance of Amount.</span>
<span class="sd">      number: A decimal number.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount, with the same currency, but with amount units divided by &#39;number&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span>
    <span class="p">),</span> <span class="s2">&quot;Amount&#39;s number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">),</span> <span class="s2">&quot;Number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">number</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">number</span> <span class="o">/</span> <span class="n">number</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>


<a href="#beancount.core.amount.from_string" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create an amount from a string.</p>
<p>This is a miniature parser used for building tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A string of &lt;number&gt; &lt;currency&gt;.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an amount from a string.</span>

<span class="sd">    This is a miniature parser used for building tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string of &lt;number&gt; &lt;currency&gt;.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;\s*([-+]?[0-9.]+)\s+(</span><span class="si">{currency}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currency</span><span class="o">=</span><span class="n">CURRENCY_RE</span><span class="p">),</span> <span class="n">string</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid string for amount: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
    <span class="n">number</span><span class="p">,</span> <span class="n">currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">number</span><span class="p">),</span> <span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.mul" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span></code>


<a href="#beancount.core.amount.mul" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Multiply the given amount by a number.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount</strong>  An instance of Amount.</p></li>
            <li><p><strong>number</strong>  A decimal number.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount, with the same currency, but with 'number' times units.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Multiply the given amount by a number.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An instance of Amount.</span>
<span class="sd">      number: A decimal number.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount, with the same currency, but with &#39;number&#39; times units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span>
    <span class="p">),</span> <span class="s2">&quot;Amount&#39;s number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">),</span> <span class="s2">&quot;Number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">number</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">number</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.sortkey" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">sortkey</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span></code>


<a href="#beancount.core.amount.sortkey" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A comparison function that sorts by currency first.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount</strong>  An instance of Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A sort key, composed of the currency first and then the number.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sortkey</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A comparison function that sorts by currency first.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An instance of Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A sort key, composed of the currency first and then the number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.amount.sub" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">amount1</span><span class="p">,</span> <span class="n">amount2</span><span class="p">)</span></code>


<a href="#beancount.core.amount.sub" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Subtract the given amounts with the same currency.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount1</strong>  An instance of Amount.</p></li>
            <li><p><strong>amount2</strong>  An instance of Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Amount, with the difference between the two amount's
numbers, in the same currency.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/amount.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">amount1</span><span class="p">,</span> <span class="n">amount2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Subtract the given amounts with the same currency.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount1: An instance of Amount.</span>
<span class="sd">      amount2: An instance of Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Amount, with the difference between the two amount&#39;s</span>
<span class="sd">      numbers, in the same currency.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">amount1</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span>
    <span class="p">),</span> <span class="s2">&quot;Amount1&#39;s number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount1</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">amount2</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span>
    <span class="p">),</span> <span class="s2">&quot;Amount2&#39;s number is not a Decimal instance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount2</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">amount1</span><span class="o">.</span><span class="n">currency</span> <span class="o">!=</span> <span class="n">amount2</span><span class="o">.</span><span class="n">currency</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Unmatching currencies for operation on </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount1</span><span class="p">,</span> <span class="n">amount2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">amount1</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="n">amount2</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">amount1</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.compare" class="doc doc-heading">
        <code>beancount.core.compare</code>



<a href="#beancount.core.compare" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Comparison helpers for data objects.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h3 id="beancount.core.compare.CompareError" class="doc doc-heading">
        <code>
beancount.core.compare.CompareError            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.compare.CompareError" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>CompareError(source, message, entry)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.compare.CompareError.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">CompareError</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.compare.CompareError.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.compare.CompareError.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">CompareError</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.compare.CompareError.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of CompareError(source, message, entry)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.compare.CompareError.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">CompareError</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.compare.CompareError.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.compare.compare_entries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">compare_entries</span><span class="p">(</span><span class="n">entries1</span><span class="p">,</span> <span class="n">entries2</span><span class="p">)</span></code>


<a href="#beancount.core.compare.compare_entries" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compare two lists of entries. This is used for testing.</p>
<p>The entries are compared with disregard for their file location.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries1</strong>  A list of directives of any type.</p></li>
            <li><p><strong>entries2</strong>  Another list of directives of any type.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>A tuple of (success, not_found1, not_found2), where the fields are</code>  success: A boolean, true if all the values are equal.
  missing1: A list of directives from 'entries1' not found in
    'entries2'.
  missing2: A list of directives from 'entries2' not found in
    'entries1'.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>ValueError</code>  If a duplicate entry is found.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compare_entries</span><span class="p">(</span><span class="n">entries1</span><span class="p">,</span> <span class="n">entries2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare two lists of entries. This is used for testing.</span>

<span class="sd">    The entries are compared with disregard for their file location.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries1: A list of directives of any type.</span>
<span class="sd">      entries2: Another list of directives of any type.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A tuple of (success, not_found1, not_found2), where the fields are:</span>
<span class="sd">        success: A boolean, true if all the values are equal.</span>
<span class="sd">        missing1: A list of directives from &#39;entries1&#39; not found in</span>
<span class="sd">          &#39;entries2&#39;.</span>
<span class="sd">        missing2: A list of directives from &#39;entries2&#39; not found in</span>
<span class="sd">          &#39;entries1&#39;.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ValueError: If a duplicate entry is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hashes1</span><span class="p">,</span> <span class="n">errors1</span> <span class="o">=</span> <span class="n">hash_entries</span><span class="p">(</span><span class="n">entries1</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">hashes2</span><span class="p">,</span> <span class="n">errors2</span> <span class="o">=</span> <span class="n">hash_entries</span><span class="p">(</span><span class="n">entries2</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">keys1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hashes1</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">keys2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hashes2</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">errors1</span> <span class="ow">or</span> <span class="n">errors2</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">errors1</span> <span class="o">+</span> <span class="n">errors2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>

    <span class="n">same</span> <span class="o">=</span> <span class="n">keys1</span> <span class="o">==</span> <span class="n">keys2</span>
    <span class="n">missing1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sorted</span><span class="p">([</span><span class="n">hashes1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys1</span> <span class="o">-</span> <span class="n">keys2</span><span class="p">])</span>
    <span class="n">missing2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sorted</span><span class="p">([</span><span class="n">hashes2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys2</span> <span class="o">-</span> <span class="n">keys1</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">same</span><span class="p">,</span> <span class="n">missing1</span><span class="p">,</span> <span class="n">missing2</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.compare.excludes_entries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">excludes_entries</span><span class="p">(</span><span class="n">subset_entries</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.compare.excludes_entries" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Check that a list of entries does not appear in another list.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>subset_entries</strong>  The set of entries to look for in 'entries'.</p></li>
            <li><p><strong>entries</strong>  The larger list of entries that should not include 'subset_entries'.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean and a list of entries that are not supposed to appear.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>ValueError</code>  If a duplicate entry is found.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">excludes_entries</span><span class="p">(</span><span class="n">subset_entries</span><span class="p">,</span> <span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that a list of entries does not appear in another list.</span>

<span class="sd">    Args:</span>
<span class="sd">      subset_entries: The set of entries to look for in &#39;entries&#39;.</span>
<span class="sd">      entries: The larger list of entries that should not include &#39;subset_entries&#39;.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean and a list of entries that are not supposed to appear.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ValueError: If a duplicate entry is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subset_hashes</span><span class="p">,</span> <span class="n">subset_errors</span> <span class="o">=</span> <span class="n">hash_entries</span><span class="p">(</span><span class="n">subset_entries</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">subset_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">subset_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">hashes</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">hash_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">subset_errors</span> <span class="ow">or</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset_errors</span> <span class="o">+</span> <span class="n">errors</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>

    <span class="n">intersection</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">subset_keys</span><span class="p">)</span>
    <span class="n">excludes</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">intersection</span><span class="p">)</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sorted</span><span class="p">([</span><span class="n">subset_hashes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">intersection</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">excludes</span><span class="p">,</span> <span class="n">extra</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.compare.hash_entries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">hash_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#beancount.core.compare.hash_entries" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute unique hashes of each of the entries and return a map of them.</p>
<p>This is used for comparisons between sets of entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
            <li><p><strong>exclude_meta</strong>  If set, exclude the metadata from the hash. Use this for
unit tests comparing entries coming from different sources as the
filename and lineno will be distinct. However, when you're using the
hashes to uniquely identify transactions, you want to include the
filenames and line numbers (the default).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A dict of hash-value to entry (for all entries) and a list of errors.
Errors are created when duplicate entries are found.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hash_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute unique hashes of each of the entries and return a map of them.</span>

<span class="sd">    This is used for comparisons between sets of entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      exclude_meta: If set, exclude the metadata from the hash. Use this for</span>
<span class="sd">        unit tests comparing entries coming from different sources as the</span>
<span class="sd">        filename and lineno will be distinct. However, when you&#39;re using the</span>
<span class="sd">        hashes to uniquely identify transactions, you want to include the</span>
<span class="sd">        filenames and line numbers (the default).</span>
<span class="sd">    Returns:</span>
<span class="sd">      A dict of hash-value to entry (for all entries) and a list of errors.</span>
<span class="sd">      Errors are created when duplicate entries are found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entry_hash_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">num_legal_duplicates</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">hash_</span> <span class="o">=</span> <span class="n">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hash_</span> <span class="ow">in</span> <span class="n">entry_hash_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Price</span><span class="p">):</span>
                <span class="c1"># Note: Allow duplicate Price entries, they should be common</span>
                <span class="c1"># because of the nature of stock markets (if they&#39;re closed, the</span>
                <span class="c1"># data source is likely to return an entry for the previously</span>
                <span class="c1"># available date, which may already have been fetched).</span>
                <span class="n">num_legal_duplicates</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_entry</span> <span class="o">=</span> <span class="n">entry_hash_dict</span><span class="p">[</span><span class="n">hash_</span><span class="p">]</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">CompareError</span><span class="p">(</span>
                        <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span>
                        <span class="s2">&quot;Duplicate entry: </span><span class="si">{}</span><span class="s2"> == </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">other_entry</span><span class="p">),</span>
                        <span class="n">entry</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="n">entry_hash_dict</span><span class="p">[</span><span class="n">hash_</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry_hash_dict</span><span class="p">)</span> <span class="o">+</span> <span class="n">num_legal_duplicates</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">),</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">entry_hash_dict</span><span class="p">),</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">),</span>
            <span class="n">num_legal_duplicates</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">entry_hash_dict</span><span class="p">,</span> <span class="n">errors</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.compare.hash_entry" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#beancount.core.compare.hash_entry" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute the stable hash of a single entry.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  A directive instance.</p></li>
            <li><p><strong>exclude_meta</strong>  If set, exclude the metadata from the hash. Use this for
unit tests comparing entries coming from different sources as the
filename and lineno will be distinct. However, when you're using the
hashes to uniquely identify transactions, you want to include the
filenames and line numbers (the default).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A stable hexadecimal hash of this entry.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hash_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the stable hash of a single entry.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A directive instance.</span>
<span class="sd">      exclude_meta: If set, exclude the metadata from the hash. Use this for</span>
<span class="sd">        unit tests comparing entries coming from different sources as the</span>
<span class="sd">        filename and lineno will be distinct. However, when you&#39;re using the</span>
<span class="sd">        hashes to uniquely identify transactions, you want to include the</span>
<span class="sd">        filenames and line numbers (the default).</span>
<span class="sd">    Returns:</span>
<span class="sd">      A stable hexadecimal hash of this entry.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">stable_hash_namedtuple</span><span class="p">(</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">IGNORED_FIELD_NAMES</span> <span class="k">if</span> <span class="n">exclude_meta</span> <span class="k">else</span> <span class="nb">frozenset</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.compare.includes_entries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">includes_entries</span><span class="p">(</span><span class="n">subset_entries</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.compare.includes_entries" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Check if a list of entries is included in another list.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>subset_entries</strong>  The set of entries to look for in 'entries'.</p></li>
            <li><p><strong>entries</strong>  The larger list of entries that could include 'subset_entries'.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean and a list of missing entries.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>ValueError</code>  If a duplicate entry is found.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">includes_entries</span><span class="p">(</span><span class="n">subset_entries</span><span class="p">,</span> <span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a list of entries is included in another list.</span>

<span class="sd">    Args:</span>
<span class="sd">      subset_entries: The set of entries to look for in &#39;entries&#39;.</span>
<span class="sd">      entries: The larger list of entries that could include &#39;subset_entries&#39;.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean and a list of missing entries.</span>
<span class="sd">    Raises:</span>
<span class="sd">      ValueError: If a duplicate entry is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subset_hashes</span><span class="p">,</span> <span class="n">subset_errors</span> <span class="o">=</span> <span class="n">hash_entries</span><span class="p">(</span><span class="n">subset_entries</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">subset_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">subset_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">hashes</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">hash_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">exclude_meta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">subset_errors</span> <span class="ow">or</span> <span class="n">errors</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset_errors</span> <span class="o">+</span> <span class="n">errors</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>

    <span class="n">includes</span> <span class="o">=</span> <span class="n">subset_keys</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sorted</span><span class="p">([</span><span class="n">subset_hashes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">subset_keys</span> <span class="o">-</span> <span class="n">keys</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">includes</span><span class="p">,</span> <span class="n">missing</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.compare.stable_hash_namedtuple" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">compare</span><span class="o">.</span><span class="n">stable_hash_namedtuple</span><span class="p">(</span><span class="n">objtuple</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">())</span></code>


<a href="#beancount.core.compare.stable_hash_namedtuple" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Hash the given namedtuple and its child fields.</p>
<p>This iterates over all the members of objtuple, skipping the attributes from
the 'ignore' set, and computes a unique hash string code. If the elements
are lists or sets, sorts them for stability.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>objtuple</strong>  A tuple object or other.</p></li>
            <li><p><strong>ignore</strong>  A set of strings, attribute names to be skipped in
computing a stable hash. For instance, circular references to objects
or irrelevant data.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/compare.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">stable_hash_namedtuple</span><span class="p">(</span><span class="n">objtuple</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">()):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hash the given namedtuple and its child fields.</span>

<span class="sd">    This iterates over all the members of objtuple, skipping the attributes from</span>
<span class="sd">    the &#39;ignore&#39; set, and computes a unique hash string code. If the elements</span>
<span class="sd">    are lists or sets, sorts them for stability.</span>

<span class="sd">    Args:</span>
<span class="sd">      objtuple: A tuple object or other.</span>
<span class="sd">      ignore: A set of strings, attribute names to be skipped in</span>
<span class="sd">        computing a stable hash. For instance, circular references to objects</span>
<span class="sd">        or irrelevant data.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: this routine is slow and would stand to be implemented in C.</span>
    <span class="n">hashobj</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">objtuple</span><span class="o">.</span><span class="n">_fields</span><span class="p">,</span> <span class="n">objtuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">)):</span>
            <span class="n">subhashes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">attr_value</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">subhashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stable_hash_namedtuple</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">ignore</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">md5</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
                    <span class="n">md5</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
                    <span class="n">subhashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">md5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">subhash</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">subhashes</span><span class="p">):</span>
                <span class="n">hashobj</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">subhash</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hashobj</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">attr_value</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">hashobj</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.convert" class="doc doc-heading">
        <code>beancount.core.convert</code>



<a href="#beancount.core.convert" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Conversions from Position (or Posting) to units, cost, weight, market value.</p>
<ul>
<li>Units: Just the primary amount of the position.</li>
<li>Cost: The cost basis of the position, if available.</li>
<li>Weight: The cost basis or price of the position.</li>
<li>Market Value: The units converted to a value via a price map.</li>
</ul>
<p>To convert an inventory's contents, simply use these functions in conjunction
with <code>Inventory.reduce()</code>, like</p>
<pre><code>cost_inv = inv.reduce(convert.get_cost)
</code></pre>
<p>This module equivalently converts Position and Posting instances. Note that
we're specifically avoiding to create an import dependency on
beancount.core.data in order to keep this module isolatable, but it works on
postings due to duck-typing.</p>
<p>Function named <code>get_*()</code> are used to compute values from postings to their price currency.
Functions named <code>convert_*()</code> are used to convert postings and amounts to any currency.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-function">



<h3 id="beancount.core.convert.convert_amount" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">convert_amount</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">via</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.convert.convert_amount" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the market value of an Amount in a particular currency.</p>
<p>In addition, if a conversion rate isn't available, you can provide a list of
currencies to attempt to synthesize a rate for via implied rates.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amt</strong>  An instance of Amount.</p></li>
            <li><p><strong>target_currency</strong>  The target currency to convert to.</p></li>
            <li><p><strong>price_map</strong>  A dict of prices, as built by prices.build_price_map().</p></li>
            <li><p><strong>date</strong>  A datetime.date instance to evaluate the value at, or None.</p></li>
            <li><p><strong>via</strong>  A list of currencies to attempt to synthesize an implied rate if the
direct conversion fails.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount, either with a successful value currency conversion, or if we
could not convert the value, the amount itself, unmodified.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_amount</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">via</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the market value of an Amount in a particular currency.</span>

<span class="sd">    In addition, if a conversion rate isn&#39;t available, you can provide a list of</span>
<span class="sd">    currencies to attempt to synthesize a rate for via implied rates.</span>

<span class="sd">    Args:</span>
<span class="sd">      amt: An instance of Amount.</span>
<span class="sd">      target_currency: The target currency to convert to.</span>
<span class="sd">      price_map: A dict of prices, as built by prices.build_price_map().</span>
<span class="sd">      date: A datetime.date instance to evaluate the value at, or None.</span>
<span class="sd">      via: A list of currencies to attempt to synthesize an implied rate if the</span>
<span class="sd">        direct conversion fails.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount, either with a successful value currency conversion, or if we</span>
<span class="sd">      could not convert the value, the amount itself, unmodified.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First, attempt to convert directly. This should be the most</span>
    <span class="c1"># straightforward conversion.</span>
    <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">amt</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># On success, just make the conversion directly.</span>
        <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">amt</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">rate</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">via</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">via</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span>

        <span class="c1"># A price is unavailable, attempt to convert via cost/price currency</span>
        <span class="c1"># hop, if the value currency isn&#39;t the target currency.</span>
        <span class="k">for</span> <span class="n">implied_currency</span> <span class="ow">in</span> <span class="n">via</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">implied_currency</span> <span class="o">==</span> <span class="n">target_currency</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">base_quote1</span> <span class="o">=</span> <span class="p">(</span><span class="n">amt</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">implied_currency</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">rate1</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote1</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rate1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">base_quote2</span> <span class="o">=</span> <span class="p">(</span><span class="n">implied_currency</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">rate2</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote2</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rate2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">amt</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">rate1</span> <span class="o">*</span> <span class="n">rate2</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">)</span>

    <span class="c1"># We failed to infer a conversion rate; return the amt.</span>
    <span class="k">return</span> <span class="n">amt</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.convert.convert_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">convert_position</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.convert.convert_position" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the market value of a Position or Posting in a particular currency.</p>
<p>In addition, if the rate from the position's currency to target_currency
isn't available, an attempt is made to convert from its cost currency, if
one is available.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>pos</strong>  An instance of Position or Posting, equivalently.</p></li>
            <li><p><strong>target_currency</strong>  The target currency to convert to.</p></li>
            <li><p><strong>price_map</strong>  A dict of prices, as built by prices.build_price_map().</p></li>
            <li><p><strong>date</strong>  A datetime.date instance to evaluate the value at, or None.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount, either with a successful value currency conversion, or if we
could not convert the value, just the units, unmodified. (See get_value()
above for details.)</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_position</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the market value of a Position or Posting in a particular currency.</span>

<span class="sd">    In addition, if the rate from the position&#39;s currency to target_currency</span>
<span class="sd">    isn&#39;t available, an attempt is made to convert from its cost currency, if</span>
<span class="sd">    one is available.</span>

<span class="sd">    Args:</span>
<span class="sd">      pos: An instance of Position or Posting, equivalently.</span>
<span class="sd">      target_currency: The target currency to convert to.</span>
<span class="sd">      price_map: A dict of prices, as built by prices.build_price_map().</span>
<span class="sd">      date: A datetime.date instance to evaluate the value at, or None.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount, either with a successful value currency conversion, or if we</span>
<span class="sd">      could not convert the value, just the units, unmodified. (See get_value()</span>
<span class="sd">      above for details.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>
    <span class="n">value_currency</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pos</span><span class="o">.</span><span class="n">price</span> <span class="ow">and</span> <span class="n">pos</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="ow">or</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">convert_amount</span><span class="p">(</span>
        <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">target_currency</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">via</span><span class="o">=</span><span class="p">(</span><span class="n">value_currency</span><span class="p">,)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.convert.get_cost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>


<a href="#beancount.core.convert.get_cost" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the total cost of a Position or Posting.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>pos</strong>  An instance of Position or Posting, equivalently.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_cost</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the total cost of a Position or Posting.</span>

<span class="sd">    Args:</span>
<span class="sd">      pos: An instance of Position or Posting, equivalently.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">Position</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Posting&quot;</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">Amount</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">))</span>
        <span class="k">else</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.convert.get_units" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">get_units</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>


<a href="#beancount.core.convert.get_units" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the units of a Position or Posting.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>pos</strong>  An instance of Position or Posting, equivalently.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_units</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the units of a Position or Posting.</span>

<span class="sd">    Args:</span>
<span class="sd">      pos: An instance of Position or Posting, equivalently.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">Position</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Posting&quot;</span>
    <span class="k">return</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.convert.get_value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_date_prices</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.convert.get_value" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the market value of a Position or Posting.</p>
<p>Note that if the position is not held at cost, this does not convert
anything, even if a price is available in the 'price_map'. We don't specify
a target currency here. If you're attempting to make such a conversion, see
<code>convert_*()</code> functions below. However, is the object is a posting and it
has a price, we will use that price to infer the target currency and those
will be converted.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>pos</strong>  An instance of Position or Posting, equivalently.</p></li>
            <li><p><strong>price_map</strong>  A dict of prices, as built by prices.build_price_map().</p></li>
            <li><p><strong>date</strong>  A datetime.date instance to evaluate the value at, or None.</p></li>
            <li><p><strong>output_date_prices</strong>  An optional output list of (date, price). If this list
is provided, it will be appended to (mutated) to output the price
pulled in making the conversions.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount, either with a successful value currency conversion, or if we
could not convert the value, just the units, unmodified. This is designed
so that you could reduce an inventory with this and not lose any
information silently in case of failure to convert (possibly due to an
empty price map). Compare the returned currency to that of the input
position if you need to check for success.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">price_map</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_date_prices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the market value of a Position or Posting.</span>

<span class="sd">    Note that if the position is not held at cost, this does not convert</span>
<span class="sd">    anything, even if a price is available in the &#39;price_map&#39;. We don&#39;t specify</span>
<span class="sd">    a target currency here. If you&#39;re attempting to make such a conversion, see</span>
<span class="sd">    ``convert_*()`` functions below. However, is the object is a posting and it</span>
<span class="sd">    has a price, we will use that price to infer the target currency and those</span>
<span class="sd">    will be converted.</span>

<span class="sd">    Args:</span>
<span class="sd">      pos: An instance of Position or Posting, equivalently.</span>
<span class="sd">      price_map: A dict of prices, as built by prices.build_price_map().</span>
<span class="sd">      date: A datetime.date instance to evaluate the value at, or None.</span>
<span class="sd">      output_date_prices: An optional output list of (date, price). If this list</span>
<span class="sd">        is provided, it will be appended to (mutated) to output the price</span>
<span class="sd">        pulled in making the conversions.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount, either with a successful value currency conversion, or if we</span>
<span class="sd">      could not convert the value, just the units, unmodified. This is designed</span>
<span class="sd">      so that you could reduce an inventory with this and not lose any</span>
<span class="sd">      information silently in case of failure to convert (possibly due to an</span>
<span class="sd">      empty price map). Compare the returned currency to that of the input</span>
<span class="sd">      position if you need to check for success.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">Position</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Posting&quot;</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>

    <span class="c1"># Try to infer what the cost/price currency should be.</span>
    <span class="n">value_currency</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pos</span><span class="o">.</span><span class="n">price</span> <span class="ow">and</span> <span class="n">pos</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="ow">or</span> <span class="kc">None</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_currency</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># We have a value currency; hit the price database.</span>
        <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">value_currency</span><span class="p">)</span>
        <span class="n">price_date</span><span class="p">,</span> <span class="n">price_number</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_date_prices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_date_prices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">price_date</span><span class="p">,</span> <span class="n">price_number</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">price_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">price_number</span><span class="p">,</span> <span class="n">value_currency</span><span class="p">)</span>

    <span class="c1"># We failed to infer a conversion rate; return the units.</span>
    <span class="k">return</span> <span class="n">units</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.convert.get_weight" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>


<a href="#beancount.core.convert.get_weight" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the weight of a Position or Posting.</p>
<p>This is the amount that will need to be balanced from a posting of a
transaction.</p>
<p>This is a <em>key</em> element of the semantics of transactions in this software. A
balance amount is the amount used to check the balance of a transaction.
Here are all relevant examples, with the amounts used to balance the
postings:</p>
<pre><code>Assets:Account  5234.50 USD                             -&amp;gt;  5234.50 USD
Assets:Account  3877.41 EUR @ 1.35 USD                  -&amp;gt;  5234.50 USD
Assets:Account       10 HOOL {523.45 USD}               -&amp;gt;  5234.50 USD
Assets:Account       10 HOOL {523.45 USD} @ 545.60 CAD  -&amp;gt;  5234.50 USD
</code></pre>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>pos</strong>  An instance of Position or Posting, equivalently.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Amount.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/convert.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_weight</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the weight of a Position or Posting.</span>

<span class="sd">    This is the amount that will need to be balanced from a posting of a</span>
<span class="sd">    transaction.</span>

<span class="sd">    This is a *key* element of the semantics of transactions in this software. A</span>
<span class="sd">    balance amount is the amount used to check the balance of a transaction.</span>
<span class="sd">    Here are all relevant examples, with the amounts used to balance the</span>
<span class="sd">    postings:</span>

<span class="sd">        Assets:Account  5234.50 USD                             -&gt;  5234.50 USD</span>
<span class="sd">        Assets:Account  3877.41 EUR @ 1.35 USD                  -&gt;  5234.50 USD</span>
<span class="sd">        Assets:Account       10 HOOL {523.45 USD}               -&gt;  5234.50 USD</span>
<span class="sd">        Assets:Account       10 HOOL {523.45 USD} @ 545.60 CAD  -&gt;  5234.50 USD</span>

<span class="sd">    Args:</span>
<span class="sd">      pos: An instance of Position or Posting, equivalently.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Amount.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">Position</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Posting&quot;</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span>

    <span class="c1"># It the object has a cost, use that as the weight, to balance.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">Amount</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Otherwise use the postings.</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">units</span>

        <span class="c1"># Unless there is a price available; use that if present.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">Position</span><span class="p">):</span>
            <span class="n">price</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">price</span>
            <span class="k">if</span> <span class="n">price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Note: Here we could assert that price.currency == units.currency.</span>
                <span class="k">if</span> <span class="n">price</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="n">MISSING</span> <span class="ow">or</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="n">MISSING</span><span class="p">:</span>
                    <span class="n">converted_number</span> <span class="o">=</span> <span class="n">MISSING</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">converted_number</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">number</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">Amount</span><span class="p">(</span><span class="n">converted_number</span><span class="p">,</span> <span class="n">price</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">weight</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.data" class="doc doc-heading">
        <code>beancount.core.data</code>



<a href="#beancount.core.data" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Basic data structures used to represent the Ledger entries.</p>



  <div class="doc doc-children">





















  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Balance" class="doc doc-heading">
        <code>
beancount.core.data.Balance            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Balance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A "check the balance of this account" directive. This directive asserts that
the declared account should have a known number of units of a particular
currency at the beginning of its date. This is essentially an assertion, and
corresponds to the final "Statement Balance" line of a real-world statement.
These assertions act as checkpoints to help ensure that you have entered your
transactions correctly.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account whose balance to check at the given date.</p></td>
      </tr>
      <tr>
        <td><code>amount</code></td>
        <td><code>Amount</code></td>
        <td><p>An Amount, the number of units of the given currency you're
expecting 'account' to have at this date.</p></td>
      </tr>
      <tr>
        <td><code>diff_amount</code></td>
        <td><code>Optional[beancount.core.amount.Amount]</code></td>
        <td><p>None if the balance check succeeds. This value is set to
an Amount instance if the balance fails, the amount of the difference.</p></td>
      </tr>
      <tr>
        <td><code>tolerance</code></td>
        <td><code>Optional[decimal.Decimal]</code></td>
        <td><p>A Decimal object, the amount of tolerance to use in the
verification.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Balance.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Balance.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Balance.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">diff_amount</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Balance.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Balance(meta, date, account, amount, tolerance, diff_amount)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Balance.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Balance.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Close" class="doc doc-heading">
        <code>
beancount.core.data.Close            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Close" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A "close account" directive.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account that is being closed.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Close.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Close.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Close.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Close.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Close(meta, date, account)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Close.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Close.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Commodity" class="doc doc-heading">
        <code>
beancount.core.data.Commodity            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Commodity" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An optional commodity declaration directive. Commodities generally do not need
to be declared, but they may, and this is mainly created as intended to be
used to attach meta-data on a commodity name. Whenever a plugin needs
per-commodity meta-data, you would define such a commodity directive. Another
use is to define a commodity that isn't otherwise (yet) used anywhere in an
input file. (At the moment the date is meaningless but is specified for
coherence with all the other directives; if you can think of a good use case,
let us know).</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>currency</code></td>
        <td><code>str</code></td>
        <td><p>A string, the commodity under consideration.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Commodity.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Commodity</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Commodity.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Commodity.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Commodity</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Commodity.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Commodity(meta, date, currency)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Commodity.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Commodity</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Commodity.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Custom" class="doc doc-heading">
        <code>
beancount.core.data.Custom            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Custom" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A custom directive. This directive can be used to implement new experimental
dated features in the Beancount file. This is meant as an intermediate measure
to be used when you would need to implement a new directive in a plugin. These
directives will be parsed liberally... any list of tokens are supported. All
that is required is some unique name for them that acts as a "type". These
directives are included in the stream and a plugin should be able to gather
them.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>type</code></td>
        <td><code>str</code></td>
        <td><p>A string that represents the type of the directive.</p></td>
      </tr>
      <tr>
        <td><code>values</code></td>
        <td><code>List</code></td>
        <td><p>A list of values of various simple types supported by the grammar.
(Note that this list is not enforced to be consistent for all directives
of the same type by the parser.)</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Custom.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Custom</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Custom.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Custom.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Custom</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Custom.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Custom(meta, date, type, values)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Custom.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Custom</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Custom.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Document" class="doc doc-heading">
        <code>
beancount.core.data.Document            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Document" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A document file declaration directive. This directive is used to attach a
statement to an account, at a particular date. A typical usage would be to
render PDF files or scans of your bank statements into the account's journal.
While you can explicitly create those directives in the input syntax, it is
much more convenient to provide Beancount with a root directory to search for
filenames in a hierarchy mirroring the chart of accounts, filenames which
should match the following dated format: "YYYY-MM-DD.*". See options for
detail. Beancount will automatically create these documents directives based
on the file hierarchy, and you can get them by parsing the list of entries.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account which the statement or document is associated
with.</p></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The absolute filename of the document file.</p></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>Optional[Set]</code></td>
        <td><p>A set of tag strings (without the '#'), or None, if an empty set.</p></td>
      </tr>
      <tr>
        <td><code>links</code></td>
        <td><code>Optional[Set]</code></td>
        <td><p>A set of link strings (without the '^'), or None, if an empty set.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Document.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Document</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Document.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Document.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Document</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">links</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Document.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Document(meta, date, account, filename, tags, links)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Document.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Document</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Document.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Event" class="doc doc-heading">
        <code>
beancount.core.data.Event            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Event" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An "event value change" directive. These directives are used as string
variables that have different values over time. You can use these to track an
address, your location, your current employer, anything you like. The kind of
reporting that is made of these generic events is based on days and a
timeline. For instance, if you need to track the number of days you spend in
each country or state, create a "location" event and whenever you travel, add
an event directive to indicate its new value. You should be able to write
simple scripts against those in order to compute if you were present somewhere
for a particular number of days. Here's an illustrative example usage, in
order to maintain your health insurance coverage in Canada, you need to be
present in the country for 183 days or more, excluding trips of less than 30
days. There is a similar test to be done in the US by aliens to figure out if
they need to be considered as residents for tax purposes (the so-called
"substantial presence test"). By integrating these directives into your
bookkeeping, you can easily have a little program that computes the tests for
you. This is, of course, entirely optional and somewhat auxiliary to the main
purpose of double-entry bookkeeping, but correlates strongly with the
transactions you insert in it, and so it's a really convenient thing to have
in the same input file.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>&#34;type&#34;</code></td>
        <td></td>
        <td><p>A short string, typically a single lowercase word, that defines a
unique variable whose value changes over time. For example, 'location'.</p></td>
      </tr>
      <tr>
        <td><code>description</code></td>
        <td><code>str</code></td>
        <td><p>A free-form string, the value of the variable as of the date
of the transaction.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Event.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Event.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Event.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Event.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Event(meta, date, type, description)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Event.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Event.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Note" class="doc doc-heading">
        <code>
beancount.core.data.Note            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Note" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A note directive, a general note that is attached to an account. These are
used to attach text at a particular date in a specific account. The notes can
be anything; a typical use would be to jot down an answer from a phone call to
the institution represented by the account. It should show up in an account's
journal. If you don't want this rendered, use the comment syntax in the input
file, which does not get parsed and stored.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account which the note is to be attached to. This is
never None, notes always have an account they correspond to.</p></td>
      </tr>
      <tr>
        <td><code>comment</code></td>
        <td><code>str</code></td>
        <td><p>A free-form string, the text of the note. This can be long if you
want it to.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Note.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Note</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Note.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Note.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Note</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">links</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Note.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Note(meta, date, account, comment, tags, links)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Note.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Note</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Note.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Open" class="doc doc-heading">
        <code>
beancount.core.data.Open            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Open" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An "open account" directive.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account that is being opened.</p></td>
      </tr>
      <tr>
        <td><code>currencies</code></td>
        <td><code>List[str]</code></td>
        <td><p>A list of strings, currencies that are allowed in this account.
May be None, in which case it means that there are no restrictions on which
currencies may be stored in this account.</p></td>
      </tr>
      <tr>
        <td><code>booking</code></td>
        <td><code>Optional[beancount.core.data.Booking]</code></td>
        <td><p>A Booking enum, the booking method to use to disambiguate
postings to this account (when zero or more than one postings match the
specification), or None if not specified. In practice, this attribute will
be should be left unspecified (None) in the vast majority of cases. See
Booking below for a selection of valid methods.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Open.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Open.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Open.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">currencies</span><span class="p">,</span> <span class="n">booking</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Open.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Open(meta, date, account, currencies, booking)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Open.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Open</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Open.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Pad" class="doc doc-heading">
        <code>
beancount.core.data.Pad            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Pad" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A "pad this account with this other account" directive. This directive
automatically inserts transactions that will make the next chronological
balance directive succeeds. It can be used to fill in missing date ranges of
transactions, as a convenience. You don't have to use this, it's sugar coating
in case you need it, while you're entering past history into your Ledger.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account which needs to be filled.</p></td>
      </tr>
      <tr>
        <td><code>source_account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account which is used to debit from
in order to fill 'account'.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Pad.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Pad</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Pad.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Pad.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Pad</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">source_account</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Pad.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Pad(meta, date, account, source_account)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Pad.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Pad</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Pad.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Posting" class="doc doc-heading">
        <code>
beancount.core.data.Posting            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Posting" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Postings are contained in Transaction entries. These represent the individual
legs of a transaction. Note: a posting may only appear within a single entry
(multiple transactions may not share a Posting instance), and that's what the
entry field should be set to.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account that is modified by this posting.</p></td>
      </tr>
      <tr>
        <td><code>units</code></td>
        <td><code>Optional[beancount.core.amount.Amount]</code></td>
        <td><p>An Amount, the units of the position, or None if it is to be
inferred from the other postings in the transaction.</p></td>
      </tr>
      <tr>
        <td><code>cost</code></td>
        <td><code>Union[beancount.core.position.Cost, beancount.core.position.CostSpec]</code></td>
        <td><p>A Cost or CostSpec instances, the units of the position.</p></td>
      </tr>
      <tr>
        <td><code>price</code></td>
        <td><code>Optional[beancount.core.amount.Amount]</code></td>
        <td><p>An Amount, the price at which the position took place, or
None, where not relevant. Providing a price member to a posting
automatically adds a price in the prices database at the date of the
transaction.</p></td>
      </tr>
      <tr>
        <td><code>flag</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>An optional flag, a one-character string or None, which is to be
associated with the posting. Most postings don't have a flag, but it can
be convenient to mark a particular posting as problematic or pending to
be reconciled for a future import of its account.</p></td>
      </tr>
      <tr>
        <td><code>meta</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>A dict of strings to values, the metadata that was attached
specifically to that posting, or None, if not provided. In practice, most
of the instances will be unlikely to have metadata.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Posting.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Posting.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Posting.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">meta</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Posting.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Posting(account, units, cost, price, flag, meta)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Posting.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Posting</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Posting.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Price" class="doc doc-heading">
        <code>
beancount.core.data.Price            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Price" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A price declaration directive. This establishes the price of a currency in
terms of another currency as of the directive's date. A history of the prices
for each currency pairs is built and can be queried within the bookkeeping
system. Note that because Beancount does not store any data at time-of-day
resolution, it makes no sense to have multiple price directives at the same
date. (Beancount will not attempt to solve this problem; this is beyond the
general scope of double-entry bookkeeping and if you need to build a day
trading system, you should probably use something else).</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
  </tbody>
</table>      <p>currency: A string, the currency that is being priced, e.g. HOOL.
 amount: An instance of Amount, the number of units and currency that
   'currency' is worth, for instance 1200.12 USD.</p>




  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Price.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Price.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Price.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Price.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Price(meta, date, currency, amount)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Price.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Price.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Query" class="doc doc-heading">
        <code>
beancount.core.data.Query            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Query" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A named query declaration. This directive is used to create pre-canned queries
that can then be automatically run or made available to the shell, or perhaps be
rendered as part of a web interface. The purpose of this routine is to define
useful queries for the context of the particular given Beancount input file.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>The date at which this query should be run. All directives following
this date will be ignored automatically. This is essentially equivalent to
the CLOSE modifier in the shell syntax.</p></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>A string, the unique identifier for the query.</p></td>
      </tr>
      <tr>
        <td><code>query_string</code></td>
        <td><code>str</code></td>
        <td><p>The SQL query string to be run or made available.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Query.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Query</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Query.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Query.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Query</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Query.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Query(meta, date, name, query_string)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Query.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Query</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Query.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.Transaction" class="doc doc-heading">
        <code>
beancount.core.data.Transaction            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.Transaction" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A transaction! This is the main type of object that we manipulate, and the
entire reason this whole project exists in the first place, because
representing these types of structures with a spreadsheet is difficult.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>flag</code></td>
        <td><code>str</code></td>
        <td><p>A single-character string or None. This user-specified string
represents some custom/user-defined state of the transaction. You can use
this for various purposes. Otherwise common, pre-defined flags are defined
under beancount.core.flags, to flags transactions that are automatically
generated.</p></td>
      </tr>
      <tr>
        <td><code>payee</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>A free-form string that identifies the payee, or None, if absent.</p></td>
      </tr>
      <tr>
        <td><code>narration</code></td>
        <td><code>str</code></td>
        <td><p>A free-form string that provides a description for the transaction.
All transactions have at least a narration string, this is never None.</p></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>FrozenSet</code></td>
        <td><p>A set of tag strings (without the '#'), or EMPTY_SET.</p></td>
      </tr>
      <tr>
        <td><code>links</code></td>
        <td><code>FrozenSet</code></td>
        <td><p>A set of link strings (without the '^'), or EMPTY_SET.</p></td>
      </tr>
      <tr>
        <td><code>postings</code></td>
        <td><code>List[beancount.core.data.Posting]</code></td>
        <td><p>A list of Posting instances, the legs of this transaction. See the
doc under Posting above.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">

















  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Transaction.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Transaction.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Transaction.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">payee</span><span class="p">,</span> <span class="n">narration</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">links</span><span class="p">,</span> <span class="n">postings</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.Transaction.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Transaction(meta, date, flag, payee, narration, tags, links, postings)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.Transaction.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.Transaction.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.TxnPosting" class="doc doc-heading">
        <code>
beancount.core.data.TxnPosting            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.TxnPosting" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A pair of a Posting and its parent Transaction. This is inserted as
temporaries in lists of postings-of-entries, which is the product of a
realization.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>txn</code></td>
        <td><code>Transaction</code></td>
        <td><p>The parent Transaction instance.</p></td>
      </tr>
      <tr>
        <td><code>posting</code></td>
        <td><code>Posting</code></td>
        <td><p>The Posting instance.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">











  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.TxnPosting.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TxnPosting</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.TxnPosting.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.TxnPosting.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TxnPosting</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">txn</span><span class="p">,</span> <span class="n">posting</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.TxnPosting.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of TxnPosting(txn, posting)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.data.TxnPosting.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TxnPosting</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.TxnPosting.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.data.dtypes" class="doc doc-heading">
        <code>
beancount.core.data.dtypes        </code>



<a href="#beancount.core.data.dtypes" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Types of directives.</p>




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Balance" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Balance            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Balance" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A "check the balance of this account" directive. This directive asserts that
the declared account should have a known number of units of a particular
currency at the beginning of its date. This is essentially an assertion, and
corresponds to the final "Statement Balance" line of a real-world statement.
These assertions act as checkpoints to help ensure that you have entered your
transactions correctly.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account whose balance to check at the given date.</p></td>
      </tr>
      <tr>
        <td><code>amount</code></td>
        <td><code>Amount</code></td>
        <td><p>An Amount, the number of units of the given currency you're
expecting 'account' to have at this date.</p></td>
      </tr>
      <tr>
        <td><code>diff_amount</code></td>
        <td><code>Optional[beancount.core.amount.Amount]</code></td>
        <td><p>None if the balance check succeeds. This value is set to
an Amount instance if the balance fails, the amount of the difference.</p></td>
      </tr>
      <tr>
        <td><code>tolerance</code></td>
        <td><code>Optional[decimal.Decimal]</code></td>
        <td><p>A Decimal object, the amount of tolerance to use in the
verification.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Balance.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Balance.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Balance.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">diff_amount</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Balance.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Balance(meta, date, account, amount, tolerance, diff_amount)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Balance.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Balance</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Balance.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Close" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Close            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Close" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A "close account" directive.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account that is being closed.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Close.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Close.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Close.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Close.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Close(meta, date, account)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Close.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Close.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Commodity" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Commodity            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Commodity" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>An optional commodity declaration directive. Commodities generally do not need
to be declared, but they may, and this is mainly created as intended to be
used to attach meta-data on a commodity name. Whenever a plugin needs
per-commodity meta-data, you would define such a commodity directive. Another
use is to define a commodity that isn't otherwise (yet) used anywhere in an
input file. (At the moment the date is meaningless but is specified for
coherence with all the other directives; if you can think of a good use case,
let us know).</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>currency</code></td>
        <td><code>str</code></td>
        <td><p>A string, the commodity under consideration.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Commodity.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Commodity</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Commodity.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Commodity.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Commodity</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Commodity.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Commodity(meta, date, currency)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Commodity.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Commodity</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Commodity.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Custom" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Custom            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Custom" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A custom directive. This directive can be used to implement new experimental
dated features in the Beancount file. This is meant as an intermediate measure
to be used when you would need to implement a new directive in a plugin. These
directives will be parsed liberally... any list of tokens are supported. All
that is required is some unique name for them that acts as a "type". These
directives are included in the stream and a plugin should be able to gather
them.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>type</code></td>
        <td><code>str</code></td>
        <td><p>A string that represents the type of the directive.</p></td>
      </tr>
      <tr>
        <td><code>values</code></td>
        <td><code>List</code></td>
        <td><p>A list of values of various simple types supported by the grammar.
(Note that this list is not enforced to be consistent for all directives
of the same type by the parser.)</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Custom.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Custom</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Custom.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Custom.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Custom</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Custom.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Custom(meta, date, type, values)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Custom.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Custom</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Custom.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Document" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Document            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Document" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A document file declaration directive. This directive is used to attach a
statement to an account, at a particular date. A typical usage would be to
render PDF files or scans of your bank statements into the account's journal.
While you can explicitly create those directives in the input syntax, it is
much more convenient to provide Beancount with a root directory to search for
filenames in a hierarchy mirroring the chart of accounts, filenames which
should match the following dated format: "YYYY-MM-DD.*". See options for
detail. Beancount will automatically create these documents directives based
on the file hierarchy, and you can get them by parsing the list of entries.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account which the statement or document is associated
with.</p></td>
      </tr>
      <tr>
        <td><code>filename</code></td>
        <td><code>str</code></td>
        <td><p>The absolute filename of the document file.</p></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>Optional[Set]</code></td>
        <td><p>A set of tag strings (without the '#'), or None, if an empty set.</p></td>
      </tr>
      <tr>
        <td><code>links</code></td>
        <td><code>Optional[Set]</code></td>
        <td><p>A set of link strings (without the '^'), or None, if an empty set.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Document.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Document</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Document.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Document.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Document</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">links</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Document.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Document(meta, date, account, filename, tags, links)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Document.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Document</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Document.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Event" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Event            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Event" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>An "event value change" directive. These directives are used as string
variables that have different values over time. You can use these to track an
address, your location, your current employer, anything you like. The kind of
reporting that is made of these generic events is based on days and a
timeline. For instance, if you need to track the number of days you spend in
each country or state, create a "location" event and whenever you travel, add
an event directive to indicate its new value. You should be able to write
simple scripts against those in order to compute if you were present somewhere
for a particular number of days. Here's an illustrative example usage, in
order to maintain your health insurance coverage in Canada, you need to be
present in the country for 183 days or more, excluding trips of less than 30
days. There is a similar test to be done in the US by aliens to figure out if
they need to be considered as residents for tax purposes (the so-called
"substantial presence test"). By integrating these directives into your
bookkeeping, you can easily have a little program that computes the tests for
you. This is, of course, entirely optional and somewhat auxiliary to the main
purpose of double-entry bookkeeping, but correlates strongly with the
transactions you insert in it, and so it's a really convenient thing to have
in the same input file.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>&#34;type&#34;</code></td>
        <td></td>
        <td><p>A short string, typically a single lowercase word, that defines a
unique variable whose value changes over time. For example, 'location'.</p></td>
      </tr>
      <tr>
        <td><code>description</code></td>
        <td><code>str</code></td>
        <td><p>A free-form string, the value of the variable as of the date
of the transaction.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Event.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Event.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Event.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Event.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Event(meta, date, type, description)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Event.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Event.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Note" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Note            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Note" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A note directive, a general note that is attached to an account. These are
used to attach text at a particular date in a specific account. The notes can
be anything; a typical use would be to jot down an answer from a phone call to
the institution represented by the account. It should show up in an account's
journal. If you don't want this rendered, use the comment syntax in the input
file, which does not get parsed and stored.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the account which the note is to be attached to. This is
never None, notes always have an account they correspond to.</p></td>
      </tr>
      <tr>
        <td><code>comment</code></td>
        <td><code>str</code></td>
        <td><p>A free-form string, the text of the note. This can be long if you
want it to.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Note.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Note</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Note.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Note.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Note</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">links</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Note.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Note(meta, date, account, comment, tags, links)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Note.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Note</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Note.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Open" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Open            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Open" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>An "open account" directive.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account that is being opened.</p></td>
      </tr>
      <tr>
        <td><code>currencies</code></td>
        <td><code>List[str]</code></td>
        <td><p>A list of strings, currencies that are allowed in this account.
May be None, in which case it means that there are no restrictions on which
currencies may be stored in this account.</p></td>
      </tr>
      <tr>
        <td><code>booking</code></td>
        <td><code>Optional[beancount.core.data.Booking]</code></td>
        <td><p>A Booking enum, the booking method to use to disambiguate
postings to this account (when zero or more than one postings match the
specification), or None if not specified. In practice, this attribute will
be should be left unspecified (None) in the vast majority of cases. See
Booking below for a selection of valid methods.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Open.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Open</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Open.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Open.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Open</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">currencies</span><span class="p">,</span> <span class="n">booking</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Open.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Open(meta, date, account, currencies, booking)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Open.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Open</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Open.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Pad" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Pad            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Pad" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A "pad this account with this other account" directive. This directive
automatically inserts transactions that will make the next chronological
balance directive succeeds. It can be used to fill in missing date ranges of
transactions, as a convenience. You don't have to use this, it's sugar coating
in case you need it, while you're entering past history into your Ledger.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account which needs to be filled.</p></td>
      </tr>
      <tr>
        <td><code>source_account</code></td>
        <td><code>str</code></td>
        <td><p>A string, the name of the account which is used to debit from
in order to fill 'account'.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Pad.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Pad</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Pad.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Pad.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Pad</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">source_account</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Pad.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Pad(meta, date, account, source_account)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Pad.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Pad</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Pad.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Price" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Price            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Price" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A price declaration directive. This establishes the price of a currency in
terms of another currency as of the directive's date. A history of the prices
for each currency pairs is built and can be queried within the bookkeeping
system. Note that because Beancount does not store any data at time-of-day
resolution, it makes no sense to have multiple price directives at the same
date. (Beancount will not attempt to solve this problem; this is beyond the
general scope of double-entry bookkeeping and if you need to build a day
trading system, you should probably use something else).</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
  </tbody>
</table>      <p>currency: A string, the currency that is being priced, e.g. HOOL.
 amount: An instance of Amount, the number of units and currency that
   'currency' is worth, for instance 1200.12 USD.</p>




  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Price.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Price.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Price.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Price.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Price(meta, date, currency, amount)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Price.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Price.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Query" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Query            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Query" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A named query declaration. This directive is used to create pre-canned queries
that can then be automatically run or made available to the shell, or perhaps be
rendered as part of a web interface. The purpose of this routine is to define
useful queries for the context of the particular given Beancount input file.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>The date at which this query should be run. All directives following
this date will be ignored automatically. This is essentially equivalent to
the CLOSE modifier in the shell syntax.</p></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>A string, the unique identifier for the query.</p></td>
      </tr>
      <tr>
        <td><code>query_string</code></td>
        <td><code>str</code></td>
        <td><p>The SQL query string to be run or made available.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Query.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Query</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Query.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Query.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Query</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Query.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Query(meta, date, name, query_string)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Query.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Query</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Query.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="beancount.core.data.dtypes.Transaction" class="doc doc-heading">
        <code>
beancount.core.data.dtypes.Transaction            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.data.dtypes.Transaction" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A transaction! This is the main type of object that we manipulate, and the
entire reason this whole project exists in the first place, because
representing these types of structures with a spreadsheet is difficult.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>meta</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>date</code></td>
        <td><code>date</code></td>
        <td><p>See above.</p></td>
      </tr>
      <tr>
        <td><code>flag</code></td>
        <td><code>str</code></td>
        <td><p>A single-character string or None. This user-specified string
represents some custom/user-defined state of the transaction. You can use
this for various purposes. Otherwise common, pre-defined flags are defined
under beancount.core.flags, to flags transactions that are automatically
generated.</p></td>
      </tr>
      <tr>
        <td><code>payee</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>A free-form string that identifies the payee, or None, if absent.</p></td>
      </tr>
      <tr>
        <td><code>narration</code></td>
        <td><code>str</code></td>
        <td><p>A free-form string that provides a description for the transaction.
All transactions have at least a narration string, this is never None.</p></td>
      </tr>
      <tr>
        <td><code>tags</code></td>
        <td><code>FrozenSet</code></td>
        <td><p>A set of tag strings (without the '#'), or EMPTY_SET.</p></td>
      </tr>
      <tr>
        <td><code>links</code></td>
        <td><code>FrozenSet</code></td>
        <td><p>A set of link strings (without the '^'), or EMPTY_SET.</p></td>
      </tr>
      <tr>
        <td><code>postings</code></td>
        <td><code>List[beancount.core.data.Posting]</code></td>
        <td><p>A list of Posting instances, the legs of this transaction. See the
doc under Posting above.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">

















  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Transaction.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Transaction.__getnewargs__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Transaction.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">payee</span><span class="p">,</span> <span class="n">narration</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">links</span><span class="p">,</span> <span class="n">postings</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Transaction.__new__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Create new instance of Transaction(meta, date, flag, payee, narration, tags, links, postings)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h5 id="beancount.core.data.dtypes.Transaction.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">Transaction</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.data.dtypes.Transaction.__repr__" class="headerlink" title="Permanent link"></a></h5>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.create_simple_posting" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">create_simple_posting</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span></code>


<a href="#beancount.core.data.create_simple_posting" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create a simple posting on the entry, with just a number and currency (no cost).</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  The entry instance to add the posting to.</p></li>
            <li><p><strong>account</strong>  A string, the account to use on the posting.</p></li>
            <li><p><strong>number</strong>  A Decimal number or string to use in the posting's Amount.</p></li>
            <li><p><strong>currency</strong>  A string, the currency for the Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Posting, and as a side-effect the entry has had its list of
postings modified with the new Posting instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_simple_posting</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a simple posting on the entry, with just a number and currency (no cost).</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: The entry instance to add the posting to.</span>
<span class="sd">      account: A string, the account to use on the posting.</span>
<span class="sd">      number: A Decimal number or string to use in the posting&#39;s Amount.</span>
<span class="sd">      currency: A string, the currency for the Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Posting, and as a side-effect the entry has had its list of</span>
<span class="sd">      postings modified with the new Posting instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="n">number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
    <span class="n">posting</span> <span class="o">=</span> <span class="n">Posting</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">posting</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.create_simple_posting_with_cost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">create_simple_posting_with_cost</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">)</span></code>


<a href="#beancount.core.data.create_simple_posting_with_cost" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create a simple posting on the entry, with just a number and currency (no cost).</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  The entry instance to add the posting to.</p></li>
            <li><p><strong>account</strong>  A string, the account to use on the posting.</p></li>
            <li><p><strong>number</strong>  A Decimal number or string to use in the posting's Amount.</p></li>
            <li><p><strong>currency</strong>  A string, the currency for the Amount.</p></li>
            <li><p><strong>cost_number</strong>  A Decimal number or string to use for the posting's cost Amount.</p></li>
            <li><p><strong>cost_currency</strong>  a string, the currency for the cost Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Posting, and as a side-effect the entry has had its list of
postings modified with the new Posting instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_simple_posting_with_cost</span><span class="p">(</span>
    <span class="n">entry</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a simple posting on the entry, with just a number and currency (no cost).</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: The entry instance to add the posting to.</span>
<span class="sd">      account: A string, the account to use on the posting.</span>
<span class="sd">      number: A Decimal number or string to use in the posting&#39;s Amount.</span>
<span class="sd">      currency: A string, the currency for the Amount.</span>
<span class="sd">      cost_number: A Decimal number or string to use for the posting&#39;s cost Amount.</span>
<span class="sd">      cost_currency: a string, the currency for the cost Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Posting, and as a side-effect the entry has had its list of</span>
<span class="sd">      postings modified with the new Posting instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cost_number</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost_number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
        <span class="n">cost_number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">cost_number</span><span class="p">)</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">Cost</span><span class="p">(</span><span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">posting</span> <span class="o">=</span> <span class="n">Posting</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">posting</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.entry_sortkey" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">entry_sortkey</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.data.entry_sortkey" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Sort-key for entries. We sort by date, except that checks
should be placed in front of every list of entries of that same day,
in order to balance linearly.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An entry instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A tuple of (date, integer, integer), that forms the sort key for the
entry.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">entry_sortkey</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort-key for entries. We sort by date, except that checks</span>
<span class="sd">    should be placed in front of every list of entries of that same day,</span>
<span class="sd">    in order to balance linearly.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An entry instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A tuple of (date, integer, integer), that forms the sort key for the</span>
<span class="sd">      entry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">SORT_ORDER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;lineno&quot;</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.filter_txns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">filter_txns</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.data.filter_txns" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A generator that yields only the Transaction instances.</p>
<p>This is such an incredibly common operation that it deserves a terse
filtering mechanism.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  A sorted list of only the Transaction directives.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_txns</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A generator that yields only the Transaction instances.</span>

<span class="sd">    This is such an incredibly common operation that it deserves a terse</span>
<span class="sd">    filtering mechanism.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">    Yields:</span>
<span class="sd">      A sorted list of only the Transaction directives.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">entry</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.find_closest" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">find_closest</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">)</span></code>


<a href="#beancount.core.data.find_closest" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Find the closest entry from entries to (filename, lineno).</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
            <li><p><strong>filename</strong>  A string, the name of the ledger file to look for. Be careful
to provide the very same filename, and note that the parser stores the
absolute path of the filename here.</p></li>
            <li><p><strong>lineno</strong>  An integer, the line number closest after the directive we're
looking for. This may be the exact/first line of the directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The closest entry found in the given file for the given filename, or
None, if none could be found.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_closest</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the closest entry from entries to (filename, lineno).</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      filename: A string, the name of the ledger file to look for. Be careful</span>
<span class="sd">        to provide the very same filename, and note that the parser stores the</span>
<span class="sd">        absolute path of the filename here.</span>
<span class="sd">      lineno: An integer, the line number closest after the directive we&#39;re</span>
<span class="sd">        looking for. This may be the exact/first line of the directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The closest entry found in the given file for the given filename, or</span>
<span class="sd">      None, if none could be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min_diffline</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
    <span class="n">closest_entry</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">emeta</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span>
        <span class="k">if</span> <span class="n">emeta</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">emeta</span><span class="p">[</span><span class="s2">&quot;lineno&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">diffline</span> <span class="o">=</span> <span class="n">lineno</span> <span class="o">-</span> <span class="n">emeta</span><span class="p">[</span><span class="s2">&quot;lineno&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">diffline</span> <span class="o">&lt;</span> <span class="n">min_diffline</span><span class="p">:</span>
                <span class="n">min_diffline</span> <span class="o">=</span> <span class="n">diffline</span>
                <span class="n">closest_entry</span> <span class="o">=</span> <span class="n">entry</span>
    <span class="k">return</span> <span class="n">closest_entry</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.get_entry" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get_entry</span><span class="p">(</span><span class="n">posting_or_entry</span><span class="p">)</span></code>


<a href="#beancount.core.data.get_entry" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the entry associated with the posting or entry.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  A TxnPosting or entry instance</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A datetime instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_entry</span><span class="p">(</span><span class="n">posting_or_entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the entry associated with the posting or entry.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A TxnPosting or entry instance</span>
<span class="sd">    Returns:</span>
<span class="sd">      A datetime instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">posting_or_entry</span><span class="o">.</span><span class="n">txn</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting_or_entry</span><span class="p">,</span> <span class="n">TxnPosting</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">posting_or_entry</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.has_entry_account_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">has_entry_account_component</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span></code>


<a href="#beancount.core.data.has_entry_account_component" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if one of the entry's postings has an account component.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  A Transaction entry.</p></li>
            <li><p><strong>component</strong>  A string, a component of an account name. For instance,
<code>Food</code> in <code>Expenses:Food:Restaurant</code>. All components are considered.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Boolean</code>  true if the component is in the account. Note that a component
name must be whole, that is <code>NY</code> is not in <code>Expenses:Taxes:StateNY</code>.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">has_entry_account_component</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if one of the entry&#39;s postings has an account component.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A Transaction entry.</span>
<span class="sd">      component: A string, a component of an account name. For instance,</span>
<span class="sd">        ``Food`` in ``Expenses:Food:Restaurant``. All components are considered.</span>
<span class="sd">    Returns:</span>
<span class="sd">      Boolean: true if the component is in the account. Note that a component</span>
<span class="sd">      name must be whole, that is ``NY`` is not in ``Expenses:Taxes:StateNY``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">has_component</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.iter_entry_dates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iter_entry_dates</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">date_begin</span><span class="p">,</span> <span class="n">date_end</span><span class="p">)</span></code>


<a href="#beancount.core.data.iter_entry_dates" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Iterate over the entries in a date window.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A date-sorted list of dated directives.</p></li>
            <li><p><strong>date_begin</strong>  A datetime.date instance, the first date to include.</p></li>
            <li><p><strong>date_end</strong>  A datetime.date instance, one day beyond the last date.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  Instances of the dated directives, between the dates, and in the order in
  which they appear.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">iter_entry_dates</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">date_begin</span><span class="p">,</span> <span class="n">date_end</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the entries in a date window.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A date-sorted list of dated directives.</span>
<span class="sd">      date_begin: A datetime.date instance, the first date to include.</span>
<span class="sd">      date_end: A datetime.date instance, one day beyond the last date.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Instances of the dated directives, between the dates, and in the order in</span>
<span class="sd">      which they appear.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">getdate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">entry</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
    <span class="n">index_begin</span> <span class="o">=</span> <span class="n">bisect_left_with_key</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">date_begin</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">getdate</span><span class="p">)</span>
    <span class="n">index_end</span> <span class="o">=</span> <span class="n">bisect_left_with_key</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">date_end</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">getdate</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index_begin</span><span class="p">,</span> <span class="n">index_end</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">entries</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.new_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">new_metadata</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">kvlist</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.data.new_metadata" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create a new metadata container from the filename and line number.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>filename</strong>  A string, the filename for the creator of this directive.</p></li>
            <li><p><strong>lineno</strong>  An integer, the line number where the directive has been created.</p></li>
            <li><p><strong>kvlist</strong>  An optional container of key-values.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A metadata dict.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">new_metadata</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">kvlist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new metadata container from the filename and line number.</span>

<span class="sd">    Args:</span>
<span class="sd">      filename: A string, the filename for the creator of this directive.</span>
<span class="sd">      lineno: An integer, the line number where the directive has been created.</span>
<span class="sd">      kvlist: An optional container of key-values.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A metadata dict.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;lineno&quot;</span><span class="p">:</span> <span class="n">lineno</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">kvlist</span><span class="p">:</span>
        <span class="n">meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kvlist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">meta</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.posting_has_conversion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">posting_has_conversion</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span></code>


<a href="#beancount.core.data.posting_has_conversion" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if this position involves a conversion.</p>
<p>A conversion is when there is a price attached to the amount but no cost.
This is used on transactions to convert between units.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>posting</strong>  an instance of Posting</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, true if this posting has a price conversion.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">posting_has_conversion</span><span class="p">(</span><span class="n">posting</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if this position involves a conversion.</span>

<span class="sd">    A conversion is when there is a price attached to the amount but no cost.</span>
<span class="sd">    This is used on transactions to convert between units.</span>

<span class="sd">    Args:</span>
<span class="sd">      posting: an instance of Posting</span>
<span class="sd">    Return:</span>
<span class="sd">      A boolean, true if this posting has a price conversion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">posting</span><span class="o">.</span><span class="n">price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.posting_sortkey" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">posting_sortkey</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.data.posting_sortkey" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Sort-key for entries or postings. We sort by date, except that checks
should be placed in front of every list of entries of that same day,
in order to balance linearly.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  A Posting or entry instance</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A tuple of (date, integer, integer), that forms the sort key for the
posting or entry.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">posting_sortkey</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sort-key for entries or postings. We sort by date, except that checks</span>
<span class="sd">    should be placed in front of every list of entries of that same day,</span>
<span class="sd">    in order to balance linearly.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A Posting or entry instance</span>
<span class="sd">    Returns:</span>
<span class="sd">      A tuple of (date, integer, integer), that forms the sort key for the</span>
<span class="sd">      posting or entry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">TxnPosting</span><span class="p">):</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">txn</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">SORT_ORDER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;lineno&quot;</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.remove_account_postings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">remove_account_postings</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.data.remove_account_postings" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Remove all postings with the given account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account</strong>  A string, the account name whose postings we want to remove.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of entries without the rounding postings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_account_postings</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all postings with the given account.</span>

<span class="sd">    Args:</span>
<span class="sd">      account: A string, the account name whose postings we want to remove.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of entries without the rounding postings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_entries</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="nb">any</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span> <span class="o">==</span> <span class="n">account</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span>
                <span class="n">postings</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">posting</span> <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span> <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span> <span class="o">!=</span> <span class="n">account</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="n">new_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_entries</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.sanity_check_types" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sanity_check_types</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">allow_none_for_tags_and_links</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#beancount.core.data.sanity_check_types" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Check that the entry and its postings has all correct data types.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of one of the entries to be checked.</p></li>
            <li><p><strong>allow_none_for_tags_and_links</strong>  A boolean, whether to allow plugins to
generate Transaction objects with None as value for the 'tags' or 'links'
attributes.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>AssertionError</code>  If there is anything that is unexpected, raises an exception.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sanity_check_types</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">allow_none_for_tags_and_links</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that the entry and its postings has all correct data types.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of one of the entries to be checked.</span>
<span class="sd">      allow_none_for_tags_and_links: A boolean, whether to allow plugins to</span>
<span class="sd">        generate Transaction objects with None as value for the &#39;tags&#39; or &#39;links&#39;</span>
<span class="sd">        attributes.</span>
<span class="sd">    Raises:</span>
<span class="sd">      AssertionError: If there is anything that is unexpected, raises an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">ALL_DIRECTIVES</span><span class="p">),</span> <span class="s2">&quot;Invalid directive type&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="s2">&quot;Invalid type for meta&quot;</span>
    <span class="k">assert</span> <span class="s2">&quot;filename&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="s2">&quot;Missing filename in metadata&quot;</span>
    <span class="k">assert</span> <span class="s2">&quot;lineno&quot;</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="p">,</span> <span class="s2">&quot;Missing line number in metadata&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">),</span> <span class="s2">&quot;Invalid date type&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">flag</span><span class="p">,</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="nb">str</span><span class="p">)),</span> <span class="s2">&quot;Invalid flag type&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">payee</span><span class="p">,</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="nb">str</span><span class="p">)),</span> <span class="s2">&quot;Invalid payee type&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">narration</span><span class="p">,</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="nb">str</span><span class="p">)),</span> <span class="s2">&quot;Invalid narration type&quot;</span>
        <span class="n">set_types</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">NoneType</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">allow_none_for_tags_and_links</span>
            <span class="k">else</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span> <span class="n">set_types</span><span class="p">),</span> <span class="s2">&quot;Invalid tags type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">links</span><span class="p">,</span> <span class="n">set_types</span><span class="p">),</span> <span class="s2">&quot;Invalid links type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s2">&quot;Invalid postings list type&quot;</span>
        <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting</span><span class="p">,</span> <span class="n">Posting</span><span class="p">),</span> <span class="s2">&quot;Invalid posting type&quot;</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;Invalid account type&quot;</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="p">(</span><span class="n">Amount</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">)),</span> <span class="s2">&quot;Invalid units type&quot;</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="p">(</span><span class="n">Cost</span><span class="p">,</span> <span class="n">CostSpec</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">)),</span> <span class="s2">&quot;Invalid cost type&quot;</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">price</span><span class="p">,</span> <span class="p">(</span><span class="n">Amount</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">)),</span> <span class="s2">&quot;Invalid price type&quot;</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">flag</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">)),</span> <span class="s2">&quot;Invalid flag type&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.sorted" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.data.sorted" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A convenience to sort a list of entries, using entry_sortkey().</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A sorted list of directives.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sorted</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A convenience to sort a list of entries, using entry_sortkey().</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A sorted list of directives.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">builtins</span><span class="o">.</span><span class="n">sorted</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">entry_sortkey</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.data.transaction_has_conversion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">transaction_has_conversion</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span></code>


<a href="#beancount.core.data.transaction_has_conversion" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Given a Transaction entry, return true if at least one of
the postings has a price conversion (without an associated
cost). These are the source of non-zero conversion balances.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>transaction</strong>  an instance of a Transaction entry.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, true if this transaction contains at least one posting with a
price conversion.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/data.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">transaction_has_conversion</span><span class="p">(</span><span class="n">transaction</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a Transaction entry, return true if at least one of</span>
<span class="sd">    the postings has a price conversion (without an associated</span>
<span class="sd">    cost). These are the source of non-zero conversion balances.</span>

<span class="sd">    Args:</span>
<span class="sd">      transaction: an instance of a Transaction entry.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if this transaction contains at least one posting with a</span>
<span class="sd">      price conversion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">transaction</span><span class="p">,</span> <span class="n">Transaction</span>
    <span class="p">),</span> <span class="s2">&quot;Invalid type of entry for transaction: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">transaction</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">posting_has_conversion</span><span class="p">(</span><span class="n">posting</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.display_context" class="doc doc-heading">
        <code>beancount.core.display_context</code>



<a href="#beancount.core.display_context" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>A settings class to offer control over the number of digits rendered.</p>
<p>This module contains routines that can accumulate information on the width and
precision of numbers to be rendered and derive the precision required to render
all of them consistently and under certain common alignment requirements. This
is required in order to output neatly lined up columns of numbers in various
styles.</p>
<p>A common case is that the precision can be observed for numbers present in the
input file. This display precision can be used as the "precision by default" if
we write a routine for which it is inconvenient to feed all the numbers to build
such an accumulator.</p>
<p>Here are all the aspects supported by this module:</p>
<p>PRECISION: Numbers for a particular currency are always rendered to the same
  precision, and they can be rendered to one of two precisions; either</p>
<ol>
<li>the most common number of fractional digits, or</li>
<li>the maximum number of digits seen (this is useful for rendering prices).</li>
</ol>
<p>ALIGNMENT: Several alignment methods are supported.</p>
<ul>
<li>
<p>"natural": Render the strings as small as possible with no padding, but to
    their currency's precision. Like this:</p>
<p>'1.2345'
  '764'
  '-7,409.01'
  '0.00000125'</p>
</li>
<li>
<p>"dot-aligned": The periods will align vertically, the left and right sides
    are padded so that the column of numbers has the same width:</p>
<p>'     1.2345    '
  '   764         '
  '-7,409.01      '
  '     0.00000125'</p>
</li>
<li>
<p>"right": The strings are all flushed right, the left side is padded so that
    the column of numbers has the same width:</p>
<p>'     1.2345'
  '        764'
  '  -7,409.01'
  ' 0.00000125'</p>
</li>
</ul>
<p>SIGN: If a negative sign is present in the input numbers, the rendered numbers
  reserve a space for it. If not, then we save the space.</p>
<p>COMMAS: If the user requests to render commas, commas are rendered in the
  output.</p>
<p>RESERVED: A number of extra integral digits reserved on the left in order to
  allow rendering novel numbers that haven't yet been seen. For example,
  balances may contains much larger numbers than the numbers seen in input
  files, and these need to be accommodated when aligning to the right.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-class">



<h3 id="beancount.core.display_context.Align" class="doc doc-heading">
        <code>
beancount.core.display_context.Align            (<span title="enum.Enum">Enum</span>)
        </code>



<a href="#beancount.core.display_context.Align" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Alignment style for numbers.</p>




  <div class="doc doc-children">














  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.display_context.DisplayContext" class="doc doc-heading">
        <code>
beancount.core.display_context.DisplayContext        </code>



<a href="#beancount.core.display_context.DisplayContext" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A builder object used to construct a DisplayContext from a series of numbers.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ccontexts</code></td>
        <td></td>
        <td><p>A dict of currency string to CurrencyContext instance.</p></td>
      </tr>
      <tr>
        <td><code>commas</code></td>
        <td></td>
        <td><p>A bool, true if we should render commas. This just gets propagated
onwards as the default value of to build with.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h4 id="beancount.core.display_context.DisplayContext.build" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayContext</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=&lt;</span><span class="n">Align</span><span class="o">.</span><span class="n">NATURAL</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=&lt;</span><span class="n">Precision</span><span class="o">.</span><span class="n">MOST_COMMON</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">commas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reserved</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#beancount.core.display_context.DisplayContext.build" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Build a formatter for the given display context.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>alignment</strong>  The desired alignment.</p></li>
            <li><p><strong>precision</strong>  The desired precision.</p></li>
            <li><p><strong>commas</strong>  Whether to render commas or not. If 'None', the default value carried
by the context will be used.</p></li>
            <li><p><strong>reserved</strong>  An integer, the number of extra digits to be allocated in
the maximum width calculations.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/display_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">alignment</span><span class="o">=</span><span class="n">Align</span><span class="o">.</span><span class="n">NATURAL</span><span class="p">,</span>
    <span class="n">precision</span><span class="o">=</span><span class="n">Precision</span><span class="o">.</span><span class="n">MOST_COMMON</span><span class="p">,</span>
    <span class="n">commas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">reserved</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a formatter for the given display context.</span>

<span class="sd">    Args:</span>
<span class="sd">      alignment: The desired alignment.</span>
<span class="sd">      precision: The desired precision.</span>
<span class="sd">      commas: Whether to render commas or not. If &#39;None&#39;, the default value carried</span>
<span class="sd">        by the context will be used.</span>
<span class="sd">      reserved: An integer, the number of extra digits to be allocated in</span>
<span class="sd">        the maximum width calculations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">commas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">commas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commas</span>
    <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="n">Align</span><span class="o">.</span><span class="n">NATURAL</span><span class="p">:</span>
        <span class="n">build_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_natural</span>
    <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="n">Align</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
        <span class="n">build_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_right</span>
    <span class="k">elif</span> <span class="n">alignment</span> <span class="o">==</span> <span class="n">Align</span><span class="o">.</span><span class="n">DOT</span><span class="p">:</span>
        <span class="n">build_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_dot</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown alignment: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alignment</span><span class="p">))</span>
    <span class="n">fmtstrings</span> <span class="o">=</span> <span class="n">build_method</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="n">commas</span><span class="p">,</span> <span class="n">reserved</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">DisplayFormatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision</span><span class="p">,</span> <span class="n">fmtstrings</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.display_context.DisplayContext.quantize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayContext</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">precision</span><span class="o">=&lt;</span><span class="n">Precision</span><span class="o">.</span><span class="n">MOST_COMMON</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">)</span></code>


<a href="#beancount.core.display_context.DisplayContext.quantize" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Quantize the given number to the given precision.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>number</strong>  A Decimal instance, the number to be quantized.</p></li>
            <li><p><strong>currency</strong>  A currency string.</p></li>
            <li><p><strong>precision</strong>  Which precision to use.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A Decimal instance, the quantized number.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/display_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">quantize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">Precision</span><span class="o">.</span><span class="n">MOST_COMMON</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quantize the given number to the given precision.</span>

<span class="sd">    Args:</span>
<span class="sd">      number: A Decimal instance, the number to be quantized.</span>
<span class="sd">      currency: A currency string.</span>
<span class="sd">      precision: Which precision to use.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Decimal instance, the quantized number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">),</span> <span class="s2">&quot;Invalid data: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="n">ccontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccontexts</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span>
    <span class="n">num_fractional_digits</span> <span class="o">=</span> <span class="n">ccontext</span><span class="o">.</span><span class="n">get_fractional</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_fractional_digits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Note: We could probably logging.warn() this situation here.</span>
        <span class="k">return</span> <span class="n">number</span>
    <span class="n">qdigit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="o">-</span><span class="n">num_fractional_digits</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
        <span class="c1"># Allow precision for numbers as large as 1 billion in addition to</span>
        <span class="c1"># the required number of fractional digits.</span>
        <span class="c1">#</span>
        <span class="c1"># TODO(blais): Review this to assess performance impact, and whether</span>
        <span class="c1"># we could fold this outside a calling loop.</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">num_fractional_digits</span> <span class="o">+</span> <span class="mi">9</span>
        <span class="k">return</span> <span class="n">number</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">qdigit</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.display_context.DisplayContext.set_commas" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayContext</span><span class="o">.</span><span class="n">set_commas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commas</span><span class="p">)</span></code>


<a href="#beancount.core.display_context.DisplayContext.set_commas" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Set the default value for rendering commas.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/display_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_commas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the default value for rendering commas.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">commas</span> <span class="o">=</span> <span class="n">commas</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.display_context.DisplayContext.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayContext</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="s1">&#39;__default__&#39;</span><span class="p">)</span></code>


<a href="#beancount.core.display_context.DisplayContext.update" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Update the builder with the given number for the given currency.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>number</strong>  An instance of Decimal to consider for this currency.</p></li>
            <li><p><strong>currency</strong>  An optional string, the currency this numbers applies to.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/display_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="o">=</span><span class="s2">&quot;__default__&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the builder with the given number for the given currency.</span>

<span class="sd">    Args:</span>
<span class="sd">      number: An instance of Decimal to consider for this currency.</span>
<span class="sd">      currency: An optional string, the currency this numbers applies to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ccontexts</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.display_context.DisplayContext.update_from" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayContext</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


<a href="#beancount.core.display_context.DisplayContext.update_from" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Update the builder with the other given DisplayContext.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  Another DisplayContext.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/display_context.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the builder with the other given DisplayContext.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: Another DisplayContext.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">ccontext</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">ccontexts</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ccontexts</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="n">ccontext</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.display_context.DisplayFormatter" class="doc doc-heading">
        <code>
beancount.core.display_context.DisplayFormatter        </code>



<a href="#beancount.core.display_context.DisplayFormatter" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A class used to contain various settings that control how we output numbers.
In particular, the precision used for each currency, and whether or not
commas should be printed. This object is intended to be passed around to all
functions that format numbers to strings.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dcontext</code></td>
        <td></td>
        <td><p>A DisplayContext instance.</p></td>
      </tr>
      <tr>
        <td><code>precision</code></td>
        <td></td>
        <td><p>An enum of Precision from which it was built.</p></td>
      </tr>
      <tr>
        <td><code>fmtstrings</code></td>
        <td></td>
        <td><p>A dict of currency to pre-baked format strings for it.</p></td>
      </tr>
      <tr>
        <td><code>fmtfuncs</code></td>
        <td></td>
        <td><p>A dict of currency to pre-baked formatting functions for it.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.display_context.Precision" class="doc doc-heading">
        <code>
beancount.core.display_context.Precision            (<span title="enum.Enum">Enum</span>)
        </code>



<a href="#beancount.core.display_context.Precision" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>The type of precision required.</p>




  <div class="doc doc-children">













  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.distribution" class="doc doc-heading">
        <code>beancount.core.distribution</code>



<a href="#beancount.core.distribution" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>A simple accumulator for data about a mathematical distribution.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h3 id="beancount.core.distribution.Distribution" class="doc doc-heading">
        <code>
beancount.core.distribution.Distribution        </code>



<a href="#beancount.core.distribution.Distribution" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A class that computes a histogram of integer values. This is used to compute
a length that will cover at least some decent fraction of the samples.</p>




  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="beancount.core.distribution.Distribution.empty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Distribution</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.distribution.Distribution.empty" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return true if the distribution is empty.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/distribution.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the distribution is empty.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.distribution.Distribution.max" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Distribution</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.distribution.Distribution.max" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the minimum value seen in the distribution.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An element of the value type, or None, if the distribution was empty.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/distribution.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the minimum value seen in the distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An element of the value type, or None, if the distribution was empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">value</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.distribution.Distribution.min" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Distribution</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.distribution.Distribution.min" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the minimum value seen in the distribution.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An element of the value type, or None, if the distribution was empty.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/distribution.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the minimum value seen in the distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An element of the value type, or None, if the distribution was empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">value</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.distribution.Distribution.mode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Distribution</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.distribution.Distribution.mode" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the mode of the distribution.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An element of the value type, or None, if the distribution was empty.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/distribution.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the mode of the distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An element of the value type, or None, if the distribution was empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">max_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">max_count</span><span class="p">:</span>
            <span class="n">max_count</span> <span class="o">=</span> <span class="n">count</span>
            <span class="n">max_value</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">max_value</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.distribution.Distribution.update" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Distribution</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>


<a href="#beancount.core.distribution.Distribution.update" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add a sample to the distribution.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>value</strong>  A value of the function.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/distribution.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a sample to the distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">      value: A value of the function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.distribution.Distribution.update_from" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">Distribution</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


<a href="#beancount.core.distribution.Distribution.update_from" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add samples from the other distribution to this one.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  Another distribution.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/distribution.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add samples from the other distribution to this one.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: Another distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.flags" class="doc doc-heading">
        <code>beancount.core.flags</code>



<a href="#beancount.core.flags" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Flag constants.</p>



  <div class="doc doc-children">




















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.getters" class="doc doc-heading">
        <code>beancount.core.getters</code>



<a href="#beancount.core.getters" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Getter functions that operate on lists of entries to return various lists of
things that they reference, accounts, tags, links, currencies, etc.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h3 id="beancount.core.getters.GetAccounts" class="doc doc-heading">
        <code>
beancount.core.getters.GetAccounts        </code>



<a href="#beancount.core.getters.GetAccounts" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Accounts gatherer.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Balance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Balance" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with a single account attribute.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The single account of this directive.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_one</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with a single account attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The single account of this directive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Close</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Close" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with a single account attribute.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The single account of this directive.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_one</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with a single account attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The single account of this directive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Commodity" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Commodity</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Commodity" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with no accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An empty list</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_zero</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with no accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An empty list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Custom" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Custom</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Custom" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with no accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An empty list</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_zero</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with no accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An empty list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Document" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Document</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Document" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with a single account attribute.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The single account of this directive.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_one</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with a single account attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The single account of this directive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Event" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Event</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Event" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with no accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An empty list</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_zero</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with no accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An empty list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Note" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Note" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with a single account attribute.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The single account of this directive.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_one</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with a single account attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The single account of this directive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Open" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Open" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with a single account attribute.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The single account of this directive.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_one</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with a single account attribute.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The single account of this directive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Pad" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Pad" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process a Pad directive.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of Pad.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The two accounts of the Pad directive.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Pad</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a Pad directive.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of Pad.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The two accounts of the Pad directive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">source_account</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Price" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Price</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Price" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with no accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An empty list</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_zero</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with no accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An empty list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Query" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Query" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process directives with no accounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a directive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An empty list</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_zero</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process directives with no accounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a directive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An empty list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.Transaction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">Transaction</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.Transaction" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Process a Transaction directive.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of Transaction.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  The accounts of the legs of the transaction.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">Transaction</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a Transaction directive.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of Transaction.</span>
<span class="sd">    Yields:</span>
<span class="sd">      The accounts of the legs of the transaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.get_accounts_use_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">get_accounts_use_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.get_accounts_use_map" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Gather the list of accounts from the list of entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of dictionaries of account name to date, one for first date
used and one for last date used. The keys should be identical.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_accounts_use_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather the list of accounts from the list of entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of dictionaries of account name to date, one for first date</span>
<span class="sd">      used and one for last date used. The keys should be identical.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">accounts_first</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">accounts_last</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">account_</span> <span class="ow">in</span> <span class="n">method</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">account_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">accounts_first</span><span class="p">:</span>
                <span class="n">accounts_first</span><span class="p">[</span><span class="n">account_</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
            <span class="n">accounts_last</span><span class="p">[</span><span class="n">account_</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
    <span class="k">return</span> <span class="n">accounts_first</span><span class="p">,</span> <span class="n">accounts_last</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.getters.GetAccounts.get_entry_accounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">GetAccounts</span><span class="o">.</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.GetAccounts.get_entry_accounts" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Gather all the accounts references by a single directive.</p>
<p>Note: This should get replaced by a method on each directive eventually,
that would be the clean way to do this.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  A directive instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of account name strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_entry_accounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather all the accounts references by a single directive.</span>

<span class="sd">    Note: This should get replaced by a method on each directive eventually,</span>
<span class="sd">    that would be the clean way to do this.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: A directive instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of account name strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_account_components" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_account_components</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_account_components" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Gather all the account components available in the given directives.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of strings, the unique account components, including the root
account names.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_account_components</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather all the account components available in the given directives.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of strings, the unique account components, including the root</span>
<span class="sd">      account names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">accounts</span> <span class="o">=</span> <span class="n">get_accounts</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="n">components</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">account_name</span> <span class="ow">in</span> <span class="n">accounts</span><span class="p">:</span>
        <span class="n">components</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_account_open_close" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_account_open_close</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_account_open_close" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Fetch the open/close entries for each of the accounts.</p>
<p>If an open or close entry happens to be duplicated, accept the earliest
entry (chronologically).</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A map of account name strings to pairs of (open-directive, close-directive)
tuples.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_account_open_close</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch the open/close entries for each of the accounts.</span>

<span class="sd">    If an open or close entry happens to be duplicated, accept the earliest</span>
<span class="sd">    entry (chronologically).</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A map of account name strings to pairs of (open-directive, close-directive)</span>
<span class="sd">      tuples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># A dict of account name to (open-entry, close-entry).</span>
    <span class="n">open_close_map</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Open</span><span class="p">,</span> <span class="n">Close</span><span class="p">)):</span>
            <span class="k">continue</span>
        <span class="n">open_close</span> <span class="o">=</span> <span class="n">open_close_map</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Open</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">previous_entry</span> <span class="o">=</span> <span class="n">open_close</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">previous_entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">previous_entry</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="n">previous_entry</span>
        <span class="n">open_close</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">open_close_map</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_accounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_accounts</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_accounts" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Gather all the accounts references by a list of directives.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of account strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_accounts</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather all the accounts references by a list of directives.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of account strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">accounts_last</span> <span class="o">=</span> <span class="n">_GetAccounts</span><span class="o">.</span><span class="n">get_accounts_use_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">accounts_last</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_accounts_use_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_accounts_use_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_accounts_use_map" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Gather all the accounts references by a list of directives.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of dictionaries of account name to date, one for first date
used and one for last date used. The keys should be identical.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_accounts_use_map</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather all the accounts references by a list of directives.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of dictionaries of account name to date, one for first date</span>
<span class="sd">      used and one for last date used. The keys should be identical.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_GetAccounts</span><span class="o">.</span><span class="n">get_accounts_use_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_active_years" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_active_years</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_active_years" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Yield all the years that have at least one entry in them.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  Unique dates see in the list of directives.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_active_years</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield all the years that have at least one entry in them.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Unique dates see in the list of directives.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">prev_year</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span>
        <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">prev_year</span><span class="p">:</span>
            <span class="n">prev_year</span> <span class="o">=</span> <span class="n">year</span>
            <span class="k">assert</span> <span class="n">year</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">year</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_all_links" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_all_links</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_all_links" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a list of all the links seen in the given entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of links strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_links</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of all the links seen in the given entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of links strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_links</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="n">all_links</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">links</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_links</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_all_payees" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_all_payees</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_all_payees" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a list of all the unique payees seen in the given entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of payee strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_payees</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of all the unique payees seen in the given entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of payee strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_payees</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">all_payees</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">payee</span><span class="p">)</span>
    <span class="n">all_payees</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_payees</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_all_tags" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_all_tags</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_all_tags" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a list of all the tags seen in the given entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of tag strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_tags</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of all the tags seen in the given entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of tag strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
            <span class="n">all_tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_tags</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_commodity_directives" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_commodity_directives</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_commodity_directives" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create map of commodity names to Commodity entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A map of commodity name strings to Commodity directives.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_commodity_directives</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create map of commodity names to Commodity entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A map of commodity name strings to Commodity directives.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">entry</span><span class="o">.</span><span class="n">currency</span><span class="p">:</span> <span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Commodity</span><span class="p">)}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_dict_accounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_dict_accounts</span><span class="p">(</span><span class="n">account_names</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_dict_accounts" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a nested dict of all the unique leaf names.
account names are labelled with LABEL=True</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_names</strong>  An iterable of account names (strings)</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A nested OrderedDict of account leafs</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_dict_accounts</span><span class="p">(</span><span class="n">account_names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a nested dict of all the unique leaf names.</span>
<span class="sd">    account names are labelled with LABEL=True</span>

<span class="sd">    Args:</span>
<span class="sd">      account_names: An iterable of account names (strings)</span>
<span class="sd">    Returns:</span>
<span class="sd">      A nested OrderedDict of account leafs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leveldict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">account_name</span> <span class="ow">in</span> <span class="n">account_names</span><span class="p">:</span>
        <span class="n">nested_dict</span> <span class="o">=</span> <span class="n">leveldict</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">):</span>
            <span class="n">nested_dict</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">())</span>
        <span class="n">nested_dict</span><span class="p">[</span><span class="n">get_dict_accounts</span><span class="o">.</span><span class="n">ACCOUNT_LABEL</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">leveldict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_entry_accounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_entry_accounts" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Gather all the accounts references by a single directive.</p>
<p>Note: This should get replaced by a method on each directive eventually,
that would be the clean way to do this.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A directive instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of account strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gather all the accounts references by a single directive.</span>

<span class="sd">    Note: This should get replaced by a method on each directive eventually,</span>
<span class="sd">    that would be the clean way to do this.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A directive instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A set of account strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_GetAccounts</span><span class="o">.</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_leveln_parent_accounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_leveln_parent_accounts</span><span class="p">(</span><span class="n">account_names</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">nrepeats</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_leveln_parent_accounts" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a list of all the unique leaf names at level N in an account hierarchy.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_names</strong>  A list of account names (strings)</p></li>
            <li><p><strong>level</strong>  The level to cross-cut. 0 is for root accounts.</p></li>
            <li><p><strong>nrepeats</strong>  A minimum number of times a leaf is required to be present in the
the list of unique account names in order to be returned by this function.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of leaf node names.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_leveln_parent_accounts</span><span class="p">(</span><span class="n">account_names</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">nrepeats</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of all the unique leaf names at level N in an account hierarchy.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_names: A list of account names (strings)</span>
<span class="sd">      level: The level to cross-cut. 0 is for root accounts.</span>
<span class="sd">      nrepeats: A minimum number of times a leaf is required to be present in the</span>
<span class="sd">        the list of unique account names in order to be returned by this function.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of leaf node names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leveldict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">account_name</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">account_names</span><span class="p">):</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
            <span class="n">leveldict</span><span class="p">[</span><span class="n">components</span><span class="p">[</span><span class="n">level</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="n">level_</span> <span class="k">for</span> <span class="n">level_</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">leveldict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">nrepeats</span><span class="p">}</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_min_max_dates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_min_max_dates</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_min_max_dates" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the minimum and maximum dates in the list of entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directive instances.</p></li>
            <li><p><strong>types</strong>  An optional tuple of types to restrict the entries to.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of datetime.date dates, the minimum and maximum dates seen in the
directives.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_min_max_dates</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the minimum and maximum dates in the list of entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directive instances.</span>
<span class="sd">      types: An optional tuple of types to restrict the entries to.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of datetime.date dates, the minimum and maximum dates seen in the</span>
<span class="sd">      directives.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">date_first</span> <span class="o">=</span> <span class="n">date_last</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">types</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">date_first</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
        <span class="k">break</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">types</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">date_last</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>
        <span class="k">break</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">date_first</span><span class="p">,</span> <span class="n">date_last</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.getters.get_values_meta" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">getters</span><span class="o">.</span><span class="n">get_values_meta</span><span class="p">(</span><span class="n">name_to_entries_map</span><span class="p">,</span> <span class="o">*</span><span class="n">meta_keys</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.getters.get_values_meta" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Get a map of the metadata from a map of entries values.</p>
<p>Given a dict of some key to a directive instance (or None), return a mapping
of the key to the metadata extracted from each directive, or a default
value. This can be used to gather a particular piece of metadata from an
accounts map or a commodities map.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>name_to_entries_map</strong>  A dict of something to an entry or None.</p></li>
            <li><p><strong>meta_keys</strong>  A list of strings, the keys to fetch from the metadata.</p></li>
            <li><p><strong>default</strong>  The default value to use if the metadata is not available or if
the value/entry is None.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A mapping of the keys of name_to_entries_map to the values of the 'meta_keys'
metadata. If there are multiple 'meta_keys', each value is a tuple of them.
On the other hand, if there is only a single one, the value itself is returned.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/getters.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_values_meta</span><span class="p">(</span><span class="n">name_to_entries_map</span><span class="p">,</span> <span class="o">*</span><span class="n">meta_keys</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a map of the metadata from a map of entries values.</span>

<span class="sd">    Given a dict of some key to a directive instance (or None), return a mapping</span>
<span class="sd">    of the key to the metadata extracted from each directive, or a default</span>
<span class="sd">    value. This can be used to gather a particular piece of metadata from an</span>
<span class="sd">    accounts map or a commodities map.</span>

<span class="sd">    Args:</span>
<span class="sd">      name_to_entries_map: A dict of something to an entry or None.</span>
<span class="sd">      meta_keys: A list of strings, the keys to fetch from the metadata.</span>
<span class="sd">      default: The default value to use if the metadata is not available or if</span>
<span class="sd">        the value/entry is None.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A mapping of the keys of name_to_entries_map to the values of the &#39;meta_keys&#39;</span>
<span class="sd">      metadata. If there are multiple &#39;meta_keys&#39;, each value is a tuple of them.</span>
<span class="sd">      On the other hand, if there is only a single one, the value itself is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">name_to_entries_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">value_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">meta_key</span> <span class="ow">in</span> <span class="n">meta_keys</span><span class="p">:</span>
            <span class="n">value_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">entry</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">meta_key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span> <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default</span>
            <span class="p">)</span>
        <span class="n">value_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">value_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value_map</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.interpolate" class="doc doc-heading">
        <code>beancount.core.interpolate</code>



<a href="#beancount.core.interpolate" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Code used to automatically complete postings without positions.</p>



  <div class="doc doc-children">














  <div class="doc doc-object doc-class">



<h3 id="beancount.core.interpolate.BalanceError" class="doc doc-heading">
        <code>
beancount.core.interpolate.BalanceError            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.interpolate.BalanceError" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>BalanceError(source, message, entry)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.interpolate.BalanceError.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">BalanceError</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.interpolate.BalanceError.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.interpolate.BalanceError.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">BalanceError</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.interpolate.BalanceError.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of BalanceError(source, message, entry)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.interpolate.BalanceError.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">BalanceError</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.interpolate.BalanceError.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.compute_entries_balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">compute_entries_balance</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.compute_entries_balance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute the balance of all postings of a list of entries.</p>
<p>Sum up all the positions in all the postings of all the transactions in the
list of entries and return an inventory of it.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
            <li><p><strong>prefix</strong>  If specified, a prefix string to restrict by account name. Only
postings with an account that starts with this prefix will be summed up.</p></li>
            <li><p><strong>date</strong>  A datetime.date instance at which to stop adding up the balance.
The date is exclusive.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_entries_balance</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the balance of all postings of a list of entries.</span>

<span class="sd">    Sum up all the positions in all the postings of all the transactions in the</span>
<span class="sd">    list of entries and return an inventory of it.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      prefix: If specified, a prefix string to restrict by account name. Only</span>
<span class="sd">        postings with an account that starts with this prefix will be summed up.</span>
<span class="sd">      date: A datetime.date instance at which to stop adding up the balance.</span>
<span class="sd">        The date is exclusive.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_balance</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">date</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span> <span class="o">&lt;</span> <span class="n">date</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                    <span class="n">total_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_balance</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.compute_entry_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">compute_entry_context</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">context_entry</span><span class="p">,</span> <span class="n">additional_accounts</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.compute_entry_context" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute the balances of all accounts referenced by entry up to entry.</p>
<p>This provides the inventory of the accounts to which the entry is to be
applied, before and after.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
            <li><p><strong>context_entry</strong>  The entry for which we want to obtain the before and after
context.</p></li>
            <li><p><strong>additional_accounts</strong>  Additional list of accounts to include in calculating
the balance. This is used when invoked for debugging, in case the booked
&amp; interpolated transaction doesn't have all the accounts we need because
it had an error (the booking code will remove invalid postings).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>Two dicts of account-name to Inventory instance, one which represents the
context before the entry is applied, and one that represents the context
after it has been applied.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_entry_context</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">context_entry</span><span class="p">,</span> <span class="n">additional_accounts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the balances of all accounts referenced by entry up to entry.</span>

<span class="sd">    This provides the inventory of the accounts to which the entry is to be</span>
<span class="sd">    applied, before and after.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      context_entry: The entry for which we want to obtain the before and after</span>
<span class="sd">        context.</span>
<span class="sd">      additional_accounts: Additional list of accounts to include in calculating</span>
<span class="sd">        the balance. This is used when invoked for debugging, in case the booked</span>
<span class="sd">        &amp; interpolated transaction doesn&#39;t have all the accounts we need because</span>
<span class="sd">        it had an error (the booking code will remove invalid postings).</span>
<span class="sd">    Returns:</span>
<span class="sd">      Two dicts of account-name to Inventory instance, one which represents the</span>
<span class="sd">      context before the entry is applied, and one that represents the context</span>
<span class="sd">      after it has been applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">context_entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;context_entry is missing.&quot;</span>

    <span class="c1"># Get the set of accounts for which to compute the context.</span>
    <span class="n">context_accounts</span> <span class="o">=</span> <span class="n">getters</span><span class="o">.</span><span class="n">get_entry_accounts</span><span class="p">(</span><span class="n">context_entry</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">additional_accounts</span><span class="p">:</span>
        <span class="n">context_accounts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_accounts</span><span class="p">)</span>

    <span class="c1"># Iterate over the entries until we find the target one and accumulate the</span>
    <span class="c1"># balance.</span>
    <span class="n">context_before</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="n">context_entry</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span> <span class="o">==</span> <span class="n">account</span> <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">context_accounts</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">balance</span> <span class="o">=</span> <span class="n">context_before</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span>
                <span class="n">balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>

    <span class="c1"># Compute the after context for the entry.</span>
    <span class="n">context_after</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">context_before</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
            <span class="n">balance</span> <span class="o">=</span> <span class="n">context_after</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span>
            <span class="n">balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">context_before</span><span class="p">,</span> <span class="n">context_after</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.compute_residual" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">compute_residual</span><span class="p">(</span><span class="n">postings</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.compute_residual" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute the residual of a set of complete postings, and the per-currency precision.</p>
<p>This is used to cross-check a balanced transaction.</p>
<p>The precision is the maximum fraction that is being used for each currency
(a dict). We use the currency of the weight amount in order to infer the
quantization precision for each currency. Integer amounts aren't
contributing to the determination of precision.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>postings</strong>  A list of Posting instances.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory, with the residual of the given list of postings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_residual</span><span class="p">(</span><span class="n">postings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the residual of a set of complete postings, and the per-currency precision.</span>

<span class="sd">    This is used to cross-check a balanced transaction.</span>

<span class="sd">    The precision is the maximum fraction that is being used for each currency</span>
<span class="sd">    (a dict). We use the currency of the weight amount in order to infer the</span>
<span class="sd">    quantization precision for each currency. Integer amounts aren&#39;t</span>
<span class="sd">    contributing to the determination of precision.</span>

<span class="sd">    Args:</span>
<span class="sd">      postings: A list of Posting instances.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory, with the residual of the given list of postings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inventory</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">postings</span><span class="p">:</span>
        <span class="c1"># Skip auto-postings inserted to absorb the residual (rounding error).</span>
        <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">meta</span> <span class="ow">and</span> <span class="n">posting</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">AUTOMATIC_RESIDUAL</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="c1"># Add to total residual balance.</span>
        <span class="n">inventory</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_weight</span><span class="p">(</span><span class="n">posting</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inventory</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.fill_residual_posting" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">fill_residual_posting</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">account_rounding</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.fill_residual_posting" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>If necessary, insert a posting to absorb the residual.
This makes the transaction balance exactly.</p>
<p>Note: This was developed in order to tweak transactions before exporting
them to Ledger. A better method would be to enable the feature that
automatically inserts these rounding postings on all transactions, and so
maybe this method can be deprecated if we do so.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entry</strong>  An instance of a Transaction.</p></li>
            <li><p><strong>account_rounding</strong>  A string, the name of the rounding account that
absorbs residuals / rounding errors.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A possibly new, modified entry with a new posting. If a residual
was not needed - the transaction already balanced perfectly - no new
leg is inserted.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fill_residual_posting</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">account_rounding</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If necessary, insert a posting to absorb the residual.</span>
<span class="sd">    This makes the transaction balance exactly.</span>

<span class="sd">    Note: This was developed in order to tweak transactions before exporting</span>
<span class="sd">    them to Ledger. A better method would be to enable the feature that</span>
<span class="sd">    automatically inserts these rounding postings on all transactions, and so</span>
<span class="sd">    maybe this method can be deprecated if we do so.</span>

<span class="sd">    Args:</span>
<span class="sd">      entry: An instance of a Transaction.</span>
<span class="sd">      account_rounding: A string, the name of the rounding account that</span>
<span class="sd">        absorbs residuals / rounding errors.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A possibly new, modified entry with a new posting. If a residual</span>
<span class="sd">      was not needed - the transaction already balanced perfectly - no new</span>
<span class="sd">      leg is inserted.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">residual</span> <span class="o">=</span> <span class="n">compute_residual</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">residual</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
        <span class="n">new_postings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">)</span>
        <span class="n">new_postings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_residual_postings</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">account_rounding</span><span class="p">))</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">postings</span><span class="o">=</span><span class="n">new_postings</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">entry</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.get_residual_postings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">get_residual_postings</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">account_rounding</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.get_residual_postings" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create postings to book the given residuals.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>residual</strong>  An Inventory, the residual positions.</p></li>
            <li><p><strong>account_rounding</strong>  A string, the name of the rounding account that
absorbs residuals / rounding errors.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of new postings to be inserted to reduce the given residual.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_residual_postings</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">account_rounding</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create postings to book the given residuals.</span>

<span class="sd">    Args:</span>
<span class="sd">      residual: An Inventory, the residual positions.</span>
<span class="sd">      account_rounding: A string, the name of the rounding account that</span>
<span class="sd">        absorbs residuals / rounding errors.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of new postings to be inserted to reduce the given residual.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span><span class="n">AUTOMATIC_META</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="n">AUTOMATIC_RESIDUAL</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">Posting</span><span class="p">(</span><span class="n">account_rounding</span><span class="p">,</span> <span class="o">-</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">residual</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
    <span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.has_nontrivial_balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">has_nontrivial_balance</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.has_nontrivial_balance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return True if a Posting has a balance amount that would have to be calculated.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>posting</strong>  A Posting instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">has_nontrivial_balance</span><span class="p">(</span><span class="n">posting</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if a Posting has a balance amount that would have to be calculated.</span>

<span class="sd">    Args:</span>
<span class="sd">      posting: A Posting instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span> <span class="ow">or</span> <span class="n">posting</span><span class="o">.</span><span class="n">price</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.infer_tolerances" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">infer_tolerances</span><span class="p">(</span><span class="n">postings</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">use_cost</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.infer_tolerances" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Infer tolerances from a list of postings.</p>
<p>The tolerance is the maximum fraction that is being used for each currency
(a dict). We use the currency of the weight amount in order to infer the
quantization precision for each currency. Integer amounts aren't
contributing to the determination of precision.</p>
<p>The 'use_cost' option allows one to experiment with letting postings at cost
and at price influence the maximum value of the tolerance. It's tricky to
use and alters the definition of the tolerance in a non-trivial way, if you
use it. The tolerance is expanded by the sum of the cost times a fraction 'M'
of the smallest digits in the number of units for all postings held at cost.</p>
<p>For example, in this transaction:</p>
<pre><code>2006-01-17 * "Plan Contribution"
  Assets:Investments:VWELX 18.572 VWELX {30.96 USD}
  Assets:Investments:VWELX 18.572 VWELX {30.96 USD}
  Assets:Investments:Cash -1150.00 USD
</code></pre>
<p>The tolerance for units of USD will calculated as the MAXIMUM of:</p>
<p>0.01 * M = 0.005 (from the 1150.00 USD leg)</p>
<p>The sum of
    0.001 * M x 30.96 = 0.01548 +
    0.001 * M x 30.96 = 0.01548
                      = 0.03096</p>
<p>So the tolerance for USD in this case is max(0.005, 0.03096) = 0.03096. Prices
contribute similarly to the maximum tolerance allowed.</p>
<p>Note that 'M' above is the inferred_tolerance_multiplier and its default
value is 0.5.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>postings</strong>  A list of Posting instances.</p></li>
            <li><p><strong>options_map</strong>  A dict of options.</p></li>
            <li><p><strong>use_cost</strong>  A boolean, true if we should be using a combination of the smallest
digit of the number times the cost or price in order to infer the tolerance.
If the value is left unspecified (as 'None'), the default value can be
overridden by setting an option.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A dict of currency to the tolerated difference amount to be used for it,
e.g. 0.005.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">infer_tolerances</span><span class="p">(</span><span class="n">postings</span><span class="p">,</span> <span class="n">options_map</span><span class="p">,</span> <span class="n">use_cost</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Infer tolerances from a list of postings.</span>

<span class="sd">    The tolerance is the maximum fraction that is being used for each currency</span>
<span class="sd">    (a dict). We use the currency of the weight amount in order to infer the</span>
<span class="sd">    quantization precision for each currency. Integer amounts aren&#39;t</span>
<span class="sd">    contributing to the determination of precision.</span>

<span class="sd">    The &#39;use_cost&#39; option allows one to experiment with letting postings at cost</span>
<span class="sd">    and at price influence the maximum value of the tolerance. It&#39;s tricky to</span>
<span class="sd">    use and alters the definition of the tolerance in a non-trivial way, if you</span>
<span class="sd">    use it. The tolerance is expanded by the sum of the cost times a fraction &#39;M&#39;</span>
<span class="sd">    of the smallest digits in the number of units for all postings held at cost.</span>

<span class="sd">    For example, in this transaction:</span>

<span class="sd">        2006-01-17 * &quot;Plan Contribution&quot;</span>
<span class="sd">          Assets:Investments:VWELX 18.572 VWELX {30.96 USD}</span>
<span class="sd">          Assets:Investments:VWELX 18.572 VWELX {30.96 USD}</span>
<span class="sd">          Assets:Investments:Cash -1150.00 USD</span>

<span class="sd">    The tolerance for units of USD will calculated as the MAXIMUM of:</span>

<span class="sd">      0.01 * M = 0.005 (from the 1150.00 USD leg)</span>

<span class="sd">      The sum of</span>
<span class="sd">        0.001 * M x 30.96 = 0.01548 +</span>
<span class="sd">        0.001 * M x 30.96 = 0.01548</span>
<span class="sd">                          = 0.03096</span>

<span class="sd">    So the tolerance for USD in this case is max(0.005, 0.03096) = 0.03096. Prices</span>
<span class="sd">    contribute similarly to the maximum tolerance allowed.</span>

<span class="sd">    Note that &#39;M&#39; above is the inferred_tolerance_multiplier and its default</span>
<span class="sd">    value is 0.5.</span>

<span class="sd">    Args:</span>
<span class="sd">      postings: A list of Posting instances.</span>
<span class="sd">      options_map: A dict of options.</span>
<span class="sd">      use_cost: A boolean, true if we should be using a combination of the smallest</span>
<span class="sd">        digit of the number times the cost or price in order to infer the tolerance.</span>
<span class="sd">        If the value is left unspecified (as &#39;None&#39;), the default value can be</span>
<span class="sd">        overridden by setting an option.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A dict of currency to the tolerated difference amount to be used for it,</span>
<span class="sd">      e.g. 0.005.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">use_cost</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">use_cost</span> <span class="o">=</span> <span class="n">options_map</span><span class="p">[</span><span class="s2">&quot;infer_tolerance_from_cost&quot;</span><span class="p">]</span>

    <span class="n">inferred_tolerance_multiplier</span> <span class="o">=</span> <span class="n">options_map</span><span class="p">[</span><span class="s2">&quot;inferred_tolerance_multiplier&quot;</span><span class="p">]</span>

    <span class="n">default_tolerances</span> <span class="o">=</span> <span class="n">options_map</span><span class="p">[</span><span class="s2">&quot;inferred_tolerance_default&quot;</span><span class="p">]</span>
    <span class="n">tolerances</span> <span class="o">=</span> <span class="n">default_tolerances</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">cost_tolerances</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">postings</span><span class="p">:</span>
        <span class="c1"># Skip the precision on automatically inferred postings.</span>
        <span class="k">if</span> <span class="n">posting</span><span class="o">.</span><span class="n">meta</span> <span class="ow">and</span> <span class="n">AUTOMATIC_META</span> <span class="ow">in</span> <span class="n">posting</span><span class="o">.</span><span class="n">meta</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">posting</span><span class="o">.</span><span class="n">units</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">Amount</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)):</span>
            <span class="k">continue</span>

        <span class="c1"># Compute bounds on the number.</span>
        <span class="n">currency</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span>
        <span class="n">expo</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="o">.</span><span class="n">exponent</span>
        <span class="k">if</span> <span class="n">expo</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Note: the exponent is a negative value.</span>
            <span class="n">tolerance</span> <span class="o">=</span> <span class="n">ONE</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="n">expo</span><span class="p">)</span> <span class="o">*</span> <span class="n">inferred_tolerance_multiplier</span>

            <span class="c1"># Note that we take the max() and not the min() here because the</span>
            <span class="c1"># tolerance has a dual purpose: it&#39;s used to infer the resolution</span>
            <span class="c1"># for interpolation (where we might want the min()) and also for</span>
            <span class="c1"># balance checks (where we favor the looser/larger tolerance).</span>
            <span class="n">tolerances</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">tolerances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="o">-</span><span class="mi">1024</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">use_cost</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Compute bounds on the smallest digit of the number implied as cost.</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span>
            <span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cost_currency</span> <span class="o">=</span> <span class="n">cost</span><span class="o">.</span><span class="n">currency</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span><span class="p">):</span>
                    <span class="n">cost_tolerance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tolerance</span> <span class="o">*</span> <span class="n">cost</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">MAXIMUM_TOLERANCE</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">CostSpec</span><span class="p">)</span>
                    <span class="n">cost_tolerance</span> <span class="o">=</span> <span class="n">MAXIMUM_TOLERANCE</span>
                    <span class="k">for</span> <span class="n">cost_number</span> <span class="ow">in</span> <span class="n">cost</span><span class="o">.</span><span class="n">number_total</span><span class="p">,</span> <span class="n">cost</span><span class="o">.</span><span class="n">number_per</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">cost_number</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">cost_number</span> <span class="ow">is</span> <span class="n">MISSING</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">cost_tolerance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tolerance</span> <span class="o">*</span> <span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_tolerance</span><span class="p">)</span>
                <span class="n">cost_tolerances</span><span class="p">[</span><span class="n">cost_currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cost_tolerance</span>

            <span class="c1"># Compute bounds on the smallest digit of the number implied as cost.</span>
            <span class="n">price</span> <span class="o">=</span> <span class="n">posting</span><span class="o">.</span><span class="n">price</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">Amount</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
                <span class="n">price_currency</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">currency</span>
                <span class="n">price_tolerance</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">tolerance</span> <span class="o">*</span> <span class="n">price</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">MAXIMUM_TOLERANCE</span><span class="p">)</span>
                <span class="n">cost_tolerances</span><span class="p">[</span><span class="n">price_currency</span><span class="p">]</span> <span class="o">+=</span> <span class="n">price_tolerance</span>

    <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">tolerance</span> <span class="ow">in</span> <span class="n">cost_tolerances</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">tolerances</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">tolerances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="o">-</span><span class="mi">1024</span><span class="p">))</span>

    <span class="n">default</span> <span class="o">=</span> <span class="n">tolerances</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">defdict</span><span class="o">.</span><span class="n">ImmutableDictWithDefault</span><span class="p">(</span><span class="n">tolerances</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.is_tolerance_user_specified" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">is_tolerance_user_specified</span><span class="p">(</span><span class="n">tolerance</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.is_tolerance_user_specified" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if the given tolerance number was user-specified.</p>
<p>This would allow the user to provide a tolerance like # 0.1234 but not
0.123456. This is used to detect whether a tolerance value # is input by the
user and not inferred automatically.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>tolerance</strong>  An instance of Decimal.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_tolerance_user_specified</span><span class="p">(</span><span class="n">tolerance</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the given tolerance number was user-specified.</span>

<span class="sd">    This would allow the user to provide a tolerance like # 0.1234 but not</span>
<span class="sd">    0.123456. This is used to detect whether a tolerance value # is input by the</span>
<span class="sd">    user and not inferred automatically.</span>

<span class="sd">    Args:</span>
<span class="sd">      tolerance: An instance of Decimal.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">tolerance</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">MAX_TOLERANCE_DIGITS</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.interpolate.quantize_with_tolerance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">quantize_with_tolerance</span><span class="p">(</span><span class="n">tolerances</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span></code>


<a href="#beancount.core.interpolate.quantize_with_tolerance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Quantize the units using the tolerance dict.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>tolerances</strong>  A dict of currency to tolerance Decimalvalues.</p></li>
            <li><p><strong>number</strong>  A number to quantize.</p></li>
            <li><p><strong>currency</strong>  A string currency.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A Decimal, the number possibly quantized.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/interpolate.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">quantize_with_tolerance</span><span class="p">(</span><span class="n">tolerances</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Quantize the units using the tolerance dict.</span>

<span class="sd">    Args:</span>
<span class="sd">      tolerances: A dict of currency to tolerance Decimalvalues.</span>
<span class="sd">      number: A number to quantize.</span>
<span class="sd">      currency: A string currency.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Decimal, the number possibly quantized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Applying rounding to the default tolerance, if there is one.</span>
    <span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">currency</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="n">quantum</span> <span class="o">=</span> <span class="p">(</span><span class="n">tolerance</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

        <span class="c1"># If the tolerance is a neat number provided by the user,</span>
        <span class="c1"># quantize the inferred numbers. See doc on quantize():</span>
        <span class="c1">#</span>
        <span class="c1"># Unlike other operations, if the length of the coefficient</span>
        <span class="c1"># after the quantize operation would be greater than</span>
        <span class="c1"># precision, then an InvalidOperation is signaled. This</span>
        <span class="c1"># guarantees that, unless there is an error condition, the</span>
        <span class="c1"># quantized exponent is always equal to that of the</span>
        <span class="c1"># right-hand operand.</span>
        <span class="k">if</span> <span class="n">is_tolerance_user_specified</span><span class="p">(</span><span class="n">quantum</span><span class="p">):</span>
            <span class="n">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">quantum</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">number</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.inventory" class="doc doc-heading">
        <code>beancount.core.inventory</code>



<a href="#beancount.core.inventory" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>A container for an inventory of positions.</p>
<p>This module provides a container class that can hold positions. An inventory is
a mapping of positions, where each position is keyed by</p>
<p>(currency: str, cost: Cost) -&gt; position: Position</p>
<p>where</p>
<p>'currency': The commodity under consideration, USD, CAD, or stock units such
     as HOOL, MSFT, AAPL, etc.;</p>
<p>'cost': None or a Cost instance existing of cost currency, number, date, and
     label;</p>
<p>'position': A Position object, whose 'units' attribute is guaranteed to have
    the same currency as 'currency' and whose 'cost' attribute is equal to the
    'cost' key. It basically stores the number of units.</p>
<p>This is meant to accommodate both booked and non-booked amounts. The clever
trick that we pull to do this is that for positions which aren't booked, we
simply leave the 'cost' as None. This is the case for most of the transactions.</p>
<p>= Conversions =</p>
<p>If it often desired to convert this inventory into an equivalent position for
its cost, or to just flatten all the positions with the same currency and count
the number of units, or to compute the market value for the inventory at a
specific date. You do these conversions using the reduce() method:</p>
<p>inventory.reduce(convert.get_cost)
  inventory.reduce(convert.get_units)
  inventory.reduce(convert.get_value, price_map, date)</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h3 id="beancount.core.inventory.Inventory" class="doc doc-heading">
        <code>
beancount.core.inventory.Inventory            (<span title="dict">dict</span>)
        </code>



<a href="#beancount.core.inventory.Inventory" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>An Inventory is a set of positions, indexed for efficiency.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__abs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__abs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return an inventory with the absolute value of each position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an inventory with the absolute value of each position.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Inventory</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__add__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__add__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add another inventory to this one. This inventory is not modified.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  An instance of Inventory.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add another inventory to this one. This inventory is not modified.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: An instance of Inventory.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_inventory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
    <span class="n">new_inventory</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_inventory</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__copy__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__copy__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A shallow copy of this inventory object.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory, equal to this one.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A shallow copy of this inventory object.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory, equal to this one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__iadd__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__iadd__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add all the positions of another Inventory instance to this one.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  An instance of Inventory to add to this one.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>This inventory, modified.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add all the positions of another Inventory instance to this one.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: An instance of Inventory to add to this one.</span>
<span class="sd">    Returns:</span>
<span class="sd">      This inventory, modified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
        <span class="c1"># Optimization for empty inventories; if the current one is empty,</span>
        <span class="c1"># adopt all of the other inventory&#39;s positions without running</span>
        <span class="c1"># through the full aggregation checks. This should be very cheap. We</span>
        <span class="c1"># can do this because the positions are immutable.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">get_positions</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__init__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create a new inventory using a list of existing positions.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>positions</strong>  A list of Position instances or an existing dict or
Inventory instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new inventory using a list of existing positions.</span>

<span class="sd">    Args:</span>
<span class="sd">      positions: A list of Position instances or an existing dict or</span>
<span class="sd">        Inventory instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">Inventory</span><span class="p">)):</span>
        <span class="nb">dict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">dict</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">positions</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__iter__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Iterate over the positions. Note that there is no guaranteed order.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the positions. Note that there is no guaranteed order.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__lt__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__lt__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Inequality comparison operator.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inequality comparison operator.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__mul__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__mul__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Scale/multiply the contents of the inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>scalar</strong>  A Decimal.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale/multiply the contents of the inventory.</span>

<span class="sd">    Args:</span>
<span class="sd">      scalar: A Decimal.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Inventory</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">pos</span> <span class="o">*</span> <span class="n">scalar</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__neg__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__neg__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return an inventory with the negative of values of this one.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an inventory with the negative of values of this one.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Inventory</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="o">-</span><span class="n">pos</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Render as a human-readable string.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, for human consumption.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render as a human-readable string.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string, for human consumption.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.__str__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Render as a human-readable string.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, for human consumption.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render as a human-readable string.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string, for human consumption.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.add_amount" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.add_amount" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add to this inventory using amount and cost. This adds with strict lot
matching, that is, no partial matches are done on the arguments to the
keys of the inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>units</strong>  An Amount instance to add.</p></li>
            <li><p><strong>cost</strong>  An instance of Cost or None, as a key to the inventory.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of (position, matched) where 'position' is the position that
that was modified BEFORE it was modified, and where 'matched' is a
MatchResult enum that hints at how the lot was booked to this inventory.
Position may be None if there is no corresponding Position object,
e.g. the position was deleted.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_amount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add to this inventory using amount and cost. This adds with strict lot</span>
<span class="sd">    matching, that is, no partial matches are done on the arguments to the</span>
<span class="sd">    keys of the inventory.</span>

<span class="sd">    Args:</span>
<span class="sd">      units: An Amount instance to add.</span>
<span class="sd">      cost: An instance of Cost or None, as a key to the inventory.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of (position, matched) where &#39;position&#39; is the position that</span>
<span class="sd">      that was modified BEFORE it was modified, and where &#39;matched&#39; is a</span>
<span class="sd">      MatchResult enum that hints at how the lot was booked to this inventory.</span>
<span class="sd">      Position may be None if there is no corresponding Position object,</span>
<span class="sd">      e.g. the position was deleted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ASSERTS_TYPES</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">Amount</span><span class="p">),</span> <span class="s2">&quot;Internal error: </span><span class="si">{!r}</span><span class="s2"> (type: </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">units</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">cost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span>
        <span class="p">),</span> <span class="s2">&quot;Internal error: </span><span class="si">{!r}</span><span class="s2"> (type: </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="c1"># Find the position.</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Note: In order to augment or reduce, all the fields have to match.</span>

        <span class="c1"># Check if reducing.</span>
        <span class="n">booking</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">MatchResult</span><span class="o">.</span><span class="n">REDUCED</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">same_sign</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">MatchResult</span><span class="o">.</span><span class="n">AUGMENTED</span>
        <span class="p">)</span>

        <span class="c1"># Compute the new number of units.</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span>
        <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
            <span class="c1"># If empty, delete the position.</span>
            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise update it.</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Position</span><span class="p">(</span><span class="n">Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">),</span> <span class="n">cost</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If not found, create a new one.</span>
        <span class="k">if</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
            <span class="n">booking</span> <span class="o">=</span> <span class="n">MatchResult</span><span class="o">.</span><span class="n">IGNORED</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Position</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
            <span class="n">booking</span> <span class="o">=</span> <span class="n">MatchResult</span><span class="o">.</span><span class="n">CREATED</span>

    <span class="k">return</span> <span class="n">pos</span><span class="p">,</span> <span class="n">booking</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.add_inventory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">add_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.add_inventory" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add all the positions of another Inventory instance to this one.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  An instance of Inventory to add to this one.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>This inventory, modified.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add all the positions of another Inventory instance to this one.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: An instance of Inventory to add to this one.</span>
<span class="sd">    Returns:</span>
<span class="sd">      This inventory, modified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
        <span class="c1"># Optimization for empty inventories; if the current one is empty,</span>
        <span class="c1"># adopt all of the other inventory&#39;s positions without running</span>
        <span class="c1"># through the full aggregation checks. This should be very cheap. We</span>
        <span class="c1"># can do this because the positions are immutable.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">get_positions</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.add_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.add_position" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Add using a position (with strict lot matching).
Return True if this position was booked against and reduced another.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>position</strong>  The Posting or Position to add to this inventory.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of (position, booking) where 'position' is the position that
that was modified, and where 'matched' is a MatchResult enum that
hints at how the lot was booked to this inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add using a position (with strict lot matching).</span>
<span class="sd">    Return True if this position was booked against and reduced another.</span>

<span class="sd">    Args:</span>
<span class="sd">      position: The Posting or Position to add to this inventory.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of (position, booking) where &#39;position&#39; is the position that</span>
<span class="sd">      that was modified, and where &#39;matched&#39; is a MatchResult enum that</span>
<span class="sd">      hints at how the lot was booked to this inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ASSERTS_TYPES</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span>
            <span class="n">position</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span>
        <span class="p">),</span> <span class="s2">&quot;Invalid type for position: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">position</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">Cost</span><span class="p">)</span>
        <span class="p">),</span> <span class="s2">&quot;Invalid type for cost: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">position</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.average" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.average" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Average all lots of the same currency together.</p>
<p>Use the minimum date from each aggregated set of lots.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Average all lots of the same currency together.</span>

<span class="sd">    Use the minimum date from each aggregated set of lots.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span>
            <span class="n">position</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span> <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">cost</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>

    <span class="n">average_inventory</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">),</span> <span class="n">positions</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">total_units</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">)</span>
        <span class="c1"># Explicitly skip aggregates when resulting in zero units.</span>
        <span class="k">if</span> <span class="n">total_units</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">units_amount</span> <span class="o">=</span> <span class="n">Amount</span><span class="p">(</span><span class="n">total_units</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cost_currency</span><span class="p">:</span>
            <span class="n">total_cost</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">(</span><span class="n">position</span><span class="p">)</span><span class="o">.</span><span class="n">number</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span>
            <span class="p">)</span>
            <span class="n">cost_number</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;Infinity&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">total_units</span> <span class="o">==</span> <span class="n">ZERO</span>
                <span class="k">else</span> <span class="p">(</span><span class="n">total_cost</span> <span class="o">/</span> <span class="n">total_units</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">min_date</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">pos_date</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">date</span> <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">pos_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">min_date</span> <span class="o">=</span> <span class="n">pos_date</span> <span class="k">if</span> <span class="n">min_date</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_date</span><span class="p">,</span> <span class="n">pos_date</span><span class="p">)</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="n">Cost</span><span class="p">(</span><span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="n">min_date</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">average_inventory</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="n">units_amount</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">average_inventory</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.cost_currencies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">cost_currencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.cost_currencies" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the list of unit currencies held in this inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of currency strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cost_currencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of unit currencies held in this inventory.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A set of currency strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.currencies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">currencies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.currencies" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the list of unit currencies held in this inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of currency strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">currencies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the list of unit currencies held in this inventory.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A list of currency strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">currency</span> <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.currency_pairs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">currency_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.currency_pairs" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the commodities held in this inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A set of currency strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">currency_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the commodities held in this inventory.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A set of currency strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">currency_pair</span><span class="p">()</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.inventory.Inventory.from_string" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create an Inventory from a string. This is useful for writing tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A comma-separated string of &lt;number&gt; &lt;currency&gt; with an
optional {&lt;number&gt; &lt;currency&gt;} for the cost.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Inventory with the given balances.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an Inventory from a string. This is useful for writing tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A comma-separated string of &lt;number&gt; &lt;currency&gt; with an</span>
<span class="sd">        optional {&lt;number&gt; &lt;currency&gt;} for the cost.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Inventory with the given balances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_inventory</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="c1"># We need to split the comma-separated positions but ignore commas</span>
    <span class="c1"># occurring within a {...cost...} specification.</span>
    <span class="n">position_strs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;([-+]?[0-9,.]+\s+[A-Z]+\s*(?:{[^}]*})?)\s*,?\s*&quot;</span><span class="p">,</span> <span class="n">string</span>
    <span class="p">)[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">position_str</span> <span class="ow">in</span> <span class="n">position_strs</span><span class="p">:</span>
        <span class="n">new_inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position_from_string</span><span class="p">(</span><span class="n">position_str</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">new_inventory</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.get_currency_units" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">get_currency_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.get_currency_units" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Fetch the total amount across all the position in the given currency.
This may sum multiple lots in the same currency denomination.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>currency</strong>  A string, the currency to filter the positions with.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Amount, with the given currency.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_currency_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch the total amount across all the position in the given currency.</span>
<span class="sd">    This may sum multiple lots in the same currency denomination.</span>

<span class="sd">    Args:</span>
<span class="sd">      currency: A string, the currency to filter the positions with.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Amount, with the given currency.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_units</span> <span class="o">=</span> <span class="n">ZERO</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span> <span class="o">==</span> <span class="n">currency</span><span class="p">:</span>
            <span class="n">total_units</span> <span class="o">+=</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span>
    <span class="k">return</span> <span class="n">Amount</span><span class="p">(</span><span class="n">total_units</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.get_only_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">get_only_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.get_only_position" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the first position and assert there are no more.
If the inventory is empty, return None.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_only_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the first position and assert there are no more.</span>
<span class="sd">    If the inventory is empty, return None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="s2">&quot;Inventory has more than one expected &quot;</span> <span class="s2">&quot;position: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.get_positions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">get_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.get_positions" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the positions in this inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A shallow copy of the list of positions.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the positions in this inventory.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A shallow copy of the list of positions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.is_empty" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.is_empty" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return true if the inventory is empty, that is, has no positions.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the inventory is empty, that is, has no positions.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.is_mixed" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">is_mixed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.is_mixed" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return true if the inventory contains a mix of positive and negative lots for
at least one instrument.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_mixed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the inventory contains a mix of positive and negative lots for</span>
<span class="sd">    at least one instrument.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">signs_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="n">prev_sign</span> <span class="o">=</span> <span class="n">signs_map</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">sign</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sign</span> <span class="o">!=</span> <span class="n">prev_sign</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.is_reduced_by" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">is_reduced_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramount</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.is_reduced_by" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return true if the amount could reduce this inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>ramount</strong>  An instance of Amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_reduced_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramount</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the amount could reduce this inventory.</span>

<span class="sd">    Args:</span>
<span class="sd">      ramount: An instance of Amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ramount</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="n">ZERO</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span>
        <span class="k">if</span> <span class="n">ramount</span><span class="o">.</span><span class="n">currency</span> <span class="o">==</span> <span class="n">units</span><span class="o">.</span><span class="n">currency</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">same_sign</span><span class="p">(</span>
            <span class="n">ramount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">number</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.is_small" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">is_small</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerances</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.is_small" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return true if all the positions in the inventory are small.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>tolerances</strong>  A Decimal, the small number of units under which a position
is considered small, or a dict of currency to such epsilon precision.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_small</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerances</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if all the positions in the inventory are small.</span>

<span class="sd">    Args:</span>
<span class="sd">      tolerances: A Decimal, the small number of units under which a position</span>
<span class="sd">        is considered small, or a dict of currency to such epsilon precision.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tolerances</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerances</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">ZERO</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="n">small</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">small</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">tolerances</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">small</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.reduce" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reducer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.reduce" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Reduce an inventory using one of the conversion functions.</p>
<p>See functions in beancount.core.convert.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reducer</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduce an inventory using one of the conversion functions.</span>

<span class="sd">    See functions in beancount.core.convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inventory</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">inventory</span><span class="o">.</span><span class="n">add_amount</span><span class="p">(</span><span class="n">reducer</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inventory</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.segregate_units" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">segregate_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currencies</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.segregate_units" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Split up the list of positions to the given currencies.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>currencies</strong>  A list of currency strings, the currencies to isolate.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A dict of currency to Inventory instances.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">segregate_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currencies</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split up the list of positions to the given currencies.</span>

<span class="sd">    Args:</span>
<span class="sd">      currencies: A list of currency strings, the currencies to isolate.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A dict of currency to Inventory instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">per_currency_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">currency</span><span class="p">:</span> <span class="n">Inventory</span><span class="p">()</span> <span class="k">for</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">currencies</span><span class="p">}</span>
    <span class="n">per_currency_dict</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">currency</span> <span class="o">=</span> <span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">currency</span> <span class="k">if</span> <span class="n">currency</span> <span class="ow">in</span> <span class="n">currencies</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">per_currency_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">per_currency_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.split" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.split" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Split up the list of positions to their corresponding currencies.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A dict of currency to Inventory instances.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split up the list of positions to their corresponding currencies.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A dict of currency to Inventory instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">per_currency_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">Inventory</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">per_currency_dict</span><span class="p">[</span><span class="n">position</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">]</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">per_currency_dict</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.inventory.Inventory.to_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=&lt;</span><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayFormatter</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x78fcde6b7290</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">parens</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.Inventory.to_string" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Convert an Inventory instance to a printable string.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>dformat</strong>  An instance of DisplayFormatter.</p></li>
            <li><p><strong>parents</strong>  A boolean, true if we should surround the results by parentheses.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A formatted string of the quantized amount and symbol.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=</span><span class="n">DEFAULT_FORMATTER</span><span class="p">,</span> <span class="n">parens</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert an Inventory instance to a printable string.</span>

<span class="sd">    Args:</span>
<span class="sd">      dformat: An instance of DisplayFormatter.</span>
<span class="sd">      parents: A boolean, true if we should surround the results by parentheses.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A formatted string of the quantized amount and symbol.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">parens</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">dformat</span><span class="p">)</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.inventory.MatchResult" class="doc doc-heading">
        <code>
beancount.core.inventory.MatchResult            (<span title="enum.Enum">Enum</span>)
        </code>



<a href="#beancount.core.inventory.MatchResult" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Result of booking a new lot to an existing inventory.</p>




  <div class="doc doc-children">















  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.inventory.check_invariants" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">check_invariants</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.check_invariants" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Check the invariants of the Inventory.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>inventory</strong>  An instance of Inventory.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>True if the invariants are respected.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_invariants</span><span class="p">(</span><span class="n">inv</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the invariants of the Inventory.</span>

<span class="sd">    Args:</span>
<span class="sd">      inventory: An instance of Inventory.</span>
<span class="sd">    Returns:</span>
<span class="sd">      True if the invariants are respected.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check that all the keys are unique.</span>
    <span class="n">lots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">inv</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">lots</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inv</span><span class="p">),</span> <span class="s2">&quot;Invalid inventory: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inv</span><span class="p">)</span>
    <span class="c1"># Check that none of the amounts is zero.</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">inv</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">!=</span> <span class="n">ZERO</span><span class="p">,</span> <span class="s2">&quot;Invalid position size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.inventory.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>


<a href="#beancount.core.inventory.from_string" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create an Inventory from a string. This is useful for writing tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A comma-separated string of &lt;number&gt; &lt;currency&gt; with an
optional {&lt;number&gt; &lt;currency&gt;} for the cost.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Inventory with the given balances.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/inventory.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an Inventory from a string. This is useful for writing tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A comma-separated string of &lt;number&gt; &lt;currency&gt; with an</span>
<span class="sd">        optional {&lt;number&gt; &lt;currency&gt;} for the cost.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Inventory with the given balances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_inventory</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">()</span>
    <span class="c1"># We need to split the comma-separated positions but ignore commas</span>
    <span class="c1"># occurring within a {...cost...} specification.</span>
    <span class="n">position_strs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;([-+]?[0-9,.]+\s+[A-Z]+\s*(?:{[^}]*})?)\s*,?\s*&quot;</span><span class="p">,</span> <span class="n">string</span>
    <span class="p">)[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">position_str</span> <span class="ow">in</span> <span class="n">position_strs</span><span class="p">:</span>
        <span class="n">new_inventory</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">position_from_string</span><span class="p">(</span><span class="n">position_str</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">new_inventory</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.number" class="doc doc-heading">
        <code>beancount.core.number</code>



<a href="#beancount.core.number" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>The module contains the basic Decimal type import.</p>
<p>About Decimal usage:</p>
<ul>
<li>
<p>Do not import Decimal from the 'decimal' or 'cdecimal' modules; always import
  your Decimal class from beancount.core.amount.</p>
</li>
<li>
<p>Prefer to use D() to create new instances of Decimal objects, which
  handles more syntax, e.g., handles None, and numbers with commas.</p>
</li>
</ul>



  <div class="doc doc-children">
















  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.D" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">D</span><span class="p">(</span><span class="n">strord</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.number.D" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Convert a string into a Decimal object.</p>
<p>This is used in parsing amounts from files in the importers. This is the
main function you should use to build all numbers the system manipulates
(never use floating-point in an accounting system). Commas are stripped and
ignored, as they are assumed to be thousands separators (the French comma
separator as decimal is not supported). This function just returns the
argument if it is already a Decimal object, for convenience.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>strord</strong>  A string or Decimal instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A Decimal instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="n">strord</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a string into a Decimal object.</span>

<span class="sd">    This is used in parsing amounts from files in the importers. This is the</span>
<span class="sd">    main function you should use to build all numbers the system manipulates</span>
<span class="sd">    (never use floating-point in an accounting system). Commas are stripped and</span>
<span class="sd">    ignored, as they are assumed to be thousands separators (the French comma</span>
<span class="sd">    separator as decimal is not supported). This function just returns the</span>
<span class="sd">    argument if it is already a Decimal object, for convenience.</span>

<span class="sd">    Args:</span>
<span class="sd">      strord: A string or Decimal instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Decimal instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Note: try a map lookup and optimize performance here.</span>
        <span class="k">if</span> <span class="n">strord</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">strord</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">strord</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">_CLEAN_NUMBER_RE</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">strord</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">strord</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">strord</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">strord</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">strord</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">strord</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Invalid value to convert: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strord</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Impossible to create Decimal instance from </span><span class="si">{!s}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strord</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
        <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.auto_quantize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">auto_quantize</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>


<a href="#beancount.core.number.auto_quantize" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Automatically quantize the number at a given threshold.</p>
<p>For example, with a threshold of 0.01, this will convert:</p>
<p>20.899999618530273 20.9
  20.290000000000000000000000000000 20.29
  110.90 110.9
  11.0600004196167 11.06
  10.539999961853027 10.54
  134.3300018310547 134.33
  253.920200000000000000000000000000 253.9202</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">auto_quantize</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically quantize the number at a given threshold.</span>

<span class="sd">    For example, with a threshold of 0.01, this will convert:</span>

<span class="sd">      20.899999618530273 20.9</span>
<span class="sd">      20.290000000000000000000000000000 20.29</span>
<span class="sd">      110.90 110.9</span>
<span class="sd">      11.0600004196167 11.06</span>
<span class="sd">      10.539999961853027 10.54</span>
<span class="sd">      134.3300018310547 134.33</span>
<span class="sd">      253.920200000000000000000000000000 253.9202</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="n">auto_quantized_exponent</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exponent</span> <span class="o">!=</span> <span class="n">number</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="o">.</span><span class="n">exponent</span><span class="p">:</span>
        <span class="n">quant</span> <span class="o">=</span> <span class="n">TEN</span><span class="o">**</span><span class="n">exponent</span>
        <span class="n">qnumber</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">quant</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qnumber</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.auto_quantized_exponent" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">auto_quantized_exponent</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>


<a href="#beancount.core.number.auto_quantized_exponent" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Automatically infer the exponent that would be used below a given threshold.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">auto_quantized_exponent</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatically infer the exponent that would be used below a given threshold.&quot;&quot;&quot;</span>
    <span class="n">dtuple</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">dtuple</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=-</span><span class="nb">len</span><span class="p">(</span><span class="n">dtuple</span><span class="o">.</span><span class="n">digits</span><span class="p">)))</span>
    <span class="n">low_threshold</span> <span class="o">=</span> <span class="n">threshold</span>
    <span class="n">high_threshold</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">low_threshold</span>
    <span class="k">while</span> <span class="n">norm</span> <span class="o">!=</span> <span class="n">ZERO</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">low_threshold</span> <span class="o">&lt;=</span> <span class="n">norm</span> <span class="o">&lt;=</span> <span class="n">high_threshold</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="n">ntuple</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">scaleb</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">ntuple</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="n">ntuple</span><span class="o">.</span><span class="n">digits</span><span class="p">[</span><span class="n">ntuple</span><span class="o">.</span><span class="n">exponent</span> <span class="p">:]))</span>
    <span class="k">return</span> <span class="n">dtuple</span><span class="o">.</span><span class="n">exponent</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="o">.</span><span class="n">exponent</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.infer_quantum_from_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">infer_quantum_from_list</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span></code>


<a href="#beancount.core.number.infer_quantum_from_list" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Given a list of numbers from floats, infer the common quantization.</p>
<p>For a series of numbers provided as floats, e.g., prices from a price
source, we'd like to infer what the right quantization that should be used
to avoid rounding errors above some threshold.</p>
<p>from the numbers. This simple algorithm auto-quantizes all the numbers and
quantizes all of them at the maximum precision that would result in rounding
under the threshold.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>prices</strong>  A list of float or Decimal prices to infer from. If floats are
provided, conversion is done naively.</p></li>
            <li><p><strong>threshold</strong> (<code>float</code>)  A fraction, the maximum error to tolerate before stopping the
search.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>Optional[decimal.Decimal]</code>  A decimal object to use with decimal.Decimal.quantize().</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">infer_quantum_from_list</span><span class="p">(</span>
    <span class="n">numbers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Decimal</span><span class="p">],</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Decimal</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given a list of numbers from floats, infer the common quantization.</span>

<span class="sd">    For a series of numbers provided as floats, e.g., prices from a price</span>
<span class="sd">    source, we&#39;d like to infer what the right quantization that should be used</span>
<span class="sd">    to avoid rounding errors above some threshold.</span>


<span class="sd">    from the numbers. This simple algorithm auto-quantizes all the numbers and</span>
<span class="sd">    quantizes all of them at the maximum precision that would result in rounding</span>
<span class="sd">    under the threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">      prices: A list of float or Decimal prices to infer from. If floats are</span>
<span class="sd">        provided, conversion is done naively.</span>
<span class="sd">      threshold: A fraction, the maximum error to tolerate before stopping the</span>
<span class="sd">        search.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A decimal object to use with decimal.Decimal.quantize().</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Auto quantize all the numbers.</span>
    <span class="n">qnumbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">auto_quantize</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">]</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">num_fractional_digits</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">qnumbers</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">exponent</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.num_fractional_digits" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">num_fractional_digits</span><span class="p">(</span><span class="n">number</span><span class="p">)</span></code>


<a href="#beancount.core.number.num_fractional_digits" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the number of fractional digits.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">num_fractional_digits</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of fractional digits.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">number</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="o">.</span><span class="n">exponent</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.round_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">round_to</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">increment</span><span class="p">)</span></code>


<a href="#beancount.core.number.round_to" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Round a number <em>down</em> to a particular increment.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>number</strong>  A Decimal, the number to be rounded.</p></li>
            <li><p><strong>increment</strong>  A Decimal, the size of the increment.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A Decimal, the rounded number.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">round_to</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">increment</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Round a number *down* to a particular increment.</span>

<span class="sd">    Args:</span>
<span class="sd">      number: A Decimal, the number to be rounded.</span>
<span class="sd">      increment: A Decimal, the size of the increment.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Decimal, the rounded number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">((</span><span class="n">number</span> <span class="o">/</span> <span class="n">increment</span><span class="p">))</span> <span class="o">*</span> <span class="n">increment</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.number.same_sign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">same_sign</span><span class="p">(</span><span class="n">number1</span><span class="p">,</span> <span class="n">number2</span><span class="p">)</span></code>


<a href="#beancount.core.number.same_sign" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return true if both numbers have the same sign.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>number1</strong>  An instance of Decimal.</p></li>
            <li><p><strong>number2</strong>  An instance of Decimal.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/number.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">same_sign</span><span class="p">(</span><span class="n">number1</span><span class="p">,</span> <span class="n">number2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if both numbers have the same sign.</span>

<span class="sd">    Args:</span>
<span class="sd">      number1: An instance of Decimal.</span>
<span class="sd">      number2: An instance of Decimal.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">number1</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">number2</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.position" class="doc doc-heading">
        <code>beancount.core.position</code>



<a href="#beancount.core.position" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>A position object, which consists of units Amount and cost Cost.</p>
<p>See types below for details.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-class">



<h3 id="beancount.core.position.Cost" class="doc doc-heading">
        <code>
beancount.core.position.Cost            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.position.Cost" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Cost(number, currency, date, label)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Cost.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Cost.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Cost.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.position.Cost.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of Cost(number, currency, date, label)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Cost.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Cost.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.position.CostSpec" class="doc doc-heading">
        <code>
beancount.core.position.CostSpec            (<span title="tuple">tuple</span>)
        </code>



<a href="#beancount.core.position.CostSpec" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>CostSpec(number_per, number_total, currency, date, label, merge)</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.CostSpec.__getnewargs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">CostSpec</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.CostSpec.__getnewargs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return self as a plain tuple.  Used by copy and pickle.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return self as a plain tuple.  Used by copy and pickle.&#39;</span>
    <span class="k">return</span> <span class="n">_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.CostSpec.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">CostSpec</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">_cls</span><span class="p">,</span> <span class="n">number_per</span><span class="p">,</span> <span class="n">number_total</span><span class="p">,</span> <span class="n">currency</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">merge</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.position.CostSpec.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of CostSpec(number_per, number_total, currency, date, label, merge)</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.CostSpec.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">CostSpec</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.CostSpec.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a nicely formatted representation string</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="s1">&#39;Return a nicely formatted representation string&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="n">repr_fmt</span> <span class="o">%</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="beancount.core.position.Position" class="doc doc-heading">
        <code>
beancount.core.position.Position            (<span title="beancount.core.position._Position">_Position</span>)
        </code>



<a href="#beancount.core.position.Position" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A 'Position' is a pair of units and optional cost.
This is used to track inventories.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>units</code></td>
        <td><code>Amount</code></td>
        <td><p>An Amount, the number of units and its currency.</p></td>
      </tr>
      <tr>
        <td><code>cost</code></td>
        <td><code>Cost</code></td>
        <td><p>A Cost that represents the lot, or None.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">











  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__abs__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__abs__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the absolute value of the position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Position with the absolute units.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the absolute value of the position.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Position with the absolute units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">amount_abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__copy__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__copy__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Shallow copy, except for the lot, which can be shared. This is important for
performance reasons; a lot of time is spent here during balancing.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A shallow copy of this position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shallow copy, except for the lot, which can be shared. This is important for</span>
<span class="sd">    performance reasons; a lot of time is spent here during balancing.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A shallow copy of this position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: We use Decimal() for efficiency.</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__eq__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Equality comparison with another Position. The objects are considered equal
if both number and lot are matching, and if the number of units is zero
and the other position is None, that is also okay.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  An instance of Position, or None.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, true if the positions are equal.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Equality comparison with another Position. The objects are considered equal</span>
<span class="sd">    if both number and lot are matching, and if the number of units is zero</span>
<span class="sd">    and the other position is None, that is also okay.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: An instance of Position, or None.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true if the positions are equal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="n">ZERO</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">units</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__hash__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__hash__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Compute a hash for this position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A hash of this position object.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute a hash for this position.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A hash of this position object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__lt__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__lt__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>A less-than comparison operator for positions.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  Another instance of Position.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>True if this positions is smaller than the other position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A less-than comparison operator for positions.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: Another instance of Position.</span>
<span class="sd">    Returns:</span>
<span class="sd">      True if this positions is smaller than the other position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortkey</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">sortkey</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__mul__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__mul__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Scale/multiply the contents of the position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>scalar</strong>  A Decimal.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scalar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale/multiply the contents of the position.</span>

<span class="sd">    Args:</span>
<span class="sd">      scalar: A Decimal.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">amount_mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">scalar</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__neg__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__neg__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Get a copy of this position but with a negative number.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Position which represents the inverse of this Position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a copy of this position but with a negative number.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Position which represents the inverse of this Position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: We use Decimal() for efficiency.</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__new__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.position.Position.__new__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create new instance of _Position(units, cost)</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">units</span><span class="p">,</span> <span class="n">Amount</span>
    <span class="p">),</span> <span class="s2">&quot;Expected an Amount for units; received &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">cost</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">cost</span><span class="p">,</span> <span class="n">Position</span><span class="o">.</span><span class="n">cost_types</span>
    <span class="p">),</span> <span class="s2">&quot;Expected a Cost for cost; received &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_Position</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__repr__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a string representation of the position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, a printable representation of the position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the position.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string, a printable representation of the position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.position.Position.__str__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a string representation of the position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, a printable representation of the position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the position.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A string, a printable representation of the position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.currency_pair" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">currency_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.position.Position.currency_pair" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return the currency pair associated with this position.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of a currency string and a cost currency string or None.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">currency_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the currency pair associated with this position.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A pair of a currency string and a cost currency string or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.from_amounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">from_amounts</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.position.Position.from_amounts" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create a position from an amount and a cost.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount</strong>  An amount, that represents the number of units and the lot currency.</p></li>
            <li><p><strong>cost_amount</strong>  If not None, represents the cost amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A Position instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_amounts</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a position from an amount and a cost.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An amount, that represents the number of units and the lot currency.</span>
<span class="sd">      cost_amount: If not None, represents the cost amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Position instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">cost_amount</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">cost_amount</span><span class="p">,</span> <span class="n">Amount</span>
    <span class="p">),</span> <span class="s2">&quot;Invalid type for cost: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost_amount</span><span class="p">)</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Cost</span><span class="p">(</span><span class="n">cost_amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">cost_amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost_amount</span>
        <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#beancount.core.position.Position.from_string" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create a position from a string specification.</p>
<p>This is a miniature parser used for building tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;
&lt;currency&gt;} for the cost, similar to the parser syntax.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a position from a string specification.</span>

<span class="sd">    This is a miniature parser used for building tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;</span>
<span class="sd">        &lt;currency&gt;} for the cost, similar to the parser syntax.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s*(</span><span class="si">{}</span><span class="s2">)\s+(</span><span class="si">{}</span><span class="s2">)&quot;</span> <span class="sa">r</span><span class="s2">&quot;(?:\s+{{([^}}]*)}})?&quot;</span> <span class="sa">r</span><span class="s2">&quot;\s*$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">NUMBER_RE</span><span class="p">,</span> <span class="n">CURRENCY_RE</span>
        <span class="p">),</span>
        <span class="n">string</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid string for position: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

    <span class="n">number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Parse a cost expression.</span>
    <span class="n">cost_number</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cost_currency</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">date</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cost_expression</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[,/]&quot;</span><span class="p">,</span> <span class="n">cost_expression</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>
            <span class="c1"># Match a compound number.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(</span><span class="si">{NUMBER_RE}</span><span class="s2">)\s*(?:#\s*(</span><span class="si">{NUMBER_RE}</span><span class="s2">))?\s+(</span><span class="si">{CURRENCY_RE}</span><span class="s2">)$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">NUMBER_RE</span><span class="o">=</span><span class="n">NUMBER_RE</span><span class="p">,</span> <span class="n">CURRENCY_RE</span><span class="o">=</span><span class="n">CURRENCY_RE</span>
                <span class="p">),</span>
                <span class="n">expr</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">per_number</span><span class="p">,</span> <span class="n">total_number</span><span class="p">,</span> <span class="n">cost_currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                <span class="n">per_number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">per_number</span><span class="p">)</span> <span class="k">if</span> <span class="n">per_number</span> <span class="k">else</span> <span class="n">ZERO</span>
                <span class="n">total_number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">total_number</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_number</span> <span class="k">else</span> <span class="n">ZERO</span>
                <span class="k">if</span> <span class="n">total_number</span><span class="p">:</span>
                    <span class="c1"># Calculate the per-unit cost.</span>
                    <span class="n">total</span> <span class="o">=</span> <span class="n">number</span> <span class="o">*</span> <span class="n">per_number</span> <span class="o">+</span> <span class="n">total_number</span>
                    <span class="n">per_number</span> <span class="o">=</span> <span class="n">total</span> <span class="o">/</span> <span class="n">number</span>
                <span class="n">cost_number</span> <span class="o">=</span> <span class="n">per_number</span>
                <span class="k">continue</span>

            <span class="c1"># Match a date.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d\d\d\d)[-/](\d\d)[-/](\d\d)$&quot;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
                <span class="k">continue</span>

            <span class="c1"># Match a label.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;([^&quot;]+)*&quot;$&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Match a merge-cost marker.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\*$&quot;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Merge-code not supported in string constructor.&quot;</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid cost component: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">Cost</span><span class="p">(</span><span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">),</span> <span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.get_negative" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">get_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.position.Position.get_negative" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Get a copy of this position but with a negative number.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Position which represents the inverse of this Position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a copy of this position but with a negative number.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of Position which represents the inverse of this Position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: We use Decimal() for efficiency.</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.is_negative_at_cost" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">is_negative_at_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.position.Position.is_negative_at_cost" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return true if the position is held at cost and negative.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_negative_at_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return true if the position is held at cost and negative.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span> <span class="o">&lt;</span> <span class="n">ZERO</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.sortkey" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">sortkey</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.position.Position.sortkey" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Return a key to sort positions by. This key depends on the order of the
currency of the lot (we want to order common currencies first) and the
number of units.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A tuple, used to sort lists of positions.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sortkey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a key to sort positions by. This key depends on the order of the</span>
<span class="sd">    currency of the lot (we want to order common currencies first) and the</span>
<span class="sd">    number of units.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A tuple, used to sort lists of positions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">currency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">currency</span>
    <span class="n">order_units</span> <span class="o">=</span> <span class="n">CURRENCY_ORDER</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">NCURRENCIES</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">currency</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cost_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span>
        <span class="n">cost_currency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cost_number</span> <span class="o">=</span> <span class="n">ZERO</span>
        <span class="n">cost_currency</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">order_units</span><span class="p">,</span> <span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.position.Position.to_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">Position</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=&lt;</span><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayFormatter</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x78fcde6b7290</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#beancount.core.position.Position.to_string" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Render the position to a string.See to_string() for details.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=</span><span class="n">DEFAULT_FORMATTER</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render the position to a string.See to_string() for details.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.position.cost_to_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">cost_to_str</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#beancount.core.position.cost_to_str" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Format an instance of Cost or a CostSpec to a string.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>cost</strong>  An instance of Cost or CostSpec.</p></li>
            <li><p><strong>dformat</strong>  A DisplayFormatter object.</p></li>
            <li><p><strong>detail</strong>  A boolean, true if we should render the non-amount components.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, suitable for formatting.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cost_to_str</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format an instance of Cost or a CostSpec to a string.</span>

<span class="sd">    Args:</span>
<span class="sd">      cost: An instance of Cost or CostSpec.</span>
<span class="sd">      dformat: A DisplayFormatter object.</span>
<span class="sd">      detail: A boolean, true if we should render the non-amount components.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, suitable for formatting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strlist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">Cost</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Amount</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">dformat</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">detail</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
                <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
                <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">CostSpec</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number_per</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number_total</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
            <span class="n">amountlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number_per</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
                <span class="n">amountlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dformat</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number_per</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number_total</span><span class="p">,</span> <span class="n">Decimal</span><span class="p">):</span>
                <span class="n">amountlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
                <span class="n">amountlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dformat</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">number_total</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">amountlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
            <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">amountlist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">detail</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
                <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
                <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">cost</span><span class="o">.</span><span class="n">merge</span><span class="p">:</span>
                <span class="n">strlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strlist</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.position.from_amounts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">from_amounts</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.position.from_amounts" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create a position from an amount and a cost.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>amount</strong>  An amount, that represents the number of units and the lot currency.</p></li>
            <li><p><strong>cost_amount</strong>  If not None, represents the cost amount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A Position instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_amounts</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a position from an amount and a cost.</span>

<span class="sd">    Args:</span>
<span class="sd">      amount: An amount, that represents the number of units and the lot currency.</span>
<span class="sd">      cost_amount: If not None, represents the cost amount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A Position instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">cost_amount</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">cost_amount</span><span class="p">,</span> <span class="n">Amount</span>
    <span class="p">),</span> <span class="s2">&quot;Invalid type for cost: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost_amount</span><span class="p">)</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Cost</span><span class="p">(</span><span class="n">cost_amount</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">cost_amount</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cost_amount</span>
        <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.position.from_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></code>


<a href="#beancount.core.position.from_string" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create a position from a string specification.</p>
<p>This is a miniature parser used for building tests.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>string</strong>  A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;
&lt;currency&gt;} for the cost, similar to the parser syntax.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A new instance of Position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a position from a string specification.</span>

<span class="sd">    This is a miniature parser used for building tests.</span>

<span class="sd">    Args:</span>
<span class="sd">      string: A string of &lt;number&gt; &lt;currency&gt; with an optional {&lt;number&gt;</span>
<span class="sd">        &lt;currency&gt;} for the cost, similar to the parser syntax.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new instance of Position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\s*(</span><span class="si">{}</span><span class="s2">)\s+(</span><span class="si">{}</span><span class="s2">)&quot;</span> <span class="sa">r</span><span class="s2">&quot;(?:\s+{{([^}}]*)}})?&quot;</span> <span class="sa">r</span><span class="s2">&quot;\s*$&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">NUMBER_RE</span><span class="p">,</span> <span class="n">CURRENCY_RE</span>
        <span class="p">),</span>
        <span class="n">string</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid string for position: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

    <span class="n">number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Parse a cost expression.</span>
    <span class="n">cost_number</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cost_currency</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">date</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cost_expression</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span><span class="n">expr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;[,/]&quot;</span><span class="p">,</span> <span class="n">cost_expression</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>
            <span class="c1"># Match a compound number.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;(</span><span class="si">{NUMBER_RE}</span><span class="s2">)\s*(?:#\s*(</span><span class="si">{NUMBER_RE}</span><span class="s2">))?\s+(</span><span class="si">{CURRENCY_RE}</span><span class="s2">)$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">NUMBER_RE</span><span class="o">=</span><span class="n">NUMBER_RE</span><span class="p">,</span> <span class="n">CURRENCY_RE</span><span class="o">=</span><span class="n">CURRENCY_RE</span>
                <span class="p">),</span>
                <span class="n">expr</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">per_number</span><span class="p">,</span> <span class="n">total_number</span><span class="p">,</span> <span class="n">cost_currency</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
                <span class="n">per_number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">per_number</span><span class="p">)</span> <span class="k">if</span> <span class="n">per_number</span> <span class="k">else</span> <span class="n">ZERO</span>
                <span class="n">total_number</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">total_number</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_number</span> <span class="k">else</span> <span class="n">ZERO</span>
                <span class="k">if</span> <span class="n">total_number</span><span class="p">:</span>
                    <span class="c1"># Calculate the per-unit cost.</span>
                    <span class="n">total</span> <span class="o">=</span> <span class="n">number</span> <span class="o">*</span> <span class="n">per_number</span> <span class="o">+</span> <span class="n">total_number</span>
                    <span class="n">per_number</span> <span class="o">=</span> <span class="n">total</span> <span class="o">/</span> <span class="n">number</span>
                <span class="n">cost_number</span> <span class="o">=</span> <span class="n">per_number</span>
                <span class="k">continue</span>

            <span class="c1"># Match a date.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d\d\d\d)[-/](\d\d)[-/](\d\d)$&quot;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
                <span class="k">continue</span>

            <span class="c1"># Match a label.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;([^&quot;]+)*&quot;$&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># Match a merge-cost marker.</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\*$&quot;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Merge-code not supported in string constructor.&quot;</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid cost component: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">Cost</span><span class="p">(</span><span class="n">cost_number</span><span class="p">,</span> <span class="n">cost_currency</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">Amount</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">currency</span><span class="p">),</span> <span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.position.get_position" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span></code>


<a href="#beancount.core.position.get_position" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Build a Position instance from a Posting instance.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>posting</strong>  An instance of Posting.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An instance of Position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="n">posting</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a Position instance from a Posting instance.</span>

<span class="sd">    Args:</span>
<span class="sd">      posting: An instance of Posting.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An instance of Position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Position</span><span class="p">(</span><span class="n">posting</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">posting</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.position.to_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=&lt;</span><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display_context</span><span class="o">.</span><span class="n">DisplayFormatter</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x78fcde6b7290</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#beancount.core.position.to_string" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Render the Position or Posting instance to a string.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>pos</strong>  An instance of Position or Posting.</p></li>
            <li><p><strong>dformat</strong>  An instance of DisplayFormatter.</p></li>
            <li><p><strong>detail</strong>  A boolean, true if we should only render the lot details
beyond the cost (lot-date, label, etc.). If false, we only render
the cost, if present.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, the rendered position.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/position.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dformat</span><span class="o">=</span><span class="n">DEFAULT_FORMATTER</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Render the Position or Posting instance to a string.</span>

<span class="sd">    Args:</span>
<span class="sd">      pos: An instance of Position or Posting.</span>
<span class="sd">      dformat: An instance of DisplayFormatter.</span>
<span class="sd">      detail: A boolean, true if we should only render the lot details</span>
<span class="sd">       beyond the cost (lot-date, label, etc.). If false, we only render</span>
<span class="sd">       the cost, if present.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered position.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pos_str</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">dformat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pos_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> {{</span><span class="si">{}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pos_str</span><span class="p">,</span> <span class="n">cost_to_str</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">detail</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pos_str</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.prices" class="doc doc-heading">
        <code>beancount.core.prices</code>



<a href="#beancount.core.prices" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>This module has code that can build a database of historical prices at
various times, from which unrealized capital gains and market value can be
deduced.</p>
<p>Prices are deduced from Price entries found in the file, or perhaps
created by scripts (for example you could build a script that will fetch
live prices online and create entries on-the-fly).</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h3 id="beancount.core.prices.PriceMap" class="doc doc-heading">
        <code>
beancount.core.prices.PriceMap            (<span title="dict">dict</span>)
        </code>



<a href="#beancount.core.prices.PriceMap" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A price map dictionary.</p>
<p>The keys include both the set of forward (base, quote) pairs and their
inverse. In order to determine which are the forward pairs, access the
'forward_pairs' attribute</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>forward_pairs</code></td>
        <td></td>
        <td><p>A list of (base, quote) keys for the forward pairs.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">












  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.build_price_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">build_price_map</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.prices.build_price_map" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Build a price map from a list of arbitrary entries.</p>
<p>If multiple prices are found for the same (currency, cost-currency) pair at
the same date, the latest date is kept and the earlier ones (for that day)
are discarded.</p>
<p>If inverse price pairs are found, e.g. USD in AUD and AUD in USD, the
inverse that has the smallest number of price points is converted into the
one that has the most price points. In that way they are reconciled into a
single one.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives, hopefully including some Price and/or</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A dict of (currency, cost-currency) keys to sorted lists of (date, number)
pairs, where 'date' is the date the price occurs at and 'number' a Decimal
that represents the price, or rate, between these two
currencies/commodities. Each date occurs only once in the sorted list of
prices of a particular key. All of the inverses are automatically
generated in the price map.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">build_price_map</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a price map from a list of arbitrary entries.</span>

<span class="sd">    If multiple prices are found for the same (currency, cost-currency) pair at</span>
<span class="sd">    the same date, the latest date is kept and the earlier ones (for that day)</span>
<span class="sd">    are discarded.</span>

<span class="sd">    If inverse price pairs are found, e.g. USD in AUD and AUD in USD, the</span>
<span class="sd">    inverse that has the smallest number of price points is converted into the</span>
<span class="sd">    one that has the most price points. In that way they are reconciled into a</span>
<span class="sd">    single one.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives, hopefully including some Price and/or</span>
<span class="sd">      Transaction entries.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A dict of (currency, cost-currency) keys to sorted lists of (date, number)</span>
<span class="sd">      pairs, where &#39;date&#39; is the date the price occurs at and &#39;number&#39; a Decimal</span>
<span class="sd">      that represents the price, or rate, between these two</span>
<span class="sd">      currencies/commodities. Each date occurs only once in the sorted list of</span>
<span class="sd">      prices of a particular key. All of the inverses are automatically</span>
<span class="sd">      generated in the price map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fetch a list of all the price entries seen in the ledger.</span>
    <span class="n">price_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Price</span><span class="p">)]</span>

    <span class="c1"># Build a map of exchange rates between these units.</span>
    <span class="c1"># (base-currency, quote-currency) -&gt; List of (date, rate).</span>
    <span class="n">price_map</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">price_entries</span><span class="p">:</span>
        <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">price</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
        <span class="n">price_map</span><span class="p">[</span><span class="n">base_quote</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">price</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">price</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">number</span><span class="p">))</span>

    <span class="c1"># Find pairs of inversed units.</span>
    <span class="n">inversed_units</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">base_quote</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">price_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="o">=</span> <span class="n">base_quote</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">quote</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span> <span class="ow">in</span> <span class="n">price_map</span><span class="p">:</span>
            <span class="n">inversed_units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_quote</span><span class="p">)</span>

    <span class="c1"># Find pairs of inversed units, and swallow the conversion with the smaller</span>
    <span class="c1"># number of rates into the other one.</span>
    <span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="ow">in</span> <span class="n">inversed_units</span><span class="p">:</span>
        <span class="n">bq_prices</span> <span class="o">=</span> <span class="n">price_map</span><span class="p">[(</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">)]</span>
        <span class="n">qb_prices</span> <span class="o">=</span> <span class="n">price_map</span><span class="p">[(</span><span class="n">quote</span><span class="p">,</span> <span class="n">base</span><span class="p">)]</span>
        <span class="n">remove</span> <span class="o">=</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bq_prices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">qb_prices</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">quote</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="o">=</span> <span class="n">remove</span>

        <span class="n">remove_list</span> <span class="o">=</span> <span class="n">price_map</span><span class="p">[</span><span class="n">remove</span><span class="p">]</span>
        <span class="n">insert_list</span> <span class="o">=</span> <span class="n">price_map</span><span class="p">[(</span><span class="n">quote</span><span class="p">,</span> <span class="n">base</span><span class="p">)]</span>
        <span class="k">del</span> <span class="n">price_map</span><span class="p">[</span><span class="n">remove</span><span class="p">]</span>

        <span class="n">inverted_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">date</span><span class="p">,</span> <span class="n">ONE</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">rate</span><span class="p">)</span> <span class="ow">in</span> <span class="n">remove_list</span> <span class="k">if</span> <span class="n">rate</span> <span class="o">!=</span> <span class="n">ZERO</span><span class="p">]</span>
        <span class="n">insert_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">inverted_list</span><span class="p">)</span>

    <span class="c1"># Unzip and sort each of the entries and eliminate duplicates on the date.</span>
    <span class="n">sorted_price_map</span> <span class="o">=</span> <span class="n">PriceMap</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="n">base_quote</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">misc_utils</span><span class="o">.</span><span class="n">sorted_uniquify</span><span class="p">(</span><span class="n">date_rates</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">base_quote</span><span class="p">,</span> <span class="n">date_rates</span><span class="p">)</span> <span class="ow">in</span> <span class="n">price_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Compute and insert all the inverted rates.</span>
    <span class="n">forward_pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sorted_price_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">quote</span><span class="p">),</span> <span class="n">price_list</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sorted_price_map</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="c1"># Note: You have to filter out zero prices for zero-cost postings, like</span>
        <span class="c1"># gifted options.</span>
        <span class="n">sorted_price_map</span><span class="p">[(</span><span class="n">quote</span><span class="p">,</span> <span class="n">base</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">ONE</span> <span class="o">/</span> <span class="n">price</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">price_list</span> <span class="k">if</span> <span class="n">price</span> <span class="o">!=</span> <span class="n">ZERO</span>
        <span class="p">]</span>

    <span class="n">sorted_price_map</span><span class="o">.</span><span class="n">forward_pairs</span> <span class="o">=</span> <span class="n">forward_pairs</span>
    <span class="k">return</span> <span class="n">sorted_price_map</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.get_all_prices" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">get_all_prices</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span></code>


<a href="#beancount.core.prices.get_all_prices" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a sorted list of all (date, number) price pairs.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>price_map</strong>  A price map, which is a dict of (base, quote) -&gt; list of (date,
number) tuples, as created by build_price_map.</p></li>
            <li><p><strong>base_quote</strong>  A pair of strings, the base currency to lookup, and the quote
currency to lookup, which expresses which units the base currency is
denominated in. This may also just be a string, with a '/' separator.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of (date, Decimal) pairs, sorted by date.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>KeyError</code>  If the base/quote could not be found.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_prices</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a sorted list of all (date, number) price pairs.</span>

<span class="sd">    Args:</span>
<span class="sd">      price_map: A price map, which is a dict of (base, quote) -&gt; list of (date,</span>
<span class="sd">        number) tuples, as created by build_price_map.</span>
<span class="sd">      base_quote: A pair of strings, the base currency to lookup, and the quote</span>
<span class="sd">        currency to lookup, which expresses which units the base currency is</span>
<span class="sd">        denominated in. This may also just be a string, with a &#39;/&#39; separator.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of (date, Decimal) pairs, sorted by date.</span>
<span class="sd">    Raises:</span>
<span class="sd">      KeyError: If the base/quote could not be found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_quote</span> <span class="o">=</span> <span class="n">normalize_base_quote</span><span class="p">(</span><span class="n">base_quote</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_lookup_price_and_inverse</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.get_last_price_entries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">get_last_price_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span></code>


<a href="#beancount.core.prices.get_last_price_entries" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Run through the entries until the given date and return the last
Price entry encountered for each (currency, cost-currency) pair.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
            <li><p><strong>date</strong>  An instance of datetime.date. If None, the very latest price
is returned.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of price entries.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_last_price_entries</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run through the entries until the given date and return the last</span>
<span class="sd">    Price entry encountered for each (currency, cost-currency) pair.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      date: An instance of datetime.date. If None, the very latest price</span>
<span class="sd">        is returned.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of price entries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">price_entry_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="n">date</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Price</span><span class="p">):</span>
            <span class="n">base_quote</span> <span class="o">=</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">currency</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">amount</span><span class="o">.</span><span class="n">currency</span><span class="p">)</span>
            <span class="n">price_entry_map</span><span class="p">[</span><span class="n">base_quote</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">price_entry_map</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">entry_sortkey</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.get_latest_price" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">get_latest_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span></code>


<a href="#beancount.core.prices.get_latest_price" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the latest price/rate from a price map for the given base/quote pair.
This is often used to just get the 'current' price if you're looking at the
entire set of entries.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>price_map</strong>  A price map, which is a dict of (base, quote) -&gt; list of (date,
number) tuples, as created by build_price_map.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of (date, number), where 'date' is a datetime.date instance and
'number' is a Decimal of the price, or rate, at that date. The date is the
latest date which we have an available price for in the price map.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_latest_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the latest price/rate from a price map for the given base/quote pair.</span>
<span class="sd">    This is often used to just get the &#39;current&#39; price if you&#39;re looking at the</span>
<span class="sd">    entire set of entries.</span>

<span class="sd">    Args:</span>
<span class="sd">      price_map: A price map, which is a dict of (base, quote) -&gt; list of (date,</span>
<span class="sd">        number) tuples, as created by build_price_map.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of (date, number), where &#39;date&#39; is a datetime.date instance and</span>
<span class="sd">      &#39;number&#39; is a Decimal of the price, or rate, at that date. The date is the</span>
<span class="sd">      latest date which we have an available price for in the price map.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_quote</span> <span class="o">=</span> <span class="n">normalize_base_quote</span><span class="p">(</span><span class="n">base_quote</span><span class="p">)</span>

    <span class="c1"># Handle the degenerate case of a currency priced into its own.</span>
    <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="o">=</span> <span class="n">base_quote</span>
    <span class="k">if</span> <span class="n">quote</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">==</span> <span class="n">quote</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">ONE</span><span class="p">)</span>

    <span class="c1"># Look up the list and return the latest element. The lists are assumed to</span>
    <span class="c1"># be sorted.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">price_list</span> <span class="o">=</span> <span class="n">_lookup_price_and_inverse</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">price_list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">price_list</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">price_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.get_price" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.prices.get_price" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return the price as of the given date.</p>
<p>If the date is unspecified, return the latest price.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>price_map</strong>  A price map, which is a dict of (base, quote) -&gt; list of (date,
number) tuples, as created by build_price_map.</p></li>
            <li><p><strong>base_quote</strong>  A pair of strings, the base currency to lookup, and the quote
currency to lookup, which expresses which units the base currency is
denominated in. This may also just be a string, with a '/' separator.</p></li>
            <li><p><strong>date</strong>  A datetime.date instance, the date at which we want the conversion
rate.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of (datetime.date, Decimal) instance. If no price information could
be found, return (None, None).</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the price as of the given date.</span>

<span class="sd">    If the date is unspecified, return the latest price.</span>

<span class="sd">    Args:</span>
<span class="sd">      price_map: A price map, which is a dict of (base, quote) -&gt; list of (date,</span>
<span class="sd">        number) tuples, as created by build_price_map.</span>
<span class="sd">      base_quote: A pair of strings, the base currency to lookup, and the quote</span>
<span class="sd">        currency to lookup, which expresses which units the base currency is</span>
<span class="sd">        denominated in. This may also just be a string, with a &#39;/&#39; separator.</span>
<span class="sd">      date: A datetime.date instance, the date at which we want the conversion</span>
<span class="sd">        rate.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of (datetime.date, Decimal) instance. If no price information could</span>
<span class="sd">      be found, return (None, None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_latest_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span>

    <span class="n">base_quote</span> <span class="o">=</span> <span class="n">normalize_base_quote</span><span class="p">(</span><span class="n">base_quote</span><span class="p">)</span>

    <span class="c1"># Handle the degenerate case of a currency priced into its own.</span>
    <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="o">=</span> <span class="n">base_quote</span>
    <span class="k">if</span> <span class="n">quote</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">base</span> <span class="o">==</span> <span class="n">quote</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">ONE</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">price_list</span> <span class="o">=</span> <span class="n">_lookup_price_and_inverse</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">base_quote</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">bisect_key</span><span class="o">.</span><span class="n">bisect_right_with_key</span><span class="p">(</span><span class="n">price_list</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">price_list</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.normalize_base_quote" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">normalize_base_quote</span><span class="p">(</span><span class="n">base_quote</span><span class="p">)</span></code>


<a href="#beancount.core.prices.normalize_base_quote" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Convert a slash-separated string to a pair of strings.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>base_quote</strong>  A pair of strings, the base currency to lookup, and the quote
currency to lookup, which expresses which units the base currency is
denominated in. This may also just be a string, with a '/' separator.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A pair of strings.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">normalize_base_quote</span><span class="p">(</span><span class="n">base_quote</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a slash-separated string to a pair of strings.</span>

<span class="sd">    Args:</span>
<span class="sd">      base_quote: A pair of strings, the base currency to lookup, and the quote</span>
<span class="sd">        currency to lookup, which expresses which units the base currency is</span>
<span class="sd">        denominated in. This may also just be a string, with a &#39;/&#39; separator.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A pair of strings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_quote</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">base_quote_norm</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">base_quote</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_quote_norm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="n">base_quote</span>
        <span class="n">base_quote</span> <span class="o">=</span> <span class="n">base_quote_norm</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_quote</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="n">base_quote</span>
    <span class="k">return</span> <span class="n">base_quote</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.prices.project" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">prices</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">orig_price_map</span><span class="p">,</span> <span class="n">from_currency</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">,</span> <span class="n">base_currencies</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.prices.project" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Project all prices with a quote currency to another quote currency.</p>
<p>Say you have a price for HOOL in USD and you'd like to convert HOOL to CAD.
If there aren't any (HOOL, CAD) price pairs in the database it will remain
unconverted. Projecting from USD to CAD will compute combined rates and
insert corresponding prices over all base currencies (like HOOL). In this
example, each of the (HOOL, USD) prices would see an inserted (HOOL, CAD)
price inserted at the same date.</p>
<p>It is common to make these projections when reducing inventories in a ledger
that states multiple operating currency pairs, when for example, one wants
to compute total value of a set of accounts in one of those currencies.</p>
<p>Please note that:</p>
<ul>
<li>
<p>Even if the target pair has existing entries, projection will still be
  applied. For example, is there exist some (HOOL, CAD) prices, the
  projection in the example above will still insert some new price points to
  it.</p>
</li>
<li>
<p>However, projected prices colliding existing ones at the same date will
  not override them.</p>
</li>
<li>
<p>Projection will fail to insert a new price if the conversion between to
  and from currencies has no existing prices (e.g. before its first price
  entry).</p>
</li>
<li>
<p>Perhaps most importantly, we only insert price points at dates where the
  base commodity has a price point. In other words, if we have prices for
  dates A and C and the rate changes between these dates at date B, we don't
  synthesize a new price at date B. A more accurate method to get projected
  prices that takes into account varying rates is to do multiple lookups.
  We'll eventually add a method to query it via a specified list of
  intermediate pairs. {c1bd24f8d4b7}</p>
</li>
</ul>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>orig_price_map</strong> (<code>PriceMap</code>)  An existing price map.</p></li>
            <li><p><strong>from_currency</strong> (<code>str</code>)  The quote currency with existing project points (e.g., USD).</p></li>
            <li><p><strong>to_currency</strong> (<code>str</code>)  The quote currency to insert price points for (e.g., CAD).</p></li>
            <li><p><strong>base_currencies</strong> (<code>Optional[Set[str]]</code>)  An optional set of commodities to restrict the
projections to (e.g., {HOOL}).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>PriceMap</code>  A new price map, with the extra projected prices. The original price map
is kept intact.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/prices.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">project</span><span class="p">(</span>
    <span class="n">orig_price_map</span><span class="p">:</span> <span class="n">PriceMap</span><span class="p">,</span>
    <span class="n">from_currency</span><span class="p">:</span> <span class="n">Currency</span><span class="p">,</span>
    <span class="n">to_currency</span><span class="p">:</span> <span class="n">Currency</span><span class="p">,</span>
    <span class="n">base_currencies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Currency</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PriceMap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Project all prices with a quote currency to another quote currency.</span>

<span class="sd">    Say you have a price for HOOL in USD and you&#39;d like to convert HOOL to CAD.</span>
<span class="sd">    If there aren&#39;t any (HOOL, CAD) price pairs in the database it will remain</span>
<span class="sd">    unconverted. Projecting from USD to CAD will compute combined rates and</span>
<span class="sd">    insert corresponding prices over all base currencies (like HOOL). In this</span>
<span class="sd">    example, each of the (HOOL, USD) prices would see an inserted (HOOL, CAD)</span>
<span class="sd">    price inserted at the same date.</span>

<span class="sd">    It is common to make these projections when reducing inventories in a ledger</span>
<span class="sd">    that states multiple operating currency pairs, when for example, one wants</span>
<span class="sd">    to compute total value of a set of accounts in one of those currencies.</span>

<span class="sd">    Please note that:</span>

<span class="sd">    - Even if the target pair has existing entries, projection will still be</span>
<span class="sd">      applied. For example, is there exist some (HOOL, CAD) prices, the</span>
<span class="sd">      projection in the example above will still insert some new price points to</span>
<span class="sd">      it.</span>

<span class="sd">    - However, projected prices colliding existing ones at the same date will</span>
<span class="sd">      not override them.</span>

<span class="sd">    - Projection will fail to insert a new price if the conversion between to</span>
<span class="sd">      and from currencies has no existing prices (e.g. before its first price</span>
<span class="sd">      entry).</span>

<span class="sd">    - Perhaps most importantly, we only insert price points at dates where the</span>
<span class="sd">      base commodity has a price point. In other words, if we have prices for</span>
<span class="sd">      dates A and C and the rate changes between these dates at date B, we don&#39;t</span>
<span class="sd">      synthesize a new price at date B. A more accurate method to get projected</span>
<span class="sd">      prices that takes into account varying rates is to do multiple lookups.</span>
<span class="sd">      We&#39;ll eventually add a method to query it via a specified list of</span>
<span class="sd">      intermediate pairs. {c1bd24f8d4b7}</span>

<span class="sd">    Args:</span>
<span class="sd">      orig_price_map: An existing price map.</span>
<span class="sd">      from_currency: The quote currency with existing project points (e.g., USD).</span>
<span class="sd">      to_currency: The quote currency to insert price points for (e.g., CAD).</span>
<span class="sd">      base_currencies: An optional set of commodities to restrict the</span>
<span class="sd">        projections to (e.g., {HOOL}).</span>
<span class="sd">    Returns:</span>
<span class="sd">      A new price map, with the extra projected prices. The original price map</span>
<span class="sd">      is kept intact.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If nothing is requested, return the original map.</span>
    <span class="k">if</span> <span class="n">from_currency</span> <span class="o">==</span> <span class="n">to_currency</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">orig_price_map</span>

    <span class="c1"># Avoid mutating the input map.</span>
    <span class="n">price_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">orig_price_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="c1"># Process the entire database (it&#39;s not indexed by quote currency).</span>
    <span class="n">currency_pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">from_currency</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">base_quote</span><span class="p">,</span> <span class="n">prices</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">price_map</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="c1"># Filter just the currencies to convert.</span>
        <span class="n">base</span><span class="p">,</span> <span class="n">quote</span> <span class="o">=</span> <span class="n">base_quote</span>
        <span class="k">if</span> <span class="n">quote</span> <span class="o">!=</span> <span class="n">from_currency</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Skip currencies not requested if a constraint has been provided.</span>
        <span class="c1"># {4bb702d82c8a}</span>
        <span class="k">if</span> <span class="n">base_currencies</span> <span class="ow">and</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_currencies</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Create a mapping of existing prices so we can avoid date collisions.</span>
        <span class="n">existing_prices</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">{</span><span class="n">date</span> <span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">price_map</span><span class="p">[(</span><span class="n">base</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">)]}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">)</span> <span class="ow">in</span> <span class="n">price_map</span>
            <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="c1"># Project over each of the prices.</span>
        <span class="n">new_projected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">prices</span><span class="p">:</span>
            <span class="n">rate_date</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="n">get_price</span><span class="p">(</span><span class="n">price_map</span><span class="p">,</span> <span class="n">currency_pair</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># There is no conversion rate at this time; skip projection.</span>
                <span class="c1"># {b2b23353275d}.</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">rate_date</span> <span class="ow">in</span> <span class="n">existing_prices</span><span class="p">:</span>
                <span class="c1"># Skip collisions in date. {97a5703ac517}</span>
                <span class="k">continue</span>

            <span class="c1"># Append the new rate.</span>
            <span class="n">new_price</span> <span class="o">=</span> <span class="n">price</span> <span class="o">*</span> <span class="n">rate</span>
            <span class="n">new_projected</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">date</span><span class="p">,</span> <span class="n">new_price</span><span class="p">))</span>

        <span class="c1"># Make sure the resulting lists are sorted.</span>
        <span class="k">if</span> <span class="n">new_projected</span><span class="p">:</span>
            <span class="n">projected</span> <span class="o">=</span> <span class="n">price_map</span><span class="o">.</span><span class="n">setdefault</span><span class="p">((</span><span class="n">base</span><span class="p">,</span> <span class="n">to_currency</span><span class="p">),</span> <span class="p">[])</span>
            <span class="n">projected</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_projected</span><span class="p">)</span>
            <span class="n">projected</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="n">inverted</span> <span class="o">=</span> <span class="n">price_map</span><span class="o">.</span><span class="n">setdefault</span><span class="p">((</span><span class="n">to_currency</span><span class="p">,</span> <span class="n">base</span><span class="p">),</span> <span class="p">[])</span>
            <span class="n">inverted</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">ZERO</span> <span class="k">if</span> <span class="n">rate</span> <span class="o">==</span> <span class="n">ZERO</span> <span class="k">else</span> <span class="n">ONE</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">new_projected</span>
            <span class="p">)</span>
            <span class="n">inverted</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">price_map</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="beancount.core.realization" class="doc doc-heading">
        <code>beancount.core.realization</code>



<a href="#beancount.core.realization" class="headerlink" title="Permanent link"></a></h2>

    <div class="doc doc-contents ">

      <p>Realization of specific lists of account postings into reports.</p>
<p>This code converts a list of entries into a tree of RealAccount nodes (which
stands for "realized accounts"). The RealAccount objects contain lists of
Posting instances instead of Transactions, or other entry types that are
attached to an account, such as a Balance or Note entry.</p>
<p>The interface of RealAccount corresponds to that of a regular Python dict, where
the keys are the names of the individual components of an account's name, and
the values are always other RealAccount instances. If you want to get an account
by long account name, there are helper functions in this module for this purpose
(see realization.get(), for instance). RealAccount instances also contain the
final balance of that account, resulting from its list of postings.</p>
<p>You should not build RealAccount trees yourself; instead, you should filter the
list of desired directives to display and call the realize() function with them.</p>



  <div class="doc doc-children">













  <div class="doc doc-object doc-class">



<h3 id="beancount.core.realization.RealAccount" class="doc doc-heading">
        <code>
beancount.core.realization.RealAccount            (<span title="dict">dict</span>)
        </code>



<a href="#beancount.core.realization.RealAccount" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>A realized account, inserted in a tree, that contains the list of realized entries.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>account</code></td>
        <td></td>
        <td><p>A string, the full name of the corresponding account.</p></td>
      </tr>
      <tr>
        <td><code>postings</code></td>
        <td></td>
        <td><p>A list of postings associated with this accounting (does not
include the postings of children accounts).</p></td>
      </tr>
      <tr>
        <td><code>balance</code></td>
        <td></td>
        <td><p>The final balance of the list of postings associated with this account.</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="beancount.core.realization.RealAccount.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">RealAccount</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.realization.RealAccount.__eq__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Equality predicate. All attributes are compared.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  Another instance of RealAccount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, True if the two real accounts are equal.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Equality predicate. All attributes are compared.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: Another instance of RealAccount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, True if the two real accounts are equal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">dict</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">account</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">account</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">balance</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">txn_postings</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">txn_postings</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.realization.RealAccount.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">RealAccount</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.realization.RealAccount.__init__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Create a RealAccount instance.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong>  a string, the name of the account. Maybe not be None.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a RealAccount instance.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: a string, the name of the account. Maybe not be None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">account</span> <span class="o">=</span> <span class="n">account_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">txn_postings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.realization.RealAccount.__ne__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">RealAccount</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.realization.RealAccount.__ne__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Not-equality predicate. See <strong>eq</strong>.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>other</strong>  Another instance of RealAccount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, True if the two real accounts are not equal.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Not-equality predicate. See __eq__.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: Another instance of RealAccount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, True if the two real accounts are not equal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.realization.RealAccount.__setitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">RealAccount</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#beancount.core.realization.RealAccount.__setitem__" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Prevent the setting of non-string or non-empty keys on this dict.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>key</strong>  The dictionary key. Must be a string.</p></li>
            <li><p><strong>value</strong>  The value, must be a RealAccount instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Exceptions:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><code>KeyError</code>  If the key is not a string, or is invalid.</p></li>
            <li><p><code>ValueError</code>  If the value is not a RealAccount instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prevent the setting of non-string or non-empty keys on this dict.</span>

<span class="sd">    Args:</span>
<span class="sd">      key: The dictionary key. Must be a string.</span>
<span class="sd">      value: The value, must be a RealAccount instance.</span>
<span class="sd">    Raises:</span>
<span class="sd">      KeyError: If the key is not a string, or is invalid.</span>
<span class="sd">      ValueError: If the value is not a RealAccount instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Invalid RealAccount key: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">RealAccount</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid RealAccount value: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;RealAccount name &#39;</span><span class="si">{}</span><span class="s2">&#39; inconsistent with key: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">value</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">key</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="beancount.core.realization.RealAccount.copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">RealAccount</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#beancount.core.realization.RealAccount.copy" class="headerlink" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Override dict.copy() to clone a RealAccount.</p>
<p>This is only necessary to correctly implement the copy method.
Otherwise, calling .copy() on a RealAccount instance invokes the base
class' method, which return just a dict.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A cloned instance of RealAccount, with all members shallow-copied.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Override dict.copy() to clone a RealAccount.</span>

<span class="sd">    This is only necessary to correctly implement the copy method.</span>
<span class="sd">    Otherwise, calling .copy() on a RealAccount instance invokes the base</span>
<span class="sd">    class&#39; method, which return just a dict.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A cloned instance of RealAccount, with all members shallow-copied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.compute_balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">compute_balance</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#beancount.core.realization.compute_balance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute the total balance of this account and all its subaccounts.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_account</strong>  A RealAccount instance.</p></li>
            <li><p><strong>leaf_only</strong>  A boolean flag, true if we should yield only leaves.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_balance</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the total balance of this account and all its subaccounts.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: A RealAccount instance.</span>
<span class="sd">      leaf_only: A boolean flag, true if we should yield only leaves.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
        <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">ra</span><span class="o">.</span><span class="n">balance</span> <span class="k">for</span> <span class="n">ra</span> <span class="ow">in</span> <span class="n">iter_children</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">leaf_only</span><span class="p">)]</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.compute_postings_balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">compute_postings_balance</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span></code>


<a href="#beancount.core.realization.compute_postings_balance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Compute the balance of a list of Postings's or TxnPosting's positions.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>postings</strong>  A list of Posting instances and other directives (which are
skipped).</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An Inventory.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_postings_balance</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the balance of a list of Postings&#39;s or TxnPosting&#39;s positions.</span>

<span class="sd">    Args:</span>
<span class="sd">      postings: A list of Posting instances and other directives (which are</span>
<span class="sd">        skipped).</span>
<span class="sd">    Returns:</span>
<span class="sd">      An Inventory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">final_balance</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">txn_posting</span> <span class="ow">in</span> <span class="n">txn_postings</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">Posting</span><span class="p">):</span>
            <span class="n">final_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">TxnPosting</span><span class="p">):</span>
            <span class="n">final_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">txn_posting</span><span class="o">.</span><span class="n">posting</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_balance</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.contains" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.realization.contains" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>True if the given account node contains the subaccount name.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>account_name</strong>  A string, the name of a direct or indirect subaccount of
this node.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A boolean, true the name is a child of this node.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;True if the given account node contains the subaccount name.</span>

<span class="sd">    Args:</span>
<span class="sd">      account_name: A string, the name of a direct or indirect subaccount of</span>
<span class="sd">        this node.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A boolean, true the name is a child of this node.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">get</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.dump" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">root_account</span><span class="p">)</span></code>


<a href="#beancount.core.realization.dump" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Convert a RealAccount node to a line of lines.</p>
<p>Note: this is not meant to be used to produce text reports; the reporting
code should produce an intermediate object that contains the structure of
it, which can then be rendered to ASCII, HTML or CSV formats. This is
intended as a convenient little function for dumping trees of data for
debugging purposes.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>root_account</strong>  A RealAccount instance.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p><code>A list of tuples of (first_line, continuation_line, real_account) where
  first_line</code>  A string, the first line to render, which includes the
    account name.
  continuation_line: A string, further line to render if necessary.
  real_account: The RealAccount instance which corresponds to this
    line.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="n">root_account</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a RealAccount node to a line of lines.</span>

<span class="sd">    Note: this is not meant to be used to produce text reports; the reporting</span>
<span class="sd">    code should produce an intermediate object that contains the structure of</span>
<span class="sd">    it, which can then be rendered to ASCII, HTML or CSV formats. This is</span>
<span class="sd">    intended as a convenient little function for dumping trees of data for</span>
<span class="sd">    debugging purposes.</span>

<span class="sd">    Args:</span>
<span class="sd">      root_account: A RealAccount instance.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of tuples of (first_line, continuation_line, real_account) where</span>
<span class="sd">        first_line: A string, the first line to render, which includes the</span>
<span class="sd">          account name.</span>
<span class="sd">        continuation_line: A string, further line to render if necessary.</span>
<span class="sd">        real_account: The RealAccount instance which corresponds to this</span>
<span class="sd">          line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute all the lines ahead of time in order to calculate the width.</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Start with the root node. We push the constant prefix before this node,</span>
    <span class="c1"># the account name, and the RealAccount instance. We will maintain a stack</span>
    <span class="c1"># of children nodes to render.</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">root_account</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">root_account</span><span class="p">,</span> <span class="kc">True</span><span class="p">)]</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">prefix</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">real_account</span><span class="p">,</span> <span class="n">is_last</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">real_account</span> <span class="ow">is</span> <span class="n">root_account</span><span class="p">:</span>
            <span class="c1"># For the root node, we don&#39;t want to render any prefix.</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Compute the string that precedes the name directly and the one below</span>
            <span class="c1"># that for the continuation lines.</span>
            <span class="c1">#  |</span>
            <span class="c1">#  @@@ Bank1    &lt;----------------</span>
            <span class="c1">#  @@@ |</span>
            <span class="c1">#  |   |-- Checking</span>
            <span class="k">if</span> <span class="n">is_last</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">PREFIX_LEAF_1</span>
                <span class="n">cont</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">PREFIX_LEAF_C</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">PREFIX_CHILD_1</span>
                <span class="n">cont</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">PREFIX_CHILD_C</span>

        <span class="c1"># Compute the name to render for continuation lines.</span>
        <span class="c1">#  |</span>
        <span class="c1">#  |-- Bank1</span>
        <span class="c1">#  |   @@@       &lt;----------------</span>
        <span class="c1">#  |   |-- Checking</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_account</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cont_name</span> <span class="o">=</span> <span class="n">PREFIX_CHILD_C</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont_name</span> <span class="o">=</span> <span class="n">PREFIX_LEAF_C</span>

        <span class="c1"># Add a line for this account.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">real_account</span> <span class="ow">is</span> <span class="n">root_account</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="p">):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">first</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">cont</span> <span class="o">+</span> <span class="n">cont_name</span><span class="p">,</span> <span class="n">real_account</span><span class="p">))</span>

        <span class="c1"># Push the children onto the stack, being careful with ordering and</span>
        <span class="c1"># marking the last node as such.</span>
        <span class="n">child_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">child_items</span><span class="p">:</span>
            <span class="n">child_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">child_items</span><span class="p">)</span>
            <span class="n">child_name</span><span class="p">,</span> <span class="n">child_account</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">child_iter</span><span class="p">)</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cont</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">child_account</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">child_account</span> <span class="ow">in</span> <span class="n">child_iter</span><span class="p">:</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cont</span><span class="p">,</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">child_account</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lines</span>

    <span class="c1"># Compute the maximum width of the lines and convert all of them to the same</span>
    <span class="c1"># maximal width. This makes it easy on the client.</span>
    <span class="n">max_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_line</span><span class="p">)</span> <span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">)</span>
    <span class="n">line_format</span> <span class="o">=</span> <span class="s2">&quot;{{:</span><span class="si">{width}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">max_width</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">first_line</span><span class="p">),</span> <span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont_line</span><span class="p">),</span> <span class="n">real_node</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">first_line</span><span class="p">,</span> <span class="n">cont_line</span><span class="p">,</span> <span class="n">real_node</span><span class="p">)</span> <span class="ow">in</span> <span class="n">lines</span>
    <span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.dump_balances" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">dump_balances</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">at_cost</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fullnames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.realization.dump_balances" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Dump a realization tree with balances.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_root</strong>  An instance of RealAccount.</p></li>
            <li><p><strong>dformat</strong>  An instance of DisplayFormatter to format the numbers with.</p></li>
            <li><p><strong>at_cost</strong>  A boolean, if true, render the values at cost.</p></li>
            <li><p><strong>fullnames</strong>  A boolean, if true, don't render a tree of accounts and
render the full account names.</p></li>
            <li><p><strong>file</strong>  A file object to dump the output to. If not specified, we
return the output as a string.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A string, the rendered tree, or nothing, if 'file' was provided.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dump_balances</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">at_cost</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fullnames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dump a realization tree with balances.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_root: An instance of RealAccount.</span>
<span class="sd">      dformat: An instance of DisplayFormatter to format the numbers with.</span>
<span class="sd">      at_cost: A boolean, if true, render the values at cost.</span>
<span class="sd">      fullnames: A boolean, if true, don&#39;t render a tree of accounts and</span>
<span class="sd">        render the full account names.</span>
<span class="sd">      file: A file object to dump the output to. If not specified, we</span>
<span class="sd">        return the output as a string.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A string, the rendered tree, or nothing, if &#39;file&#39; was provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fullnames</span><span class="p">:</span>
        <span class="c1"># Compute the maximum account name length;</span>
        <span class="n">maxlen</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">real_child</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">real_child</span> <span class="ow">in</span> <span class="n">iter_children</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">line_format</span> <span class="o">=</span> <span class="s2">&quot;{{:</span><span class="si">{width}</span><span class="s2">}} {{}}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">line_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">       </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">cont_line</span><span class="p">,</span> <span class="n">real_account</span> <span class="ow">in</span> <span class="n">dump</span><span class="p">(</span><span class="n">real_root</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">real_account</span><span class="o">.</span><span class="n">balance</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">at_cost</span><span class="p">:</span>
                <span class="n">rinv</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">balance</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_cost</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rinv</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">balance</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">convert</span><span class="o">.</span><span class="n">get_units</span><span class="p">)</span>
            <span class="n">amounts</span> <span class="o">=</span> <span class="p">[</span><span class="n">position</span><span class="o">.</span><span class="n">units</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">rinv</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()]</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">amount_</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">dformat</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">amount_</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">amounts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">amount</span><span class="o">.</span><span class="n">sortkey</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fullnames</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">position</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_account</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># Skip parent accounts with no position to render.</span>
                <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">account</span><span class="p">,</span> <span class="n">position</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">first_line</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">position</span><span class="p">))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">cont_line</span>

    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span></code>


<a href="#beancount.core.realization.filter" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Filter a RealAccount tree of nodes by the predicate.</p>
<p>This function visits the tree and applies the predicate on each node. It
returns a partial clone of RealAccount whereby on each node
- either the predicate is true, or
- for at least one child of the node the predicate is true.
All the leaves have the predicate be true.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_account</strong>  An instance of RealAccount.</p></li>
            <li><p><strong>predicate</strong>  A callable/function which accepts a RealAccount and returns
a boolean. If the function returns True, the node is kept.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A shallow clone of RealAccount is always returned.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">predicate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter a RealAccount tree of nodes by the predicate.</span>

<span class="sd">    This function visits the tree and applies the predicate on each node. It</span>
<span class="sd">    returns a partial clone of RealAccount whereby on each node</span>
<span class="sd">    - either the predicate is true, or</span>
<span class="sd">    - for at least one child of the node the predicate is true.</span>
<span class="sd">    All the leaves have the predicate be true.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: An instance of RealAccount.</span>
<span class="sd">      predicate: A callable/function which accepts a RealAccount and returns</span>
<span class="sd">        a boolean. If the function returns True, the node is kept.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A shallow clone of RealAccount is always returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">RealAccount</span><span class="p">)</span>

    <span class="n">real_copy</span> <span class="o">=</span> <span class="n">RealAccount</span><span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">account</span><span class="p">)</span>
    <span class="n">real_copy</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">balance</span>
    <span class="n">real_copy</span><span class="o">.</span><span class="n">txn_postings</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">txn_postings</span>

    <span class="k">for</span> <span class="n">child_name</span><span class="p">,</span> <span class="n">real_child</span> <span class="ow">in</span> <span class="n">real_account</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">real_child_copy</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">real_child</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">real_child_copy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">real_copy</span><span class="p">[</span><span class="n">child_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_child_copy</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_copy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">predicate</span><span class="p">(</span><span class="n">real_account</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">real_copy</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.find_last_active_posting" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">find_last_active_posting</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span></code>


<a href="#beancount.core.realization.find_last_active_posting" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Look at the end of the list of postings, and find the last
posting or entry that is not an automatically added directive.
Note that if the account is closed, the last posting is assumed
to be a Close directive (this is the case if the input is valid
and checks without errors.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>txn_postings</strong>  a list of postings or entries.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>An entry, or None, if the input list was empty.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_last_active_posting</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look at the end of the list of postings, and find the last</span>
<span class="sd">    posting or entry that is not an automatically added directive.</span>
<span class="sd">    Note that if the account is closed, the last posting is assumed</span>
<span class="sd">    to be a Close directive (this is the case if the input is valid</span>
<span class="sd">    and checks without errors.</span>

<span class="sd">    Args:</span>
<span class="sd">      txn_postings: a list of postings or entries.</span>
<span class="sd">    Returns:</span>
<span class="sd">      An entry, or None, if the input list was empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">txn_posting</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">Posting</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="p">(</span><span class="n">TxnPosting</span><span class="p">,</span> <span class="n">Open</span><span class="p">,</span> <span class="n">Close</span><span class="p">,</span> <span class="n">Pad</span><span class="p">,</span> <span class="n">Balance</span><span class="p">,</span> <span class="n">Note</span><span class="p">)):</span>
            <span class="k">continue</span>
        <span class="k">return</span> <span class="n">txn_posting</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#beancount.core.realization.get" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Fetch the subaccount name from the real_account node.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_account</strong>  An instance of RealAccount, the parent node to look for
children of.</p></li>
            <li><p><strong>account_name</strong>  A string, the name of a possibly indirect child leaf
found down the tree of 'real_account' nodes.</p></li>
            <li><p><strong>default</strong>  The default value that should be returned if the child
subaccount is not found.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A RealAccount instance for the child, or the default value, if the child
is not found.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch the subaccount name from the real_account node.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: An instance of RealAccount, the parent node to look for</span>
<span class="sd">        children of.</span>
<span class="sd">      account_name: A string, the name of a possibly indirect child leaf</span>
<span class="sd">        found down the tree of &#39;real_account&#39; nodes.</span>
<span class="sd">      default: The default value that should be returned if the child</span>
<span class="sd">        subaccount is not found.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A RealAccount instance for the child, or the default value, if the child</span>
<span class="sd">      is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">components</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
        <span class="n">real_child</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">real_child</span> <span class="ow">is</span> <span class="n">default</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="n">real_account</span> <span class="o">=</span> <span class="n">real_child</span>
    <span class="k">return</span> <span class="n">real_account</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.get_or_create" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span></code>


<a href="#beancount.core.realization.get_or_create" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Fetch the subaccount name from the real_account node.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_account</strong>  An instance of RealAccount, the parent node to look for
children of, or create under.</p></li>
            <li><p><strong>account_name</strong>  A string, the name of the direct or indirect child leaf
to get or create.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A RealAccount instance for the child, or the default value, if the child
is not found.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_or_create</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">account_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch the subaccount name from the real_account node.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: An instance of RealAccount, the parent node to look for</span>
<span class="sd">        children of, or create under.</span>
<span class="sd">      account_name: A string, the name of the direct or indirect child leaf</span>
<span class="sd">        to get or create.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A RealAccount instance for the child, or the default value, if the child</span>
<span class="sd">      is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">components</span> <span class="o">=</span> <span class="n">account</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">account_name</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
        <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">real_child</span> <span class="o">=</span> <span class="n">real_account</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">real_child</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">real_child</span> <span class="o">=</span> <span class="n">RealAccount</span><span class="p">(</span><span class="n">account</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="p">))</span>
            <span class="n">real_account</span><span class="p">[</span><span class="n">component</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_child</span>
        <span class="n">real_account</span> <span class="o">=</span> <span class="n">real_child</span>
    <span class="k">return</span> <span class="n">real_account</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.get_postings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">get_postings</span><span class="p">(</span><span class="n">real_account</span><span class="p">)</span></code>


<a href="#beancount.core.realization.get_postings" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Return a sorted list a RealAccount's postings and children.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_account</strong>  An instance of RealAccount.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A list of Posting or directories.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_postings</span><span class="p">(</span><span class="n">real_account</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a sorted list a RealAccount&#39;s postings and children.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: An instance of RealAccount.</span>
<span class="sd">    Returns:</span>
<span class="sd">      A list of Posting or directories.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We accumulate all the postings at once here instead of incrementally</span>
    <span class="c1"># because we need to return them sorted.</span>
    <span class="n">accumulator</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">real_child</span> <span class="ow">in</span> <span class="n">iter_children</span><span class="p">(</span><span class="n">real_account</span><span class="p">):</span>
        <span class="n">accumulator</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">real_child</span><span class="o">.</span><span class="n">txn_postings</span><span class="p">)</span>
    <span class="n">accumulator</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">posting_sortkey</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">accumulator</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.index_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">index_key</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">cmp</span><span class="p">)</span></code>


<a href="#beancount.core.realization.index_key" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Find the index of the first element in 'sequence' which is equal to 'value'.
If 'key' is specified, the value compared to the value returned by this
function. If the value is not found, return None.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>sequence</strong>  The sequence to search.</p></li>
            <li><p><strong>value</strong>  The value to search for.</p></li>
            <li><p><strong>key</strong>  A predicate to call to obtain the value to compare against.</p></li>
            <li><p><strong>cmp</strong>  A comparison predicate.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The index of the first element found, or None, if the element was not found.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">index_key</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">cmp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the index of the first element in &#39;sequence&#39; which is equal to &#39;value&#39;.</span>
<span class="sd">    If &#39;key&#39; is specified, the value compared to the value returned by this</span>
<span class="sd">    function. If the value is not found, return None.</span>

<span class="sd">    Args:</span>
<span class="sd">      sequence: The sequence to search.</span>
<span class="sd">      value: The value to search for.</span>
<span class="sd">      key: A predicate to call to obtain the value to compare against.</span>
<span class="sd">      cmp: A comparison predicate.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The index of the first element found, or None, if the element was not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cmp</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">element</span><span class="p">),</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">index</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.iter_children" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">iter_children</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#beancount.core.realization.iter_children" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Iterate this account node and all its children, depth-first.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>real_account</strong>  An instance of RealAccount.</p></li>
            <li><p><strong>leaf_only</strong>  A boolean flag, true if we should yield only leaves.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  Instances of RealAccount, beginning with this account. The order is
  undetermined.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">iter_children</span><span class="p">(</span><span class="n">real_account</span><span class="p">,</span> <span class="n">leaf_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate this account node and all its children, depth-first.</span>

<span class="sd">    Args:</span>
<span class="sd">      real_account: An instance of RealAccount.</span>
<span class="sd">      leaf_only: A boolean flag, true if we should yield only leaves.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Instances of RealAccount, beginning with this account. The order is</span>
<span class="sd">      undetermined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">leaf_only</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">real_account</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">real_account</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">real_child</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">real_subchild</span> <span class="ow">in</span> <span class="n">iter_children</span><span class="p">(</span><span class="n">real_child</span><span class="p">,</span> <span class="n">leaf_only</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">real_subchild</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">real_account</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">real_child</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">real_account</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">for</span> <span class="n">real_subchild</span> <span class="ow">in</span> <span class="n">iter_children</span><span class="p">(</span><span class="n">real_child</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">real_subchild</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.iterate_with_balance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">iterate_with_balance</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span></code>


<a href="#beancount.core.realization.iterate_with_balance" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Iterate over the entries, accumulating the running balance.</p>
<p>For each entry, this yields tuples of the form:</p>
<p>(entry, postings, change, balance)</p>
<p>entry: This is the directive for this line. If the list contained Posting
  instance, this yields the corresponding Transaction object.
postings: A list of postings on this entry that affect the balance. Only the
  postings encountered in the input list are included; only those affect the
  balance. If 'entry' is not a Transaction directive, this should always be
  an empty list. We preserve the original ordering of the postings as they
  appear in the input list.
change: An Inventory object that reflects the total change due to the
  postings from this entry that appear in the list. For example, if a
  Transaction has three postings and two are in the input list, the sum of
  the two postings will be in the 'change' Inventory object. However, the
  position for the transactions' third posting--the one not included in the
  input list--will not be in this inventory.
balance: An Inventory object that reflects the balance <em>after</em> adding the
  'change' inventory due to this entry's transaction. The 'balance' yielded
  is never None, even for entries that do not affect the balance, that is,
  with an empty 'change' inventory. It's up to the caller, the one rendering
  the entry, to decide whether to render this entry's change for a
  particular entry type.</p>
<p>Note that if the input list of postings-or-entries is not in sorted date
order, two postings for the same entry appearing twice with a different date
in between will cause the entry appear twice. This is correct behavior, and
it is expected that in practice this should never happen anyway, because the
list of postings or entries should always be sorted. This method attempts to
detect this and raises an assertion if this is seen.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>txn_postings</strong>  A list of postings or directive instances.
Postings affect the balance; other entries do not.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>      <p>Yields:
  Tuples of (entry, postings, change, balance) as described above.</p>

        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">iterate_with_balance</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the entries, accumulating the running balance.</span>

<span class="sd">    For each entry, this yields tuples of the form:</span>

<span class="sd">      (entry, postings, change, balance)</span>

<span class="sd">    entry: This is the directive for this line. If the list contained Posting</span>
<span class="sd">      instance, this yields the corresponding Transaction object.</span>
<span class="sd">    postings: A list of postings on this entry that affect the balance. Only the</span>
<span class="sd">      postings encountered in the input list are included; only those affect the</span>
<span class="sd">      balance. If &#39;entry&#39; is not a Transaction directive, this should always be</span>
<span class="sd">      an empty list. We preserve the original ordering of the postings as they</span>
<span class="sd">      appear in the input list.</span>
<span class="sd">    change: An Inventory object that reflects the total change due to the</span>
<span class="sd">      postings from this entry that appear in the list. For example, if a</span>
<span class="sd">      Transaction has three postings and two are in the input list, the sum of</span>
<span class="sd">      the two postings will be in the &#39;change&#39; Inventory object. However, the</span>
<span class="sd">      position for the transactions&#39; third posting--the one not included in the</span>
<span class="sd">      input list--will not be in this inventory.</span>
<span class="sd">    balance: An Inventory object that reflects the balance *after* adding the</span>
<span class="sd">      &#39;change&#39; inventory due to this entry&#39;s transaction. The &#39;balance&#39; yielded</span>
<span class="sd">      is never None, even for entries that do not affect the balance, that is,</span>
<span class="sd">      with an empty &#39;change&#39; inventory. It&#39;s up to the caller, the one rendering</span>
<span class="sd">      the entry, to decide whether to render this entry&#39;s change for a</span>
<span class="sd">      particular entry type.</span>

<span class="sd">    Note that if the input list of postings-or-entries is not in sorted date</span>
<span class="sd">    order, two postings for the same entry appearing twice with a different date</span>
<span class="sd">    in between will cause the entry appear twice. This is correct behavior, and</span>
<span class="sd">    it is expected that in practice this should never happen anyway, because the</span>
<span class="sd">    list of postings or entries should always be sorted. This method attempts to</span>
<span class="sd">    detect this and raises an assertion if this is seen.</span>

<span class="sd">    Args:</span>
<span class="sd">      txn_postings: A list of postings or directive instances.</span>
<span class="sd">        Postings affect the balance; other entries do not.</span>
<span class="sd">    Yields:</span>
<span class="sd">      Tuples of (entry, postings, change, balance) as described above.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The running balance.</span>
    <span class="n">running_balance</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">()</span>

    <span class="c1"># Previous date.</span>
    <span class="n">prev_date</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># A list of entries at the current date.</span>
    <span class="n">date_entries</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">first</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pair</span><span class="p">:</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">txn_posting</span> <span class="ow">in</span> <span class="n">txn_postings</span><span class="p">:</span>
        <span class="c1"># Get the posting if we are dealing with one.</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">Posting</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">txn_posting</span><span class="p">,</span> <span class="n">TxnPosting</span><span class="p">):</span>
            <span class="n">posting</span> <span class="o">=</span> <span class="n">txn_posting</span><span class="o">.</span><span class="n">posting</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">txn_posting</span><span class="o">.</span><span class="n">txn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">posting</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="n">txn_posting</span>

        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span> <span class="o">!=</span> <span class="n">prev_date</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">prev_date</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;</span> <span class="n">prev_date</span>
            <span class="p">),</span> <span class="s2">&quot;Invalid date order for postings: </span><span class="si">{}</span><span class="s2"> &gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prev_date</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
            <span class="n">prev_date</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">date</span>

            <span class="c1"># Flush the dated entries.</span>
            <span class="k">for</span> <span class="n">date_entry</span><span class="p">,</span> <span class="n">date_postings</span> <span class="ow">in</span> <span class="n">date_entries</span><span class="p">:</span>
                <span class="n">change</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">date_postings</span><span class="p">:</span>
                    <span class="c1"># Compute the change due to this transaction and update the</span>
                    <span class="c1"># total balance at the same time.</span>
                    <span class="k">for</span> <span class="n">date_posting</span> <span class="ow">in</span> <span class="n">date_postings</span><span class="p">:</span>
                        <span class="n">change</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">date_posting</span><span class="p">)</span>
                        <span class="n">running_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">date_posting</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">date_entry</span><span class="p">,</span> <span class="n">date_postings</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span> <span class="n">running_balance</span>

            <span class="n">date_entries</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="n">date_entries</span>

        <span class="k">if</span> <span class="n">posting</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># De-dup multiple postings on the same transaction entry by</span>
            <span class="c1"># grouping their positions together.</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">index_key</span><span class="p">(</span><span class="n">date_entries</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">is_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">date_entries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">entry</span><span class="p">,</span> <span class="p">[</span><span class="n">posting</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># We are indeed de-duping!</span>
                <span class="n">postings</span> <span class="o">=</span> <span class="n">date_entries</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">postings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">posting</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This is a regular entry; nothing to add/remove.</span>
            <span class="n">date_entries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">entry</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="c1"># Flush the final dated entries if any, same as above.</span>
    <span class="k">for</span> <span class="n">date_entry</span><span class="p">,</span> <span class="n">date_postings</span> <span class="ow">in</span> <span class="n">date_entries</span><span class="p">:</span>
        <span class="n">change</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">Inventory</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">date_postings</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">date_posting</span> <span class="ow">in</span> <span class="n">date_postings</span><span class="p">:</span>
                <span class="n">change</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">date_posting</span><span class="p">)</span>
                <span class="n">running_balance</span><span class="o">.</span><span class="n">add_position</span><span class="p">(</span><span class="n">date_posting</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">date_entry</span><span class="p">,</span> <span class="n">date_postings</span><span class="p">,</span> <span class="n">change</span><span class="p">,</span> <span class="n">running_balance</span>
    <span class="n">date_entries</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.postings_by_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">postings_by_account</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></code>


<a href="#beancount.core.realization.postings_by_account" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Create lists of postings and balances by account.</p>
<p>This routine aggregates postings and entries grouping them by account name.
The resulting lists contain postings in-lieu of Transaction directives, but
the other directives are stored as entries. This yields a list of postings
or other entries by account. All references to accounts are taken into
account.</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>A mapping of account name to list of TxnPosting instances or
non-Transaction directives, sorted in the same order as the entries.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">postings_by_account</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create lists of postings and balances by account.</span>

<span class="sd">    This routine aggregates postings and entries grouping them by account name.</span>
<span class="sd">    The resulting lists contain postings in-lieu of Transaction directives, but</span>
<span class="sd">    the other directives are stored as entries. This yields a list of postings</span>
<span class="sd">    or other entries by account. All references to accounts are taken into</span>
<span class="sd">    account.</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">    Returns:</span>
<span class="sd">       A mapping of account name to list of TxnPosting instances or</span>
<span class="sd">       non-Transaction directives, sorted in the same order as the entries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">txn_postings_map</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Transaction</span><span class="p">):</span>
            <span class="c1"># Insert an entry for each of the postings.</span>
            <span class="k">for</span> <span class="n">posting</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">postings</span><span class="p">:</span>
                <span class="n">txn_postings_map</span><span class="p">[</span><span class="n">posting</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TxnPosting</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">posting</span><span class="p">))</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="p">(</span><span class="n">Open</span><span class="p">,</span> <span class="n">Close</span><span class="p">,</span> <span class="n">Balance</span><span class="p">,</span> <span class="n">Note</span><span class="p">,</span> <span class="n">Document</span><span class="p">)):</span>
            <span class="c1"># Append some other entries in the realized list.</span>
            <span class="n">txn_postings_map</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Pad</span><span class="p">):</span>
            <span class="c1"># Insert the pad entry in both realized accounts.</span>
            <span class="n">txn_postings_map</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">txn_postings_map</span><span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">source_account</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">Custom</span><span class="p">):</span>
            <span class="c1"># Insert custom entry for each account in its values.</span>
            <span class="k">for</span> <span class="n">custom_value</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">custom_value</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">account</span><span class="o">.</span><span class="n">TYPE</span><span class="p">:</span>
                    <span class="n">txn_postings_map</span><span class="p">[</span><span class="n">custom_value</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">txn_postings_map</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="beancount.core.realization.realize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">beancount</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">realization</span><span class="o">.</span><span class="n">realize</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">min_accounts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compute_balance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#beancount.core.realization.realize" class="headerlink" title="Permanent link"></a></h3>

    <div class="doc doc-contents ">

      <p>Group entries by account, into a "tree" of realized accounts. RealAccount's
are essentially containers for lists of postings and the final balance of
each account, and may be non-leaf accounts (used strictly for organizing
accounts into a hierarchy). This is then used to issue reports.</p>
<p>The lists of postings in each account my be any of the entry types, except
for Transaction, whereby Transaction entries are replaced by the specific
Posting legs that belong to the account. Here's a simple diagram that
summarizes this seemingly complex, but rather simple data structure:</p>
<p>+-------------+ postings  +------+
   | RealAccount |----------&gt;| Open |
   +-------------+           +------+
                                 |
                                 v
                          +------------+     +-------------+
                          | TxnPosting |----&gt;| Transaction |
                          +------------+     +-------------+
                                 |      \                 \\
                                 v       <code>\.__          +---------+
                              +-----+</code>--------&gt;| Posting |
                              | Pad |                   +---------+
                              +-----+
                                 |
                                 v
                            +---------+
                            | Balance |
                            +---------+
                                 |
                                 v
                             +-------+
                             | Close |
                             +-------+
                                 |
                                 .</p>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li><p><strong>entries</strong>  A list of directives.</p></li>
            <li><p><strong>min_accounts</strong>  A list of strings, account names to ensure we create,
regardless of whether there are postings on those accounts or not.
This can be used to ensure the root accounts all exist.</p></li>
            <li><p><strong>compute_balance</strong>  A boolean, true if we should compute the final
balance on the realization.</p></li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
    <th class="field-name">Returns:</th>
    <td class="field-body">
        <ul class="first simple">
          <li><p>The root RealAccount instance.</p></li>
        </ul>
    </td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>beancount/core/realization.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">realize</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">min_accounts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compute_balance</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Group entries by account, into a &quot;tree&quot; of realized accounts. RealAccount&#39;s</span>
<span class="sd">    are essentially containers for lists of postings and the final balance of</span>
<span class="sd">    each account, and may be non-leaf accounts (used strictly for organizing</span>
<span class="sd">    accounts into a hierarchy). This is then used to issue reports.</span>

<span class="sd">    The lists of postings in each account my be any of the entry types, except</span>
<span class="sd">    for Transaction, whereby Transaction entries are replaced by the specific</span>
<span class="sd">    Posting legs that belong to the account. Here&#39;s a simple diagram that</span>
<span class="sd">    summarizes this seemingly complex, but rather simple data structure:</span>

<span class="sd">       +-------------+ postings  +------+</span>
<span class="sd">       | RealAccount |----------&gt;| Open |</span>
<span class="sd">       +-------------+           +------+</span>
<span class="sd">                                     |</span>
<span class="sd">                                     v</span>
<span class="sd">                              +------------+     +-------------+</span>
<span class="sd">                              | TxnPosting |----&gt;| Transaction |</span>
<span class="sd">                              +------------+     +-------------+</span>
<span class="sd">                                     |      \                 \\\</span>
<span class="sd">                                     v       `\.__          +---------+</span>
<span class="sd">                                  +-----+         `--------&gt;| Posting |</span>
<span class="sd">                                  | Pad |                   +---------+</span>
<span class="sd">                                  +-----+</span>
<span class="sd">                                     |</span>
<span class="sd">                                     v</span>
<span class="sd">                                +---------+</span>
<span class="sd">                                | Balance |</span>
<span class="sd">                                +---------+</span>
<span class="sd">                                     |</span>
<span class="sd">                                     v</span>
<span class="sd">                                 +-------+</span>
<span class="sd">                                 | Close |</span>
<span class="sd">                                 +-------+</span>
<span class="sd">                                     |</span>
<span class="sd">                                     .</span>

<span class="sd">    Args:</span>
<span class="sd">      entries: A list of directives.</span>
<span class="sd">      min_accounts: A list of strings, account names to ensure we create,</span>
<span class="sd">        regardless of whether there are postings on those accounts or not.</span>
<span class="sd">        This can be used to ensure the root accounts all exist.</span>
<span class="sd">      compute_balance: A boolean, true if we should compute the final</span>
<span class="sd">        balance on the realization.</span>
<span class="sd">    Returns:</span>
<span class="sd">      The root RealAccount instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create lists of the entries by account.</span>
    <span class="n">txn_postings_map</span> <span class="o">=</span> <span class="n">postings_by_account</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

    <span class="c1"># Create a RealAccount tree and compute the balance for each.</span>
    <span class="n">real_root</span> <span class="o">=</span> <span class="n">RealAccount</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">account_name</span><span class="p">,</span> <span class="n">txn_postings</span> <span class="ow">in</span> <span class="n">txn_postings_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">real_account</span> <span class="o">=</span> <span class="n">get_or_create</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span>
        <span class="n">real_account</span><span class="o">.</span><span class="n">txn_postings</span> <span class="o">=</span> <span class="n">txn_postings</span>
        <span class="k">if</span> <span class="n">compute_balance</span><span class="p">:</span>
            <span class="n">real_account</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">compute_postings_balance</span><span class="p">(</span><span class="n">txn_postings</span><span class="p">)</span>

    <span class="c1"># Ensure a minimum set of accounts that should exist. This is typically</span>
    <span class="c1"># called with an instance of AccountTypes to make sure that those exist.</span>
    <span class="k">if</span> <span class="n">min_accounts</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">account_name</span> <span class="ow">in</span> <span class="n">min_accounts</span><span class="p">:</span>
            <span class="n">get_or_create</span><span class="p">(</span><span class="n">real_root</span><span class="p">,</span> <span class="n">account_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">real_root</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="beancount.loader.html" class="btn btn-neutral float-right" title="beancount.loader">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="beancount"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="index.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="beancount.loader.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
