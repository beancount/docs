<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://beancount.github.io/docs/api_reference/beancount.query.html" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>beancount.query - Beancount Documentation</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="../css/custom.css" rel="stylesheet"/>
<script>
    // Current page data
    var mkdocs_page_name = "beancount.query";
    var mkdocs_page_input_path = "api_reference/beancount.query.md";
    var mkdocs_page_url = "/docs/api_reference/beancount.query.html";
  </script>
<script defer="" src="../js/jquery-2.1.1.min.js"></script>
<script defer="" src="../js/modernizr-2.8.3.min.js"></script>
</link></link></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> Beancount Documentation</a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Index</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Outline</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Users</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../01_command_line_accounting_in_context.html">Command Line Accounting in Context</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../02_the_double_entry_counting_method.html">The Double Entry Counting Method</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_installing_beancount.html">Installing Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_running_beancount_and_generating_reports.html">Running Beancount and Generating Reports</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../05_getting_started_with_beancount.html">Getting Started with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../06_beancount_language_syntax.html">Beancount Language Syntax</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../07_beancount_options_reference.html">Beancount Options Reference</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../08_precision_tolerances.html">Precision Tolerances</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../09_beancount_query_language.html">Beancount Query Language</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../10_beancount_cheat_sheet.html">Beancount Cheat Sheet</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../11_how_inventories_work.html">How Inventories Work</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../12_exporting_your_portfolio.html">Exporting Your Portfolio</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../13_tutorial_example.html">Tutorial &amp; Example</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../14_beancount_history_and_credits.html">Beancount History and Credits</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../15_a_comparison_of_beancount_and_ledger_hledger.html">A Comparison of Beancount and Ledger Hledger</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../16_fetching_prices_in_beancount.html">Fetching Prices in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../17_importing_external_data.html">Importing External Data</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Cookbooks &amp; Examples</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../18_command_line_accounting_cookbook.html">Command Line Accounting Cookbook</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../19_trading_with_beancount.html">Trading with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../20_stock_vesting_in_beancount.html">Stock Vesting in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../21_sharing_expenses_with_beancount.html">Sharing Expenses with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../22_how_we_share_expenses.html">How We Share Expenses</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Documentation for Developers</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../23_beancount_scripting_plugins.html">Beancount Scripting Plugins</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../24_beancount_design_doc.html">Beancount Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../25_ledgerhub_design_doc.html">Ledgerhub Design Doc</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../26_external_contributions.html">External Contributions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Enhancement Proposals &amp; Discussions</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../27_a_proposal_for_an_improvement_on_inventory_booking.html">A Proposal for an Improvement on Inventory Booking</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../28_settlement_dates_in_beancount.html">Settlement Dates in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../29_balance_assertions_in_beancount.html">Balance Assertions in Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../30_fund_accounting_with_beancount.html">Fund Accounting with Beancount</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../31_rounding_precision_in_beancount.html">Rounding Precision in Beancount</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">beancount</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.core.html">beancount.core</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ingest.html">beancount.ingest</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.loader.html">beancount.loader</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.ops.html">beancount.ops</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.parser.html">beancount.parser</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.plugins.html">beancount.plugins</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.prices.html">beancount.prices</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="beancount.query.html">beancount.query</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#beancount.query">beancount.query</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.numberify">numberify</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.AmountConverter">AmountConverter</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.numberify.AmountConverter.dtype">dtype</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.IdentityConverter">IdentityConverter</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.InventoryConverter">InventoryConverter</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.numberify.InventoryConverter.dtype">dtype</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.PositionConverter">PositionConverter</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.numberify.PositionConverter.dtype">dtype</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.convert_col_Amount">convert_col_Amount()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.convert_col_Inventory">convert_col_Inventory()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.convert_col_Position">convert_col_Position()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.numberify.numberify_results">numberify_results()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query">query</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query.run_query">run_query()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_compile">query_compile</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.CompilationEnvironment">CompilationEnvironment</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.CompilationEnvironment.get_column">get_column()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.CompilationEnvironment.get_function">get_function()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.CompilationError">CompilationError</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalAggregator">EvalAggregator</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalAggregator.__call__">__call__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalAggregator.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalAggregator.finalize">finalize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalAggregator.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalAggregator.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalColumn">EvalColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom">EvalFrom</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalFrom._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalFunction">EvalFunction</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalNode">EvalNode</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalNode.__call__">__call__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalNode.__eq__">__eq__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalNode.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalNode.childnodes">childnodes()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint">EvalPrint</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalPrint._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery">EvalQuery</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalQuery._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget">EvalTarget</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.EvalTarget._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.ResultSetEnvironment">ResultSetEnvironment</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile.ResultSetEnvironment.get_column">get_column()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile._get_columns_and_aggregates">_get_columns_and_aggregates()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile">compile()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_expression">compile_expression()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_from">compile_from()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_group_by">compile_group_by()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_order_by">compile_order_by()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_print">compile_print()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_select">compile_select()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.compile_targets">compile_targets()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.find_unique_name">find_unique_name()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.get_columns_and_aggregates">get_columns_and_aggregates()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.is_aggregate">is_aggregate()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.is_hashable_type">is_hashable_type()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.transform_balances">transform_balances()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile.transform_journal">transform_journal()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_compile_test">query_compile_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_compile_test.CompileSelectBase">CompileSelectBase</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile_test.CompileSelectBase.assertCompile">assertCompile()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile_test.CompileSelectBase.assertIndexes">assertIndexes()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile_test.CompileSelectBase.assertSelectInvariants">assertSelectInvariants()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile_test.CompileSelectBase.compile">compile()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_compile_test.CompileSelectBase.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_env">query_env</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env._Neg">_Neg</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.AbsDecimal">AbsDecimal</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.AbsInventory">AbsInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.AbsPosition">AbsPosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.AccountColumn">AccountColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.AccountSortKey">AccountSortKey</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.AnyMeta">AnyMeta</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.BalanceColumn">BalanceColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CloseDate">CloseDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Coalesce">Coalesce</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ConvertAmount">ConvertAmount</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ConvertAmountWithDate">ConvertAmountWithDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ConvertInventory">ConvertInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ConvertInventoryWithDate">ConvertInventoryWithDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ConvertPosition">ConvertPosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ConvertPositionWithDate">ConvertPositionWithDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CostCurrencyColumn">CostCurrencyColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CostDateColumn">CostDateColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CostInventory">CostInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CostLabelColumn">CostLabelColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CostNumberColumn">CostNumberColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CostPosition">CostPosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Count">Count</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Count.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Count.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Count.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Currency">Currency</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CurrencyColumn">CurrencyColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.CurrencyMeta">CurrencyMeta</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Date">Date</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DateAdd">DateAdd</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DateColumn">DateColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DateDiff">DateDiff</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DateEntryColumn">DateEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Day">Day</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DayColumn">DayColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DayEntryColumn">DayEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DescriptionColumn">DescriptionColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.DescriptionEntryColumn">DescriptionEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.EntryMeta">EntryMeta</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FileLocationColumn">FileLocationColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FilenameColumn">FilenameColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FilenameEntryColumn">FilenameEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FilterCurrencyInventory">FilterCurrencyInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FilterCurrencyPosition">FilterCurrencyPosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FilterEntriesEnvironment">FilterEntriesEnvironment</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FilterPostingsEnvironment">FilterPostingsEnvironment</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FindFirst">FindFirst</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.First">First</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.First.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.First.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.First.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FlagColumn">FlagColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.FlagEntryColumn">FlagEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.GetItemStr">GetItemStr</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Grep">Grep</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.GrepN">GrepN</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.IdColumn">IdColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.IdEntryColumn">IdEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.JoinStr">JoinStr</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Last">Last</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Last.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Last.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Last.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Leaf">Leaf</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Length">Length</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.LineNoColumn">LineNoColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.LineNoEntryColumn">LineNoEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.LinksColumn">LinksColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.LinksEntryColumn">LinksEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.MatchAccount">MatchAccount</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Max">Max</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Max.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Max.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Max.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.MaxWidth">MaxWidth</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Meta">Meta</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Min">Min</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Min.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Min.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Min.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Month">Month</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.MonthColumn">MonthColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.MonthEntryColumn">MonthEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.NarrationColumn">NarrationColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.NarrationEntryColumn">NarrationEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Number">Number</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.NumberColumn">NumberColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.OnlyInventory">OnlyInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.OpenDate">OpenDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.OpenMeta">OpenMeta</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.OtherAccountsColumn">OtherAccountsColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Parent">Parent</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ParseDate">ParseDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PayeeColumn">PayeeColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PayeeEntryColumn">PayeeEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PositionColumn">PositionColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PosSignAmount">PosSignAmount</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PosSignDecimal">PosSignDecimal</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PosSignInventory">PosSignInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PosSignPosition">PosSignPosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PostingFlagColumn">PostingFlagColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Price">Price</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PriceColumn">PriceColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.PriceWithDate">PriceWithDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Quarter">Quarter</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Root">Root</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.SafeDiv">SafeDiv</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Str">Str</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Subst">Subst</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Sum">Sum</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Sum.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Sum.initialize">initialize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.Sum.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.SumAmount">SumAmount</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.SumAmount.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.SumBase">SumBase</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.SumBase.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.SumBase.initialize">initialize()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.SumInventory">SumInventory</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.SumInventory.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.SumPosition">SumPosition</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env.SumPosition.update">update()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.TagsColumn">TagsColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.TagsEntryColumn">TagsEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.TargetsEnvironment">TargetsEnvironment</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Today">Today</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.TypeColumn">TypeColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.TypeEntryColumn">TypeEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.UnitsInventory">UnitsInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.UnitsPosition">UnitsPosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ValueInventory">ValueInventory</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ValueInventoryWithDate">ValueInventoryWithDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ValuePosition">ValuePosition</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.ValuePositionWithDate">ValuePositionWithDate</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Weekday">Weekday</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.WeightColumn">WeightColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.Year">Year</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.YearColumn">YearColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.YearEntryColumn">YearEntryColumn</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env.YearMonth">YearMonth</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_env_test">query_env_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv">TestEnv</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv.test_AnyMeta">test_AnyMeta()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv.test_Coalesce">test_Coalesce()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv.test_Date">test_Date()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv.test_DateDiffAdjust">test_DateDiffAdjust()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv.test_GrepN">test_GrepN()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_env_test.TestEnv.test_Subst">test_Subst()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_execute">query_execute</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.Allocator">Allocator</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_execute.Allocator.allocate">allocate()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_execute.Allocator.create_store">create_store()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.RowContext">RowContext</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.create_row_context">create_row_context()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.execute_print">execute_print()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.execute_query">execute_query()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.filter_entries">filter_entries()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.flatten_results">flatten_results()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.row_sortkey">row_sortkey()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute.uses_balance_column">uses_balance_column()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_execute_test">query_execute_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_execute_test.QueryBase">QueryBase</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_execute_test.QueryBase.compile">compile()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_execute_test.QueryBase.parse">parse()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_execute_test.QueryBase.setUp">setUp()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_parser">query_parser</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Balances">Balances</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Balances.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Balances.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Balances.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Balances._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Balances._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Balances._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Errors">Errors</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Errors.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Errors.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Errors.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Errors._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Errors._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Errors._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Explain">Explain</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Explain.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Explain.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Explain.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Explain._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Explain._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Explain._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Journal">Journal</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Journal.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Journal.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Journal.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Journal._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Journal._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Journal._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Lexer">Lexer</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Lexer.t_DATE">t_DATE()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Lexer.t_DECIMAL">t_DECIMAL()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Lexer.t_ID">t_ID()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Lexer.t_INTEGER">t_INTEGER()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Lexer.t_STRING">t_STRING()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.ParseError">ParseError</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Parser">Parser</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_balances_statement">p_balances_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_delimiter">p_delimiter()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_errors_statement">p_errors_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_explain_statement">p_explain_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_journal_statement">p_journal_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_print_statement">p_print_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_regular_statement">p_regular_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_reload_statement">p_reload_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_run_statement">p_run_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_statement">p_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Parser.p_summary_func">p_summary_func()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Print">Print</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Print.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Print.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Print.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Print._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Print._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Print._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Reload">Reload</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Reload.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Reload.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Reload.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Reload._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Reload._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Reload._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.RunCustom">RunCustom</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.RunCustom.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.RunCustom.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.RunCustom.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.RunCustom._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.RunCustom._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.RunCustom._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.Select">Select</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Select.__getnewargs__">__getnewargs__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Select.__new__">__new__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Select.__repr__">__repr__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Select._asdict">_asdict()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Select._make">_make()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.Select._replace">_replace()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.SelectParser">SelectParser</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.handle_comma_separated_list">handle_comma_separated_list()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_account">p_account()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_boolean">p_boolean()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_column">p_column()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_column_list">p_column_list()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_constant">p_constant()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_distinct">p_distinct()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_empty">p_empty()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expr_index">p_expr_index()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expr_index_list">p_expr_index_list()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_add">p_expression_add()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_and">p_expression_and()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_column">p_expression_column()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_constant">p_expression_constant()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_contains">p_expression_contains()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_div">p_expression_div()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_eq">p_expression_eq()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_function">p_expression_function()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_gt">p_expression_gt()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_gte">p_expression_gte()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_list">p_expression_list()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_list_opt">p_expression_list_opt()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_lt">p_expression_lt()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_lte">p_expression_lte()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_match">p_expression_match()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_mul">p_expression_mul()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_ne">p_expression_ne()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_not">p_expression_not()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_or">p_expression_or()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_paren">p_expression_paren()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_expression_sub">p_expression_sub()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_flatten">p_flatten()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_from">p_from()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_from_subselect">p_from_subselect()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_group_by">p_group_by()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_having">p_having()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_limit">p_limit()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_opt_clear">p_opt_clear()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_opt_close">p_opt_close()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_opt_expression">p_opt_expression()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_opt_open">p_opt_open()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_order_by">p_order_by()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_ordering">p_ordering()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_pivot_by">p_pivot_by()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_select_statement">p_select_statement()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_target">p_target()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_target_list">p_target_list()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_target_spec">p_target_spec()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser.SelectParser.p_where">p_where()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser.get_expression_name">get_expression_name()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.query_parser_test">query_parser_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser_test.QueryParserTestBase">QueryParserTestBase</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser_test.QueryParserTestBase.assertParse">assertParse()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser_test.QueryParserTestBase.parse">parse()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser_test.QueryParserTestBase.setUp">setUp()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser_test.TestSelectFromBase">TestSelectFromBase</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.query_parser_test.TestSelectFromBase.setUp">setUp()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.query_parser_test.qSelect">qSelect()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.shell">shell</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.BQLShell">BQLShell</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Balances">on_Balances()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Errors">on_Errors()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Explain">on_Explain()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Journal">on_Journal()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Print">on_Print()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Reload">on_Reload()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_RunCustom">on_RunCustom()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.BQLShell.on_Select">on_Select()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.DispatchingShell">DispatchingShell</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.__init__">__init__()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.add_help">add_help()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.cmdloop">cmdloop()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.default">default()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.dispatch">dispatch()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_clear">do_clear()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_EOF">do_EOF()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_exit">do_exit()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_help">do_help()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_history">do_history()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_lex">do_lex()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_parse">do_parse()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_quit">do_quit()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_set">do_set()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.do_tokenize">do_tokenize()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.emptyline">emptyline()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.exit">exit()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.get_pager">get_pager()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.initialize_vars">initialize_vars()</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell.DispatchingShell.run_parser">run_parser()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.convert_bool">convert_bool()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.create_custom_query_map">create_custom_query_map()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.generate_env_attribute_list">generate_env_attribute_list()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.generate_env_attributes">generate_env_attributes()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.get_history">get_history()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.load_history">load_history()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.print_statistics">print_statistics()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.save_history">save_history()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell.summary_statistics">summary_statistics()</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#beancount.query.shell_test">shell_test</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell_test.TestShell">TestShell</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#beancount.query.shell_test.TestShell.test_success">test_success()</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell_test.TestUseCases">TestUseCases</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#beancount.query.shell_test.runshell">runshell()</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.reports.html">beancount.reports</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.scripts.html">beancount.scripts</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.utils.html">beancount.utils</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="beancount.web.html">beancount.web</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">Beancount Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="..">Docs</a> </li>
<li>API reference </li>
<li>beancount.query</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/beancount/docs/edit/master/docs/api_reference/beancount.query.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div role="main">
<div class="section">
<h1 id="beancountquery">beancount.query<a class="headerlink" href="#beancountquery" title="Permanent link"></a></h1>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#beancount.query" id="beancount.query" style="visibility: hidden; width: 0; height: 0;">
<a class="headerlink" href="#beancount.query" title="Permanent link"></a></h2>
<div class="doc doc-contents first">
<p>Transaction and postings filtering syntax parser.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.numberify">
<code>beancount.query.numberify</code>
<a class="headerlink" href="#beancount.query.numberify" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Code to split table columns containing amounts and inventories into number columns.</p>
<p>For example, given a column with this content:</p>
<pre><code>----- amount ------
101.23 USD
   200 JPY
 99.23 USD
 38.34 USD, 100 JPY
</code></pre>
<p>We can convert this into two columns and remove the currencies:</p>
<pre><code>-amount (USD)- -amount (JPY)-
        101.23
                          200
         99.23
         38.34            100
</code></pre>
<p>The point is that the columns should be typed as numbers to make this importable
into a spreadsheet and able to be processed.</p>
<p>Notes:</p>
<ul>
<li>
<p>This handles the Amount, Position and Inventory datatypes. There is code to
  automatically recognize columns containing such types from a table of strings
  and convert such columns to their corresponding guessed data types.</p>
</li>
<li>
<p>The per-currency columns are ordered in decreasing order of the number of
  instances of numbers seen for each currency. So if the most numbers you have
  in a column are USD, then the USD column renders first.</p>
</li>
<li>
<p>Cost basis specifications should be unmodified and reported to a dedicated
  extra column, like this:</p>
<p>----- amount ------
1 AAPL {21.23 USD}</p>
</li>
</ul>
<p>We can convert this into two columns and remove the currencies:</p>
<pre><code>-amount (AAPL)- -Cost basis-
              1 {21.23 USD}
</code></pre>
<p>(Eventually we might support the conversion of cost amounts as well, but they
  may contain other information, such as a label or a date, so for now we don't
  convert them. I'm not sure there's a good practical use case in doing that
  yet.)</p>
<ul>
<li>
<p>We may provide some options to break out only some of the currencies into
  columns, in order to handle the case where an inventory contains a large
  number of currencies and we want to only operate on a restricted set of
  operating currencies.</p>
</li>
<li>
<p>If you provide a DisplayFormatter object to the numberification routine, they
  quantize each column according to their currency's precision. It is
  recommended that you do that.</p>
</li>
</ul>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.numberify.AmountConverter">
<code>beancount.query.numberify.AmountConverter</code>
<a class="headerlink" href="#beancount.query.numberify.AmountConverter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A converter that extracts the number of an amount for a specific currency.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="beancount.query.numberify.AmountConverter.dtype">
<code>beancount.query.numberify.AmountConverter.dtype</code>
<a class="headerlink" href="#beancount.query.numberify.AmountConverter.dtype" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Construct a new Decimal object. 'value' can be an integer, string, tuple,
or another Decimal object. If no value is given, return Decimal('0'). The
context does not affect the conversion and is only passed to determine if
the InvalidOperation trap is active.</p>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.numberify.IdentityConverter">
<code>beancount.query.numberify.IdentityConverter</code>
<a class="headerlink" href="#beancount.query.numberify.IdentityConverter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A converter that simply copies its column.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.numberify.InventoryConverter">
<code>beancount.query.numberify.InventoryConverter</code>
<a class="headerlink" href="#beancount.query.numberify.InventoryConverter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A converter that extracts the number of a inventory for a specific currency.
    If there are multiple lots we aggregate by currency.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="beancount.query.numberify.InventoryConverter.dtype">
<code>beancount.query.numberify.InventoryConverter.dtype</code>
<a class="headerlink" href="#beancount.query.numberify.InventoryConverter.dtype" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Construct a new Decimal object. 'value' can be an integer, string, tuple,
or another Decimal object. If no value is given, return Decimal('0'). The
context does not affect the conversion and is only passed to determine if
the InvalidOperation trap is active.</p>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.numberify.PositionConverter">
<code>beancount.query.numberify.PositionConverter</code>
<a class="headerlink" href="#beancount.query.numberify.PositionConverter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A converter that extracts the number of a position for a specific currency.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="beancount.query.numberify.PositionConverter.dtype">
<code>beancount.query.numberify.PositionConverter.dtype</code>
<a class="headerlink" href="#beancount.query.numberify.PositionConverter.dtype" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Construct a new Decimal object. 'value' can be an integer, string, tuple,
or another Decimal object. If no value is given, return Decimal('0'). The
context does not affect the conversion and is only passed to determine if
the InvalidOperation trap is active.</p>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.numberify.convert_col_Amount">
<code class="highlight language-python">
beancount.query.numberify.convert_col_Amount
(name, drows, index)

        </code>
<a class="headerlink" href="#beancount.query.numberify.convert_col_Amount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create converters for a column of type Amount.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the column name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>drows</code></td>
<td><code></code></td>
<td>
<p>The table of objects.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>index</code></td>
<td><code></code></td>
<td>
<p>The column number.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of Converter instances, one for each of the currency types found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/numberify.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def convert_col_Amount(name, drows, index):
    """Create converters for a column of type Amount.

    Args:
      name: A string, the column name.
      drows: The table of objects.
      index: The column number.
    Returns:
      A list of Converter instances, one for each of the currency types found.
    """
    currency_map = collections.defaultdict(int)
    for drow in drows:
        vamount = drow[index]
        if vamount and vamount.currency:
            currency_map[vamount.currency] += 1
    return [AmountConverter('{} ({})'.format(name, currency), index, currency)
            for currency, _ in sorted(currency_map.items(),
                                      key=lambda item: (item[1], item[0]),
                                      reverse=True)]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.numberify.convert_col_Inventory">
<code class="highlight language-python">
beancount.query.numberify.convert_col_Inventory
(name, drows, index)

        </code>
<a class="headerlink" href="#beancount.query.numberify.convert_col_Inventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create converters for a column of type Inventory.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the column name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>drows</code></td>
<td><code></code></td>
<td>
<p>The table of objects.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>index</code></td>
<td><code></code></td>
<td>
<p>The column number.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of Converter instances, one for each of the currency types found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/numberify.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def convert_col_Inventory(name, drows, index):
    """Create converters for a column of type Inventory.

    Args:
      name: A string, the column name.
      drows: The table of objects.
      index: The column number.
    Returns:
      A list of Converter instances, one for each of the currency types found.
    """
    currency_map = collections.defaultdict(int)
    for drow in drows:
        inv = drow[index]
        for currency in inv.currencies():
            currency_map[currency] += 1
    return [InventoryConverter('{} ({})'.format(name, currency), index, currency)
            for currency, _ in sorted(currency_map.items(),
                                      key=lambda item: (item[1], item[0]),
                                      reverse=True)]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.numberify.convert_col_Position">
<code class="highlight language-python">
beancount.query.numberify.convert_col_Position
(name, drows, index)

        </code>
<a class="headerlink" href="#beancount.query.numberify.convert_col_Position" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create converters for a column of type Position.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the column name.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>drows</code></td>
<td><code></code></td>
<td>
<p>The table of objects.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>index</code></td>
<td><code></code></td>
<td>
<p>The column number.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of Converter instances, one for each of the currency types found.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/numberify.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def convert_col_Position(name, drows, index):
    """Create converters for a column of type Position.

    Args:
      name: A string, the column name.
      drows: The table of objects.
      index: The column number.
    Returns:
      A list of Converter instances, one for each of the currency types found.
    """
    currency_map = collections.defaultdict(int)
    for drow in drows:
        pos = drow[index]
        if pos and pos.units.currency:
            currency_map[pos.units.currency] += 1
    return [PositionConverter('{} ({})'.format(name, currency), index, currency)
            for currency, _ in sorted(currency_map.items(),
                                      key=lambda item: (item[1], item[0]),
                                      reverse=True)]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.numberify.numberify_results">
<code class="highlight language-python">
beancount.query.numberify.numberify_results
(dtypes, drows, dformat=None)

        </code>
<a class="headerlink" href="#beancount.query.numberify.numberify_results" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Number rows containing Amount, Position or Inventory types.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>result_types</code></td>
<td><code></code></td>
<td>
<p>A list of items describing the names and data types of the items in
each column.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>result_rows</code></td>
<td><code></code></td>
<td>
<p>A list of ResultRow instances.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>dformat</code></td>
<td><code></code></td>
<td>
<p>An optional DisplayFormatter. If set, quantize the numbers by
their currency-specific precision when converting the Amount's,
Position's or Inventory'es..</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of modified (result_types, result_rows) with converted datatypes.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/numberify.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def numberify_results(dtypes, drows, dformat=None):
    """Number rows containing Amount, Position or Inventory types.

    Args:
      result_types: A list of items describing the names and data types of the items in
        each column.
      result_rows: A list of ResultRow instances.
      dformat: An optional DisplayFormatter. If set, quantize the numbers by
        their currency-specific precision when converting the Amount's,
        Position's or Inventory'es..
    Returns:
      A pair of modified (result_types, result_rows) with converted datatypes.
    """
    # Build an array of converters.
    converters = []
    for index, col_desc in enumerate(dtypes):
        name, dtype = col_desc
        convert_col_fun = CONVERTING_TYPES.get(dtype, None)
        if convert_col_fun is None:
            converters.append(IdentityConverter(name, dtype, index))
        else:
            col_converters = convert_col_fun(name, drows, index)
            converters.extend(col_converters)

    # Derive the output types from the expected outputs from the converters
    # themselves.
    otypes = [(c.name, c.dtype) for c in converters]

    # Convert the input rows by processing them through the converters.
    orows = []
    for drow in drows:
        orow = []
        for converter in converters:
            orow.append(converter(drow, dformat))
        orows.append(orow)

    return otypes, orows
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query">
<code>beancount.query.query</code>
<a class="headerlink" href="#beancount.query.query" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>A library to run queries. This glues together all the parts of the query engine.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query.run_query">
<code class="highlight language-python">
beancount.query.query.run_query
    (entries, options_map, query, *
format_args, *, numberify=False)

        </code>
<a class="headerlink" href="#beancount.query.query.run_query" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compile and execute a query, return the result types and rows.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of entries, as produced by the loader.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A dict of options, as produced by the loader.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>A string, a single BQL query, optionally containing some new-style
(e.g., {}) formatting specifications.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>format_args</code></td>
<td><code></code></td>
<td>
<p>A tuple of arguments to be formatted in the query. This is
just provided as a convenience.</p>
</td>
<td><code>()</code></td>
</tr>
<tr>
<td><code>numberify</code></td>
<td><code></code></td>
<td>
<p>If true, numberify the results before returning them.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of result types and result rows.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ParseError</code></td>
<td>
<p>If the statement cannot be parsed.</p>
</td>
</tr>
<tr>
<td><code>CompilationError</code></td>
<td>
<p>If the statement cannot be compiled.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def run_query(entries, options_map, query, *format_args, numberify=False):
    """Compile and execute a query, return the result types and rows.

    Args:
      entries: A list of entries, as produced by the loader.
      options_map: A dict of options, as produced by the loader.
      query: A string, a single BQL query, optionally containing some new-style
        (e.g., {}) formatting specifications.
      format_args: A tuple of arguments to be formatted in the query. This is
        just provided as a convenience.
      numberify: If true, numberify the results before returning them.
    Returns:
      A pair of result types and result rows.
    Raises:
      ParseError: If the statement cannot be parsed.
      CompilationError: If the statement cannot be compiled.
    """
    env_targets = query_env.TargetsEnvironment()
    env_entries = query_env.FilterEntriesEnvironment()
    env_postings = query_env.FilterPostingsEnvironment()

    # Apply formatting to the query.
    formatted_query = query.format(*format_args)

    # Parse the statement.
    parser = query_parser.Parser()
    statement = parser.parse(formatted_query)

    # Compile the SELECT statement.
    c_query = query_compile.compile(statement,
                                    env_targets,
                                    env_postings,
                                    env_entries)

    # Execute it to obtain the result rows.
    rtypes, rrows = query_execute.execute_query(c_query, entries, options_map)

    # Numberify the results, if requested.
    if numberify:
        dformat = options_map['dcontext'].build()
        rtypes, rrows = numberify_lib.numberify_results(rtypes, rrows, dformat)

    return rtypes, rrows
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_compile">
<code>beancount.query.query_compile</code>
<a class="headerlink" href="#beancount.query.query_compile" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Interpreter for the query language's AST.</p>
<p>This code accepts the abstract syntax tree produced by the query parser,
resolves the column and function names, compiles and interpreter and prepares a
query to be run against a list of entries.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.CompilationEnvironment">
<code>beancount.query.query_compile.CompilationEnvironment</code>
<a class="headerlink" href="#beancount.query.query_compile.CompilationEnvironment" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Base class for all compilation contexts. A compilation context provides
    column accessors specific to the particular row objects that we will access.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.CompilationEnvironment.get_column">
<code class="highlight language-python">
beancount.query.query_compile.CompilationEnvironment.get_column
(self, name)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.CompilationEnvironment.get_column" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a column accessor for the given named column.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the column to access.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_column(self, name):
    """Return a column accessor for the given named column.
    Args:
      name: A string, the name of the column to access.
    """
    try:
        return self.columns[name]()
    except KeyError:
        raise CompilationError("Invalid column name '{}' in {} context.".format(
            name, self.context_name))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.CompilationEnvironment.get_function">
<code class="highlight language-python">
beancount.query.query_compile.CompilationEnvironment.get_function
(self, name, operands)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.CompilationEnvironment.get_function" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a function accessor for the given named function.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the function to access.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_function(self, name, operands):
    """Return a function accessor for the given named function.
    Args:
      name: A string, the name of the function to access.
    """
    try:
        key = tuple([name] + [operand.dtype for operand in operands])
        return self.functions[key](operands)
    except KeyError:
        # If not found with the operands, try just looking it up by name.
        try:
            return self.functions[name](operands)
        except KeyError:
            signature = '{}({})'.format(name,
                                        ', '.join(operand.dtype.__name__
                                                  for operand in operands))
            raise CompilationError("Invalid function '{}' in {} context".format(
                signature, self.context_name))
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.CompilationError">
<code>beancount.query.query_compile.CompilationError</code>
<a class="headerlink" href="#beancount.query.query_compile.CompilationError" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A compiler/interpreter error.</p>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalAggregator">
<code>beancount.query.query_compile.EvalAggregator</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalAggregator" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Base class for all aggregator evaluator types.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalAggregator.__call__">
<code class="highlight language-python">
beancount.query.query_compile.EvalAggregator.__call__
(self, context)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalAggregator.__call__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return the value on evaluation.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The evaluation object to which the evaluation need to apply.
This is either an entry, a Posting instance, or a particular result
set row from a sub-select. This is the provider for the underlying
data.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The final aggregated value.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __call__(self, context):
    """Return the value on evaluation.

    Args:
      context: The evaluation object to which the evaluation need to apply.
        This is either an entry, a Posting instance, or a particular result
        set row from a sub-select. This is the provider for the underlying
        data.
    Returns:
      The final aggregated value.
    """
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalAggregator.allocate">
<code class="highlight language-python">
beancount.query.query_compile.EvalAggregator.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.EvalAggregator.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    """Allocate handles to store data for a node's aggregate storage.

    This is called once before beginning aggregations. If you need any
    kind of per-aggregate storage during the computation phase, get it
    in this method.

    Args:
      allocator: An instance of Allocator, on which you can call allocate() to
        obtain a handle for a slot to store data on store objects later on.
    """
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalAggregator.finalize">
<code class="highlight language-python">
beancount.query.query_compile.EvalAggregator.finalize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.EvalAggregator.finalize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Finalize this node's aggregate data and return it.</p>
<p>For aggregate methods, this finalizes the node and returns the final
value. The context node will be the alloc instead of the context object.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def finalize(self, store):
    """Finalize this node's aggregate data and return it.

    For aggregate methods, this finalizes the node and returns the final
    value. The context node will be the alloc instead of the context object.

    Args:
      store: An object indexable by handles appropriated during allocate().
    """
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalAggregator.initialize">
<code class="highlight language-python">
beancount.query.query_compile.EvalAggregator.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.EvalAggregator.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    """Initialize this node's aggregate data. If the node is not an aggregate,
    simply initialize the subnodes. Override this method in the aggregator
    if you need data for storage.

    Args:
      store: An object indexable by handles appropriated during allocate().
    """
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalAggregator.update">
<code class="highlight language-python">
beancount.query.query_compile.EvalAggregator.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.EvalAggregator.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    """Evaluate this node. This is designed to recurse on its children.

    Args:
      store: An object indexable by handles appropriated during allocate().
      context: The object to which the evaluation need to apply (see __call__).
    """
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalColumn">
<code>beancount.query.query_compile.EvalColumn</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Base class for all column accessors.</p>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom">
<code>beancount.query.query_compile.EvalFrom</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>EvalFrom(c_expr, open, close, clear)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_compile.EvalFrom.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom.__new__">
<code class="highlight language-python">
beancount.query.query_compile.EvalFrom.__new__
(_cls, c_expr, open, close, clear)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of EvalFrom(c_expr, open, close, clear)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom.__repr__">
<code class="highlight language-python">
beancount.query.query_compile.EvalFrom.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom._asdict">
<code class="highlight language-python">
beancount.query.query_compile.EvalFrom._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom._make">
<code class="highlight language-python">
beancount.query.query_compile.EvalFrom._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new EvalFrom object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalFrom._replace">
<code class="highlight language-python">
beancount.query.query_compile.EvalFrom._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalFrom._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new EvalFrom object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalFunction">
<code>beancount.query.query_compile.EvalFunction</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalFunction" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Base class for all function objects.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalNode">
<code>beancount.query.query_compile.EvalNode</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalNode" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalNode.__call__">
<code class="highlight language-python">
beancount.query.query_compile.EvalNode.__call__
(self, context)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalNode.__call__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.
All subclasses must override and implement this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The evaluation object to which the evaluation need to apply.
This is either an entry, a Posting instance, or a particular result
set row from a sub-select. This is the provider for the underlying
data.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The evaluated value for this sub-expression tree.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __call__(self, context):
    """Evaluate this node. This is designed to recurse on its children.
    All subclasses must override and implement this method.

    Args:
      context: The evaluation object to which the evaluation need to apply.
        This is either an entry, a Posting instance, or a particular result
        set row from a sub-select. This is the provider for the underlying
        data.
    Returns:
      The evaluated value for this sub-expression tree.
    """
    raise NotImplementedError
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalNode.__eq__">
<code class="highlight language-python">
beancount.query.query_compile.EvalNode.__eq__
(self, other)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalNode.__eq__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Override the equality operator to compare the data type and a all attributes
of this node. This is used by tests for comparing nodes.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __eq__(self, other):
    """Override the equality operator to compare the data type and a all attributes
    of this node. This is used by tests for comparing nodes.
    """
    return (isinstance(other, type(self))
            and all(
                getattr(self, attribute) == getattr(other, attribute)
                for attribute in self.__slots__))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalNode.__repr__">
<code class="highlight language-python">
beancount.query.query_compile.EvalNode.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalNode.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return str(self).</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __str__(self):
    return "{}({})".format(type(self).__name__,
                           ', '.join(repr(getattr(self, child))
                                     for child in self.__slots__))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalNode.childnodes">
<code class="highlight language-python">
beancount.query.query_compile.EvalNode.childnodes
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.EvalNode.childnodes" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Returns the child nodes of this node.
Yields:
  A list of EvalNode instances.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def childnodes(self):
    """Returns the child nodes of this node.
    Yields:
      A list of EvalNode instances.
    """
    for attr in self.__slots__:
        child = getattr(self, attr)
        if isinstance(child, EvalNode):
            yield child
        elif isinstance(child, list):
            for element in child:
                if isinstance(element, EvalNode):
                    yield element
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint">
<code>beancount.query.query_compile.EvalPrint</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>EvalPrint(c_from,)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_compile.EvalPrint.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint.__new__">
<code class="highlight language-python">
beancount.query.query_compile.EvalPrint.__new__
(_cls, c_from)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of EvalPrint(c_from,)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint.__repr__">
<code class="highlight language-python">
beancount.query.query_compile.EvalPrint.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint._asdict">
<code class="highlight language-python">
beancount.query.query_compile.EvalPrint._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint._make">
<code class="highlight language-python">
beancount.query.query_compile.EvalPrint._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new EvalPrint object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalPrint._replace">
<code class="highlight language-python">
beancount.query.query_compile.EvalPrint._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalPrint._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new EvalPrint object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery">
<code>beancount.query.query_compile.EvalQuery</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>EvalQuery(c_targets, c_from, c_where, group_indexes, order_indexes, ordering, limit, distinct, flatten)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_compile.EvalQuery.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery.__new__">
<code class="highlight language-python">
beancount.query.query_compile.EvalQuery.__new__
(_cls, c_targets, c_from, c_where, group_indexes, order_indexes, ordering, limit, distinct, flatten)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of EvalQuery(c_targets, c_from, c_where, group_indexes, order_indexes, ordering, limit, distinct, flatten)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery.__repr__">
<code class="highlight language-python">
beancount.query.query_compile.EvalQuery.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery._asdict">
<code class="highlight language-python">
beancount.query.query_compile.EvalQuery._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery._make">
<code class="highlight language-python">
beancount.query.query_compile.EvalQuery._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new EvalQuery object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalQuery._replace">
<code class="highlight language-python">
beancount.query.query_compile.EvalQuery._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalQuery._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new EvalQuery object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget">
<code>beancount.query.query_compile.EvalTarget</code>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>EvalTarget(c_expr, name, is_aggregate)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_compile.EvalTarget.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget.__new__">
<code class="highlight language-python">
beancount.query.query_compile.EvalTarget.__new__
(_cls, c_expr, name, is_aggregate)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of EvalTarget(c_expr, name, is_aggregate)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget.__repr__">
<code class="highlight language-python">
beancount.query.query_compile.EvalTarget.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget._asdict">
<code class="highlight language-python">
beancount.query.query_compile.EvalTarget._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget._make">
<code class="highlight language-python">
beancount.query.query_compile.EvalTarget._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new EvalTarget object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.EvalTarget._replace">
<code class="highlight language-python">
beancount.query.query_compile.EvalTarget._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile.EvalTarget._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new EvalTarget object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile.ResultSetEnvironment">
<code>beancount.query.query_compile.ResultSetEnvironment</code>
<a class="headerlink" href="#beancount.query.query_compile.ResultSetEnvironment" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An execution context that provides access to attributes from a result set.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile.ResultSetEnvironment.get_column">
<code class="highlight language-python">
beancount.query.query_compile.ResultSetEnvironment.get_column
(self, name)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.ResultSetEnvironment.get_column" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Override the column getter to provide a single attribute getter.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_column(self, name):
    """Override the column getter to provide a single attribute getter.
    """
    # FIXME: How do we figure out the data type here? We need the context.
    return AttributeColumn(name)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile._get_columns_and_aggregates">
<code class="highlight language-python">
beancount.query.query_compile._get_columns_and_aggregates
(node, columns, aggregates)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_compile._get_columns_and_aggregates" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Walk down a tree of nodes and fetch the column accessors and aggregates.</p>
<p>This function ignores all nodes under aggregate nodes.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code></code></td>
<td>
<p>An instance of EvalNode.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>columns</code></td>
<td><code></code></td>
<td>
<p>An accumulator for columns found so far.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>aggregate</code></td>
<td><code></code></td>
<td>
<p>An accumulator for aggregate notes found so far.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _get_columns_and_aggregates(node, columns, aggregates):
    """Walk down a tree of nodes and fetch the column accessors and aggregates.

    This function ignores all nodes under aggregate nodes.

    Args:
      node: An instance of EvalNode.
      columns: An accumulator for columns found so far.
      aggregate: An accumulator for aggregate notes found so far.
    """
    if isinstance(node, EvalAggregator):
        aggregates.append(node)
    elif isinstance(node, EvalColumn):
        columns.append(node)
    else:
        for child in node.childnodes():
            _get_columns_and_aggregates(child, columns, aggregates)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile">
<code class="highlight language-python">
beancount.query.query_compile.compile
(statement, targets_environ, postings_environ, entries_environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Prepare an AST any of the statement into an executable statement.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>statement</code></td>
<td><code></code></td>
<td>
<p>An instance of the parser's Select, Balances, Journal or Print.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>targets_environ</code></td>
<td><code></code></td>
<td>
<p>A compilation environment for evaluating targets.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>postings_environ</code></td>
<td><code></code></td>
<td>
<p>: A compilation environment for evaluating postings filters.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries_environ</code></td>
<td><code></code></td>
<td>
<p>: A compilation environment for evaluating entry filters.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of EvalQuery or EvalPrint, ready to be executed.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CompilationError</code></td>
<td>
<p>If the statement cannot be compiled, or is not one of the
supported statements.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile(statement, targets_environ, postings_environ, entries_environ):
    """Prepare an AST any of the statement into an executable statement.

    Args:
      statement: An instance of the parser's Select, Balances, Journal or Print.
      targets_environ: A compilation environment for evaluating targets.
      postings_environ: : A compilation environment for evaluating postings filters.
      entries_environ: : A compilation environment for evaluating entry filters.
    Returns:
      An instance of EvalQuery or EvalPrint, ready to be executed.
    Raises:
      CompilationError: If the statement cannot be compiled, or is not one of the
        supported statements.
    """
    if isinstance(statement, query_parser.Balances):
        statement = transform_balances(statement)
    elif isinstance(statement, query_parser.Journal):
        statement = transform_journal(statement)

    if isinstance(statement, query_parser.Select):
        c_query = compile_select(statement,
                                 targets_environ, postings_environ, entries_environ)
    elif isinstance(statement, query_parser.Print):
        c_query = compile_print(statement, entries_environ)
    else:
        raise CompilationError(
            "Cannot compile a statement of type '{}'".format(type(statement)))

    return c_query
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_expression">
<code class="highlight language-python">
beancount.query.query_compile.compile_expression
(expr, environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_expression" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Bind an expression to its execution context.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>expr</code></td>
<td><code></code></td>
<td>
<p>The root node of an expression.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>environ</code></td>
<td><code></code></td>
<td>
<p>An CompilationEnvironment instance.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The root node of a bound expression.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_expression(expr, environ):
    """Bind an expression to its execution context.

    Args:
      expr: The root node of an expression.
      environ: An CompilationEnvironment instance.
    Returns:
      The root node of a bound expression.
    """
    # Convert column references to the context.
    if isinstance(expr, query_parser.Column):
        c_expr = environ.get_column(expr.name)

    elif isinstance(expr, query_parser.Function):
        c_operands = [compile_expression(operand, environ)
                      for operand in expr.operands]
        c_expr = environ.get_function(expr.fname, c_operands)

    elif isinstance(expr, query_parser.UnaryOp):
        node_type = OPERATORS[type(expr)]
        c_expr = node_type(compile_expression(expr.operand, environ))

    elif isinstance(expr, query_parser.BinaryOp):
        node_type = OPERATORS[type(expr)]
        c_expr = node_type(compile_expression(expr.left, environ),
                           compile_expression(expr.right, environ))

    elif isinstance(expr, query_parser.Constant):
        c_expr = EvalConstant(expr.value)

    else:
        assert False, "Invalid expression to compile: {}".format(expr)

    return c_expr
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_from">
<code class="highlight language-python">
beancount.query.query_compile.compile_from
(from_clause, environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_from" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compiled a From clause as provided by the parser, in the given environment.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>select</code></td>
<td><code></code></td>
<td>
<p>An instance of query_parser.Select.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>environ</code></td>
<td><code></code></td>
<td>
<p>: A compilation context for evaluating entry filters.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of Query, ready to be executed.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_from(from_clause, environ):
    """Compiled a From clause as provided by the parser, in the given environment.

    Args:
      select: An instance of query_parser.Select.
      environ: : A compilation context for evaluating entry filters.
    Returns:
      An instance of Query, ready to be executed.
    """
    if from_clause is not None:
        c_expression = (compile_expression(from_clause.expression, environ)
                        if from_clause.expression is not None
                        else None)

        # Check that the from clause does not contain aggregates.
        if c_expression is not None and is_aggregate(c_expression):
            raise CompilationError("Aggregates are not allowed in from clause")

        if (isinstance(from_clause.open, datetime.date) and
            isinstance(from_clause.close, datetime.date) and
            from_clause.open &gt; from_clause.close):
            raise CompilationError("Invalid dates: CLOSE date must follow OPEN date")

        c_from = EvalFrom(c_expression,
                          from_clause.open,
                          from_clause.close,
                          from_clause.clear)
    else:
        c_from = None

    return c_from
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_group_by">
<code class="highlight language-python">
beancount.query.query_compile.compile_group_by
(group_by, c_targets, environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_group_by" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Process a group-by clause.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>group_by</code></td>
<td><code></code></td>
<td>
<p>A GroupBy instance as provided by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>c_targets</code></td>
<td><code></code></td>
<td>
<p>A list of compiled target expressions.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>environ</code></td>
<td><code></code></td>
<td>
<p>A compilation context to be used to evaluate GROUP BY expressions.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A tuple of
 new_targets</code></td>
<td>
<p>A list of new compiled target nodes.
 group_indexes: If the query is an aggregate query, a list of integer
   indexes to be used for processing grouping. Note that this list may be
   empty (in the case of targets with only aggregates). On the other hand,
   if this is not an aggregated query, this is set to None. So do
   distinguish the empty list vs. None.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_group_by(group_by, c_targets, environ):
    """Process a group-by clause.

    Args:
      group_by: A GroupBy instance as provided by the parser.
      c_targets: A list of compiled target expressions.
      environ: A compilation context to be used to evaluate GROUP BY expressions.
    Returns:
      A tuple of
       new_targets: A list of new compiled target nodes.
       group_indexes: If the query is an aggregate query, a list of integer
         indexes to be used for processing grouping. Note that this list may be
         empty (in the case of targets with only aggregates). On the other hand,
         if this is not an aggregated query, this is set to None. So do
         distinguish the empty list vs. None.
    """
    new_targets = copy.copy(c_targets)
    c_target_expressions = [c_target.c_expr for c_target in c_targets]

    group_indexes = []
    if group_by:
        # Check that HAVING is not supported yet.
        if group_by and group_by.having is not None:
            raise CompilationError("The HAVING clause is not supported yet")

        assert group_by.columns, "Internal error with GROUP-BY parsing"

        # Compile group-by expressions and resolve them to their targets if
        # possible. A GROUP-BY column may be one of the following:
        #
        # * A reference to a target by name.
        # * A reference to a target by index (starting at one).
        # * A new, non-aggregate expression.
        #
        # References by name are converted to indexes. New expressions are
        # inserted into the list of targets as invisible targets.
        targets_name_map = {target.name: index
                            for index, target in enumerate(c_targets)}
        for column in group_by.columns:
            index = None

            # Process target references by index.
            if isinstance(column, int):
                index = column - 1
                if not (0 &lt;= index &lt; len(c_targets)):
                    raise CompilationError(
                        "Invalid GROUP-BY column index {}".format(column))

            else:
                # Process target references by name. These will be parsed as
                # simple Column expressions. If they refer to a target name, we
                # resolve them.
                if isinstance(column, query_parser.Column):
                    name = column.name
                    index = targets_name_map.get(name, None)

                # Otherwise we compile the expression and add it to the list of
                # targets to evaluate and index into that new target.
                if index is None:
                    c_expr = compile_expression(column, environ)

                    # Check if the new expression is an aggregate.
                    aggregate = is_aggregate(c_expr)
                    if aggregate:
                        raise CompilationError(
                            "GROUP-BY expressions may not be aggregates: '{}'".format(
                                column))

                    # Attempt to reconcile the expression with one of the existing
                    # target expressions.
                    try:
                        index = c_target_expressions.index(c_expr)
                    except ValueError:
                        # Add the new target. 'None' for the target name implies it
                        # should be invisible, not to be rendered.
                        index = len(new_targets)
                        new_targets.append(EvalTarget(c_expr, None, aggregate))
                        c_target_expressions.append(c_expr)

            assert index is not None, "Internal error, could not index group-by reference."
            group_indexes.append(index)

            # Check that the group-by column references a non-aggregate.
            c_expr = new_targets[index].c_expr
            if is_aggregate(c_expr):
                raise CompilationError(
                    "GROUP-BY expressions may not reference aggregates: '{}'".format(
                        column))

            # Check that the group-by column has a supported hashable type.
            if not is_hashable_type(c_expr):
                raise CompilationError(
                    "GROUP-BY a non-hashable type is not supported: '{}'".format(
                        column))


    else:
        # If it does not have a GROUP-BY clause...
        aggregate_bools = [c_target.is_aggregate for c_target in c_targets]
        if any(aggregate_bools):
            # If the query is an aggregate query, check that all the targets are
            # aggregates.
            if all(aggregate_bools):
                assert group_indexes == []
            else:
                # If some of the targets aren't aggregates, automatically infer
                # that they are to be implicit group by targets. This makes for
                # a much more convenient syntax for our lightweight SQL, where
                # grouping is optional.
                if SUPPORT_IMPLICIT_GROUPBY:
                    group_indexes = [index
                                     for index, c_target in enumerate(c_targets)
                                     if not c_target.is_aggregate]
                else:
                    raise CompilationError(
                        "Aggregate query without a GROUP-BY should have only aggregates")
        else:
            # This is not an aggregate query; don't set group_indexes to
            # anything useful, we won't need it.
            group_indexes = None

    return new_targets[len(c_targets):], group_indexes
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_order_by">
<code class="highlight language-python">
beancount.query.query_compile.compile_order_by
(order_by, c_targets, environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_order_by" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Process an order-by clause.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>order_by</code></td>
<td><code></code></td>
<td>
<p>A OrderBy instance as provided by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>c_targets</code></td>
<td><code></code></td>
<td>
<p>A list of compiled target expressions.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>environ</code></td>
<td><code></code></td>
<td>
<p>A compilation context to be used to evaluate ORDER BY expressions.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A tuple of
 new_targets</code></td>
<td>
<p>A list of new compiled target nodes.
 order_indexes: A list of integer indexes to be used for processing ordering.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_order_by(order_by, c_targets, environ):
    """Process an order-by clause.

    Args:
      order_by: A OrderBy instance as provided by the parser.
      c_targets: A list of compiled target expressions.
      environ: A compilation context to be used to evaluate ORDER BY expressions.
    Returns:
      A tuple of
       new_targets: A list of new compiled target nodes.
       order_indexes: A list of integer indexes to be used for processing ordering.
    """
    new_targets = copy.copy(c_targets)
    c_target_expressions = [c_target.c_expr for c_target in c_targets]
    order_indexes = []

    # Compile order-by expressions and resolve them to their targets if
    # possible. A ORDER-BY column may be one of the following:
    #
    # * A reference to a target by name.
    # * A reference to a target by index (starting at one).
    # * A new expression, aggregate or not.
    #
    # References by name are converted to indexes. New expressions are
    # inserted into the list of targets as invisible targets.
    targets_name_map = {target.name: index
                        for index, target in enumerate(c_targets)}
    for column in order_by.columns:
        index = None

        # Process target references by index.
        if isinstance(column, int):
            index = column - 1
            if not (0 &lt;= index &lt; len(c_targets)):
                raise CompilationError(
                    "Invalid ORDER-BY column index {}".format(column))

        else:
            # Process target references by name. These will be parsed as
            # simple Column expressions. If they refer to a target name, we
            # resolve them.
            if isinstance(column, query_parser.Column):
                name = column.name
                index = targets_name_map.get(name, None)

            # Otherwise we compile the expression and add it to the list of
            # targets to evaluate and index into that new target.
            if index is None:
                c_expr = compile_expression(column, environ)

                # Attempt to reconcile the expression with one of the existing
                # target expressions.
                try:
                    index = c_target_expressions.index(c_expr)
                except ValueError:
                    # Add the new target. 'None' for the target name implies it
                    # should be invisible, not to be rendered.
                    index = len(new_targets)
                    new_targets.append(EvalTarget(c_expr, None, is_aggregate(c_expr)))
                    c_target_expressions.append(c_expr)

        assert index is not None, "Internal error, could not index order-by reference."
        order_indexes.append(index)

    return (new_targets[len(c_targets):], order_indexes)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_print">
<code class="highlight language-python">
beancount.query.query_compile.compile_print
(print_stmt, env_entries)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_print" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compile a Print statement.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>statement</code></td>
<td><code></code></td>
<td>
<p>An instance of query_parser.Print.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries_environ</code></td>
<td><code></code></td>
<td>
<p>: A compilation environment for evaluating entry filters.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of EvalPrint, ready to be executed.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_print(print_stmt, env_entries):
    """Compile a Print statement.

    Args:
      statement: An instance of query_parser.Print.
      entries_environ: : A compilation environment for evaluating entry filters.
    Returns:
      An instance of EvalPrint, ready to be executed.
    """
    c_from = compile_from(print_stmt.from_clause, env_entries)
    return EvalPrint(c_from)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_select">
<code class="highlight language-python">
beancount.query.query_compile.compile_select
(select, targets_environ, postings_environ, entries_environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_select" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Prepare an AST for a Select statement into a very rudimentary execution tree.
The execution tree mostly looks much like an AST, but with some nodes
replaced with knowledge specific to an execution context and eventually some
basic optimizations.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>select</code></td>
<td><code></code></td>
<td>
<p>An instance of query_parser.Select.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>targets_environ</code></td>
<td><code></code></td>
<td>
<p>A compilation environment for evaluating targets.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>postings_environ</code></td>
<td><code></code></td>
<td>
<p>A compilation environment for evaluating postings filters.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries_environ</code></td>
<td><code></code></td>
<td>
<p>A compilation environment for evaluating entry filters.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of EvalQuery, ready to be executed.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_select(select, targets_environ, postings_environ, entries_environ):
    """Prepare an AST for a Select statement into a very rudimentary execution tree.
    The execution tree mostly looks much like an AST, but with some nodes
    replaced with knowledge specific to an execution context and eventually some
    basic optimizations.

    Args:
      select: An instance of query_parser.Select.
      targets_environ: A compilation environment for evaluating targets.
      postings_environ: A compilation environment for evaluating postings filters.
      entries_environ: A compilation environment for evaluating entry filters.
    Returns:
      An instance of EvalQuery, ready to be executed.
    """

    # Process the FROM clause and figure out the execution environment for the
    # targets and the where clause.
    from_clause = select.from_clause
    if isinstance(from_clause, query_parser.Select):
        c_from = None
        environ_target = ResultSetEnvironment()
        environ_where = ResultSetEnvironment()

        # Remove this when we add support for nested queries.
        raise CompilationError("Queries from nested SELECT are not supported yet")

    if from_clause is None or isinstance(from_clause, query_parser.From):
        # Bind the from clause contents.
        c_from = compile_from(from_clause, entries_environ)
        environ_target = targets_environ
        environ_where = postings_environ

    else:
        raise CompilationError("Unexpected from clause in AST: {}".format(from_clause))

    # Compile the targets.
    c_targets = compile_targets(select.targets, environ_target)

    # Bind the WHERE expression to the execution environment.
    if select.where_clause is not None:
        c_where = compile_expression(select.where_clause, environ_where)

        # Aggregates are disallowed in this clause. Check for this.
        # NOTE: This should never trigger if the compilation environment does not
        # contain any aggregate. Just being manic and safe here.
        if is_aggregate(c_where):
            raise CompilationError("Aggregates are disallowed in WHERE clause")
    else:
        c_where = None

    # Process the GROUP-BY clause.
    new_targets, group_indexes = compile_group_by(select.group_by,
                                                  c_targets,
                                                  environ_target)
    if new_targets:
        c_targets.extend(new_targets)

    # Process the ORDER-BY clause.
    if select.order_by is not None:
        (new_targets, order_indexes) = compile_order_by(select.order_by,
                                                        c_targets,
                                                        environ_target)
        if new_targets:
            c_targets.extend(new_targets)
        ordering = select.order_by.ordering
    else:
        order_indexes = None
        ordering = None

    # If this is an aggregate query (it groups, see list of indexes), check that
    # the set of non-aggregates match exactly the group indexes. This should
    # always be the case at this point, because we have added all the necessary
    # targets to the list of group-by expressions and should have resolved all
    # the indexes.
    if group_indexes is not None:
        non_aggregate_indexes = set(index
                                    for index, c_target in enumerate(c_targets)
                                    if not c_target.is_aggregate)
        if non_aggregate_indexes != set(group_indexes):
            missing_names = ['"{}"'.format(c_targets[index].name)
                             for index in non_aggregate_indexes - set(group_indexes)]
            raise CompilationError(
                "All non-aggregates must be covered by GROUP-BY clause in aggregate query; "
                "the following targets are missing: {}".format(",".join(missing_names)))

    # Check that PIVOT-BY is not supported yet.
    if select.pivot_by is not None:
        raise CompilationError("The PIVOT BY clause is not supported yet")

    return EvalQuery(c_targets,
                     c_from,
                     c_where,
                     group_indexes,
                     order_indexes,
                     ordering,
                     select.limit,
                     select.distinct,
                     select.flatten)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.compile_targets">
<code class="highlight language-python">
beancount.query.query_compile.compile_targets
(targets, environ)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.compile_targets" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compile the targets and check for their validity. Process wildcard.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>targets</code></td>
<td><code></code></td>
<td>
<p>A list of target expressions from the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>environ</code></td>
<td><code></code></td>
<td>
<p>A compilation context for the targets.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of compiled target expressions with resolved names.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile_targets(targets, environ):
    """Compile the targets and check for their validity. Process wildcard.

    Args:
      targets: A list of target expressions from the parser.
      environ: A compilation context for the targets.
    Returns:
      A list of compiled target expressions with resolved names.
    """
    # Bind the targets expressions to the execution context.
    if isinstance(targets, query_parser.Wildcard):
        # Insert the full list of available columns.
        targets = [query_parser.Target(query_parser.Column(name), None)
                   for name in environ.wildcard_columns]

    # Compile targets.
    c_targets = []
    target_names = set()
    for target in targets:
        c_expr = compile_expression(target.expression, environ)
        target_name = find_unique_name(
            target.name or query_parser.get_expression_name(target.expression),
            target_names)
        target_names.add(target_name)
        c_targets.append(EvalTarget(c_expr, target_name, is_aggregate(c_expr)))

    # Figure out if this query is an aggregate query and check validity of each
    # target's aggregation type.
    for index, c_target in enumerate(c_targets):
        columns, aggregates = get_columns_and_aggregates(c_target.c_expr)

        # Check for mixed aggregates and non-aggregates.
        if columns and aggregates:
            raise CompilationError(
                "Mixed aggregates and non-aggregates are not allowed")

        if aggregates:
            # Check for aggregates of aggregates.
            for aggregate in aggregates:
                for child in aggregate.childnodes():
                    if is_aggregate(child):
                        raise CompilationError(
                            "Aggregates of aggregates are not allowed")

    return c_targets
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.find_unique_name">
<code class="highlight language-python">
beancount.query.query_compile.find_unique_name
(name, allocated_set)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.find_unique_name" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Come up with a unique name for 'name' amongst 'allocated_set'.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code></code></td>
<td>
<p>A string, the prefix of the name to find a unique for.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>allocated_set</code></td>
<td><code></code></td>
<td>
<p>A set of string, the set of already allocated names.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A unique name. 'allocated_set' is unmodified.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def find_unique_name(name, allocated_set):
    """Come up with a unique name for 'name' amongst 'allocated_set'.

    Args:
      name: A string, the prefix of the name to find a unique for.
      allocated_set: A set of string, the set of already allocated names.
    Returns:
      A unique name. 'allocated_set' is unmodified.
    """
    # Make sure the name is unique.
    prefix = name
    i = 1
    while name in allocated_set:
        name = '{}_{}'.format(prefix, i)
        i += 1
    return name
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.get_columns_and_aggregates">
<code class="highlight language-python">
beancount.query.query_compile.get_columns_and_aggregates
(node)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.get_columns_and_aggregates" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find the columns and aggregate nodes below this tree.</p>
<p>All nodes under aggregate nodes are ignored.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code></code></td>
<td>
<p>An instance of EvalNode.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of (columns, aggregates), both of which are lists of EvalNode instances.
  columns</code></td>
<td>
<p>The list of all columns accessed not under an aggregate node.
  aggregates: The list of all aggregate nodes.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_columns_and_aggregates(node):
    """Find the columns and aggregate nodes below this tree.

    All nodes under aggregate nodes are ignored.

    Args:
      node: An instance of EvalNode.
    Returns:
      A pair of (columns, aggregates), both of which are lists of EvalNode instances.
        columns: The list of all columns accessed not under an aggregate node.
        aggregates: The list of all aggregate nodes.
    """
    columns = []
    aggregates = []
    _get_columns_and_aggregates(node, columns, aggregates)
    return columns, aggregates
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.is_aggregate">
<code class="highlight language-python">
beancount.query.query_compile.is_aggregate
(node)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.is_aggregate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the node is an aggregate.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code></code></td>
<td>
<p>An instance of EvalNode.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_aggregate(node):
    """Return true if the node is an aggregate.

    Args:
      node: An instance of EvalNode.
    Returns:
      A boolean.
    """
    # Note: We could be a tiny bit more efficient here, but it doesn't matter
    # much. Performance of the query compilation matters very little overall.
    _, aggregates = get_columns_and_aggregates(node)
    return bool(aggregates)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.is_hashable_type">
<code class="highlight language-python">
beancount.query.query_compile.is_hashable_type
(node)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.is_hashable_type" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the node is of a hashable type.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code></code></td>
<td>
<p>An instance of EvalNode.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def is_hashable_type(node):
    """Return true if the node is of a hashable type.

    Args:
      node: An instance of EvalNode.
    Returns:
      A boolean.
    """
    return not issubclass(node.dtype, inventory.Inventory)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.transform_balances">
<code class="highlight language-python">
beancount.query.query_compile.transform_balances
(balances)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.transform_balances" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Translate a Balances entry into an uncompiled Select statement.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>balances</code></td>
<td><code></code></td>
<td>
<p>An instance of a Balance object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of an uncompiled Select object.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def transform_balances(balances):
    """Translate a Balances entry into an uncompiled Select statement.

    Args:
      balances: An instance of a Balance object.
    Returns:
      An instance of an uncompiled Select object.
    """
    ## FIXME: Change the aggregation rules to allow GROUP-BY not to include the
    ## non-aggregate ORDER-BY columns, so we could just GROUP-BY accounts here
    ## instead of having to include the sort-key. I think it should be fine if
    ## the first or last sort-order value gets used, because it would simplify
    ## the input statement.

    cooked_select = query_parser.Parser().parse("""

      SELECT account, SUM({}(position))
      GROUP BY account, ACCOUNT_SORTKEY(account)
      ORDER BY ACCOUNT_SORTKEY(account)

    """.format(balances.summary_func or ""))

    return query_parser.Select(cooked_select.targets,
                               balances.from_clause,
                               balances.where_clause,
                               cooked_select.group_by,
                               cooked_select.order_by,
                               None, None, None, None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_compile.transform_journal">
<code class="highlight language-python">
beancount.query.query_compile.transform_journal
(journal)

        </code>
<a class="headerlink" href="#beancount.query.query_compile.transform_journal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Translate a Journal entry into an uncompiled Select statement.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>journal</code></td>
<td><code></code></td>
<td>
<p>An instance of a Journal object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>An instance of an uncompiled Select object.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def transform_journal(journal):
    """Translate a Journal entry into an uncompiled Select statement.

    Args:
      journal: An instance of a Journal object.
    Returns:
      An instance of an uncompiled Select object.
    """
    cooked_select = query_parser.Parser().parse("""

        SELECT
           date,
           flag,
           MAXWIDTH(payee, 48),
           MAXWIDTH(narration, 80),
           account,
           {summary_func}(position),
           {summary_func}(balance)
        {where}

    """.format(where=('WHERE account ~ "{}"'.format(journal.account)
                      if journal.account
                      else ''),
               summary_func=journal.summary_func or ''))

    return query_parser.Select(cooked_select.targets,
                               journal.from_clause,
                               cooked_select.where_clause,
                               None, None, None, None, None, None)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_compile_test">
<code>beancount.query.query_compile_test</code>
<a class="headerlink" href="#beancount.query.query_compile_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_compile_test.CompileSelectBase">
<code>beancount.query.query_compile_test.CompileSelectBase</code>
<a class="headerlink" href="#beancount.query.query_compile_test.CompileSelectBase" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile_test.CompileSelectBase.assertCompile">
<code class="highlight language-python">
beancount.query.query_compile_test.CompileSelectBase.assertCompile
(self, expected, query, debug=False)

        </code>
<a class="headerlink" href="#beancount.query.query_compile_test.CompileSelectBase.assertCompile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Assert parsed and compiled contents from 'query' is 'expected'.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>expected</code></td>
<td><code></code></td>
<td>
<p>An expected AST to compare against the parsed value.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An SQL query to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>debug</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, print extra debugging information on the console.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AssertionError</code></td>
<td>
<p>If the actual AST does not match the expected one.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def assertCompile(self, expected, query, debug=False):
    """Assert parsed and compiled contents from 'query' is 'expected'.

    Args:
      expected: An expected AST to compare against the parsed value.
      query: An SQL query to be parsed.
      debug: A boolean, if true, print extra debugging information on the console.
    Raises:
      AssertionError: If the actual AST does not match the expected one.
    """
    actual = self.compile(query)
    if debug:
        print()
        print()
        print(actual)
        print()
    try:
        self.assertEqual(expected, actual)
        return actual
    except AssertionError:
        print()
        print("Expected: {}".format(expected))
        print("Actual  : {}".format(actual))
        raise
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile_test.CompileSelectBase.assertIndexes">
<code class="highlight language-python">
beancount.query.query_compile_test.CompileSelectBase.assertIndexes
(self, query, expected_simple_indexes, expected_aggregate_indexes, expected_group_indexes, expected_order_indexes)

        </code>
<a class="headerlink" href="#beancount.query.query_compile_test.CompileSelectBase.assertIndexes" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Check the four lists of indexes for comparison.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An instance of EvalQuery, a compiled query statement.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>expected_simple_indexes</code></td>
<td><code></code></td>
<td>
<p>The expected visible non-aggregate indexes.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>expected_aggregate_indexes</code></td>
<td><code></code></td>
<td>
<p>The expected visible aggregate indexes.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>expected_group_indexes</code></td>
<td><code></code></td>
<td>
<p>The expected group_indexes.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>expected_order_indexes</code></td>
<td><code></code></td>
<td>
<p>The expected order_indexes.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AssertionError</code></td>
<td>
<p>if the check fails.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def assertIndexes(self,
                  query,
                  expected_simple_indexes,
                  expected_aggregate_indexes,
                  expected_group_indexes,
                  expected_order_indexes):
    """Check the four lists of indexes for comparison.

    Args:
      query: An instance of EvalQuery, a compiled query statement.
      expected_simple_indexes: The expected visible non-aggregate indexes.
      expected_aggregate_indexes: The expected visible aggregate indexes.
      expected_group_indexes: The expected group_indexes.
      expected_order_indexes: The expected order_indexes.
    Raises:
      AssertionError: if the check fails.
    """
    # Compute the list of _visible_ aggregates and non-aggregates.
    simple_indexes = [index
                      for index, c_target in enumerate(query.c_targets)
                      if c_target.name and not qc.is_aggregate(c_target.expression)]
    aggregate_indexes = [index
                         for index, c_target in enumerate(query.c_targets)
                         if c_target.name and qc.is_aggregate(c_target.expression)]

    self.assertEqual(set(expected_simple_indexes), set(simple_indexes))

    self.assertEqual(set(expected_aggregate_indexes), set(aggregate_indexes))

    self.assertEqual(
        set(expected_group_indexes) if expected_group_indexes is not None else None,
        set(query.group_indexes) if query.group_indexes is not None else None)

    self.assertEqual(
        set(expected_order_indexes) if expected_order_indexes is not None else None,
        set(query.order_indexes) if query.order_indexes is not None else None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile_test.CompileSelectBase.assertSelectInvariants">
<code class="highlight language-python">
beancount.query.query_compile_test.CompileSelectBase.assertSelectInvariants
(self, query)

        </code>
<a class="headerlink" href="#beancount.query.query_compile_test.CompileSelectBase.assertSelectInvariants" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Assert the invariants on the query.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An instance of EvalQuery, a compiled query statement.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AssertionError</code></td>
<td>
<p>if the check fails.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def assertSelectInvariants(self, query):
    """Assert the invariants on the query.

    Args:
      query: An instance of EvalQuery, a compiled query statement.
    Raises:
      AssertionError: if the check fails.
    """
    # Check that the group references cover all the simple indexes.
    if query.group_indexes is not None:
        non_aggregate_indexes = [index
                                 for index, c_target in enumerate(query.c_targets)
                                 if not qc.is_aggregate(c_target.c_expr)]

        self.assertEqual(set(non_aggregate_indexes), set(query.group_indexes),
                         "Invalid indexes: {}".format(query))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile_test.CompileSelectBase.compile">
<code class="highlight language-python">
beancount.query.query_compile_test.CompileSelectBase.compile
(self, query)

        </code>
<a class="headerlink" href="#beancount.query.query_compile_test.CompileSelectBase.compile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Parse one query and compile it.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An SQL query to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The AST.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile(self, query):
    """Parse one query and compile it.

    Args:
      query: An SQL query to be parsed.
    Returns:
      The AST.
    """
    statement = self.parse(query)
    c_query = qc.compile(statement,
                         self.xcontext_targets,
                         self.xcontext_postings,
                         self.xcontext_entries)
    if isinstance(c_query, qp.Select):
        self.assertSelectInvariants(c_query)
    return c_query
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_compile_test.CompileSelectBase.setUp">
<code class="highlight language-python">
beancount.query.query_compile_test.CompileSelectBase.setUp
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_compile_test.CompileSelectBase.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_compile_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def setUp(self):
    self.parser = qp.Parser()
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_env">
<code>beancount.query.query_env</code>
<a class="headerlink" href="#beancount.query.query_env" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Environment object for compiler.</p>
<p>This module contains the various column accessors and function evaluators that
are made available by the query compiler via their compilation context objects.
Define new columns and functions here.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env._Neg">
<code>beancount.query.query_env._Neg</code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_env._Neg" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the negative value of the argument. This works on various types.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.AbsDecimal">
<code>beancount.query.query_env.AbsDecimal</code>
<a class="headerlink" href="#beancount.query.query_env.AbsDecimal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the length of the argument. This works on sequences.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.AbsInventory">
<code>beancount.query.query_env.AbsInventory</code>
<a class="headerlink" href="#beancount.query.query_env.AbsInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the length of the argument. This works on sequences.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.AbsPosition">
<code>beancount.query.query_env.AbsPosition</code>
<a class="headerlink" href="#beancount.query.query_env.AbsPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the length of the argument. This works on sequences.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.AccountColumn">
<code>beancount.query.query_env.AccountColumn</code>
<a class="headerlink" href="#beancount.query.query_env.AccountColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The account of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.AccountSortKey">
<code>beancount.query.query_env.AccountSortKey</code>
<a class="headerlink" href="#beancount.query.query_env.AccountSortKey" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get a string to sort accounts in order taking into account the types.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.AnyMeta">
<code>beancount.query.query_env.AnyMeta</code>
<a class="headerlink" href="#beancount.query.query_env.AnyMeta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get metadata from the posting or its parent transaction's metadata if not present.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.BalanceColumn">
<code>beancount.query.query_env.BalanceColumn</code>
<a class="headerlink" href="#beancount.query.query_env.BalanceColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The balance for the posting. These can be summed into inventories.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CloseDate">
<code>beancount.query.query_env.CloseDate</code>
<a class="headerlink" href="#beancount.query.query_env.CloseDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the date of the close directive of the account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Coalesce">
<code>beancount.query.query_env.Coalesce</code>
<a class="headerlink" href="#beancount.query.query_env.Coalesce" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the first non-null argument</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ConvertAmount">
<code>beancount.query.query_env.ConvertAmount</code>
<a class="headerlink" href="#beancount.query.query_env.ConvertAmount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an amount to a particular currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ConvertAmountWithDate">
<code>beancount.query.query_env.ConvertAmountWithDate</code>
<a class="headerlink" href="#beancount.query.query_env.ConvertAmountWithDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an amount to a particular currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ConvertInventory">
<code>beancount.query.query_env.ConvertInventory</code>
<a class="headerlink" href="#beancount.query.query_env.ConvertInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an inventory to a particular currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ConvertInventoryWithDate">
<code>beancount.query.query_env.ConvertInventoryWithDate</code>
<a class="headerlink" href="#beancount.query.query_env.ConvertInventoryWithDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an inventory to a particular currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ConvertPosition">
<code>beancount.query.query_env.ConvertPosition</code>
<a class="headerlink" href="#beancount.query.query_env.ConvertPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an amount to a particular currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ConvertPositionWithDate">
<code>beancount.query.query_env.ConvertPositionWithDate</code>
<a class="headerlink" href="#beancount.query.query_env.ConvertPositionWithDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an amount to a particular currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CostCurrencyColumn">
<code>beancount.query.query_env.CostCurrencyColumn</code>
<a class="headerlink" href="#beancount.query.query_env.CostCurrencyColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The cost currency of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CostDateColumn">
<code>beancount.query.query_env.CostDateColumn</code>
<a class="headerlink" href="#beancount.query.query_env.CostDateColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The cost currency of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CostInventory">
<code>beancount.query.query_env.CostInventory</code>
<a class="headerlink" href="#beancount.query.query_env.CostInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the cost of an inventory.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CostLabelColumn">
<code>beancount.query.query_env.CostLabelColumn</code>
<a class="headerlink" href="#beancount.query.query_env.CostLabelColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The cost currency of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CostNumberColumn">
<code>beancount.query.query_env.CostNumberColumn</code>
<a class="headerlink" href="#beancount.query.query_env.CostNumberColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The number of cost units of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CostPosition">
<code>beancount.query.query_env.CostPosition</code>
<a class="headerlink" href="#beancount.query.query_env.CostPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the cost of a position.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Count">
<code>beancount.query.query_env.Count</code>
<a class="headerlink" href="#beancount.query.query_env.Count" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Count the number of occurrences of the argument.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Count.allocate">
<code class="highlight language-python">
beancount.query.query_env.Count.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Count.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Count.initialize">
<code class="highlight language-python">
beancount.query.query_env.Count.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Count.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = 0
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Count.update">
<code class="highlight language-python">
beancount.query.query_env.Count.update
(self, store, unused_ontext)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Count.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, unused_ontext):
    store[self.handle] += 1
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Currency">
<code>beancount.query.query_env.Currency</code>
<a class="headerlink" href="#beancount.query.query_env.Currency" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the currency from an Amount.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CurrencyColumn">
<code>beancount.query.query_env.CurrencyColumn</code>
<a class="headerlink" href="#beancount.query.query_env.CurrencyColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The currency of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.CurrencyMeta">
<code>beancount.query.query_env.CurrencyMeta</code>
<a class="headerlink" href="#beancount.query.query_env.CurrencyMeta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the metadata dict of the commodity directive of the currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Date">
<code>beancount.query.query_env.Date</code>
<a class="headerlink" href="#beancount.query.query_env.Date" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Construct a date with year, month, day arguments</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DateAdd">
<code>beancount.query.query_env.DateAdd</code>
<a class="headerlink" href="#beancount.query.query_env.DateAdd" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Adds/subtracts number of days from the given date</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DateColumn">
<code>beancount.query.query_env.DateColumn</code>
<a class="headerlink" href="#beancount.query.query_env.DateColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The date of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DateDiff">
<code>beancount.query.query_env.DateDiff</code>
<a class="headerlink" href="#beancount.query.query_env.DateDiff" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Calculates the difference (in days) between two dates</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DateEntryColumn">
<code>beancount.query.query_env.DateEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.DateEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The date of the directive.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Day">
<code>beancount.query.query_env.Day</code>
<a class="headerlink" href="#beancount.query.query_env.Day" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the day from a date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DayColumn">
<code>beancount.query.query_env.DayColumn</code>
<a class="headerlink" href="#beancount.query.query_env.DayColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The day of the date of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DayEntryColumn">
<code>beancount.query.query_env.DayEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.DayEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The day of the date of the directive.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DescriptionColumn">
<code>beancount.query.query_env.DescriptionColumn</code>
<a class="headerlink" href="#beancount.query.query_env.DescriptionColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A combination of the payee + narration for the transaction of this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.DescriptionEntryColumn">
<code>beancount.query.query_env.DescriptionEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.DescriptionEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A combination of the payee + narration of the transaction, if present.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.EntryMeta">
<code>beancount.query.query_env.EntryMeta</code>
<a class="headerlink" href="#beancount.query.query_env.EntryMeta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get some metadata key of the parent directive (Transaction).</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FileLocationColumn">
<code>beancount.query.query_env.FileLocationColumn</code>
<a class="headerlink" href="#beancount.query.query_env.FileLocationColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The filename:lineno where the posting was parsed from or created.</p>
<pre><code>If you select this column as the first column, because it renders like
errors, Emacs is able to pick those up and you can navigate between an
arbitrary list of transactions with next-error and previous-error.
</code></pre>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FilenameColumn">
<code>beancount.query.query_env.FilenameColumn</code>
<a class="headerlink" href="#beancount.query.query_env.FilenameColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The filename where the posting was parsed from or created.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FilenameEntryColumn">
<code>beancount.query.query_env.FilenameEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.FilenameEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The filename where the directive was parsed from or created.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FilterCurrencyInventory">
<code>beancount.query.query_env.FilterCurrencyInventory</code>
<a class="headerlink" href="#beancount.query.query_env.FilterCurrencyInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Filter an inventory to just the specified currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FilterCurrencyPosition">
<code>beancount.query.query_env.FilterCurrencyPosition</code>
<a class="headerlink" href="#beancount.query.query_env.FilterCurrencyPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Filter an inventory to just the specified currency.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FilterEntriesEnvironment">
<code>beancount.query.query_env.FilterEntriesEnvironment</code>
<a class="headerlink" href="#beancount.query.query_env.FilterEntriesEnvironment" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An execution context that provides access to attributes on Transactions
    and other entry types.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FilterPostingsEnvironment">
<code>beancount.query.query_env.FilterPostingsEnvironment</code>
<a class="headerlink" href="#beancount.query.query_env.FilterPostingsEnvironment" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An execution context that provides access to attributes on Postings.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FindFirst">
<code>beancount.query.query_env.FindFirst</code>
<a class="headerlink" href="#beancount.query.query_env.FindFirst" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Filter a string sequence by regular expression and return the first match.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.First">
<code>beancount.query.query_env.First</code>
<a class="headerlink" href="#beancount.query.query_env.First" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Keep the first of the values seen.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.First.allocate">
<code class="highlight language-python">
beancount.query.query_env.First.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.First.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.First.initialize">
<code class="highlight language-python">
beancount.query.query_env.First.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.First.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.First.update">
<code class="highlight language-python">
beancount.query.query_env.First.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.First.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    if store[self.handle] is None:
        value = self.eval_args(context)[0]
        store[self.handle] = value
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FlagColumn">
<code>beancount.query.query_env.FlagColumn</code>
<a class="headerlink" href="#beancount.query.query_env.FlagColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The flag of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.FlagEntryColumn">
<code>beancount.query.query_env.FlagEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.FlagEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The flag the transaction.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.GetItemStr">
<code>beancount.query.query_env.GetItemStr</code>
<a class="headerlink" href="#beancount.query.query_env.GetItemStr" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the string value of a dict. The value is always converted to a string.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Grep">
<code>beancount.query.query_env.Grep</code>
<a class="headerlink" href="#beancount.query.query_env.Grep" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Match a group against a string and return only the matched portion.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.GrepN">
<code>beancount.query.query_env.GrepN</code>
<a class="headerlink" href="#beancount.query.query_env.GrepN" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Match a pattern with subgroups against a string and return the subgroup at the index</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.IdColumn">
<code>beancount.query.query_env.IdColumn</code>
<a class="headerlink" href="#beancount.query.query_env.IdColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The unique id of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.IdEntryColumn">
<code>beancount.query.query_env.IdEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.IdEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Unique id of a directive.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.JoinStr">
<code>beancount.query.query_env.JoinStr</code>
<a class="headerlink" href="#beancount.query.query_env.JoinStr" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Join a sequence of strings to a single comma-separated string.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Last">
<code>beancount.query.query_env.Last</code>
<a class="headerlink" href="#beancount.query.query_env.Last" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Keep the last of the values seen.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Last.allocate">
<code class="highlight language-python">
beancount.query.query_env.Last.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Last.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Last.initialize">
<code class="highlight language-python">
beancount.query.query_env.Last.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Last.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Last.update">
<code class="highlight language-python">
beancount.query.query_env.Last.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Last.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    store[self.handle] = value
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Leaf">
<code>beancount.query.query_env.Leaf</code>
<a class="headerlink" href="#beancount.query.query_env.Leaf" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the name of the leaf subaccount.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Length">
<code>beancount.query.query_env.Length</code>
<a class="headerlink" href="#beancount.query.query_env.Length" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the length of the argument. This works on sequences.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.LineNoColumn">
<code>beancount.query.query_env.LineNoColumn</code>
<a class="headerlink" href="#beancount.query.query_env.LineNoColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The line number from the file the posting was parsed from.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.LineNoEntryColumn">
<code>beancount.query.query_env.LineNoEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.LineNoEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The line number from the file the directive was parsed from.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.LinksColumn">
<code>beancount.query.query_env.LinksColumn</code>
<a class="headerlink" href="#beancount.query.query_env.LinksColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The set of links of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.LinksEntryColumn">
<code>beancount.query.query_env.LinksEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.LinksEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The set of links of the transaction.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.MatchAccount">
<code>beancount.query.query_env.MatchAccount</code>
<a class="headerlink" href="#beancount.query.query_env.MatchAccount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A predicate, true if the transaction has at least one posting matching
    the regular expression argument.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Max">
<code>beancount.query.query_env.Max</code>
<a class="headerlink" href="#beancount.query.query_env.Max" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the maximum of the values.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Max.allocate">
<code class="highlight language-python">
beancount.query.query_env.Max.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Max.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Max.initialize">
<code class="highlight language-python">
beancount.query.query_env.Max.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Max.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = self.dtype()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Max.update">
<code class="highlight language-python">
beancount.query.query_env.Max.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Max.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    if value &gt; store[self.handle]:
        store[self.handle] = value
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.MaxWidth">
<code>beancount.query.query_env.MaxWidth</code>
<a class="headerlink" href="#beancount.query.query_env.MaxWidth" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert the argument to a substring. This can be used to ensure maximum width</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Meta">
<code>beancount.query.query_env.Meta</code>
<a class="headerlink" href="#beancount.query.query_env.Meta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get some metadata key of the Posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Min">
<code>beancount.query.query_env.Min</code>
<a class="headerlink" href="#beancount.query.query_env.Min" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Compute the minimum of the values.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Min.allocate">
<code class="highlight language-python">
beancount.query.query_env.Min.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Min.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Min.initialize">
<code class="highlight language-python">
beancount.query.query_env.Min.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Min.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = self.dtype()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Min.update">
<code class="highlight language-python">
beancount.query.query_env.Min.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Min.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    if value &lt; store[self.handle]:
        store[self.handle] = value
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Month">
<code>beancount.query.query_env.Month</code>
<a class="headerlink" href="#beancount.query.query_env.Month" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the month from a date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.MonthColumn">
<code>beancount.query.query_env.MonthColumn</code>
<a class="headerlink" href="#beancount.query.query_env.MonthColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The month of the date of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.MonthEntryColumn">
<code>beancount.query.query_env.MonthEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.MonthEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The month of the date of the directive.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.NarrationColumn">
<code>beancount.query.query_env.NarrationColumn</code>
<a class="headerlink" href="#beancount.query.query_env.NarrationColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The narration of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.NarrationEntryColumn">
<code>beancount.query.query_env.NarrationEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.NarrationEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The narration of the transaction.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Number">
<code>beancount.query.query_env.Number</code>
<a class="headerlink" href="#beancount.query.query_env.Number" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the number from an Amount.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.NumberColumn">
<code>beancount.query.query_env.NumberColumn</code>
<a class="headerlink" href="#beancount.query.query_env.NumberColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The number of units of the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.OnlyInventory">
<code>beancount.query.query_env.OnlyInventory</code>
<a class="headerlink" href="#beancount.query.query_env.OnlyInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get one currency's amount from the inventory.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.OpenDate">
<code>beancount.query.query_env.OpenDate</code>
<a class="headerlink" href="#beancount.query.query_env.OpenDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the date of the open directive of the account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.OpenMeta">
<code>beancount.query.query_env.OpenMeta</code>
<a class="headerlink" href="#beancount.query.query_env.OpenMeta" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the metadata dict of the open directive of the account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.OtherAccountsColumn">
<code>beancount.query.query_env.OtherAccountsColumn</code>
<a class="headerlink" href="#beancount.query.query_env.OtherAccountsColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The list of other accounts in the transaction, excluding that of this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Parent">
<code>beancount.query.query_env.Parent</code>
<a class="headerlink" href="#beancount.query.query_env.Parent" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the parent name of the account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ParseDate">
<code>beancount.query.query_env.ParseDate</code>
<a class="headerlink" href="#beancount.query.query_env.ParseDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Construct a date with year, month, day arguments</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PayeeColumn">
<code>beancount.query.query_env.PayeeColumn</code>
<a class="headerlink" href="#beancount.query.query_env.PayeeColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The payee of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PayeeEntryColumn">
<code>beancount.query.query_env.PayeeEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.PayeeEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The payee of the transaction.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PositionColumn">
<code>beancount.query.query_env.PositionColumn</code>
<a class="headerlink" href="#beancount.query.query_env.PositionColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The position for the posting. These can be summed into inventories.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PosSignAmount">
<code>beancount.query.query_env.PosSignAmount</code>
<a class="headerlink" href="#beancount.query.query_env.PosSignAmount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Correct sign of an Amount based on the usual balance of associated account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PosSignDecimal">
<code>beancount.query.query_env.PosSignDecimal</code>
<a class="headerlink" href="#beancount.query.query_env.PosSignDecimal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Correct sign of an Amount based on the usual balance of associated account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PosSignInventory">
<code>beancount.query.query_env.PosSignInventory</code>
<a class="headerlink" href="#beancount.query.query_env.PosSignInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Correct sign of an Amount based on the usual balance of associated account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PosSignPosition">
<code>beancount.query.query_env.PosSignPosition</code>
<a class="headerlink" href="#beancount.query.query_env.PosSignPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Correct sign of an Amount based on the usual balance of associated account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PostingFlagColumn">
<code>beancount.query.query_env.PostingFlagColumn</code>
<a class="headerlink" href="#beancount.query.query_env.PostingFlagColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The flag of the posting itself.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Price">
<code>beancount.query.query_env.Price</code>
<a class="headerlink" href="#beancount.query.query_env.Price" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Fetch a price for something at a particular date</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PriceColumn">
<code>beancount.query.query_env.PriceColumn</code>
<a class="headerlink" href="#beancount.query.query_env.PriceColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The price attached to the posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.PriceWithDate">
<code>beancount.query.query_env.PriceWithDate</code>
<a class="headerlink" href="#beancount.query.query_env.PriceWithDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Fetch a price for something at a particular date</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Quarter">
<code>beancount.query.query_env.Quarter</code>
<a class="headerlink" href="#beancount.query.query_env.Quarter" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the quarter from a date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Root">
<code>beancount.query.query_env.Root</code>
<a class="headerlink" href="#beancount.query.query_env.Root" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the root name(s) of the account.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.SafeDiv">
<code>beancount.query.query_env.SafeDiv</code>
<a class="headerlink" href="#beancount.query.query_env.SafeDiv" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A division operation that swallows dbz exceptions and outputs 0 instead.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Str">
<code>beancount.query.query_env.Str</code>
<a class="headerlink" href="#beancount.query.query_env.Str" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert the argument to a string.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Subst">
<code>beancount.query.query_env.Subst</code>
<a class="headerlink" href="#beancount.query.query_env.Subst" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Substitute leftmost non-overlapping occurrences of pattern by replacement.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Sum">
<code>beancount.query.query_env.Sum</code>
<a class="headerlink" href="#beancount.query.query_env.Sum" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Calculate the sum of the numerical argument.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Sum.allocate">
<code class="highlight language-python">
beancount.query.query_env.Sum.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Sum.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Sum.initialize">
<code class="highlight language-python">
beancount.query.query_env.Sum.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Sum.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = self.dtype()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.Sum.update">
<code class="highlight language-python">
beancount.query.query_env.Sum.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.Sum.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    if value is not None:
        store[self.handle] += value
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.SumAmount">
<code>beancount.query.query_env.SumAmount</code>
<a class="headerlink" href="#beancount.query.query_env.SumAmount" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Calculate the sum of the amount. The result is an Inventory.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.SumAmount.update">
<code class="highlight language-python">
beancount.query.query_env.SumAmount.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.SumAmount.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    store[self.handle].add_amount(value)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.SumBase">
<code>beancount.query.query_env.SumBase</code>
<a class="headerlink" href="#beancount.query.query_env.SumBase" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.SumBase.allocate">
<code class="highlight language-python">
beancount.query.query_env.SumBase.allocate
(self, allocator)

        </code>
<a class="headerlink" href="#beancount.query.query_env.SumBase.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate handles to store data for a node's aggregate storage.</p>
<p>This is called once before beginning aggregations. If you need any
kind of per-aggregate storage during the computation phase, get it
in this method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allocator</code></td>
<td><code></code></td>
<td>
<p>An instance of Allocator, on which you can call allocate() to
obtain a handle for a slot to store data on store objects later on.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self, allocator):
    self.handle = allocator.allocate()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.SumBase.initialize">
<code class="highlight language-python">
beancount.query.query_env.SumBase.initialize
(self, store)

        </code>
<a class="headerlink" href="#beancount.query.query_env.SumBase.initialize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize this node's aggregate data. If the node is not an aggregate,
simply initialize the subnodes. Override this method in the aggregator
if you need data for storage.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize(self, store):
    store[self.handle] = inventory.Inventory()
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.SumInventory">
<code>beancount.query.query_env.SumInventory</code>
<a class="headerlink" href="#beancount.query.query_env.SumInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Calculate the sum of the inventories. The result is an Inventory.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.SumInventory.update">
<code class="highlight language-python">
beancount.query.query_env.SumInventory.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.SumInventory.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    store[self.handle].add_inventory(value)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.SumPosition">
<code>beancount.query.query_env.SumPosition</code>
<a class="headerlink" href="#beancount.query.query_env.SumPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Calculate the sum of the position. The result is an Inventory.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env.SumPosition.update">
<code class="highlight language-python">
beancount.query.query_env.SumPosition.update
(self, store, context)

        </code>
<a class="headerlink" href="#beancount.query.query_env.SumPosition.update" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Evaluate this node. This is designed to recurse on its children.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>store</code></td>
<td><code></code></td>
<td>
<p>An object indexable by handles appropriated during allocate().</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>The object to which the evaluation need to apply (see <strong>call</strong>).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def update(self, store, context):
    value = self.eval_args(context)[0]
    store[self.handle].add_position(value)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.TagsColumn">
<code>beancount.query.query_env.TagsColumn</code>
<a class="headerlink" href="#beancount.query.query_env.TagsColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The set of tags of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.TagsEntryColumn">
<code>beancount.query.query_env.TagsEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.TagsEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The set of tags of the transaction.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.TargetsEnvironment">
<code>beancount.query.query_env.TargetsEnvironment</code>
<a class="headerlink" href="#beancount.query.query_env.TargetsEnvironment" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An execution context that provides access to attributes on Postings.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Today">
<code>beancount.query.query_env.Today</code>
<a class="headerlink" href="#beancount.query.query_env.Today" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Today's date</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.TypeColumn">
<code>beancount.query.query_env.TypeColumn</code>
<a class="headerlink" href="#beancount.query.query_env.TypeColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The data type of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.TypeEntryColumn">
<code>beancount.query.query_env.TypeEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.TypeEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The data type of the directive.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.UnitsInventory">
<code>beancount.query.query_env.UnitsInventory</code>
<a class="headerlink" href="#beancount.query.query_env.UnitsInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the number of units of an inventory (stripping cost).</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.UnitsPosition">
<code>beancount.query.query_env.UnitsPosition</code>
<a class="headerlink" href="#beancount.query.query_env.UnitsPosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Get the number of units of a position (stripping cost).</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ValueInventory">
<code>beancount.query.query_env.ValueInventory</code>
<a class="headerlink" href="#beancount.query.query_env.ValueInventory" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an inventory to its market value at the current date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ValueInventoryWithDate">
<code>beancount.query.query_env.ValueInventoryWithDate</code>
<a class="headerlink" href="#beancount.query.query_env.ValueInventoryWithDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Coerce an inventory to its market value at a particular date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ValuePosition">
<code>beancount.query.query_env.ValuePosition</code>
<a class="headerlink" href="#beancount.query.query_env.ValuePosition" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a position to its cost currency at the market value.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.ValuePositionWithDate">
<code>beancount.query.query_env.ValuePositionWithDate</code>
<a class="headerlink" href="#beancount.query.query_env.ValuePositionWithDate" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a position to its cost currency at the market value of a particular date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Weekday">
<code>beancount.query.query_env.Weekday</code>
<a class="headerlink" href="#beancount.query.query_env.Weekday" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract a 3-letter weekday from a date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.WeightColumn">
<code>beancount.query.query_env.WeightColumn</code>
<a class="headerlink" href="#beancount.query.query_env.WeightColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The computed weight used for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.Year">
<code>beancount.query.query_env.Year</code>
<a class="headerlink" href="#beancount.query.query_env.Year" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the year from a date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.YearColumn">
<code>beancount.query.query_env.YearColumn</code>
<a class="headerlink" href="#beancount.query.query_env.YearColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The year of the date of the parent transaction for this posting.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.YearEntryColumn">
<code>beancount.query.query_env.YearEntryColumn</code>
<a class="headerlink" href="#beancount.query.query_env.YearEntryColumn" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>The year of the date of the directive.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env.YearMonth">
<code>beancount.query.query_env.YearMonth</code>
<a class="headerlink" href="#beancount.query.query_env.YearMonth" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract the year and month from a date.</p>
<div class="doc doc-children">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_env_test">
<code>beancount.query.query_env_test</code>
<a class="headerlink" href="#beancount.query.query_env_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv">
<code>beancount.query.query_env_test.TestEnv</code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv.test_AnyMeta">
<code class="highlight language-python">
beancount.query.query_env_test.TestEnv.test_AnyMeta
(self, entries, _, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv.test_AnyMeta" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2016-11-20 *
  name: "TheName"
  address: "1 Wrong Way"
  empty: "NotEmpty"
  Assets:Banking          1 USD
    color: "Green"
    address: "1 Right Way"
    empty:</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@parser.parse_doc()
def test_AnyMeta(self, entries, _, options_map):
    """
    2016-11-20 *
      name: "TheName"
      address: "1 Wrong Way"
      empty: "NotEmpty"
      Assets:Banking          1 USD
        color: "Green"
        address: "1 Right Way"
        empty:
    """
    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT ANY_META("name") as m')
    self.assertEqual([('TheName',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT ANY_META("color") as m')
    self.assertEqual([('Green',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT ANY_META("address") as m')
    self.assertEqual([('1 Right Way',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT ANY_META("empty") as m')
    self.assertEqual([(None,)], rrows)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv.test_Coalesce">
<code class="highlight language-python">
beancount.query.query_env_test.TestEnv.test_Coalesce
(self, entries, _, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv.test_Coalesce" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2016-11-20 *
  Assets:Banking          1 USD</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@parser.parse_doc()
def test_Coalesce(self, entries, _, options_map):
    """
    2016-11-20 *
      Assets:Banking          1 USD
    """
    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT COALESCE(account, price) as m')
    self.assertEqual([('Assets:Banking',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT COALESCE(price, account) as m')
    self.assertEqual([('Assets:Banking',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT COALESCE(price, cost_number) as m')
    self.assertEqual([(None,)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT COALESCE(narration, account) as m')
    self.assertEqual([('',)], rrows)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv.test_Date">
<code class="highlight language-python">
beancount.query.query_env_test.TestEnv.test_Date
(self, entries, _, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv.test_Date" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2016-11-20 * "ok"
  Assets:Banking          1 USD</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@parser.parse_doc()
def test_Date(self, entries, _, options_map):
    """
    2016-11-20 * "ok"
      Assets:Banking          1 USD
    """
    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date(2020, 1, 2) as m')
    self.assertEqual([(datetime.date(2020, 1, 2),)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date(year, month, 1) as m')
    self.assertEqual([(datetime.date(2016, 11, 1),)], rrows)

    with self.assertRaisesRegex(ValueError, "day is out of range for month"):
        rtypes, rrows = query.run_query(entries, options_map,
                                        'SELECT date(2020, 2, 32) as m')

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date("2020-01-02") as m')
    self.assertEqual([(datetime.date(2020, 1, 2),)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date("2016/11/1") as m')
    self.assertEqual([(datetime.date(2016, 11, 1),)], rrows)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv.test_DateDiffAdjust">
<code class="highlight language-python">
beancount.query.query_env_test.TestEnv.test_DateDiffAdjust
(self, entries, _, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv.test_DateDiffAdjust" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2016-11-20 * "ok"
  Assets:Banking          -1 STOCK { 5 USD, 2016-10-30 }</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@parser.parse_doc()
def test_DateDiffAdjust(self, entries, _, options_map):
    """
    2016-11-20 * "ok"
      Assets:Banking          -1 STOCK { 5 USD, 2016-10-30 }
    """
    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date_diff(date, cost_date) as m')
    self.assertEqual([(21,)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date_diff(cost_date, date) as m')
    self.assertEqual([(-21,)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date_add(date, 1) as m')
    self.assertEqual([(datetime.date(2016, 11, 21),)], rrows)

    rtypes, rrows = query.run_query(entries, options_map,
                                    'SELECT date_add(date, -1) as m')
    self.assertEqual([(datetime.date(2016, 11, 19),)], rrows)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv.test_GrepN">
<code class="highlight language-python">
beancount.query.query_env_test.TestEnv.test_GrepN
(self, entries, _, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv.test_GrepN" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2016-11-20 * "prev match in context next"
  Assets:Banking          1 USD</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@parser.parse_doc()
def test_GrepN(self, entries, _, options_map):
    """
    2016-11-20 * "prev match in context next"
      Assets:Banking          1 USD
    """
    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT GREPN("in", narration, 0) as m
    ''')
    self.assertEqual([('in',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT GREPN("match (.*) context", narration, 1) as m
    ''')
    self.assertEqual([('in',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT GREPN("(.*) in (.*)", narration, 2) as m
    ''')
    self.assertEqual([('context next',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT GREPN("ab(at)hing", "abathing", 1) as m
    ''')
    self.assertEqual([('at',)], rrows)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_env_test.TestEnv.test_Subst">
<code class="highlight language-python">
beancount.query.query_env_test.TestEnv.test_Subst
(self, entries, _, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_env_test.TestEnv.test_Subst" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2016-11-20 * "I love candy"
  Assets:Banking       -1 USD</p>
<p>2016-11-21 * "Buy thing thing"
  Assets:Cash          -1 USD</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_env_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@parser.parse_doc()
def test_Subst(self, entries, _, options_map):
    """
    2016-11-20 * "I love candy"
      Assets:Banking       -1 USD

    2016-11-21 * "Buy thing thing"
      Assets:Cash          -1 USD
    """
    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT SUBST("[Cc]andy", "carrots", narration) as m where date = 2016-11-20
    ''')
    self.assertEqual([('I love carrots',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT SUBST("thing", "t", narration) as m where date = 2016-11-21
    ''')
    self.assertEqual([('Buy t t',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT SUBST("random", "t", narration) as m where date = 2016-11-21
    ''')
    self.assertEqual([('Buy thing thing',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT SUBST("(love)", "\\1 \\1", narration) as m where date = 2016-11-20
    ''')
    self.assertEqual([('I love love candy',)], rrows)

    rtypes, rrows = query.run_query(entries, options_map, '''
      SELECT SUBST("Assets:.*", "Savings", account) as a, str(sum(position)) as p
    ''')
    self.assertEqual([('Savings', '(-2 USD)')], rrows)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_execute">
<code>beancount.query.query_execute</code>
<a class="headerlink" href="#beancount.query.query_execute" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Execution of interpreter on data rows.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_execute.Allocator">
<code>beancount.query.query_execute.Allocator</code>
<a class="headerlink" href="#beancount.query.query_execute.Allocator" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A helper class to count slot allocations and return unique handles to them.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_execute.Allocator.allocate">
<code class="highlight language-python">
beancount.query.query_execute.Allocator.allocate
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.Allocator.allocate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Allocate a new slot to store row aggregation information.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A unique handle used to index into an row-aggregation store (an integer).</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def allocate(self):
    """Allocate a new slot to store row aggregation information.

    Returns:
      A unique handle used to index into an row-aggregation store (an integer).
    """
    handle = self.size
    self.size += 1
    return handle
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_execute.Allocator.create_store">
<code class="highlight language-python">
beancount.query.query_execute.Allocator.create_store
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.Allocator.create_store" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a new row-aggregation store suitable to contain all the node allocations.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A store that can accommodate and be indexed by all the allocated slot handles.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def create_store(self):
    """Create a new row-aggregation store suitable to contain all the node allocations.

    Returns:
      A store that can accommodate and be indexed by all the allocated slot handles.
    """
    return [None] * self.size
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_execute.RowContext">
<code>beancount.query.query_execute.RowContext</code>
<a class="headerlink" href="#beancount.query.query_execute.RowContext" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A dumb container for information used by a row expression.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.create_row_context">
<code class="highlight language-python">
beancount.query.query_execute.create_row_context
(entries, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.create_row_context" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Create the context container which we will use to evaluate rows.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def create_row_context(entries, options_map):
    """Create the context container which we will use to evaluate rows."""
    context = RowContext()
    context.balance = inventory.Inventory()

    # Initialize some global properties for use by some of the accessors.
    context.options_map = options_map
    context.account_types = options.get_account_types(options_map)
    context.open_close_map = getters.get_account_open_close(entries)
    context.commodity_map = getters.get_commodity_map(entries)
    context.price_map = prices.build_price_map(entries)

    return context
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.execute_print">
<code class="highlight language-python">
beancount.query.query_execute.execute_print
(c_print, entries, options_map, file)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.execute_print" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print entries from a print statement specification.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>c_print</code></td>
<td><code></code></td>
<td>
<p>An instance of a compiled EvalPrint statement.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A parser's option_map.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>file</code></td>
<td><code></code></td>
<td>
<p>The output file to print to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def execute_print(c_print, entries, options_map, file):
    """Print entries from a print statement specification.

    Args:
      c_print: An instance of a compiled EvalPrint statement.
      entries: A list of directives.
      options_map: A parser's option_map.
      file: The output file to print to.
    """
    if c_print and c_print.c_from is not None:
        context = create_row_context(entries, options_map)
        entries = filter_entries(c_print.c_from, entries, options_map, context)

    # Create a context that renders all numbers with their natural
    # precision, but honors the commas option. This is kept in sync with
    # {2c694afe3140} to avoid a dependency.
    dcontext = display_context.DisplayContext()
    dcontext.set_commas(options_map['dcontext'].commas)
    printer.print_entries(entries, dcontext, file=file)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.execute_query">
<code class="highlight language-python">
beancount.query.query_execute.execute_query
(query, entries, options_map)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.execute_query" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Given a compiled select statement, execute the query.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An instance of a query_compile.Query</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A parser's option_map.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>A pair of</code></td>
<td>
<p>result_types: A list of (name, data-type) item pairs.
  result_rows: A list of ResultRow tuples of length and types described by
    'result_types'.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def execute_query(query, entries, options_map):
    """Given a compiled select statement, execute the query.

    Args:
      query: An instance of a query_compile.Query
      entries: A list of directives.
      options_map: A parser's option_map.
    Returns:
      A pair of:
        result_types: A list of (name, data-type) item pairs.
        result_rows: A list of ResultRow tuples of length and types described by
          'result_types'.
    """
    # Figure out the result types that describe what we return.
    result_types = [(target.name, target.c_expr.dtype)
                    for target in query.c_targets
                    if target.name is not None]

    # Create a class for each final result.
    # pylint: disable=invalid-name
    ResultRow = collections.namedtuple('ResultRow',
                                       [target.name
                                        for target in query.c_targets
                                        if target.name is not None])

    # Pre-compute lists of the expressions to evaluate.
    group_indexes = (set(query.group_indexes)
                     if query.group_indexes is not None
                     else query.group_indexes)

    # Indexes of the columns for result rows and order rows.
    result_indexes = [index
                      for index, c_target in enumerate(query.c_targets)
                      if c_target.name]
    order_indexes = query.order_indexes

    # Figure out if we need to compute balance.
    uses_balance = any(uses_balance_column(c_expr)
                       for c_expr in itertools.chain(
                               [c_target.c_expr for c_target in query.c_targets],
                               [query.c_where] if query.c_where else []))

    context = create_row_context(entries, options_map)

    # Filter the entries using the FROM clause.
    filt_entries = (filter_entries(query.c_from, entries, options_map, context)
                    if query.c_from is not None else
                    entries)

    # Dispatch between the non-aggregated queries and aggregated queries.
    c_where = query.c_where
    schwartz_rows = []

    # Precompute a list of expressions to be evaluated.
    c_target_exprs = [c_target.c_expr for c_target in query.c_targets]

    if query.group_indexes is None:
        # This is a non-aggregated query.

        # Iterate over all the postings once and produce schwartzian rows.
        for entry in misc_utils.filter_type(filt_entries, data.Transaction):
            context.entry = entry
            for posting in entry.postings:
                context.posting = posting
                if c_where is None or c_where(context):
                    # Compute the balance.
                    if uses_balance:
                        context.balance.add_position(posting)

                    # Evaluate all the values.
                    values = [c_expr(context) for c_expr in c_target_exprs]

                    # Compute result and sort-key objects.
                    result = ResultRow._make(values[index]
                                             for index in result_indexes)
                    sortkey = row_sortkey(order_indexes, values, c_target_exprs)
                    schwartz_rows.append((sortkey, result))
    else:
        # This is an aggregated query.

        # Precompute lists of non-aggregate and aggregate expressions to
        # evaluate. For aggregate targets, we hunt down the aggregate
        # sub-expressions to evaluate, to avoid recursion during iteration.
        c_nonaggregate_exprs = []
        c_aggregate_exprs = []
        for index, c_expr in enumerate(c_target_exprs):
            if index in group_indexes:
                c_nonaggregate_exprs.append(c_expr)
            else:
                _, aggregate_exprs = query_compile.get_columns_and_aggregates(c_expr)
                c_aggregate_exprs.extend(aggregate_exprs)
        # Note: it is possible that there are no aggregates to compute here. You could
        # have all columns be non-aggregates and group-by the entire list of columns.

        # Pre-allocate handles in aggregation nodes.
        allocator = Allocator()
        for c_expr in c_aggregate_exprs:
            c_expr.allocate(allocator)

        # Iterate over all the postings to evaluate the aggregates.
        agg_store = {}
        for entry in misc_utils.filter_type(filt_entries, data.Transaction):
            context.entry = entry
            for posting in entry.postings:
                context.posting = posting
                if c_where is None or c_where(context):
                    # Compute the balance.
                    if uses_balance:
                        context.balance.add_position(posting)

                    # Compute the non-aggregate expressions.
                    row_key = tuple(c_expr(context)
                                    for c_expr in c_nonaggregate_exprs)

                    # Get an appropriate store for the unique key of this row.
                    try:
                        store = agg_store[row_key]
                    except KeyError:
                        # This is a row; create a new store.
                        store = allocator.create_store()
                        for c_expr in c_aggregate_exprs:
                            c_expr.initialize(store)
                        agg_store[row_key] = store

                    # Update the aggregate expressions.
                    for c_expr in c_aggregate_exprs:
                        c_expr.update(store, context)

        # Iterate over all the aggregations to produce the schwartzian rows.
        for key, store in agg_store.items():
            key_iter = iter(key)
            values = []

            # Finalize the store.
            for c_expr in c_aggregate_exprs:
                c_expr.finalize(store)
            context.store = store

            for index, c_expr in enumerate(c_target_exprs):
                if index in group_indexes:
                    value = next(key_iter)
                else:
                    value = c_expr(context)
                values.append(value)

            # Compute result and sort-key objects.
            result = ResultRow._make(values[index]
                                     for index in result_indexes)
            sortkey = row_sortkey(order_indexes, values, c_target_exprs)
            schwartz_rows.append((sortkey, result))

    # Order results if requested.
    if order_indexes is not None:
        schwartz_rows.sort(key=operator.itemgetter(0),
                           reverse=(query.ordering == 'DESC'))

    # Extract final results, in sorted order at this point.
    result_rows = [x[1] for x in schwartz_rows]

    # Apply distinct.
    if query.distinct:
        result_rows = list(misc_utils.uniquify(result_rows))

    # Apply limit.
    if query.limit is not None:
        result_rows = result_rows[:query.limit]

    # Flatten inventories if requested.
    if query.flatten:
        result_types, result_rows = flatten_results(result_types, result_rows)

    return (result_types, result_rows)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.filter_entries">
<code class="highlight language-python">
beancount.query.query_execute.filter_entries
(c_from, entries, options_map, context)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.filter_entries" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Filter the entries by the given compiled FROM clause.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>c_from</code></td>
<td><code></code></td>
<td>
<p>A compiled From clause instance.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>A parser's option_map.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>context</code></td>
<td><code></code></td>
<td>
<p>A prototype of RowContext to use for evaluation.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of filtered entries.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def filter_entries(c_from, entries, options_map, context):
    """Filter the entries by the given compiled FROM clause.

    Args:
      c_from: A compiled From clause instance.
      entries: A list of directives.
      options_map: A parser's option_map.
      context: A prototype of RowContext to use for evaluation.
    Returns:
      A list of filtered entries.
    """
    assert c_from is None or isinstance(c_from, query_compile.EvalFrom)
    assert isinstance(entries, list)

    context = copy.copy(context)

    if c_from is None:
        return entries

    # Process the OPEN clause.
    if c_from.open is not None:
        assert isinstance(c_from.open, datetime.date)
        open_date = c_from.open
        entries, index = summarize.open_opt(entries, open_date, options_map)

    # Process the CLOSE clause.
    if c_from.close is not None:
        if isinstance(c_from.close, datetime.date):
            close_date = c_from.close
            entries, index = summarize.close_opt(entries, close_date, options_map)
        elif c_from.close is True:
            entries, index = summarize.close_opt(entries, None, options_map)

    # Process the CLEAR clause.
    if c_from.clear is not None:
        entries, index = summarize.clear_opt(entries, None, options_map)

    # Filter the entries with the FROM clause's expression.
    c_expr = c_from.c_expr
    if c_expr is not None:
        # A simple function receives a context; how come close_date() is
        # accepted in the context of a FROM clause? It shouldn't be.
        new_entries = []
        for entry in entries:
            context.entry = entry
            if c_expr(context):
                new_entries.append(entry)
        entries = new_entries

    return entries
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.flatten_results">
<code class="highlight language-python">
beancount.query.query_execute.flatten_results
(result_types, result_rows)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.flatten_results" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert inventories in result types to have a row for each.</p>
<p>This routine will expand all result lines with an inventory into a new line
for each position.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>result_types</code></td>
<td><code></code></td>
<td>
<p>A list of (name, data-type) item pairs.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>result_rows</code></td>
<td><code></code></td>
<td>
<p>A list of ResultRow tuples of length and types described by
'result_types'.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>result_types</code></td>
<td>
<p>A list of (name, data-type) item pairs. There should be no
  Inventory types anymore.
result_rows: A list of ResultRow tuples of length and types described by
  'result_types'. All inventories from the input should have been converted
  to Position types.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def flatten_results(result_types, result_rows):
    """Convert inventories in result types to have a row for each.

    This routine will expand all result lines with an inventory into a new line
    for each position.

    Args:
        result_types: A list of (name, data-type) item pairs.
        result_rows: A list of ResultRow tuples of length and types described by
          'result_types'.
    Returns:
        result_types: A list of (name, data-type) item pairs. There should be no
          Inventory types anymore.
        result_rows: A list of ResultRow tuples of length and types described by
          'result_types'. All inventories from the input should have been converted
          to Position types.
    """
    indexes = set(index
                  for index, (name, result_type) in enumerate(result_types)
                  if result_type is inventory.Inventory)
    if not indexes:
        return (result_types, result_rows)

    # pylint: disable=invalid-name
    ResultRow = type(result_rows[0])

    # We have to make at least some conversions.
    num_columns = len(result_types)
    output_rows = []
    for result_row in result_rows:
        max_rows = max(len(result_row[icol]) for icol in indexes)
        for irow in range(max_rows):
            output_row = []
            for icol in range(num_columns):
                value = result_row[icol]
                if icol in indexes:
                    value = value[irow] if irow &lt; len(value) else None
                output_row.append(value)
            output_rows.append(ResultRow._make(output_row))

    # Convert the types.
    output_types = [(name, (position.Position
                            if result_type is inventory.Inventory
                            else result_type))
                    for name, result_type in result_types]

    return output_types, output_rows
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.row_sortkey">
<code class="highlight language-python">
beancount.query.query_execute.row_sortkey
(order_indexes, values, c_exprs)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.row_sortkey" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Generate a sortkey for the given values.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>order_indexes</code></td>
<td><code></code></td>
<td>
<p>The indexes by which the rows should be sorted.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>values</code></td>
<td><code></code></td>
<td>
<p>The computed values in the row.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>c_exprs</code></td>
<td><code></code></td>
<td>
<p>The matching c_expr's.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple, the sortkey.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def row_sortkey(order_indexes, values, c_exprs):
    """Generate a sortkey for the given values.

    Args:
      order_indexes: The indexes by which the rows should be sorted.
      values: The computed values in the row.
      c_exprs: The matching c_expr's.
    Returns:
      A tuple, the sortkey.
    """
    if order_indexes is None:
        return None
    key = []
    for index in order_indexes:
        value = values[index]
        key.append(_MIN_VALUES.get(c_exprs[index].dtype, None)
                   if value is None
                   else value)
    return tuple(key)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_execute.uses_balance_column">
<code class="highlight language-python">
beancount.query.query_execute.uses_balance_column
(c_expr)

        </code>
<a class="headerlink" href="#beancount.query.query_execute.uses_balance_column" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return true if the expression accesses the special 'balance' column.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>c_expr</code></td>
<td><code></code></td>
<td>
<p>A compiled expression tree (an EvalNode node).</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A boolean, true if the expression contains a BalanceColumn node.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def uses_balance_column(c_expr):
    """Return true if the expression accesses the special 'balance' column.

    Args:
      c_expr: A compiled expression tree (an EvalNode node).
    Returns:
      A boolean, true if the expression contains a BalanceColumn node.
    """
    return (isinstance(c_expr, query_env.BalanceColumn) or
            any(uses_balance_column(c_node) for c_node in c_expr.childnodes()))
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_execute_test">
<code>beancount.query.query_execute_test</code>
<a class="headerlink" href="#beancount.query.query_execute_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_execute_test.QueryBase">
<code>beancount.query.query_execute_test.QueryBase</code>
<a class="headerlink" href="#beancount.query.query_execute_test.QueryBase" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_execute_test.QueryBase.compile">
<code class="highlight language-python">
beancount.query.query_execute_test.QueryBase.compile
(self, bql_string)

        </code>
<a class="headerlink" href="#beancount.query.query_execute_test.QueryBase.compile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Parse a query and compile it.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bql_string</code></td>
<td><code></code></td>
<td>
<p>An SQL query to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A compiled EvalQuery node.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def compile(self, bql_string):
    """Parse a query and compile it.

    Args:
      bql_string: An SQL query to be parsed.
    Returns:
      A compiled EvalQuery node.
    """
    return qc.compile_select(self.parse(bql_string),
                             self.xcontext_targets,
                             self.xcontext_postings,
                             self.xcontext_entries)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_execute_test.QueryBase.parse">
<code class="highlight language-python">
beancount.query.query_execute_test.QueryBase.parse
(self, bql_string)

        </code>
<a class="headerlink" href="#beancount.query.query_execute_test.QueryBase.parse" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Parse a query.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bql_string</code></td>
<td><code></code></td>
<td>
<p>An SQL query to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A parsed statement (Select() node).</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def parse(self, bql_string):
    """Parse a query.

    Args:
      bql_string: An SQL query to be parsed.
    Returns:
      A parsed statement (Select() node).
    """
    return self.parser.parse(bql_string.strip())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_execute_test.QueryBase.setUp">
<code class="highlight language-python">
beancount.query.query_execute_test.QueryBase.setUp
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_execute_test.QueryBase.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_execute_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def setUp(self):
    super().setUp()
    self.parser = query_parser.Parser()
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_parser">
<code>beancount.query.query_parser</code>
<a class="headerlink" href="#beancount.query.query_parser" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>Parser for Beancount Query Language.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Balances">
<code>beancount.query.query_parser.Balances</code>
<a class="headerlink" href="#beancount.query.query_parser.Balances" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Balances(summary_func, from_clause, where_clause)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Balances.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Balances.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Balances.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Balances.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Balances.__new__
(_cls, summary_func, from_clause, where_clause)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Balances.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Balances(summary_func, from_clause, where_clause)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Balances.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Balances.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Balances.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Balances._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Balances._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Balances._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Balances._make">
<code class="highlight language-python">
beancount.query.query_parser.Balances._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Balances._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Balances object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Balances._replace">
<code class="highlight language-python">
beancount.query.query_parser.Balances._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Balances._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Balances object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Errors">
<code>beancount.query.query_parser.Errors</code>
<a class="headerlink" href="#beancount.query.query_parser.Errors" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Errors()</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Errors.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Errors.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Errors.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Errors.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Errors.__new__
(_cls)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Errors.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Errors()</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Errors.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Errors.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Errors.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Errors._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Errors._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Errors._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Errors._make">
<code class="highlight language-python">
beancount.query.query_parser.Errors._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Errors._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Errors object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Errors._replace">
<code class="highlight language-python">
beancount.query.query_parser.Errors._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Errors._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Errors object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Explain">
<code>beancount.query.query_parser.Explain</code>
<a class="headerlink" href="#beancount.query.query_parser.Explain" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Explain(statement,)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Explain.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Explain.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Explain.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Explain.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Explain.__new__
(_cls, statement)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Explain.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Explain(statement,)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Explain.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Explain.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Explain.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Explain._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Explain._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Explain._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Explain._make">
<code class="highlight language-python">
beancount.query.query_parser.Explain._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Explain._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Explain object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Explain._replace">
<code class="highlight language-python">
beancount.query.query_parser.Explain._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Explain._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Explain object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Journal">
<code>beancount.query.query_parser.Journal</code>
<a class="headerlink" href="#beancount.query.query_parser.Journal" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Journal(account, summary_func, from_clause)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Journal.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Journal.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Journal.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Journal.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Journal.__new__
(_cls, account, summary_func, from_clause)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Journal.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Journal(account, summary_func, from_clause)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Journal.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Journal.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Journal.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Journal._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Journal._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Journal._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Journal._make">
<code class="highlight language-python">
beancount.query.query_parser.Journal._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Journal._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Journal object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Journal._replace">
<code class="highlight language-python">
beancount.query.query_parser.Journal._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Journal._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Journal object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Lexer">
<code>beancount.query.query_parser.Lexer</code>
<a class="headerlink" href="#beancount.query.query_parser.Lexer" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>PLY lexer for the Beancount Query Language.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Lexer.t_DATE">
<code class="highlight language-python">
beancount.query.query_parser.Lexer.t_DATE
(self, token)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Lexer.t_DATE" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>(#(\"[^\"]<em>\"|\'[^\']</em>\')|\d\d\d\d-\d\d-\d\d)</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def t_DATE(self, token):
    r"(\#(\"[^\"]*\"|\'[^\']*\')|\d\d\d\d-\d\d-\d\d)"
    if token.value[0] == '#':
        token.value = dateutil.parser.parse(token.value[2:-1]).date()
    else:
        token.value = datetime.datetime.strptime(token.value, '%Y-%m-%d').date()
    return token
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Lexer.t_DECIMAL">
<code class="highlight language-python">
beancount.query.query_parser.Lexer.t_DECIMAL
(self, token)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Lexer.t_DECIMAL" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>[-+]?([0-9]+.[0-9]<em>|[0-9]</em>.[0-9]+)</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def t_DECIMAL(self, token):
    r"[-+]?([0-9]+\.[0-9]*|[0-9]*\.[0-9]+)"
    token.value = D(token.value)
    return token
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Lexer.t_ID">
<code class="highlight language-python">
beancount.query.query_parser.Lexer.t_ID
(self, token)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Lexer.t_ID" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>[a-zA-Z][a-zA-Z_]*</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def t_ID(self, token):
    "[a-zA-Z][a-zA-Z_]*"
    utoken = token.value.upper()
    if utoken in self.keywords:
        token.type = utoken
        token.value = token.value.upper()
    else:
        token.value = token.value.lower()
    return token
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Lexer.t_INTEGER">
<code class="highlight language-python">
beancount.query.query_parser.Lexer.t_INTEGER
(self, token)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Lexer.t_INTEGER" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>[-+]?[0-9]+</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def t_INTEGER(self, token):
    r"[-+]?[0-9]+"
    token.value = int(token.value)
    return token
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Lexer.t_STRING">
<code class="highlight language-python">
beancount.query.query_parser.Lexer.t_STRING
(self, token)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Lexer.t_STRING" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>("[^"]<em>"|'[^']</em>')</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def t_STRING(self, token):
    "(\"[^\"]*\"|\'[^\']*\')"
    token.value = token.value[1:-1]
    return token
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.ParseError">
<code>beancount.query.query_parser.ParseError</code>
<a class="headerlink" href="#beancount.query.query_parser.ParseError" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A parser error.</p>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Parser">
<code>beancount.query.query_parser.Parser</code>
<a class="headerlink" href="#beancount.query.query_parser.Parser" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>PLY parser for the Beancount Query Language's full command syntax.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_balances_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_balances_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_balances_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>balances_statement : BALANCES summary_func from where</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_balances_statement(self, p):
    """
    balances_statement : BALANCES summary_func from where
    """
    p[0] = Balances(p[2], p[3], p[4])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_delimiter">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_delimiter
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_delimiter" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>delimiter : SEMI
          | empty</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_delimiter(self, p):
    """
    delimiter : SEMI
              | empty
    """
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_errors_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_errors_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_errors_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>errors_statement : ERRORS</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_errors_statement(self, p):
    """
    errors_statement : ERRORS
    """
    p[0] = Errors()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_explain_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_explain_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_explain_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>top_statement : EXPLAIN statement delimiter</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_explain_statement(self, p):
    "top_statement : EXPLAIN statement delimiter"
    p[0] = Explain(p[2])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_journal_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_journal_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_journal_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>journal_statement : JOURNAL summary_func from
                  | JOURNAL account summary_func from</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_journal_statement(self, p):
    """
    journal_statement : JOURNAL summary_func from
                      | JOURNAL account summary_func from
    """
    p[0] = Journal(None, p[2], p[3]) if len(p) == 4 else Journal(p[2], p[3], p[4])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_print_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_print_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_print_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>print_statement : PRINT from</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_print_statement(self, p):
    """
    print_statement : PRINT from
    """
    p[0] = Print(p[2])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_regular_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_regular_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_regular_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>top_statement : statement delimiter</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_regular_statement(self, p):
    "top_statement : statement delimiter"
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_reload_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_reload_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_reload_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>reload_statement : RELOAD</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_reload_statement(self, p):
    """
    reload_statement : RELOAD
    """
    p[0] = Reload()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_run_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_run_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_run_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>run_statement : RUN ID
              | RUN STRING
              | RUN ASTERISK
              | RUN empty</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_run_statement(self, p):
    """
    run_statement : RUN ID
                  | RUN STRING
                  | RUN ASTERISK
                  | RUN empty
    """
    p[0] = RunCustom(p[2])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_statement">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>statement : select_statement
          | balances_statement
          | journal_statement
          | print_statement
          | run_statement
          | errors_statement
          | reload_statement</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_statement(self, p):
    """
    statement : select_statement
              | balances_statement
              | journal_statement
              | print_statement
              | run_statement
              | errors_statement
              | reload_statement
    """
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Parser.p_summary_func">
<code class="highlight language-python">
beancount.query.query_parser.Parser.p_summary_func
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.Parser.p_summary_func" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>summary_func : empty
             | AT ID</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_summary_func(self, p):
    """
    summary_func : empty
                 | AT ID
    """
    p[0] = p[2] if len(p) == 3 else None
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Print">
<code>beancount.query.query_parser.Print</code>
<a class="headerlink" href="#beancount.query.query_parser.Print" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print(from_clause,)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Print.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Print.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Print.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Print.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Print.__new__
(_cls, from_clause)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Print.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Print(from_clause,)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Print.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Print.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Print.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Print._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Print._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Print._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Print._make">
<code class="highlight language-python">
beancount.query.query_parser.Print._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Print._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Print object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Print._replace">
<code class="highlight language-python">
beancount.query.query_parser.Print._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Print._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Print object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Reload">
<code>beancount.query.query_parser.Reload</code>
<a class="headerlink" href="#beancount.query.query_parser.Reload" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Reload()</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Reload.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Reload.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Reload.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Reload.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Reload.__new__
(_cls)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Reload.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Reload()</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Reload.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Reload.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Reload.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Reload._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Reload._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Reload._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Reload._make">
<code class="highlight language-python">
beancount.query.query_parser.Reload._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Reload._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Reload object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Reload._replace">
<code class="highlight language-python">
beancount.query.query_parser.Reload._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Reload._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Reload object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.RunCustom">
<code>beancount.query.query_parser.RunCustom</code>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>RunCustom(query_name,)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.RunCustom.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.RunCustom.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.RunCustom.__new__">
<code class="highlight language-python">
beancount.query.query_parser.RunCustom.__new__
(_cls, query_name)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of RunCustom(query_name,)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.RunCustom.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.RunCustom.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.RunCustom._asdict">
<code class="highlight language-python">
beancount.query.query_parser.RunCustom._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.RunCustom._make">
<code class="highlight language-python">
beancount.query.query_parser.RunCustom._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new RunCustom object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.RunCustom._replace">
<code class="highlight language-python">
beancount.query.query_parser.RunCustom._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.RunCustom._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new RunCustom object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.Select">
<code>beancount.query.query_parser.Select</code>
<a class="headerlink" href="#beancount.query.query_parser.Select" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Select(targets, from_clause, where_clause, group_by, order_by, pivot_by, limit, distinct, flatten)</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Select.__getnewargs__">
<code class="highlight language-python">
beancount.query.query_parser.Select.__getnewargs__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Select.__getnewargs__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return self as a plain tuple.  Used by copy and pickle.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __getnewargs__(self):
    'Return self as a plain tuple.  Used by copy and pickle.'
    return _tuple(self)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Select.__new__">
<code class="highlight language-python">
beancount.query.query_parser.Select.__new__
(_cls, targets, from_clause, where_clause, group_by, order_by, pivot_by, limit, distinct, flatten)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Select.__new__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create new instance of Select(targets, from_clause, where_clause, group_by, order_by, pivot_by, limit, distinct, flatten)</p>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Select.__repr__">
<code class="highlight language-python">
beancount.query.query_parser.Select.__repr__
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Select.__repr__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a nicely formatted representation string</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __repr__(self):
    'Return a nicely formatted representation string'
    return self.__class__.__name__ + repr_fmt % self
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Select._asdict">
<code class="highlight language-python">
beancount.query.query_parser.Select._asdict
(self)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Select._asdict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new dict which maps field names to their values.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _asdict(self):
    'Return a new dict which maps field names to their values.'
    return _dict(_zip(self._fields, self))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Select._make">
<code class="highlight language-python">
beancount.query.query_parser.Select._make
(iterable)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Select._make" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Make a new Select object from a sequence or iterable</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@classmethod
def _make(cls, iterable):
    result = tuple_new(cls, iterable)
    if _len(result) != num_fields:
        raise TypeError(f'Expected {num_fields} arguments, got {len(result)}')
    return result
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.Select._replace">
<code class="highlight language-python">
beancount.query.query_parser.Select._replace
    (/, self, **
kwds)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-private"><code>private</code></small>
</span>
<a class="headerlink" href="#beancount.query.query_parser.Select._replace" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Return a new Select object replacing specified fields with new values</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def _replace(self, /, **kwds):
    result = self._make(_map(kwds.pop, field_names, self))
    if kwds:
        raise ValueError(f'Got unexpected field names: {list(kwds)!r}')
    return result
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser.SelectParser">
<code>beancount.query.query_parser.SelectParser</code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>PLY parser for the Beancount Query Language's SELECT statement.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.handle_comma_separated_list">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.handle_comma_separated_list
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.handle_comma_separated_list" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Handle a list of 0, 1 or more comma-separated values.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>p</code></td>
<td><code></code></td>
<td>
<p>A grammar object.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def handle_comma_separated_list(self, p):
    """Handle a list of 0, 1 or more comma-separated values.
    Args:
      p: A grammar object.
    """
    if len(p) == 2:
        return [] if p[1] is None else [p[1]]
    else:
        return p[1] + [p[3]]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_account">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_account
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_account" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>account : STRING</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_account(self, p):
    """
    account : STRING
    """
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_boolean">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_boolean
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_boolean" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>boolean : TRUE
        | FALSE</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_boolean(self, p):
    """
    boolean : TRUE
            | FALSE
    """
    p[0] = (p[1] == 'TRUE')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_column">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_column
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_column" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>column : ID</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_column(self, p):
    """
    column : ID
    """
    p[0] = Column(p[1])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_column_list">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_column_list
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_column_list" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>column_list : column
            | column_list COMMA column</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_column_list(self, p):
    """
    column_list : column
                | column_list COMMA column
    """
    p[0] = self.handle_comma_separated_list(p)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_constant">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_constant
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_constant" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>constant : NULL
         | boolean
         | INTEGER
         | DECIMAL
         | STRING
         | DATE</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_constant(self, p):
    """
    constant : NULL
             | boolean
             | INTEGER
             | DECIMAL
             | STRING
             | DATE
    """
    p[0] = Constant(p[1] if p[1] != 'NULL' else None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_distinct">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_distinct
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_distinct" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>distinct : empty
         | DISTINCT</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_distinct(self, p):
    """
    distinct : empty
             | DISTINCT
    """
    p[0] = True if p[1] == 'DISTINCT' else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_empty">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_empty
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_empty" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>empty :</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_empty(self, _):
    """
    empty :
    """
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expr_index">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expr_index
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expr_index" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expr_index : expression
           | INTEGER</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expr_index(self, p):
    """
    expr_index : expression
               | INTEGER
    """
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expr_index_list">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expr_index_list
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expr_index_list" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expr_index_list : expr_index
                | expr_index_list COMMA expr_index</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expr_index_list(self, p):
    """
    expr_index_list : expr_index
                    | expr_index_list COMMA expr_index
    """
    p[0] = self.handle_comma_separated_list(p)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_add">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_add
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_add" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression PLUS expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_add(self, p):
    "expression : expression PLUS expression"
    p[0] = Add(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_and">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_and
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_and" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression AND expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_and(self, p):
    "expression : expression AND expression"
    p[0] = And(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_column">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_column
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_column" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : column</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_column(self, p):
    "expression : column"
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_constant">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_constant
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_constant" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : constant</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_constant(self, p):
    "expression : constant"
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_contains">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_contains
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_contains" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression IN expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_contains(self, p):
    "expression : expression IN expression"
    p[0] = Contains(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_div">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_div
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_div" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression SLASH expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_div(self, p):
    "expression : expression SLASH expression"
    p[0] = Div(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_eq">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_eq
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_eq" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression EQ expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_eq(self, p):
    "expression : expression EQ expression"
    p[0] = Equal(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_function">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_function
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_function" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : ID LPAREN expression_list_opt RPAREN</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_function(self, p):
    "expression : ID LPAREN expression_list_opt RPAREN"
    p[0] = Function(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_gt">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_gt
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_gt" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression GT expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_gt(self, p):
    "expression : expression GT expression"
    p[0] = Greater(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_gte">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_gte
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_gte" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression GTE expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_gte(self, p):
    "expression : expression GTE expression"
    p[0] = GreaterEq(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_list">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_list
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_list" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression_list : expression
                | expression_list COMMA expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_list(self, p):
    """
    expression_list : expression
                    | expression_list COMMA expression
    """
    p[0] = self.handle_comma_separated_list(p)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_list_opt">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_list_opt
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_list_opt" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression_list_opt : empty
                    | expression
                    | expression_list COMMA expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_list_opt(self, p):
    """
    expression_list_opt : empty
                        | expression
                        | expression_list COMMA expression
    """
    p[0] = self.handle_comma_separated_list(p)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_lt">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_lt
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_lt" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression LT expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_lt(self, p):
    "expression : expression LT expression"
    p[0] = Less(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_lte">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_lte
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_lte" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression LTE expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_lte(self, p):
    "expression : expression LTE expression"
    p[0] = LessEq(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_match">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_match
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_match" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression TILDE expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_match(self, p):
    "expression : expression TILDE expression"
    p[0] = Match(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_mul">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_mul
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_mul" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression ASTERISK expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_mul(self, p):
    "expression : expression ASTERISK expression"
    p[0] = Mul(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_ne">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_ne
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_ne" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression NE expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_ne(self, p):
    "expression : expression NE expression"
    p[0] = Not(Equal(p[1], p[3]))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_not">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_not
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_not" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : NOT expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_not(self, p):
    "expression : NOT expression"
    p[0] = Not(p[2])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_or">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_or
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_or" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression OR expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_or(self, p):
    "expression : expression OR expression"
    p[0] = Or(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_paren">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_paren
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_paren" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : LPAREN expression RPAREN</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_paren(self, p):
    "expression : LPAREN expression RPAREN"
    p[0] = p[2]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_expression_sub">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_expression_sub
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_expression_sub" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>expression : expression MINUS expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_expression_sub(self, p):
    "expression : expression MINUS expression"
    p[0] = Sub(p[1], p[3])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_flatten">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_flatten
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_flatten" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>flatten : empty
        | FLATTEN</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_flatten(self, p):
    """
    flatten : empty
            | FLATTEN
    """
    p[0] = True if p[1] == 'FLATTEN' else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_from">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_from
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_from" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>from : empty
     | FROM opt_expression opt_open opt_close opt_clear</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_from(self, p):
    """
    from : empty
         | FROM opt_expression opt_open opt_close opt_clear
    """
    if len(p) != 2:
        if all(p[i] is None for i in range(2, 6)):
            raise ParseError("Empty FROM expression is not allowed")
        p[0] = From(p[2], p[3], p[4], p[5])
    else:
        p[0] = None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_from_subselect">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_from_subselect
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_from_subselect" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>from_subselect : from
               | FROM LPAREN select_statement RPAREN</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_from_subselect(self, p):
    """
    from_subselect : from
                   | FROM LPAREN select_statement RPAREN
    """
    if len(p) == 2:
        p[0] = p[1]
    else:
        p[0] = p[3]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_group_by">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_group_by
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_group_by" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>group_by : empty
         | GROUP BY expr_index_list having</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_group_by(self, p):
    """
    group_by : empty
             | GROUP BY expr_index_list having
    """
    p[0] = GroupBy(p[3], p[4]) if len(p) != 2 else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_having">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_having
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_having" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>having : empty
       | HAVING expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_having(self, p):
    """
    having : empty
           | HAVING expression
    """
    p[0] = p[2] if len(p) == 3 else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_limit">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_limit
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_limit" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>limit : empty
      | LIMIT INTEGER</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_limit(self, p):
    """
    limit : empty
          | LIMIT INTEGER
    """
    p[0] = p[2] if len(p) == 3 else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_opt_clear">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_opt_clear
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_opt_clear" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>opt_clear : empty
          | CLEAR</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_opt_clear(self, p):
    """
    opt_clear : empty
              | CLEAR
    """
    p[0] = True if (p[1] == 'CLEAR') else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_opt_close">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_opt_close
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_opt_close" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>opt_close : empty
          | CLOSE
          | CLOSE ON DATE</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_opt_close(self, p):
    """
    opt_close : empty
              | CLOSE
              | CLOSE ON DATE
    """
    p[0] = p[3] if len(p) == 4 else (True
                                     if (p[1] == 'CLOSE') else
                                     self.default_close_date)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_opt_expression">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_opt_expression
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_opt_expression" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>opt_expression : empty
               | expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_opt_expression(self, p):
    """
    opt_expression : empty
                   | expression
    """
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_opt_open">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_opt_open
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_opt_open" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>opt_open : empty
         | OPEN ON DATE</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_opt_open(self, p):
    """
    opt_open : empty
             | OPEN ON DATE
    """
    p[0] = p[3] if len(p) == 4 else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_order_by">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_order_by
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_order_by" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>order_by : empty
         | ORDER BY expr_index_list ordering</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_order_by(self, p):
    """
    order_by : empty
             | ORDER BY expr_index_list ordering
    """
    p[0] = None if len(p) == 2 else OrderBy(p[3], p[4])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_ordering">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_ordering
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_ordering" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>ordering : empty
         | ASC
         | DESC</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_ordering(self, p):
    """
    ordering : empty
             | ASC
             | DESC
    """
    p[0] = p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_pivot_by">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_pivot_by
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_pivot_by" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>pivot_by : empty
         | PIVOT BY column_list</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_pivot_by(self, p):
    """
    pivot_by : empty
             | PIVOT BY column_list
    """
    p[0] = PivotBy(p[3]) if len(p) == 4 else None
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_select_statement">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_select_statement
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_select_statement" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>select_statement : SELECT distinct target_spec from_subselect where                            group_by order_by pivot_by limit flatten</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_select_statement(self, p):
    """
    select_statement : SELECT distinct target_spec from_subselect where \
                       group_by order_by pivot_by limit flatten
    """
    p[0] = Select(p[3], p[4], p[5], p[6], p[7], p[8], p[9], p[2], p[10])
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_target">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_target
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_target" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>target : expression AS ID
       | expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_target(self, p):
    """
    target : expression AS ID
           | expression
    """
    p[0] = Target(p[1], p[3] if len(p) == 4 else None)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_target_list">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_target_list
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_target_list" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>target_list : target
            | target_list COMMA target</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_target_list(self, p):
    """
    target_list : target
                | target_list COMMA target
    """
    p[0] = self.handle_comma_separated_list(p)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_target_spec">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_target_spec
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_target_spec" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>target_spec : ASTERISK
            | target_list</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_target_spec(self, p):
    """
    target_spec : ASTERISK
                | target_list
    """
    p[0] = Wildcard() if p[1] == '*' else p[1]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser.SelectParser.p_where">
<code class="highlight language-python">
beancount.query.query_parser.SelectParser.p_where
(self, p)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.SelectParser.p_where" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>where : empty
      | WHERE expression</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def p_where(self, p):
    """
    where : empty
          | WHERE expression
    """
    if len(p) == 3:
        assert p[2], "Empty WHERE clause is not allowed"
        p[0] = p[2]
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_parser.get_expression_name">
<code class="highlight language-python">
beancount.query.query_parser.get_expression_name
(expr)

        </code>
<a class="headerlink" href="#beancount.query.query_parser.get_expression_name" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Come up with a reasonable identifier for an expression.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>expr</code></td>
<td><code></code></td>
<td>
<p>An expression node.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_expression_name(expr):
    """Come up with a reasonable identifier for an expression.

    Args:
      expr: An expression node.
    """
    if isinstance(expr, Column):
        return expr.name.lower()

    elif isinstance(expr, Function):
        names = [expr.fname.lower()]
        for operand in expr.operands:
            names.append(get_expression_name(operand))
        return '_'.join(names)

    elif isinstance(expr, Constant):
        return 'c{}'.format(re.sub('[^a-z0-9]+', '_', str(expr.value)))

    elif isinstance(expr, UnaryOp):
        return '_'.join([type(expr).__name__.lower(),
                         get_expression_name(expr.operand)])

    elif isinstance(expr, BinaryOp):
        return '_'.join([type(expr).__name__.lower(),
                         get_expression_name(expr.left),
                         get_expression_name(expr.right)])

    else:
        assert False, "Unknown expression type."
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.query_parser_test">
<code>beancount.query.query_parser_test</code>
<a class="headerlink" href="#beancount.query.query_parser_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser_test.QueryParserTestBase">
<code>beancount.query.query_parser_test.QueryParserTestBase</code>
<a class="headerlink" href="#beancount.query.query_parser_test.QueryParserTestBase" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser_test.QueryParserTestBase.assertParse">
<code class="highlight language-python">
beancount.query.query_parser_test.QueryParserTestBase.assertParse
(self, expected, query, debug=False)

        </code>
<a class="headerlink" href="#beancount.query.query_parser_test.QueryParserTestBase.assertParse" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Assert parsed contents from 'query' is 'expected'.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>expected</code></td>
<td><code></code></td>
<td>
<p>An expected AST to compare against the parsed value.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An SQL query to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>debug</code></td>
<td><code></code></td>
<td>
<p>A boolean, if true, print extra debugging information on the console.</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AssertionError</code></td>
<td>
<p>If the actual AST does not match the expected one.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def assertParse(self, expected, query, debug=False):
    """Assert parsed contents from 'query' is 'expected'.

    Args:
      expected: An expected AST to compare against the parsed value.
      query: An SQL query to be parsed.
      debug: A boolean, if true, print extra debugging information on the console.
    Raises:
      AssertionError: If the actual AST does not match the expected one.
    """
    actual = self.parse(query)
    if debug:
        print()
        print()
        print(actual)
        print()
    self.assertEqual(expected, actual)
    return actual
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser_test.QueryParserTestBase.parse">
<code class="highlight language-python">
beancount.query.query_parser_test.QueryParserTestBase.parse
(self, query)

        </code>
<a class="headerlink" href="#beancount.query.query_parser_test.QueryParserTestBase.parse" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Parse one query.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code></code></td>
<td>
<p>An SQL query to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The AST.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def parse(self, query):
    """Parse one query.

    Args:
      query: An SQL query to be parsed.
    Returns:
      The AST.
    """
    return self.parser.parse(query.strip())
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser_test.QueryParserTestBase.setUp">
<code class="highlight language-python">
beancount.query.query_parser_test.QueryParserTestBase.setUp
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_parser_test.QueryParserTestBase.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def setUp(self):
    self.parser = qp.Parser()
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.query_parser_test.TestSelectFromBase">
<code>beancount.query.query_parser_test.TestSelectFromBase</code>
<a class="headerlink" href="#beancount.query.query_parser_test.TestSelectFromBase" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.query_parser_test.TestSelectFromBase.setUp">
<code class="highlight language-python">
beancount.query.query_parser_test.TestSelectFromBase.setUp
(self)

        </code>
<a class="headerlink" href="#beancount.query.query_parser_test.TestSelectFromBase.setUp" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Hook method for setting up the test fixture before exercising it.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def setUp(self):
    super().setUp()
    self.targets = [qp.Target(qp.Column('a'), None),
                    qp.Target(qp.Column('b'), None)]
    self.expr = qp.Equal(qp.Column('d'),
                         qp.And(
                             qp.Function('max', [qp.Column('e')]),
                             qp.Constant(17)))
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.query_parser_test.qSelect">
<code class="highlight language-python">
beancount.query.query_parser_test.qSelect
(target_spec=None, from_clause=None, where_clause=None, group_by=None, order_by=None, pivot_by=None, limit=None, distinct=None, flatten=None)

        </code>
<a class="headerlink" href="#beancount.query.query_parser_test.qSelect" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A convenience constructor for writing tests without having to provide all arguments.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/query_parser_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def qSelect(target_spec=None,
            from_clause=None, where_clause=None,
            group_by=None, order_by=None, pivot_by=None,
            limit=None, distinct=None, flatten=None):
    "A convenience constructor for writing tests without having to provide all arguments."
    return qp.Select(target_spec,
                     from_clause, where_clause,
                     group_by, order_by, pivot_by,
                     limit, distinct, flatten)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.shell">
<code>beancount.query.shell</code>
<a class="headerlink" href="#beancount.query.shell" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<p>An interactive command-line shell interpreter for the Beancount Query Language.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.shell.BQLShell">
<code>beancount.query.shell.BQLShell</code>
<a class="headerlink" href="#beancount.query.shell.BQLShell" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>An interactive shell interpreter for the Beancount query language.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Balances">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Balances
(self, balance)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Balances" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Select balances of some subset of postings. This command is a
convenience and converts into an equivalent Select statement, designed
to extract the most sensible list of columns for the register of a list
of entries as a table.</p>
<p>The general form of a JOURNAL statement loosely follows SQL syntax:</p>
<p>BALANCE [FROM_CLAUSE]</p>
<p>See the SELECT query help for more details on the FROM clause.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Balances(self, balance):
    """
    Select balances of some subset of postings. This command is a
    convenience and converts into an equivalent Select statement, designed
    to extract the most sensible list of columns for the register of a list
    of entries as a table.

    The general form of a JOURNAL statement loosely follows SQL syntax:

       BALANCE [FROM_CLAUSE]

    See the SELECT query help for more details on the FROM clause.
    """
    return self.on_Select(balance)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Errors">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Errors
(self, errors_statement)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Errors" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Print the errors that occurred during parsing.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Errors(self, errors_statement):
    """
    Print the errors that occurred during parsing.
    """
    if self.errors:
        printer.print_errors(self.errors)
    else:
        print('(No errors)', file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Explain">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Explain
(self, explain)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Explain" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Compile and print a compiled statement for debugging.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Explain(self, explain):
    """
    Compile and print a compiled statement for debugging.
    """
    # pylint: disable=invalid-name
    pr = lambda *args: print(*args, file=self.outfile)
    pr("Parsed statement:")
    pr("  {}".format(explain.statement))
    pr()

    # Compile the select statement and print it uot.
    try:
        query = query_compile.compile(explain.statement,
                                      self.env_targets,
                                      self.env_postings,
                                      self.env_entries)
    except query_compile.CompilationError as exc:
        pr(str(exc).rstrip('.'))
        return

    pr("Compiled query:")
    pr("  {}".format(query))
    pr()
    pr("Targets:")
    for c_target in query.c_targets:
        pr("  '{}'{}: {}".format(
            c_target.name or '(invisible)',
            ' (aggregate)' if query_compile.is_aggregate(c_target.c_expr) else '',
            c_target.c_expr.dtype.__name__))
    pr()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Journal">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Journal
(self, journal)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Journal" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Select a journal of some subset of postings. This command is a
convenience and converts into an equivalent Select statement, designed
to extract the most sensible list of columns for the register of a list
of entries as a table.</p>
<p>The general form of a JOURNAL statement loosely follows SQL syntax:</p>
<p>JOURNAL &lt;account-regexp&gt; [FROM_CLAUSE]</p>
<p>See the SELECT query help for more details on the FROM clause.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Journal(self, journal):
    """
    Select a journal of some subset of postings. This command is a
    convenience and converts into an equivalent Select statement, designed
    to extract the most sensible list of columns for the register of a list
    of entries as a table.

    The general form of a JOURNAL statement loosely follows SQL syntax:

       JOURNAL &lt;account-regexp&gt; [FROM_CLAUSE]

    See the SELECT query help for more details on the FROM clause.
    """
    return self.on_Select(journal)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Print">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Print
(self, print_stmt)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Print" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Print entries in Beancount format.</p>
<p>The general form of a PRINT statement includes an SQL-like FROM
selector:</p>
<p>PRINT [FROM &lt;from_expr&gt; ...]</p>
<p>Where:</p>
<p>from_expr: A logical expression that matches on the attributes of
    the directives. See SELECT command for details (this FROM expression
    supports all the same expressions including its OPEN, CLOSE and
    CLEAR operations).</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Print(self, print_stmt):
    """
    Print entries in Beancount format.

    The general form of a PRINT statement includes an SQL-like FROM
    selector:

       PRINT [FROM &lt;from_expr&gt; ...]

    Where:

      from_expr: A logical expression that matches on the attributes of
        the directives. See SELECT command for details (this FROM expression
        supports all the same expressions including its OPEN, CLOSE and
        CLEAR operations).

    """
    # Compile the print statement.
    try:
        c_print = query_compile.compile(print_stmt,
                                        self.env_targets,
                                        self.env_postings,
                                        self.env_entries)
    except query_compile.CompilationError as exc:
        print('ERROR: {}.'.format(str(exc).rstrip('.')), file=self.outfile)
        return

    if self.outfile is sys.stdout:
        query_execute.execute_print(c_print, self.entries, self.options_map,
                                    file=self.outfile)
    else:
        with self.get_pager() as file:
            query_execute.execute_print(c_print, self.entries, self.options_map, file)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Reload">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Reload
(self, unused_statement=None)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Reload" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Reload the input file without restarting the shell.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Reload(self, unused_statement=None):
    """
    Reload the input file without restarting the shell.
    """
    self.entries, self.errors, self.options_map = self.loadfun()
    if self.is_interactive:
        print_statistics(self.entries, self.options_map, self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_RunCustom">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_RunCustom
(self, run_stmt)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_RunCustom" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Run a custom query instead of a SQL command.</p>
<p>RUN &lt;custom-query-name&gt;</p>
<p>Where:</p>
<p>custom-query-name: Should be the name of a custom query to be defined
    in the Beancount input file.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_RunCustom(self, run_stmt):
    """
    Run a custom query instead of a SQL command.

       RUN &lt;custom-query-name&gt;

    Where:

      custom-query-name: Should be the name of a custom query to be defined
        in the Beancount input file.

    """
    custom_query_map = create_custom_query_map(self.entries)
    name = run_stmt.query_name
    if name is None:
        # List the available queries.
        for name in sorted(custom_query_map):
            print(name)
    elif name == "*":
        for name, query in sorted(custom_query_map.items()):
            print('{}:'.format(name))
            self.run_parser(query.query_string, default_close_date=query.date)
            print()
            print()
    else:
        query = None
        if name in custom_query_map:
            query = custom_query_map[name]
        else:  # lookup best query match using name as prefix
            queries = [q for q in custom_query_map if q.startswith(name)]
            if len(queries) == 1:
                name = queries[0]
                query = custom_query_map[name]
        if query:
            statement = self.parser.parse(query.query_string)
            self.dispatch(statement)
        else:
            print("ERROR: Query '{}' not found".format(name))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.BQLShell.on_Select">
<code class="highlight language-python">
beancount.query.shell.BQLShell.on_Select
(self, statement)

        </code>
<a class="headerlink" href="#beancount.query.shell.BQLShell.on_Select" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Extract data from a query on the postings.</p>
<p>The general form of a SELECT statement loosely follows SQL syntax, with
some mild and idiomatic extensions:</p>
<p>SELECT [DISTINCT] [&lt;targets&gt;|*]
   [FROM &lt;from_expr&gt; [OPEN ON &lt;date&gt;] [CLOSE [ON &lt;date&gt;]] [CLEAR]]
   [WHERE &lt;where_expr&gt;]
   [GROUP BY &lt;groups&gt;]
   [ORDER BY &lt;groups&gt; [ASC|DESC]]
   [LIMIT num]</p>
<p>Where:</p>
<p>targets: A list of desired output attributes from the postings, and
    expressions on them. Some of the attributes of the parent transaction
    directive are made available in this context as well. Simple functions
    (that return a single value per row) and aggregation functions (that
    return a single value per group) are available. For the complete
    list of supported columns and functions, see help on "targets".
    You can also provide a wildcard here, which will select a reasonable
    default set of columns for rendering a journal.</p>
<p>from_expr: A logical expression that matches on the attributes of
    the directives (not postings). This allows you to select a subset of
    transactions, so the accounting equation is respected for balance
    reports. For the complete list of supported columns and functions,
    see help on "from".</p>
<p>where_expr: A logical expression that matches on the attributes of
    postings. The available columns are similar to those in the targets
    clause, without the aggregation functions.</p>
<p>OPEN clause: replace all the transactions before the given date by
    summarizing entries and transfer Income and Expenses balances to
    Equity.</p>
<p>CLOSE clause: Remove all the transactions after the given date and</p>
<p>CLEAR: Transfer final Income and Expenses balances to Equity.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def on_Select(self, statement):
    """
    Extract data from a query on the postings.

    The general form of a SELECT statement loosely follows SQL syntax, with
    some mild and idiomatic extensions:

       SELECT [DISTINCT] [&lt;targets&gt;|*]
       [FROM &lt;from_expr&gt; [OPEN ON &lt;date&gt;] [CLOSE [ON &lt;date&gt;]] [CLEAR]]
       [WHERE &lt;where_expr&gt;]
       [GROUP BY &lt;groups&gt;]
       [ORDER BY &lt;groups&gt; [ASC|DESC]]
       [LIMIT num]

    Where:

      targets: A list of desired output attributes from the postings, and
        expressions on them. Some of the attributes of the parent transaction
        directive are made available in this context as well. Simple functions
        (that return a single value per row) and aggregation functions (that
        return a single value per group) are available. For the complete
        list of supported columns and functions, see help on "targets".
        You can also provide a wildcard here, which will select a reasonable
        default set of columns for rendering a journal.

      from_expr: A logical expression that matches on the attributes of
        the directives (not postings). This allows you to select a subset of
        transactions, so the accounting equation is respected for balance
        reports. For the complete list of supported columns and functions,
        see help on "from".

      where_expr: A logical expression that matches on the attributes of
        postings. The available columns are similar to those in the targets
        clause, without the aggregation functions.

      OPEN clause: replace all the transactions before the given date by
        summarizing entries and transfer Income and Expenses balances to
        Equity.

      CLOSE clause: Remove all the transactions after the given date and

      CLEAR: Transfer final Income and Expenses balances to Equity.

    """
    # Compile the SELECT statement.
    try:
        c_query = query_compile.compile(statement,
                                        self.env_targets,
                                        self.env_postings,
                                        self.env_entries)
    except query_compile.CompilationError as exc:
        print('ERROR: {}.'.format(str(exc).rstrip('.')), file=self.outfile)
        return

    # Execute it to obtain the result rows.
    rtypes, rrows = query_execute.execute_query(c_query,
                                                self.entries,
                                                self.options_map)

    # Output the resulting rows.
    if not rrows:
        print("(empty)", file=self.outfile)
    else:
        output_format = self.vars['format']
        if output_format == 'text':
            kwds = dict(boxed=self.vars['boxed'],
                        spaced=self.vars['spaced'],
                        expand=self.vars['expand'])
            if self.outfile is sys.stdout:
                with self.get_pager() as file:
                    query_render.render_text(rtypes, rrows,
                                             self.options_map['dcontext'],
                                             file,
                                             **kwds)
            else:
                query_render.render_text(rtypes, rrows,
                                         self.options_map['dcontext'],
                                         self.outfile,
                                         **kwds)

        elif output_format == 'csv':
            # Numberify CSV output if requested.
            if self.vars['numberify']:
                dformat = self.options_map['dcontext'].build()
                rtypes, rrows = numberify.numberify_results(rtypes, rrows, dformat)

            query_render.render_csv(rtypes, rrows,
                                    self.options_map['dcontext'],
                                    self.outfile,
                                    expand=self.vars['expand'])

        else:
            assert output_format not in _SUPPORTED_FORMATS
            print("Unsupported output format: '{}'.".format(output_format),
                  file=self.outfile)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.shell.DispatchingShell">
<code>beancount.query.shell.DispatchingShell</code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>A usable convenient shell for interpreting commands, with history.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.__init__">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.__init__
(self, is_interactive, parser, outfile, default_format, do_numberify)

        </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.__init__" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create a shell with history.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>is_interactive</code></td>
<td><code></code></td>
<td>
<p>A boolean, true if this serves an interactive tty.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>parser</code></td>
<td><code></code></td>
<td>
<p>A command parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>outfile</code></td>
<td><code></code></td>
<td>
<p>An output file object to write communications to.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>default_format</code></td>
<td><code></code></td>
<td>
<p>A string, the default output format.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def __init__(self, is_interactive, parser, outfile, default_format, do_numberify):
    """Create a shell with history.

    Args:
      is_interactive: A boolean, true if this serves an interactive tty.
      parser: A command parser.
      outfile: An output file object to write communications to.
      default_format: A string, the default output format.
    """
    super().__init__()
    if is_interactive and readline is not None:
        load_history(path.expanduser(HISTORY_FILENAME))
    self.is_interactive = is_interactive
    self.parser = parser
    self.initialize_vars(default_format, do_numberify)
    self.add_help()
    self.outfile = outfile
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.add_help">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.add_help
(self)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.add_help" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Attach help functions for each of the parsed token handlers.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def add_help(self):
    "Attach help functions for each of the parsed token handlers."
    for attrname, func in list(self.__class__.__dict__.items()):
        match = re.match('on_(.*)', attrname)
        if not match:
            continue
        command_name = match.group(1)
        setattr(self.__class__, 'help_{}'.format(command_name.lower()),
                lambda _, fun=func: print(textwrap.dedent(fun.__doc__).strip(),
                                          file=self.outfile))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.cmdloop">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.cmdloop
(self)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.cmdloop" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Override cmdloop to handle keyboard interrupts.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def cmdloop(self):
    """Override cmdloop to handle keyboard interrupts."""
    while True:
        try:
            super().cmdloop()
            break
        except KeyboardInterrupt:
            print('\n(Interrupted)', file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.default">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.default
(self, line)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.default" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Default handling of lines which aren't recognized as native shell commands.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>line</code></td>
<td><code></code></td>
<td>
<p>The string to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def default(self, line):
    """Default handling of lines which aren't recognized as native shell commands.

    Args:
      line: The string to be parsed.
    """
    self.run_parser(line)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.dispatch">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.dispatch
(self, statement)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.dispatch" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Dispatch the given statement to a suitable method.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>statement</code></td>
<td><code></code></td>
<td>
<p>An instance provided by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>Whatever the invoked method happens to return.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def dispatch(self, statement):
    """Dispatch the given statement to a suitable method.

    Args:
      statement: An instance provided by the parser.
    Returns:
      Whatever the invoked method happens to return.
    """
    try:
        method = getattr(self, 'on_{}'.format(type(statement).__name__))
    except AttributeError:
        print("Internal error: statement '{}' is unsupported.".format(statement),
              file=self.outfile)
    else:
        return method(statement)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_clear">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_clear
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_clear" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Clear the history.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_clear(self, _):
    "Clear the history."
    readline.clear_history()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_EOF">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_EOF
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_EOF" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Exit the parser.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def exit(self, _):
    """Exit the parser."""
    print('exit', file=self.outfile)
    return 1
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_exit">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_exit
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_exit" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Exit the parser.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def exit(self, _):
    """Exit the parser."""
    print('exit', file=self.outfile)
    return 1
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_help">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_help
(self, command)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_help" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Strip superfluous semicolon.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_help(self, command):
    """Strip superfluous semicolon."""
    super().do_help(command.rstrip('; \t'))
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_history">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_history
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_history" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Print the command-line history statement.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_history(self, _):
    "Print the command-line history statement."
    if readline is not None:
        for index, line in enumerate(get_history(self.max_entries)):
            print(line, file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_lex">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_lex
(self, line)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_lex" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Just run the lexer on the following command and print the output.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_lex(self, line):
    "Just run the lexer on the following command and print the output."
    try:
        self.parser.tokenize(line)
    except query_parser.ParseError as exc:
        print(exc, file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_parse">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_parse
(self, line)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_parse" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Just run the parser on the following command and print the output.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_parse(self, line):
    "Just run the parser on the following command and print the output."
    print("INPUT: {}".format(repr(line)), file=self.outfile)
    try:
        statement = self.parser.parse(line, True)
        print(statement, file=self.outfile)
    except (query_parser.ParseError,
            query_compile.CompilationError) as exc:
        print(exc, file=self.outfile)
    except Exception as exc:
        traceback.print_exc(file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_quit">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_quit
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_quit" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Exit the parser.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def exit(self, _):
    """Exit the parser."""
    print('exit', file=self.outfile)
    return 1
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_set">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_set
(self, line)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_set" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Get/set shell settings variables.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_set(self, line):
    "Get/set shell settings variables."
    if not line:
        for varname, value in sorted(self.vars.items()):
            print('{}: {}'.format(varname, value), file=self.outfile)
    else:
        components = shlex.split(line)
        varname = components[0]
        if len(components) == 1:
            try:
                value = self.vars[varname]
                print('{}: {}'.format(varname, value), file=self.outfile)
            except KeyError:
                print("Variable '{}' does not exist.".format(varname),
                      file=self.outfile)
        elif len(components) == 2:
            value = components[1]
            try:
                converted_value = self.vars_types[varname](value)
                self.vars[varname] = converted_value
                print('{}: {}'.format(varname, converted_value), file=self.outfile)
            except KeyError:
                print("Variable '{}' does not exist.".format(varname),
                      file=self.outfile)
        else:
            print("Invalid number of arguments.", file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.do_tokenize">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.do_tokenize
(self, line)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.do_tokenize" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Just run the lexer on the following command and print the output.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def do_lex(self, line):
    "Just run the lexer on the following command and print the output."
    try:
        self.parser.tokenize(line)
    except query_parser.ParseError as exc:
        print(exc, file=self.outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.emptyline">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.emptyline
(self)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.emptyline" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Do nothing on an empty line.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def emptyline(self):
    """Do nothing on an empty line."""
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.exit">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.exit
(self, _)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.exit" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Exit the parser.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def exit(self, _):
    """Exit the parser."""
    print('exit', file=self.outfile)
    return 1
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.get_pager">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.get_pager
(self)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.get_pager" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Create and return a context manager to write to, a pager subprocess if required.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A pair of a file object to write to, and a pipe object to wait on (or</p>
</td>
</tr>
</tbody>
</table>
<p>None if not necessary to wait).</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_pager(self):
    """Create and return a context manager to write to, a pager subprocess if required.

    Returns:
      A pair of a file object to write to, and a pipe object to wait on (or
    None if not necessary to wait).
    """
    if self.is_interactive:
        return pager.ConditionalPager(self.vars.get('pager', None),
                                      minlines=misc_utils.get_screen_height())
    else:
        file = (codecs.getwriter("utf-8")(sys.stdout.buffer)
                if hasattr(sys.stdout, 'buffer') else
                sys.stdout)
        return pager.flush_only(file)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.initialize_vars">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.initialize_vars
(self, default_format, do_numberify)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.initialize_vars" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Initialize the setting variables of the interactive shell.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def initialize_vars(self, default_format, do_numberify):
    """Initialize the setting variables of the interactive shell."""
    self.vars_types = {
        'pager': str,
        'format': str,
        'boxed': convert_bool,
        'spaced': convert_bool,
        'expand': convert_bool,
        'numberify': convert_bool,
        }
    self.vars = {
        'pager': os.environ.get('PAGER', None),
        'format': default_format,
        'boxed': False,
        'spaced': False,
        'expand': False,
        'numberify': do_numberify,
        }
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell.DispatchingShell.run_parser">
<code class="highlight language-python">
beancount.query.shell.DispatchingShell.run_parser
(self, line, default_close_date=None)

        </code>
<a class="headerlink" href="#beancount.query.shell.DispatchingShell.run_parser" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Handle statements via our parser instance and dispatch to appropriate methods.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>line</code></td>
<td><code></code></td>
<td>
<p>The string to be parsed.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>default_close_date</code></td>
<td><code></code></td>
<td>
<p>A datetimed.date instance, the default close date.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def run_parser(self, line, default_close_date=None):
    """Handle statements via our parser instance and dispatch to appropriate methods.

    Args:
      line: The string to be parsed.
      default_close_date: A datetimed.date instance, the default close date.
    """
    try:
        statement = self.parser.parse(line,
                                      default_close_date=default_close_date)
        self.dispatch(statement)
    except query_parser.ParseError as exc:
        print(exc, file=self.outfile)
    except Exception as exc:
        traceback.print_exc(file=self.outfile)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.convert_bool">
<code class="highlight language-python">
beancount.query.shell.convert_bool
(string)

        </code>
<a class="headerlink" href="#beancount.query.shell.convert_bool" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Convert a string to a boolean.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>string</code></td>
<td><code></code></td>
<td>
<p>A string representing a boolean.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>The corresponding boolean.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def convert_bool(string):
    """Convert a string to a boolean.

    Args:
      string: A string representing a boolean.
    Returns:
      The corresponding boolean.
    """
    return not string.lower() in ('f', 'false', '0')
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.create_custom_query_map">
<code class="highlight language-python">
beancount.query.shell.create_custom_query_map
(entries)

        </code>
<a class="headerlink" href="#beancount.query.shell.create_custom_query_map" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Extract a mapping of the custom queries from the list of entries.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of entries.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A map of query-name strings to Query directives.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def create_custom_query_map(entries):
    """Extract a mapping of the custom queries from the list of entries.

    Args:
      entries: A list of entries.
    Returns:
      A map of query-name strings to Query directives.
    """
    query_map = {}
    for entry in entries:
        if not isinstance(entry, data.Query):
            continue
        if entry.name in query_map:
            logging.warning("Duplicate query: %s", entry.name)
        query_map[entry.name] = entry
    return query_map
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.generate_env_attribute_list">
<code class="highlight language-python">
beancount.query.shell.generate_env_attribute_list
(env)

        </code>
<a class="headerlink" href="#beancount.query.shell.generate_env_attribute_list" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Generate a dictionary of rendered attribute lists for help.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>env</code></td>
<td><code></code></td>
<td>
<p>An instance of an environment.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A dict with keys 'columns', 'functions' and 'aggregates' to rendered
and formatted strings.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def generate_env_attribute_list(env):
    """Generate a dictionary of rendered attribute lists for help.

    Args:
      env: An instance of an environment.
    Returns:
      A dict with keys 'columns', 'functions' and 'aggregates' to rendered
      and formatted strings.
    """
    wrapper = textwrap.TextWrapper(initial_indent='  ',
                                   subsequent_indent='    ',
                                   drop_whitespace=True,
                                   width=80)

    str_columns = generate_env_attributes(
        wrapper, env.columns)
    str_simple = generate_env_attributes(
        wrapper, env.functions,
        lambda node: not issubclass(node, query_compile.EvalAggregator))
    str_aggregate = generate_env_attributes(
        wrapper, env.functions,
        lambda node: issubclass(node, query_compile.EvalAggregator))

    return dict(columns=str_columns,
                functions=str_simple,
                aggregates=str_aggregate)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.generate_env_attributes">
<code class="highlight language-python">
beancount.query.shell.generate_env_attributes
(wrapper, field_dict, filter_pred=None)

        </code>
<a class="headerlink" href="#beancount.query.shell.generate_env_attributes" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Generate a string of all the help functions of the attributes.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>wrapper</code></td>
<td><code></code></td>
<td>
<p>A TextWrapper instance to format the paragraphs.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>field_dict</code></td>
<td><code></code></td>
<td>
<p>A dict of the field-names to the node instances, fetch from an
environment.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>filter_pred</code></td>
<td><code></code></td>
<td>
<p>A predicate to filter the desired columns. This is applied to
the evaluator node instances.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A formatted multiline string, ready for insertion in a help text.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def generate_env_attributes(wrapper, field_dict, filter_pred=None):
    """Generate a string of all the help functions of the attributes.

    Args:
      wrapper: A TextWrapper instance to format the paragraphs.
      field_dict: A dict of the field-names to the node instances, fetch from an
        environment.
      filter_pred: A predicate to filter the desired columns. This is applied to
        the evaluator node instances.
    Returns:
      A formatted multiline string, ready for insertion in a help text.
    """
    # Expand the name if its key has argument types.
    #
    # FIXME: Render the __intypes__ here nicely instead of the key.
    flat_items = []
    for name, column_cls in field_dict.items():
        if isinstance(name, tuple):
            name = name[0]

        if issubclass(column_cls, query_compile.EvalFunction):
            name = name.upper()
            args = []
            for dtypes in column_cls.__intypes__:
                if isinstance(dtypes, (tuple, list)):
                    arg = '|'.join(dtype.__name__ for dtype in dtypes)
                else:
                    arg = dtypes.__name__
                args.append(arg)
            name = "{}({})".format(name, ','.join(args))

        flat_items.append((name, column_cls))

    # Render each of the attributes.
    oss = io.StringIO()
    for name, column_cls in sorted(flat_items):
        if filter_pred and not filter_pred(column_cls):
            continue
        docstring = column_cls.__doc__ or "[See class {}]".format(column_cls.__name__)
        if issubclass(column_cls, query_compile.EvalColumn):
            docstring += " Type: {}.".format(column_cls().dtype.__name__)
            # if hasattr(column_cls, '__equivalent__'):
            #     docstring += " Attribute:{}.".format(column_cls.__equivalent__)

        text = re.sub('[ \t]+', ' ', docstring.strip().replace('\n', ' '))
        doc = "'{}': {}".format(name, text)
        oss.write(wrapper.fill(doc))
        oss.write('\n')

    return oss.getvalue().rstrip()
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.get_history">
<code class="highlight language-python">
beancount.query.shell.get_history
(max_entries)

        </code>
<a class="headerlink" href="#beancount.query.shell.get_history" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Return the history in the readline buffer.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>max_entries</code></td>
<td><code></code></td>
<td>
<p>An integer, the maximum number of entries to return.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A list of string, the previous history of commands.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def get_history(max_entries):
    """Return the history in the readline buffer.

    Args:
      max_entries: An integer, the maximum number of entries to return.
    Returns:
      A list of string, the previous history of commands.
    """
    num_entries = readline.get_current_history_length()
    assert num_entries &gt;= 0
    start = max(0, num_entries - max_entries)
    return [readline.get_history_item(index+1)
            for index in range(start, num_entries)]
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.load_history">
<code class="highlight language-python">
beancount.query.shell.load_history
(filename)

        </code>
<a class="headerlink" href="#beancount.query.shell.load_history" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Load the shell's past history.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the file containing the shell history.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def load_history(filename):
    """Load the shell's past history.

    Args:
      filename: A string, the name of the file containing the shell history.
    """
    readline.parse_and_bind("tab:complete")
    if hasattr(readline, "read_history_file"):
        try:
            readline.read_history_file(filename)
        except IOError:
            # Don't error on absent file.
            pass
        atexit.register(save_history, filename)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.print_statistics">
<code class="highlight language-python">
beancount.query.shell.print_statistics
(entries, options_map, outfile)

        </code>
<a class="headerlink" href="#beancount.query.shell.print_statistics" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Print summary statistics to stdout.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>options_map</code></td>
<td><code></code></td>
<td>
<p>An options map. as produced by the parser.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>outfile</code></td>
<td><code></code></td>
<td>
<p>A file object to write to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def print_statistics(entries, options_map, outfile):
    """Print summary statistics to stdout.

    Args:
      entries: A list of directives.
      options_map: An options map. as produced by the parser.
      outfile: A file object to write to.
    """
    num_directives, num_transactions, num_postings = summary_statistics(entries)
    if 'title' in options_map:
        print('Input file: "{}"'.format(options_map['title']), file=outfile)
    print("Ready with {} directives ({} postings in {} transactions).".format(
        num_directives, num_postings, num_transactions),
          file=outfile)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.save_history">
<code class="highlight language-python">
beancount.query.shell.save_history
(filename)

        </code>
<a class="headerlink" href="#beancount.query.shell.save_history" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Save the shell history. This should be invoked on exit.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filename</code></td>
<td><code></code></td>
<td>
<p>A string, the name of the file to save the history to.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def save_history(filename):
    """Save the shell history. This should be invoked on exit.

    Args:
      filename: A string, the name of the file to save the history to.
    """
    readline.write_history_file(filename)
</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell.summary_statistics">
<code class="highlight language-python">
beancount.query.shell.summary_statistics
(entries)

        </code>
<a class="headerlink" href="#beancount.query.shell.summary_statistics" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Calculate basic summary statistics to output a brief welcome message.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>entries</code></td>
<td><code></code></td>
<td>
<p>A list of directives.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code></code></td>
<td>
<p>A tuple of three integers, the total number of directives parsed, the total number
of transactions and the total number of postings there in.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>beancount/query/shell.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def summary_statistics(entries):
    """Calculate basic summary statistics to output a brief welcome message.

    Args:
      entries: A list of directives.
    Returns:
      A tuple of three integers, the total number of directives parsed, the total number
      of transactions and the total number of postings there in.
    """
    num_directives = len(entries)
    num_transactions = 0
    num_postings = 0
    for entry in entries:
        if isinstance(entry, data.Transaction):
            num_transactions += 1
            num_postings += len(entry.postings)
    return (num_directives, num_transactions, num_postings)
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="beancount.query.shell_test">
<code>beancount.query.shell_test</code>
<a class="headerlink" href="#beancount.query.shell_test" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.shell_test.TestShell">
<code>beancount.query.shell_test.TestShell</code>
<a class="headerlink" href="#beancount.query.shell_test.TestShell" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h4 class="doc doc-heading" id="beancount.query.shell_test.TestShell.test_success">
<code class="highlight language-python">
beancount.query.shell_test.TestShell.test_success
(self, filename)

        </code>
<a class="headerlink" href="#beancount.query.shell_test.TestShell.test_success" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>2013-01-01 open Assets:Account1
2013-01-01 open Assets:Account2
2013-01-01 open Assets:Account3
2013-01-01 open Equity:Unknown</p>
<p>2013-04-05 *
  Equity:Unknown
  Assets:Account1     5000 USD</p>
<p>2013-04-05 *
  Assets:Account1     -3000 USD
  Assets:Account2        30 BOOG {100 USD}</p>
<p>2013-04-05 *
  Assets:Account1     -1000 USD
  Assets:Account3       800 EUR @ 1.25 USD</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">@test_utils.docfile
def test_success(self, filename):
    """
    2013-01-01 open Assets:Account1
    2013-01-01 open Assets:Account2
    2013-01-01 open Assets:Account3
    2013-01-01 open Equity:Unknown

    2013-04-05 *
      Equity:Unknown
      Assets:Account1     5000 USD

    2013-04-05 *
      Assets:Account1     -3000 USD
      Assets:Account2        30 BOOG {100 USD}

    2013-04-05 *
      Assets:Account1     -1000 USD
      Assets:Account3       800 EUR @ 1.25 USD
    """
    with test_utils.capture('stdout', 'stderr') as (stdout, _):
        test_utils.run_with_args(shell.main, [filename, "SELECT 1;"])
    self.assertTrue(stdout.getvalue())
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="beancount.query.shell_test.TestUseCases">
<code>beancount.query.shell_test.TestUseCases</code>
<a class="headerlink" href="#beancount.query.shell_test.TestUseCases" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Testing all the use cases from the proposal here.
    I'm hoping to replace reports by these queries instead.</p>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="beancount.query.shell_test.runshell">
<code class="highlight language-python">
beancount.query.shell_test.runshell
(function)

        </code>
<a class="headerlink" href="#beancount.query.shell_test.runshell" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Decorate a function to run the shell and return the output.</p>
<details class="quote">
<summary>Source code in <code>beancount/query/shell_test.py</code></summary>
<pre class="highlight"><code class="language-python linenums">def runshell(function):
    """Decorate a function to run the shell and return the output."""
    def test_function(self):
        def loadfun():
            return entries, errors, options_map
        with test_utils.capture('stdout') as stdout:
            shell_obj = shell.BQLShell(False, loadfun, sys.stdout)
            shell_obj.on_Reload()
            shell_obj.onecmd(function.__doc__)
        return function(self, stdout.getvalue())
    return test_function
</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-right" href="beancount.reports.html" title="beancount.reports">Next <span class="icon icon-circle-arrow-right"></span></a>
<a class="btn btn-neutral" href="beancount.prices.html" title="beancount.prices"><span class="icon icon-circle-arrow-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<a class="fa fa-github" href="https://github.com/beancount/docs/" style="float: left; color: #fcfcfc"> GitHub</a>
<span><a href="beancount.prices.html" style="color: #fcfcfc;"> Previous</a></span>
<span style="margin-left: 15px"><a href="beancount.reports.html" style="color: #fcfcfc">Next </a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme.js"></script>
<script defer="" src="../js/extra.js"></script>
<script defer="" src="../search/main.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
